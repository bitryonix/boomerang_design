<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4845px" preserveAspectRatio="none" style="width:3972px;height:4845px;background:#FFFFFF;" version="1.1" viewBox="0 0 3972 4845" width="3972px" zoomAndPan="magnify"><title>Duress Protection Withdrawal Sequence Diagram</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="345.1967" x="1814.9639" y="29.9659">Duress Protection Withdrawal Sequence Diagram</text><rect fill="#F0F8FF" height="4793.2211" style="stroke:#181818;stroke-width:0.5;" width="2215.4671" x="179.9427" y="46.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="60.2941" x="1257.5292" y="59.9649">User Side</text><rect fill="none" height="91.118" style="stroke:#000000;stroke-width:1.5;" width="555.6545" x="977" y="3101.918"/><rect fill="none" height="91.118" style="stroke:#000000;stroke-width:1.5;" width="525.5205" x="992" y="3207.036"/><rect fill="none" height="55.412" style="stroke:#000000;stroke-width:1.5;" width="420.4283" x="3212" y="4029.0406"/><rect fill="none" height="73.118" style="stroke:#000000;stroke-width:1.5;" width="647.1614" x="3099" y="4098.4526"/><rect fill="none" height="108.5301" style="stroke:#000000;stroke-width:1.5;" width="436.4775" x="3215" y="4185.5707"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="198.2516" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="201.9427" x2="201.9427" y1="146.8419" y2="4757.2211"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="724.9362" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="727.9753" x2="727.9753" y1="146.8419" y2="4757.2211"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="1251.6208" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1254.7749" x2="1254.7749" y1="146.8419" y2="4757.2211"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="1778.3054" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1781.5704" x2="1781.5704" y1="146.8419" y2="4757.2211"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="2365.6959" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2368.9819" x2="2368.9819" y1="146.8419" y2="4757.2211"/></g><g><title>WTs</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="2892.3805" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2895.6255" x2="2895.6255" y1="146.8419" y2="4757.2211"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="3419.0651" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3423.0421" x2="3423.0421" y1="146.8419" y2="4757.2211"/></g><g><title>Peers</title><rect fill="#000000" fill-opacity="0.00000" height="4610.3792" width="8" x="3945.7497" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3949.3747" x2="3949.3747" y1="146.8419" y2="4757.2211"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="183.9427" y="142.7399">User</text><ellipse cx="202.2516" cy="76.2739" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M202.2516,84.2739 L202.2516,111.2739 M189.2516,92.2739 L215.2516,92.2739 M202.2516,111.2739 L189.2516,126.2739 M202.2516,111.2739 L215.2516,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="183.9427" y="4771.187">User</text><ellipse cx="202.2516" cy="4783.789" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M202.2516,4791.789 L202.2516,4818.789 M189.2516,4799.789 L215.2516,4799.789 M202.2516,4818.789 L189.2516,4833.789 M202.2516,4818.789 L215.2516,4833.789" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="711.9753" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="718.9753" y="134.7399">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="711.9753" y="4756.2211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="718.9753" y="4778.187">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="1220.7749" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="1227.7749" y="134.7399">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="1220.7749" y="4756.2211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="1227.7749" y="4778.187">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1767.5704" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1774.5704" y="134.7399">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1767.5704" y="4756.2211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1774.5704" y="4778.187">ST</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="2347.9819" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="2354.9819" y="134.7399">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="2347.9819" y="4756.2211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="2354.9819" y="4778.187">Niso</text></g><g class="participant participant-head" data-participant="WTs"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.5099" x="2875.6255" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.5099" x="2882.6255" y="134.7399">WTs</text></g><g class="participant participant-tail" data-participant="WTs"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.5099" x="2875.6255" y="4756.2211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.5099" x="2882.6255" y="4778.187">WTs</text></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3400.0421" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3407.0421" y="134.7399">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3400.0421" y="4756.2211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3407.0421" y="4778.187">SARs</text></g><g class="participant participant-head" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7499" x="3928.3747" y="142.7399">Peers</text><ellipse cx="3949.7497" cy="76.2739" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3949.7497,84.2739 L3949.7497,111.2739 M3936.7497,92.2739 L3962.7497,92.2739 M3949.7497,111.2739 L3936.7497,126.2739 M3949.7497,111.2739 L3962.7497,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7499" x="3928.3747" y="4771.187">Peers</text><ellipse cx="3949.7497" cy="4783.789" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3949.7497,4791.789 L3949.7497,4818.789 M3936.7497,4799.789 L3962.7497,4799.789 M3949.7497,4818.789 L3936.7497,4833.789 M3949.7497,4818.789 L3962.7497,4833.789" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="message" data-participant-1="User" data-participant-2="Iso"><polygon fill="#181818" points="213.2516,176.5479,203.2516,180.5479,213.2516,184.5479,209.2516,180.5479" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="716.9362,176.5479,726.9362,180.5479,716.9362,184.5479,720.9362,180.5479" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.2516" x2="722.9362" y1="180.5479" y2="180.5479"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="219.2516" y="174.7389">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><polygon fill="#181818" points="739.9362,208.2539,729.9362,212.2539,739.9362,216.2539,735.9362,212.2539" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1243.6208,208.2539,1253.6208,212.2539,1243.6208,216.2539,1247.6208,212.2539" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="733.9362" x2="1249.6208" y1="212.2539" y2="212.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="745.9362" y="206.4449">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="Boomlet" data-participant-2="ST"><polygon fill="#181818" points="1266.6208,239.9599,1256.6208,243.9599,1266.6208,247.9599,1262.6208,243.9599" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1770.3054,239.9599,1780.3054,243.9599,1770.3054,247.9599,1774.3054,243.9599" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1260.6208" x2="1776.3054" y1="243.9599" y2="243.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="1272.6208" y="238.1509">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="ST" data-participant-2="Niso"><polygon fill="#181818" points="1793.3054,271.6659,1783.3054,275.6659,1793.3054,279.6659,1789.3054,275.6659" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2357.6959,271.6659,2367.6959,275.6659,2357.6959,279.6659,2361.6959,275.6659" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1787.3054" x2="2363.6959" y1="275.6659" y2="275.6659"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="1799.3054" y="269.8569">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="Niso" data-participant-2="WTs"><polygon fill="#181818" points="2380.6959,303.3719,2370.6959,307.3719,2380.6959,311.3719,2376.6959,307.3719" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2884.3805,303.3719,2894.3805,307.3719,2884.3805,311.3719,2888.3805,307.3719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2374.6959" x2="2890.3805" y1="307.3719" y2="307.3719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="2386.6959" y="301.5629">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="WTs" data-participant-2="SARs"><polygon fill="#181818" points="2907.3805,335.0779,2897.3805,339.0779,2907.3805,343.0779,2903.3805,339.0779" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3411.0651,335.0779,3421.0651,339.0779,3411.0651,343.0779,3415.0651,339.0779" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2901.3805" x2="3417.0651" y1="339.0779" y2="339.0779"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="2913.3805" y="333.2689">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="SARs" data-participant-2="Peers"><polygon fill="#181818" points="3434.0651,366.784,3424.0651,370.784,3434.0651,374.784,3430.0651,370.784" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3937.7497,366.784,3947.7497,370.784,3937.7497,374.784,3941.7497,370.784" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3428.0651" x2="3943.7497" y1="370.784" y2="370.784"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.6846" x="3440.0651" y="364.975">keeping                       the                              social                                                  distance</text></g><path d="M1161,383.784 L1161,516.784 L1349,516.784 L1349,393.784 L1339,383.784 L1161,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1339,383.784 L1339,393.784 L1349,393.784 L1339,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.886" x="1167" y="402.681">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1167" y="420.387">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3221" x="1167" y="438.093">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1167" y="455.799">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1167" y="473.505">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1167" y="491.2111">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.4051" x="1167" y="508.9171">duress_consent_set</text><path d="M1688,383.784 L1688,481.784 L1876,481.784 L1876,393.784 L1866,383.784 L1688,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1866,383.784 L1866,393.784 L1876,393.784 L1866,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.69" x="1694" y="402.681">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1694" y="420.387">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9831" x="1694" y="438.093">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1694" y="455.799">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1694" y="473.505">shared_boomlet_st_privkey</text><path d="M708,383.784 L708,428.784 L748,428.784 L748,393.784 L738,383.784 L708,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M738,383.784 L738,393.784 L748,393.784 L738,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.565" x="714" y="402.681">Iso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="714" y="420.387">&#160;</text><path d="M44,383.784 L44,428.784 L360,428.784 L360,393.784 L350,383.784 L44,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M350,383.784 L350,393.784 L360,393.784 L350,383.784" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.874" x="50" y="402.681">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.5032" x="50" y="420.387">name_of_5_consent_countries_in_brain_memory</text><polygon fill="#FF0000" points="1129,527.7261,1381,527.7261,1391,539.7261,1381,552.7261,1129,552.7261,1119,539.7261,1129,527.7261" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.3523" x="1131" y="545.6231">DURESS CHECK INITIATED VIA BOOMLET</text><polygon fill="#FEFFDD" points="840,563.4321,1670,563.4321,1680,611.4321,1670,659.4321,840,659.4321,830,611.4321,840,563.4321" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4162" x="842" y="581.3291">Boomlet will create 5 randomly ordered set of numbers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.8533" x="842" y="599.0351">between 1 and 195 inclusive and encrypt the container collection with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.0961" x="842" y="616.7411">its shared key with ST:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.0003" x="842" y="634.4472">temp_duress_message_collection:=[rand_order[1..195]; 5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="826.2415" x="842" y="652.1532">_duress_message_collection_encrypted_by_boomlet_for_st:=AES_encrypt(shared_boomlet_st_privkey, temp_duress_message_collection)</text><path d="M1077,669.9622 L1077,860.9622 L1433,860.9622 L1433,679.9622 L1423,669.9622 L1077,669.9622" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1423,669.9622 L1423,679.9622 L1433,679.9622 L1423,669.9622" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.886" x="1083" y="688.8592">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1083" y="706.5652">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3221" x="1083" y="724.2712">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1083" y="741.9772">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1083" y="759.6833">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1083" y="777.3893">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.4051" x="1083" y="795.0953">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="188.3572" x="1083" y="830.5073">temp_duress_message_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="329.1864" x="1083" y="848.2133">_duress_message_collection_encrypted_by_boomlet_for_st</text><line style="stroke:#181818;stroke-width:1;" x1="1078" x2="1213.6817" y1="807.7573" y2="807.7573"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1213.6817" y="812.3013">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1296.5047" x2="1432.1864" y1="807.7573" y2="807.7573"/><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><polygon fill="#181818" points="2357.6959,885.7284,2367.6959,889.7284,2357.6959,893.7284,2361.6959,889.7284" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1255.6208" x2="2363.6959" y1="889.7284" y2="889.7284"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5851" x="1262.6208" y="883.9194">Message 01:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.6103" x="1345.2059" y="883.9194">duress_message_collection_encrypted_by_boomlet_for_st</text></g><polygon fill="#FEFFDD" points="2176,902.7284,2561,902.7284,2571,923.7284,2561,945.7284,2176,945.7284,2166,923.7284,2176,902.7284" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381.5243" x="2178" y="920.6254">Niso will encode the received encrypted message to a QR code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.7123" x="2178" y="938.3314">and will display it on its monitor for ST to scan.</text><path d="M2191,956.1404 L2191,1040.1404 L2547,1040.1404 L2547,966.1404 L2537,956.1404 L2191,956.1404" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2537,956.1404 L2537,966.1404 L2547,966.1404 L2537,956.1404" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.042" x="2197" y="975.0374">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="2197" y="992.7434">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="329.1864" x="2197" y="1028.1555">_duress_message_collection_encrypted_by_boomlet_for_st</text><line style="stroke:#181818;stroke-width:1;" x1="2192" x2="2327.6817" y1="1005.4054" y2="1005.4054"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="2327.6817" y="1009.9494">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2410.5047" x2="2546.1864" y1="1005.4054" y2="1005.4054"/><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1793.3054,1065.6705,1783.3054,1069.6705,1793.3054,1073.6705,1789.3054,1069.6705" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2369.1959" cy="1068.9205" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1787.3054" x2="2364.6959" y1="1069.6705" y2="1069.6705"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5851" x="1799.3054" y="1063.8615">Message 02:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.928" x="1881.8905" y="1063.8615">QR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.4103" x="1900.8185" y="1063.8615">(duress_message_collection_encrypted_by_boomlet_for_st)</text></g><polygon fill="#FEFFDD" points="1389,1082.6705,2175,1082.6705,2185,1103.6705,2175,1125.6705,1389,1125.6705,1379,1103.6705,1389,1082.6705" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.4612" x="1391" y="1100.5675">ST will decrypt the received message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="782.4835" x="1391" y="1118.2735">duress_message_collection:=AES_decrypt(shared_boomlet_st_privkey, duress_message_collection_encrypted_by_boomlet_for_st)</text><path d="M1688,1136.0825 L1688,1273.0825 L1876,1273.0825 L1876,1146.0825 L1866,1136.0825 L1688,1136.0825" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1866,1136.0825 L1866,1146.0825 L1876,1146.0825 L1866,1136.0825" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.69" x="1694" y="1154.9795">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1694" y="1172.6855">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9831" x="1694" y="1190.3916">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1694" y="1208.0976">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1694" y="1225.8036">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="158.6522" x="1694" y="1261.2156">_duress_message_collection</text><line style="stroke:#181818;stroke-width:1;" x1="1689" x2="1740.6005" y1="1238.4656" y2="1238.4656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1740.6005" y="1243.0096">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1823.4236" x2="1875.0242" y1="1238.4656" y2="1238.4656"/><polygon fill="#FEFFDD" points="1594,1284.0246,1970,1284.0246,1980,1314.0246,1970,1345.0246,1594,1345.0246,1584,1314.0246,1594,1284.0246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.2613" x="1596" y="1301.9216">ST will assign a country to each of the 5 sets retrieved</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="372.5413" x="1596" y="1319.6277">after decryption in the previous manner and show 5 columns</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4712" x="1596" y="1337.3337">to the user on its monitor.</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="213.2516,1369.8487,203.2516,1373.8487,213.2516,1377.8487,209.2516,1373.8487" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1781.8054" cy="1373.0987" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="207.2516" x2="1777.3054" y1="1373.8487" y2="1373.8487"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5851" x="219.2516" y="1368.0397">Message 03:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.403" x="301.8367" y="1368.0397">Monitor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4202" x="354.2397" y="1368.0397">(duress_message_collection)</text></g><polygon fill="#FEFFDD" points="15,1386.8487,389,1386.8487,399,1407.8487,389,1429.8487,15,1429.8487,5,1407.8487,15,1386.8487" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370.5132" x="17" y="1404.7457">User will select 1 country from each column shown on the ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.8482" x="17" y="1422.4517">to signal their duress situation</text><path d="M44,1440.2607 L44,1503.2607 L360,1503.2607 L360,1450.2607 L350,1440.2607 L44,1440.2607" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M350,1440.2607 L350,1450.2607 L360,1450.2607 L350,1440.2607" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.874" x="50" y="1459.1577">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.5032" x="50" y="1476.8638">name_of_5_consent_countries_in_brain_memory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="254.9043" x="50" y="1494.5698">_duress_message_collection_index_collection</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="201.7516" cy="1531.3348" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1770.3054,1528.0848,1780.3054,1532.0848,1770.3054,1536.0848,1774.3054,1532.0848" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="206.2516" x2="1776.3054" y1="1532.0848" y2="1532.0848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5851" x="209.2516" y="1526.2758">Message 04:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5461" x="291.8367" y="1526.2758">ST's Joystick</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.8872" x="370.3828" y="1526.2758">(duress_message_collection_index_collection)</text></g><path d="M1641,1545.0848 L1641,1682.0848 L1922,1682.0848 L1922,1555.0848 L1912,1545.0848 L1641,1545.0848" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1912,1545.0848 L1912,1555.0848 L1922,1555.0848 L1912,1545.0848" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.69" x="1647" y="1563.9818">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1647" y="1581.6878">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9831" x="1647" y="1599.3938">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1647" y="1617.0999">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1647" y="1634.8059">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="254.9043" x="1647" y="1670.2179">_duress_message_collection_index_collection</text><line style="stroke:#181818;stroke-width:1;" x1="1642" x2="1740.5406" y1="1647.4679" y2="1647.4679"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1740.5406" y="1652.0119">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1823.3637" x2="1921.9043" y1="1647.4679" y2="1647.4679"/><polygon fill="#FEFFDD" points="1285,1693.0269,2278,1693.0269,2288,1723.0269,2278,1754.0269,1285,1754.0269,1275,1723.0269,1285,1693.0269" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.4713" x="1287" y="1710.9239">ST will encrypt `duress_message_collection_index_collection`</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.4402" x="1287" y="1728.6299">with `shared_boomlet_st_privkey`:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="989.4566" x="1287" y="1746.336">duress_message_collection_index_collection_encrypted_by_st_for_boomlet:=AES_encrypt(shared_boomlet_st_privkey, duress_message_collection_index_collection)</text><path d="M1556,1764.145 L1556,1901.145 L2008,1901.145 L2008,1774.145 L1998,1764.145 L1556,1764.145" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1998,1764.145 L1998,1774.145 L2008,1774.145 L1998,1764.145" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.69" x="1562" y="1783.042">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1562" y="1800.748">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9831" x="1562" y="1818.454">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1562" y="1836.16">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1562" y="1853.866">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="425.4384" x="1562" y="1889.2781">_duress_message_collection_index_collection_encrypted_by_st_for_boomlet</text><line style="stroke:#181818;stroke-width:1;" x1="1557" x2="1740.8077" y1="1866.528" y2="1866.528"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1740.8077" y="1871.0721">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1823.6308" x2="2007.4384" y1="1866.528" y2="1866.528"/><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1781.8054" cy="1930.0431" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2357.6959,1926.7931,2367.6959,1930.7931,2357.6959,1934.7931,2361.6959,1930.7931" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1786.3054" x2="2363.6959" y1="1930.7931" y2="1930.7931"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5851" x="1789.3054" y="1924.9841">Message 05:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.928" x="1871.8905" y="1924.9841">QR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.8774" x="1890.8185" y="1924.9841">(duress_message_collection_index_collection_encrypted_by_st_for_boomlet)</text></g><path d="M2143,1943.7931 L2143,2027.7931 L2595,2027.7931 L2595,1953.7931 L2585,1943.7931 L2143,1943.7931" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2585,1943.7931 L2585,1953.7931 L2595,1953.7931 L2585,1943.7931" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.042" x="2149" y="1962.6901">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="2149" y="1980.3961">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="425.4384" x="2149" y="2015.8082">_duress_message_collection_index_collection_encrypted_by_st_for_boomlet</text><line style="stroke:#181818;stroke-width:1;" x1="2144" x2="2327.8077" y1="1993.0581" y2="1993.0581"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="2327.8077" y="1997.6021">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2410.6308" x2="2594.4384" y1="1993.0581" y2="1993.0581"/><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1266.6208,2053.3232,1256.6208,2057.3232,1266.6208,2061.3232,1262.6208,2057.3232" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2369.1959" cy="2056.5732" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1260.6208" x2="2364.6959" y1="2057.3232" y2="2057.3232"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="78.5851" x="1272.6208" y="2051.5142">Message 06:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="454.0774" x="1355.2059" y="2051.5142">duress_message_collection_index_collection_encrypted_by_st_for_boomlet</text></g><polygon fill="#FEFFDD" points="758,2070.3232,1751,2070.3232,1761,2091.3232,1751,2113.3232,758,2113.3232,748,2091.3232,758,2070.3232" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.8102" x="760" y="2088.2202">Boomlet will decrypt the received message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="989.4176" x="760" y="2105.9262">duress_message_collection_index_collection:=AES_decrypt(shared_boomlet_st_privkey, duress_message_collection_index_collection_encrypted_by_st_for_boomlet)</text><path d="M1114,2123.7352 L1114,2314.7352 L1395,2314.7352 L1395,2133.7352 L1385,2123.7352 L1114,2123.7352" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1385,2123.7352 L1385,2133.7352 L1395,2133.7352 L1385,2123.7352" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.886" x="1120" y="2142.6322">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1120" y="2160.3382">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3221" x="1120" y="2178.0443">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1120" y="2195.7503">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1120" y="2213.4563">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1120" y="2231.1623">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.4051" x="1120" y="2248.8683">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.5672" x="1120" y="2284.2804">temp_duress_message_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="254.9043" x="1120" y="2301.9864">_duress_message_collection_index_collection</text><line style="stroke:#181818;stroke-width:1;" x1="1115" x2="1213.5406" y1="2261.5303" y2="2261.5303"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1213.5406" y="2266.0743">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1296.3637" x2="1394.9043" y1="2261.5303" y2="2261.5303"/><polygon fill="#FEFFDD" points="988,2324.7954,1522,2324.7954,1532,2363.7954,1522,2402.7954,988,2402.7954,978,2363.7954,988,2324.7954" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="465.4134" x="990" y="2342.6924">Boomlet will search for the indices in `temp_duress_message_collection` and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="507.2603" x="990" y="2360.3984">if the resulting 5 numbers corresponding to the aforementioned indices, constitute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="530.9203" x="990" y="2378.1044">the same set as the `duress_consent_set`, boomlet knows that the user is not in duress.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.2702" x="990" y="2395.8104">Otherwise the user is in duress.</text><polygon fill="#FEFFDD" points="1033,2413.6194,1477,2413.6194,1487,2443.6194,1477,2474.6194,1033,2474.6194,1023,2443.6194,1033,2413.6194" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440.9213" x="1035" y="2431.5165">Boomlet will drop redundant data and indicate user's duress situation in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.8992" x="1035" y="2449.2225">a variable based on the latest evaluation:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.4301" x="1035" y="2466.9285">user_is_in_duress:=bool</text><path d="M1161,2484.7375 L1161,2657.7375 L1349,2657.7375 L1349,2494.7375 L1339,2484.7375 L1161,2484.7375" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1339,2484.7375 L1339,2494.7375 L1349,2494.7375 L1339,2484.7375" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.886" x="1167" y="2503.6345">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1167" y="2521.3405">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3221" x="1167" y="2539.0465">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1167" y="2556.7526">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1167" y="2574.4586">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1167" y="2592.1646">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.4051" x="1167" y="2609.8706">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="98.0071" x="1167" y="2645.2826">user_is_in_duress</text><line style="stroke:#181818;stroke-width:1;" x1="1162" x2="1213.6005" y1="2622.5326" y2="2622.5326"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1213.6005" y="2627.0766">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1296.4236" x2="1348.0242" y1="2622.5326" y2="2622.5326"/><polygon fill="#FEFFDD" points="1030,2668.0916,1479,2668.0916,1489,2689.0916,1479,2711.0916,1030,2711.0916,1020,2689.0916,1030,2668.0916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445.7183" x="1032" y="2685.9886">Boomlet in any duress check instance will need to send another message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.0492" x="1032" y="2703.6947">in withdrawal procedure. Lets name it</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="135.6551" x="1266.4292" y="2703.6947">Withdrawal Message</text><polygon fill="#FEFFDD" points="979,2721.5037,1532,2721.5037,1542,2786.5037,1532,2852.5037,979,2852.5037,969,2786.5037,979,2721.5037" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.1883" x="981" y="2739.4007">Boomlet will create its usual WithdrawalMessage. Each WithdrawalMessage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.9221" x="981" y="2757.1067">has a `duress_bearing_payload`:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309.7773" x="981" y="2774.8127">WithdrawalMessage:=[...]+duress_bearing_payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="549.1205" x="981" y="2792.5187">In case of duress, boomlet will fill the `duress_bearing_payload` with the doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="535.3143" x="981" y="2810.2247">encrypted by the shared key between itself and the SAR. Otherwise, a random data with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="352.3264" x="981" y="2827.9308">equal length to 'doxing_password' will be replaced with it.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413.1533" x="981" y="2845.6368">Here we need something from setup, so we show them in the state.</text><path d="M1158,2863.4458 L1158,3089.4458 L1352,3089.4458 L1352,2873.4458 L1342,2863.4458 L1158,2863.4458" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1342,2863.4458 L1342,2873.4458 L1352,2873.4458 L1342,2863.4458" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.886" x="1164" y="2882.3428">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1164" y="2900.0488">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9401" x="1164" y="2917.7548">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0811" x="1164" y="2935.4608">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1164" y="2953.1669">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3221" x="1164" y="2970.8729">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1164" y="2988.5789">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1164" y="3006.2849">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1164" y="3023.9909">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.4051" x="1164" y="3041.6969">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="98.0071" x="1164" y="3077.109">user_is_in_duress</text><line style="stroke:#181818;stroke-width:1;" x1="1159" x2="1214.0585" y1="3054.359" y2="3054.359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1214.0585" y="3058.903">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1296.8816" x2="1351.9401" y1="3054.359" y2="3054.359"/><path d="M977,3101.918 L1120.2801,3101.918 L1120.2801,3111.624 L1110.2801,3121.624 L977,3121.624 L977,3101.918" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="91.118" style="stroke:#000000;stroke-width:1.5;" width="555.6545" x="977" y="3101.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.9001" x="992" y="3116.815">User In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123.2211" x="1135.2801" y="3115.6769">[user_in_duress = true]</text><polygon fill="#FEFFDD" points="997,3126.624,1512,3126.624,1522,3138.624,1512,3151.624,997,3151.624,987,3138.624,997,3126.624" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="511.6545" x="999" y="3144.521">encrypted_duress_payload := AES_encrypt(shared_boomlet_sar_privkey, duress_key)</text><polygon fill="#FEFFDD" points="1075,3162.33,1434,3162.33,1444,3174.33,1434,3187.33,1075,3187.33,1065,3174.33,1075,3162.33" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.7974" x="1077" y="3180.227">WithdrawalMessage 01 := [...] + encrypted_duress_payload</text><path d="M992,3207.036 L1162.9181,3207.036 L1162.9181,3216.7421 L1152.9181,3226.7421 L992,3226.7421 L992,3207.036" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="91.118" style="stroke:#000000;stroke-width:1.5;" width="525.5205" x="992" y="3207.036"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.5381" x="1007" y="3221.933">User Not In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.9491" x="1177.9181" y="3220.7949">[user_in_duress = false]</text><polygon fill="#FEFFDD" points="1012,3231.7421,1497,3231.7421,1507,3243.7421,1497,3256.7421,1012,3256.7421,1002,3243.7421,1012,3231.7421" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="481.5205" x="1014" y="3249.6391">encrypted_duress_payload := AES_encrypt(shared_boomlet_sar_privkey, [0; 32])</text><polygon fill="#FEFFDD" points="1075,3267.4481,1434,3267.4481,1444,3279.4481,1434,3292.4481,1075,3292.4481,1065,3279.4481,1075,3267.4481" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.7974" x="1077" y="3285.3451">WithdrawalMessage 01 := [...] + encrypted_duress_payload</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><polygon fill="#181818" points="2357.6959,3324.8601,2367.6959,3328.8601,2357.6959,3332.8601,2361.6959,3328.8601" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1255.6208" x2="2363.6959" y1="3328.8601" y2="3328.8601"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154.2321" x="1262.6208" y="3323.0511">WithdrawalMessage 01:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.9752" x="1420.8529" y="3323.0511">[...] + encrypted_duress_payload</text></g><path d="M2286,3341.8601 L2286,3425.8601 L2452,3425.8601 L2452,3351.8601 L2442,3341.8601 L2286,3341.8601" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2442,3341.8601 L2442,3351.8601 L2452,3351.8601 L2442,3341.8601" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.042" x="2292" y="3360.7571">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="2292" y="3378.4631">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="139.9061" x="2292" y="3413.8752">withdrawal_message_01</text><line style="stroke:#181818;stroke-width:1;" x1="2287" x2="2328.0415" y1="3391.1251" y2="3391.1251"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="2328.0415" y="3395.6691">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2410.8646" x2="2451.9061" y1="3391.1251" y2="3391.1251"/><g class="message" data-participant-1="Niso" data-participant-2="WTs"><ellipse cx="2369.1959" cy="3454.6402" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2884.3805,3451.3902,2894.3805,3455.3902,2884.3805,3459.3902,2888.3805,3455.3902" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2373.6959" x2="2890.3805" y1="3455.3902" y2="3455.3902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87.1911" x="2376.6959" y="3449.5812">Message [07]:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.7981" x="2467.887" y="3449.5812">withdrawal_message_01</text></g><polygon fill="#FEFFDD" points="2650,3468.3902,3142,3468.3902,3152,3498.3902,3142,3529.3902,2650,3529.3902,2640,3498.3902,2650,3468.3902" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="488.0593" x="2652" y="3486.2872">WT will decompose the message into two parts. The first is the usual withdrawal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.9073" x="2652" y="3503.9932">part and the second is the `encrypted_duress_payload`.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409.0583" x="2652" y="3521.6992">WT will send the `encrypted_duress_payload` to the pertinent SARs.</text><g class="message" data-participant-1="WTs" data-participant-2="SARs"><ellipse cx="2895.8805" cy="3557.4642" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3411.0651,3554.2142,3421.0651,3558.2142,3411.0651,3562.2142,3415.0651,3558.2142" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2900.3805" x2="3417.0651" y1="3558.2142" y2="3558.2142"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87.1911" x="2903.3805" y="3552.4052">Message [08]:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.7731" x="2994.5716" y="3552.4052">encrypted_duress_payload</text></g><path d="M3325,3571.2142 L3325,3691.2142 L3519,3691.2142 L3519,3581.2142 L3509,3571.2142 L3325,3571.2142" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3509,3571.2142 L3509,3581.2142 L3519,3581.2142 L3509,3571.2142" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.713" x="3331" y="3590.1113">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="3331" y="3607.8173">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9401" x="3331" y="3625.5233">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="3331" y="3643.2293">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="151.7881" x="3331" y="3678.6413">encrypted_duress_payload</text><line style="stroke:#181818;stroke-width:1;" x1="3326" x2="3381.0585" y1="3655.8913" y2="3655.8913"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="3381.0585" y="3660.4353">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="3463.8816" x2="3518.9401" y1="3655.8913" y2="3655.8913"/><polygon fill="#FEFFDD" points="3151,3701.4503,3694,3701.4503,3704,3722.4503,3694,3744.4503,3151,3744.4503,3141,3722.4503,3151,3701.4503" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.0543" x="3153" y="3719.3474">SAR will decrypt the duress payload received.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="539.1365" x="3153" y="3737.0534">duress_payload := AES_decrypt(shared_boomlet_sar_privkey, encrypted_duress_payload)</text><path d="M3325,3754.8624 L3325,3891.8624 L3519,3891.8624 L3519,3764.8624 L3509,3754.8624 L3325,3754.8624" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3509,3754.8624 L3509,3764.8624 L3519,3764.8624 L3509,3754.8624" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.713" x="3331" y="3773.7594">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="3331" y="3791.4654">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9401" x="3331" y="3809.1714">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="3331" y="3826.8774">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.7731" x="3331" y="3862.2895">encrypted_duress_payload</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="89.6481" x="3331" y="3879.9955">duress_payload</text><line style="stroke:#181818;stroke-width:1;" x1="3326" x2="3381.0585" y1="3839.5395" y2="3839.5395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="3381.0585" y="3844.0835">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="3463.8816" x2="3518.9401" y1="3839.5395" y2="3839.5395"/><polygon fill="#FEFFDD" points="3165,3902.8045,3680,3902.8045,3690,3959.8045,3680,4016.8045,3165,4016.8045,3155,3959.8045,3165,3902.8045" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.5003" x="3167" y="3920.7015">SAR will check the now decrypted duress_payload.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.2142" x="3167" y="3938.4075">If it's all zeros we are not in duress.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.4733" x="3167" y="3956.1135">If it's not all zeros, SAR will hash it to get the identifier.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.4272" x="3167" y="3973.8196">doxing_identifier := SHA256(duress_payload)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="511.1343" x="3167" y="3991.5256">SAR will search for the same identifier in its database. If found, the user is in duress.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.1573" x="3167" y="4009.2316">If not, the message is malformed and SAR will act accordingly.</text><path d="M3212,4029.0406 L3382.9181,4029.0406 L3382.9181,4038.7466 L3372.9181,4048.7466 L3212,4048.7466 L3212,4029.0406" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="55.412" style="stroke:#000000;stroke-width:1.5;" width="420.4283" x="3212" y="4029.0406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.5381" x="3227" y="4043.9376">User Not In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="158.4539" x="3397.9181" y="4042.7995">[duress_payload is all zeroes]</text><polygon fill="#FEFFDD" points="3232,4053.7466,3612,4053.7466,3622,4065.7466,3612,4078.7466,3232,4078.7466,3222,4065.7466,3232,4053.7466" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.4283" x="3234" y="4071.6436">SAR does nothing regarding the search and rescue operation.</text><path d="M3099,4098.4526 L3242.2801,4098.4526 L3242.2801,4108.1586 L3232.2801,4118.1586 L3099,4118.1586 L3099,4098.4526" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="73.118" style="stroke:#000000;stroke-width:1.5;" width="647.1614" x="3099" y="4098.4526"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.9001" x="3114" y="4113.3496">User In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="214.6855" x="3257.2801" y="4112.2115">[doxing_identifier is found in database]</text><polygon fill="#FEFFDD" points="3119,4123.1586,3726,4123.1586,3736,4144.1586,3726,4166.1586,3119,4166.1586,3109,4144.1586,3119,4123.1586" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="530.8163" x="3121" y="4141.0557">The `doxing_key` will be used to decrypt dynamic and static doxing data and the search</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.1614" x="3121" y="4158.7617">and rescue operation will start. If a match is not found, the message will be deemed as malformed.</text><path d="M3215,4185.5707 L3395.1221,4185.5707 L3395.1221,4195.2767 L3385.1221,4205.2767 L3215,4205.2767 L3215,4185.5707" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="108.5301" style="stroke:#000000;stroke-width:1.5;" width="436.4775" x="3215" y="4185.5707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.7421" x="3230" y="4200.4677">Malformed Message</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="236.3553" x="3410.1221" y="4199.3296">[doxing_identifier is not found in database]</text><polygon fill="#FEFFDD" points="3235,4210.2767,3609,4210.2767,3619,4249.2767,3609,4288.2767,3235,4288.2767,3225,4249.2767,3235,4210.2767" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370.4224" x="3237" y="4228.1737">SAR detects that something is wrong, either in Niso or in WT.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.2112" x="3237" y="4245.8797">The SAR will keep a counter of this event and should it reach</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.9022" x="3237" y="4263.5857">a predefined limit, will deem the setup malfunctioning</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.5883" x="3237" y="4281.2918">and stop responding to halt the procedure.</text><polygon fill="#FEFFDD" points="3110,4306.1008,3735,4306.1008,3745,4327.1008,3735,4349.1008,3110,4349.1008,3100,4327.1008,3110,4306.1008" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.7643" x="3112" y="4323.9978">SAR will sign the received message, drop the redundant data and send the signed message to the WT.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="529.5295" x="3112" y="4341.7038">duress_payload_signed_by_sar := Sign(sar_identity_privkey, encrypted_duress_payload)</text><g class="message" data-participant-1="SARs" data-participant-2="WTs"><polygon fill="#181818" points="2907.3805,4374.2188,2897.3805,4378.2188,2907.3805,4382.2188,2903.3805,4378.2188" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3422.5651" cy="4377.4688" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2901.3805" x2="3418.0651" y1="4378.2188" y2="4378.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87.1911" x="2913.3805" y="4372.4098">Message [09]:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.1481" x="3004.5716" y="4372.4098">duress_payload_signed_by_sar</text></g><polygon fill="#FF0000" points="2714,4391.2188,3077,4391.2188,3087,4421.2188,3077,4452.2188,2714,4452.2188,2704,4421.2188,2714,4391.2188" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.8793" x="2716" y="4409.1158">WT will include this signature in its reply to the participants</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.5662" x="2716" y="4426.8218">and boomlet will check the inclusion and soundness of this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.5952" x="2716" y="4444.5279">payload to further the protocol.</text><path d="M1158,4462.3369 L1158,4706.3369 L1352,4706.3369 L1352,4472.3369 L1342,4462.3369 L1158,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1342,4462.3369 L1342,4472.3369 L1352,4472.3369 L1342,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.886" x="1164" y="4481.2339">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1164" y="4498.9399">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9401" x="1164" y="4516.6459">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0811" x="1164" y="4534.3519">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.4202" x="1164" y="4552.0579">[..sar_identity_pubkey...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="1164" y="4569.764">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3221" x="1164" y="4587.47">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1164" y="4605.176">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1164" y="4622.882">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1164" y="4640.588">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.4051" x="1164" y="4658.294">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4311" x="1164" y="4693.7061">user_is_in_duress</text><line style="stroke:#181818;stroke-width:1;" x1="1159" x2="1214.0585" y1="4670.9561" y2="4670.9561"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.8231" x="1214.0585" y="4675.5001">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1296.8816" x2="1351.9401" y1="4670.9561" y2="4670.9561"/><path d="M1688,4462.3369 L1688,4560.3369 L1876,4560.3369 L1876,4472.3369 L1866,4462.3369 L1688,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1866,4462.3369 L1866,4472.3369 L1876,4472.3369 L1866,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.69" x="1694" y="4481.2339">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1694" y="4498.9399">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9831" x="1694" y="4516.6459">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1694" y="4534.3519">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.9711" x="1694" y="4552.0579">shared_boomlet_st_privkey</text><path d="M2344,4462.3369 L2344,4507.3369 L2394,4507.3369 L2394,4472.3369 L2384,4462.3369 L2344,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2384,4462.3369 L2384,4472.3369 L2394,4472.3369 L2384,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.042" x="2350" y="4481.2339">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="2350" y="4498.9399">[...]</text><path d="M2875,4462.3369 L2875,4507.3369 L2916,4507.3369 L2916,4472.3369 L2906,4462.3369 L2875,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2906,4462.3369 L2906,4472.3369 L2916,4472.3369 L2906,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.098" x="2881" y="4481.2339">WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="2881" y="4498.9399">[...]</text><path d="M708,4462.3369 L708,4507.3369 L748,4507.3369 L748,4472.3369 L738,4462.3369 L708,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M738,4462.3369 L738,4472.3369 L748,4472.3369 L738,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.565" x="714" y="4481.2339">Iso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="714" y="4498.9399">[...]</text><path d="M44,4462.3369 L44,4525.3369 L360,4525.3369 L360,4472.3369 L350,4462.3369 L44,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M350,4462.3369 L350,4472.3369 L360,4472.3369 L350,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.874" x="50" y="4481.2339">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="50" y="4498.9399">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.5032" x="50" y="4516.6459">name_of_5_consent_countries_in_brain_memory</text><path d="M3325,4462.3369 L3325,4542.3369 L3519,4542.3369 L3519,4472.3369 L3509,4462.3369 L3325,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3509,4462.3369 L3509,4472.3369 L3519,4472.3369 L3509,4462.3369" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.713" x="3331" y="4481.2339">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="3331" y="4498.9399">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9401" x="3331" y="4516.6459">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.006" x="3331" y="4534.3519">[...]</text><polygon fill="#FEFFDD" points="858,4716.5151,1651,4716.5151,1661,4728.5151,1651,4741.5151,858,4741.5151,848,4728.5151,858,4716.5151" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="789.9321" x="860" y="4734.4121">When one duress check is positive, all messages afterwards bear the duress signal, regardless of user's input to the duress check.</text><!--SRC=[vLfRSnCv5dxthr2H1y3Zc0GcCqE6K1KWDMINsyIUeRRYb2Dtox4gRSaZgMEyltw_8wcxtRwH1AX0RHuSbtHqT7Iktv5iBwMQSCF7p8f_Sg4IyLPOoo_4OIOl5Cl4q3MST9bWhtA36VR1Q2SI9xLY7wKRfOPFUSOwSJ5x9Va5k3K6-XExzvSLXdLaAkwnBV1Bn8ii5msUE6sOdzCcnUSksteZBqRkvOoh1eHnCf4JhXmxjZgIF8uadi4yoGkjnvbmaUn99FiWrMMDhDED53-phR-bnehQz3jPxhGNMVnXX50DeLA6ezI8FtPjf7tw6ziw4MbzfyEJSlefs_gFo38zZMV-88Gf9dTtTXgD1i-TLlbuW85xpmRFe-xPpix-lTgaTNhIy2fxjlsSzBBFBeMOI7N1Ll-vaM0R_wnE90ntuxzKMiTXwGOPXuI95hXxWGfN8A4wtRkN1pv7ef1ltRqmtiD977ZltKj38UJDX63v3Wn58KlY-FYyUtdcuXufDn-BHkC-ErRIIKvvjw6GWPc-mdGPUyrc_DfizjHfkzq-wwb16Edlz9615PBuh3ynykfIp5RFvGC_PLUFZhWHQRzO1wAIL-eBGp_Hoc9HtoAtFcALZ1IApMQdIv9TVzk2-GsbQJogDlPPijd4Fzgw9XDbKfgZ_pIf-5ZqzR2_LvuYqRboHWhRbwe_C1oVOp7MPjPeZ9Rqxwl0FdlrrybHfyDUlZvw-Mzs_EwuUtpOFNh5_Zu-P2_Ult_xvgYxOkr-oMGgiumbHd1Gx373LOhnMIWN8aLzHfKRik0O5heKReeIXUe9IhRxT8z9bMIvbLV2Zw0Sczd4UN_5gHoEW5qJdMMnV4zHldlmAik2Ek7tCpz89kif9yQJVhJjEDIbVhLw_-2K9EnxwKvtssq8SFOxsuFVhL_KZpAHwMQbzORQm8Bx1uT7dOBWmLe3jzXckHv-_z7HKzlR4Koz78daSdkxfvx9vvlFvKbkfrdA7Xqd9cotB95bMReTmpal3cnyTV7-YsKw5TxfZ4W4dB7qH7oB-p2d6MT_dZ2YxIdoLhyO6N2IyHcJy7J5o3F76WuAv8ID2SDXdKsuQZSM1MWswV-SULUg-0lrzpXKKHtnHRFvvqcp-U1MF1_Ewv2OuN111QAAsbA1aVT-wKshuf729wxU53wt5FUEylcD3RbEhznQwcSu2ubzHguaU3AYb4gwtgFyQg5oIlhGERnowC0ZQfJofLIUScB4bTGvV9ChogZalNQafs01CVAnGcu6SoBDVOzJy-HswKrF222IBnN5w6sWsEHIDRS9wtnJu8ze1L6X7XH771ez3eSCWdan5Gb4mdMwNavI2z0AHgI9pe4nboz2ZIyecP-BFQbIyMdUXeMAVWujJnLmdUvzo_wbPnRjrkN6s5la-UDuyB8wrhXqKU3Fhy_glATyWJzVA-xvfYIpnA-UCsn85v7fjGlw_uKHDscgzFUz8YKKHUqp1UOccppy-ZNpLcVyfIgY9JxxIbjy5bpVjhWkYV4LgkrjRVS3WTelGxIRqk1gyrh13OeTOKMoC1Z8H5Ygs-URHJcd8evMQ1Wzm-QPemk0lQBRGW4r69veiCHuBEySEuanQKqhE5BShqNT5WgKonsmBT5Pb4hVld7hrvqlg- -ynQAUsQNIKwBZhi8GqbBpIYS9IzizzHwJPYgjg55L5DU81gCdE6oQgvGkBbFkk0Sp_XpKX19JrDj5K002e2DsnOtaWqom0RSuVKGL6HPQnyGLpm8ruehuzAM71O7N_W4Ec_smdThIUJRg6YRXQbPeCI4-60jNFS4GIa1_1CNejfc35InRf2LuPUZKuqNxnEX44AysUqE0bM0OzKlDvjnjVBn6RZQlVTz023MtETPMR2ANDZiY2BaqtbCZ-3CllNc0w4Dmz2TybccU4f1OMhD_u6twq-ebFNMiM09l8b0UIAgmyD8EwMC-X1Ot3VSNH97gJs72sgasu5rreOEPfvYxzIZkKg06aGrz57Y8V7ZIPcMWjN3OS2iJOYNSduX_I6kPK1UqiMRt5pQ-7oGVK5v1SmlZ1HcbGn2_5WO-8887M3qMRaJvnGDt-5y-QJ5gh4LeC238kEX2u3zEjAyRGejUpysSsoygwiS9E_nT69rFGXC4vuchJWDfGSSEc3EvE5iP3LNPZO94LsBx1smJWArKM5PvV7-uSe-bE60xkyJVQvhzj5O6Udwg7V4TYi2cOmvvPh_XEKztVcTF7fzzYqCkF8IjO4PFOaltLvzbVZlGMoNS4Ytix9OGzjTvQN-jFToTxkoSGSuIulhNbjNSvdJegJvMDq1wFD6ni1StPjBVAKmrexT6ssPTp0sbGQcLDY80oaFLLZrwrdLbAhFWIhKz8f1r-Zf7KYe4yULeCtM1X2R20329-FpPBXJrct_eqUL3ppMi50ZHs1sUN3D_RRBZsWr7YplYSxb7Y75LH4hHChJBfBKGG-iQWlaOMYVIms-ZX7NRUVLSMoa1jP1A04uB5Q5arHb0ByT353PWHev5_nL6MofU47i9lXQ4D5uIjweTWIseHfA3NOXWZL1KXbAOTbcrgZ6oGUVruUEzNnuiA9RrLCbseKNmo7oEXmntTLJU2TMs6SGSQW3arXgKxG-2CxJgmKgNWnas6OlKHs2vFqzmt0JT1FKHsQozARil-9Yij2hisMfZfPWYSJoACEA2cz2l-0JWJqxIW6sIOosYraFqzbATcPTYIT4GnEl4go5gQeKyNG_JmcgwM2fnK6u3t2qYBPq1nCeaNAG2rk1hM5Qr9DK1mcl1uWcYSHqodhSPX_uTJXlxfZaJ5YOgX4c5y4QQirXD7MzBEvOfVgL6ocq-enLl9K6_e8azNeNwm6LgjBf0Zf2-1G2d-CCK-lgn2s_h1bGQnATtwk96cwv9gNq54t55YJXUI-TPIc5aw1gOkhO9KeWOIkfNCpcMSDoOzG0jWvQ1EhqkSkLxOqWMT4u_GM7r9dZ4CnVln8kk9EXkVIRnj_2hxbzQeHyDKqizQLcBQ7tz8Ob6lMxgyT8FbFuoXOViW847b3KNyUocf5oKigVXLm9bJT-qMMEXjiVduQAk-cTQ_qOcRRX-Ts1Mv1xg4cPbNQr-M6I35MhjK9MMuzElLa5Rv8YAmZVw1861a4N0U9WRxrxHS4udEaCY-aQjH5tXlXq8ZBxBDcEvntZq7VoImKFN1UGwF-yzijdys5qvM_yTnDBquiDEjCjDVXBnw8kXIsDrIp4Iz5mb5YvFWCYqbGxPe-LBOam6g8_qP3T5qRECBWRcCLnuvch5efZ5s8WtN59DSbV4tFnUxVy1]--></g></svg>