<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4511px" preserveAspectRatio="none" style="width:4481px;height:4511px;background:#FFFFFF;" version="1.1" viewBox="0 0 4481 4511" width="4481px" zoomAndPan="magnify"><title>Duress Protection Withdrawal Sequence Diagram</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="352.5566" x="2065.7583" y="28.5352">Duress Protection Withdrawal Sequence Diagram</text><rect fill="#F0F8FF" height="4462.0176" style="stroke:#181818;stroke-width:0.5;" width="2478.394" x="186.896" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.6196" x="1394.7832" y="56.0566">User Side</text><rect fill="none" height="132.5527" style="stroke:#000000;stroke-width:1.5;" width="663.855" x="1090" y="2785.3477"/><rect fill="none" height="132.5527" style="stroke:#000000;stroke-width:1.5;" width="843.6333" x="1000" y="2931.9004"/><rect fill="none" height="129.8633" style="stroke:#000000;stroke-width:1.5;" width="712.5859" x="3496" y="3705.7695"/><rect fill="none" height="50.6211" style="stroke:#000000;stroke-width:1.5;" width="431.8799" x="3636" y="3849.6328"/><rect fill="none" height="96.5527" style="stroke:#000000;stroke-width:1.5;" width="436.1582" x="3637" y="3914.2539"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="205.0786" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="208.896" x2="208.896" y1="139.2871" y2="4426.0176"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="811.6602" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="814.7754" x2="814.7754" y1="139.2871" y2="4426.0176"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="1418.2417" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1421.5391" x2="1421.5391" y1="139.2871" y2="4426.0176"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="2024.8232" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2028.627" x2="2028.627" y1="139.2871" y2="4426.0176"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="2635.2271" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2639.1641" x2="2639.1641" y1="139.2871" y2="4426.0176"/></g><g><title>WTs</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="3241.8086" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3244.8257" x2="3244.8257" y1="139.2871" y2="4426.0176"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="3848.3901" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3851.7959" x2="3851.7959" y1="139.2871" y2="4426.0176"/></g><g><title>Peers</title><rect fill="#000000" fill-opacity="0.00000" height="4286.7305" width="8" x="4454.9717" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="4458.8701" x2="4458.8701" y1="139.2871" y2="4426.0176"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="190.896" y="136.334">User</text><ellipse cx="209.0786" cy="71.2988" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M209.0786,79.2988 L209.0786,106.2988 M196.0786,87.2988 L222.0786,87.2988 M209.0786,106.2988 L196.0786,121.2988 M209.0786,106.2988 L222.0786,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="190.896" y="4438.5527">User</text><ellipse cx="209.0786" cy="4450.0059" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M209.0786,4458.0059 L209.0786,4485.0059 M196.0786,4466.0059 L222.0786,4466.0059 M209.0786,4485.0059 L196.0786,4500.0059 M209.0786,4485.0059 L222.0786,4500.0059" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="798.7754" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="805.7754" y="128.334">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="798.7754" y="4425.0176"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="805.7754" y="4445.5527">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="1387.5391" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="1394.5391" y="128.334">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="1387.5391" y="4425.0176"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="1394.5391" y="4445.5527">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="2013.627" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="2020.627" y="128.334">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="2013.627" y="4425.0176"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="2020.627" y="4445.5527">ST</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2617.1641" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2624.1641" y="128.334">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2617.1641" y="4425.0176"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2624.1641" y="4445.5527">Niso</text></g><g class="participant participant-head" data-participant="WTs"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.9658" x="3224.8257" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.9658" x="3231.8257" y="128.334">WTs</text></g><g class="participant participant-tail" data-participant="WTs"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.9658" x="3224.8257" y="4425.0176"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.9658" x="3231.8257" y="4445.5527">WTs</text></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="3828.7959" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="3835.7959" y="128.334">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="3828.7959" y="4425.0176"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="3835.7959" y="4445.5527">SARs</text></g><g class="participant participant-head" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="4437.8701" y="136.334">Peers</text><ellipse cx="4458.9717" cy="71.2988" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M4458.9717,79.2988 L4458.9717,106.2988 M4445.9717,87.2988 L4471.9717,87.2988 M4458.9717,106.2988 L4445.9717,121.2988 M4458.9717,106.2988 L4471.9717,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="4437.8701" y="4438.5527">Peers</text><ellipse cx="4458.9717" cy="4450.0059" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M4458.9717,4458.0059 L4458.9717,4485.0059 M4445.9717,4466.0059 L4471.9717,4466.0059 M4458.9717,4485.0059 L4445.9717,4500.0059 M4458.9717,4485.0059 L4471.9717,4500.0059" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="message" data-participant-1="User" data-participant-2="Iso"><polygon fill="#181818" points="220.0786,166.5977,210.0786,170.5977,220.0786,174.5977,216.0786,170.5977" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="803.6602,166.5977,813.6602,170.5977,803.6602,174.5977,807.6602,170.5977" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="214.0786" x2="809.6602" y1="170.5977" y2="170.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="226.0786" y="165.8555">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><polygon fill="#181818" points="826.6602,195.9082,816.6602,199.9082,826.6602,203.9082,822.6602,199.9082" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1410.2417,195.9082,1420.2417,199.9082,1410.2417,203.9082,1414.2417,199.9082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="820.6602" x2="1416.2417" y1="199.9082" y2="199.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="832.6602" y="195.166">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="Boomlet" data-participant-2="ST"><polygon fill="#181818" points="1433.2417,225.2188,1423.2417,229.2188,1433.2417,233.2188,1429.2417,229.2188" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2016.8232,225.2188,2026.8232,229.2188,2016.8232,233.2188,2020.8232,229.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1427.2417" x2="2022.8232" y1="229.2188" y2="229.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="1439.2417" y="224.4766">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="ST" data-participant-2="Niso"><polygon fill="#181818" points="2039.8232,254.5293,2029.8232,258.5293,2039.8232,262.5293,2035.8232,258.5293" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2627.2271,254.5293,2637.2271,258.5293,2627.2271,262.5293,2631.2271,258.5293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2033.8232" x2="2633.2271" y1="258.5293" y2="258.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="2045.8232" y="253.7871">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="Niso" data-participant-2="WTs"><polygon fill="#181818" points="2650.2271,283.8398,2640.2271,287.8398,2650.2271,291.8398,2646.2271,287.8398" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3233.8086,283.8398,3243.8086,287.8398,3233.8086,291.8398,3237.8086,287.8398" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2644.2271" x2="3239.8086" y1="287.8398" y2="287.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="2656.2271" y="283.0977">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="WTs" data-participant-2="SARs"><polygon fill="#181818" points="3256.8086,313.1504,3246.8086,317.1504,3256.8086,321.1504,3252.8086,317.1504" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3840.3901,313.1504,3850.3901,317.1504,3840.3901,321.1504,3844.3901,317.1504" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3250.8086" x2="3846.3901" y1="317.1504" y2="317.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="3262.8086" y="312.4082">keeping                       the                              social                                                  distance</text></g><g class="message" data-participant-1="SARs" data-participant-2="Peers"><polygon fill="#181818" points="3863.3901,342.4609,3853.3901,346.4609,3863.3901,350.4609,3859.3901,346.4609" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="4446.9717,342.4609,4456.9717,346.4609,4446.9717,350.4609,4450.9717,346.4609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3857.3901" x2="4452.9717" y1="346.4609" y2="346.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="582.5815" x="3869.3901" y="341.7188">keeping                       the                              social                                                  distance</text></g><path d="M1325,359.4609 L1325,476.4609 L1519,476.4609 L1519,369.4609 L1509,359.4609 L1325,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1509,359.4609 L1509,369.4609 L1519,369.4609 L1509,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.5137" x="1331" y="377.0293">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1331" y="392.3398">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0181" x="1331" y="407.6504">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1331" y="422.9609">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1331" y="438.2715">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1331" y="453.582">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3096" x="1331" y="468.8926">duress_consent_set</text><path d="M1931,359.4609 L1931,445.4609 L2125,445.4609 L2125,369.4609 L2115,359.4609 L1931,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2115,359.4609 L2115,369.4609 L2125,369.4609 L2115,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.396" x="1937" y="377.0293">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1937" y="392.3398">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.355" x="1937" y="407.6504">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1937" y="422.9609">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1937" y="438.2715">shared_boomlet_st_privkey</text><path d="M795,359.4609 L795,399.4609 L835,399.4609 L835,369.4609 L825,359.4609 L795,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,359.4609 L825,369.4609 L835,369.4609 L825,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.9634" x="801" y="377.0293">Iso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="801" y="392.3398">&#160;</text><path d="M46,359.4609 L46,399.4609 L372,399.4609 L372,369.4609 L362,359.4609 L46,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M362,359.4609 L362,369.4609 L372,369.4609 L362,359.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.4497" x="52" y="377.0293">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.1572" x="52" y="392.3398">name_of_5_consent_countries_in_brain_memory</text><polygon fill="#FF0000" points="1293,486.6348,1549,486.6348,1559,497.6348,1549,509.6348,1293,509.6348,1283,497.6348,1293,486.6348" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.8589" x="1295" y="503.2031">DURESS CHECK INITIATED VIA BOOMLET</text><polygon fill="#FEFFDD" points="991,519.9453,1853,519.9453,1863,561.9453,1853,603.9453,991,603.9453,981,561.9453,991,519.9453" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.4038" x="993" y="536.5137">Boomlet will create 5 randomly ordered set of numbers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442.2729" x="993" y="551.8242">between 1 and 198 inclusive and encrypt the container collection with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.9907" x="993" y="567.1348">its shared key with ST:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="368.0942" x="993" y="582.4453">temp_duress_message_collection:=[rand_order[1..198]; 5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="858.2476" x="993" y="597.7559">_duress_message_collection_encrypted_by_boomlet_for_st:=AES_encrypt(shared_boomlet_st_privkey, temp_duress_message_collection)</text><path d="M1224,614.498 L1224,781.498 L1620,781.498 L1620,624.498 L1610,614.498 L1224,614.498" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1610,614.498 L1610,624.498 L1620,624.498 L1610,614.498" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.5137" x="1230" y="632.0664">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1230" y="647.377">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0181" x="1230" y="662.6875">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1230" y="677.998">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1230" y="693.3086">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1230" y="708.6191">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3096" x="1230" y="723.9297">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="209.8853" x="1230" y="754.5508">temp_duress_message_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="369.2114" x="1230" y="769.8613">_duress_message_collection_encrypted_by_boomlet_for_st</text><line style="stroke:#181818;stroke-width:1;" x1="1225" x2="1378.9575" y1="734.3271" y2="734.3271"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1378.9575" y="738.7402">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1465.2539" x2="1619.2114" y1="734.3271" y2="734.3271"/><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><polygon fill="#181818" points="2627.2271,803.9141,2637.2271,807.9141,2627.2271,811.9141,2631.2271,807.9141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1422.2417" x2="2633.2271" y1="807.9141" y2="807.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.6021" x="1429.2417" y="803.1719">Message 01:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362.7114" x="1515.8438" y="803.1719">duress_message_collection_encrypted_by_boomlet_for_st</text></g><polygon fill="#FEFFDD" points="2440,820.9141,2838,820.9141,2848,839.9141,2838,858.9141,2440,858.9141,2430,839.9141,2440,820.9141" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="394.4497" x="2442" y="837.4824">Niso will encode the received encrypted message to a QR code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.165" x="2442" y="852.793">and will display it on its monitor for ST to scan.</text><path d="M2441,869.5352 L2441,944.5352 L2837,944.5352 L2837,879.5352 L2827,869.5352 L2441,869.5352" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2827,869.5352 L2827,879.5352 L2837,879.5352 L2827,869.5352" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.8721" x="2447" y="887.1035">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="2447" y="902.4141">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="369.2114" x="2447" y="933.0352">_duress_message_collection_encrypted_by_boomlet_for_st</text><line style="stroke:#181818;stroke-width:1;" x1="2442" x2="2595.9575" y1="912.8115" y2="912.8115"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="2595.9575" y="917.2246">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2682.2539" x2="2836.2114" y1="912.8115" y2="912.8115"/><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="2039.8232,967.0879,2029.8232,971.0879,2039.8232,975.0879,2035.8232,971.0879" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2638.7271" cy="970.3379" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2033.8232" x2="2634.2271" y1="971.0879" y2="971.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.6021" x="2045.8232" y="966.3457">Message 02:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.6777" x="2132.4253" y="966.3457">QR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.1665" x="2152.103" y="966.3457">(duress_message_collection_encrypted_by_boomlet_for_st)</text></g><polygon fill="#FEFFDD" points="1620,984.0879,2436,984.0879,2446,1003.0879,2436,1022.0879,1620,1022.0879,1610,1003.0879,1620,984.0879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.1392" x="1622" y="1000.6563">ST will decrypt the received message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="812.938" x="1622" y="1015.9668">duress_message_collection:=AES_decrypt(shared_boomlet_st_privkey, duress_message_collection_encrypted_by_boomlet_for_st)</text><path d="M1926,1032.709 L1926,1153.709 L2130,1153.709 L2130,1042.709 L2120,1032.709 L1926,1032.709" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2120,1032.709 L2120,1042.709 L2130,1042.709 L2120,1032.709" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.396" x="1932" y="1050.2773">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1932" y="1065.5879">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.355" x="1932" y="1080.8984">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1932" y="1096.209">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1932" y="1111.5195">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="177.4614" x="1932" y="1142.1406">_duress_message_collection</text><line style="stroke:#181818;stroke-width:1;" x1="1927" x2="1985.0825" y1="1121.917" y2="1121.917"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1985.0825" y="1126.3301">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2071.3789" x2="2129.4614" y1="1121.917" y2="1121.917"/><polygon fill="#FEFFDD" points="1834,1163.8828,2223,1163.8828,2233,1189.8828,2223,1216.8828,1834,1216.8828,1824,1189.8828,1834,1163.8828" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.4658" x="1836" y="1180.4512">ST will assign a country to each of the 5 sets retrieved</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.0234" x="1836" y="1195.7617">after decryption in the previous manner and show 5 columns</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3721" x="1836" y="1211.0723">to the user on its monitor.</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="220.0786,1240.125,210.0786,1244.125,220.0786,1248.125,216.0786,1244.125" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2028.3232" cy="1243.375" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="214.0786" x2="2023.8232" y1="1244.125" y2="1244.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.6021" x="226.0786" y="1239.3828">Message 03:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.3491" x="312.6807" y="1239.3828">Monitor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.4165" x="365.0298" y="1239.3828">(duress_message_collection)</text></g><polygon fill="#FEFFDD" points="15,1257.125,404,1257.125,414,1276.125,404,1295.125,15,1295.125,5,1276.125,15,1257.125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.3535" x="17" y="1273.6934">User will select 1 country from each column shown on the ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.2798" x="17" y="1289.0039">to signal their duress situation</text><path d="M46,1305.7461 L46,1360.7461 L372,1360.7461 L372,1315.7461 L362,1305.7461 L46,1305.7461" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M362,1305.7461 L362,1315.7461 L372,1315.7461 L362,1305.7461" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.4497" x="52" y="1323.3145">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.1572" x="52" y="1338.625">name_of_5_consent_countries_in_brain_memory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="286.4189" x="52" y="1353.9355">_duress_message_collection_index_collection</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="208.5786" cy="1387.2383" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2016.8232,1383.9883,2026.8232,1387.9883,2016.8232,1391.9883,2020.8232,1387.9883" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="213.0786" x2="2022.8232" y1="1387.9883" y2="1387.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.6021" x="216.0786" y="1383.2461">Message 04:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="84.5571" x="302.6807" y="1383.2461">ST's Joystick</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.374" x="387.2378" y="1383.2461">(duress_message_collection_index_collection)</text></g><path d="M1872,1400.9883 L1872,1521.9883 L2185,1521.9883 L2185,1410.9883 L2175,1400.9883 L1872,1400.9883" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2175,1400.9883 L2175,1410.9883 L2185,1410.9883 L2175,1400.9883" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.396" x="1878" y="1418.5566">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1878" y="1433.8672">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.355" x="1878" y="1449.1777">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1878" y="1464.4883">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1878" y="1479.7988">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="286.4189" x="1878" y="1510.4199">_duress_message_collection_index_collection</text><line style="stroke:#181818;stroke-width:1;" x1="1873" x2="1985.5613" y1="1490.1963" y2="1490.1963"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1985.5613" y="1494.6094">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2071.8577" x2="2184.4189" y1="1490.1963" y2="1490.1963"/><polygon fill="#FEFFDD" points="1511,1532.1621,2545,1532.1621,2555,1558.1621,2545,1585.1621,1511,1585.1621,1501,1558.1621,1511,1532.1621" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391.8662" x="1513" y="1548.7305">ST will encrypt `duress_message_collection_index_collection`</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.2822" x="1513" y="1564.041">with `shared_boomlet_st_privkey`:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1030.7388" x="1513" y="1579.3516">duress_message_collection_index_collection_encrypted_by_st_for_boomlet:=AES_encrypt(shared_boomlet_st_privkey, duress_message_collection_index_collection)</text><path d="M1776,1596.0938 L1776,1717.0938 L2281,1717.0938 L2281,1606.0938 L2271,1596.0938 L1776,1596.0938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2271,1596.0938 L2271,1606.0938 L2281,1606.0938 L2271,1596.0938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.396" x="1782" y="1613.6621">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1782" y="1628.9727">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.355" x="1782" y="1644.2832">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1782" y="1659.5938">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1782" y="1674.9043">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="478.1689" x="1782" y="1705.5254">_duress_message_collection_index_collection_encrypted_by_st_for_boomlet</text><line style="stroke:#181818;stroke-width:1;" x1="1777" x2="1985.4363" y1="1685.3018" y2="1685.3018"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1985.4363" y="1689.7148">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2071.7327" x2="2280.1689" y1="1685.3018" y2="1685.3018"/><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="2028.3232" cy="1742.8281" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2627.2271,1739.5781,2637.2271,1743.5781,2627.2271,1747.5781,2631.2271,1743.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2032.8232" x2="2633.2271" y1="1743.5781" y2="1743.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.6021" x="2035.8232" y="1738.8359">Message 05:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.6777" x="2122.4253" y="1738.8359">QR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.124" x="2142.103" y="1738.8359">(duress_message_collection_index_collection_encrypted_by_st_for_boomlet)</text></g><path d="M2386,1756.5781 L2386,1831.5781 L2891,1831.5781 L2891,1766.5781 L2881,1756.5781 L2386,1756.5781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2881,1756.5781 L2881,1766.5781 L2891,1766.5781 L2881,1756.5781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.8721" x="2392" y="1774.1465">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="2392" y="1789.457">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="478.1689" x="2392" y="1820.0781">_duress_message_collection_index_collection_encrypted_by_st_for_boomlet</text><line style="stroke:#181818;stroke-width:1;" x1="2387" x2="2595.4363" y1="1799.8545" y2="1799.8545"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="2595.4363" y="1804.2676">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2681.7327" x2="2890.1689" y1="1799.8545" y2="1799.8545"/><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1433.2417,1854.1309,1423.2417,1858.1309,1433.2417,1862.1309,1429.2417,1858.1309" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2638.7271" cy="1857.3809" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1427.2417" x2="2634.2271" y1="1858.1309" y2="1858.1309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.6021" x="1439.2417" y="1853.3887">Message 06:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="471.6689" x="1525.8438" y="1853.3887">duress_message_collection_index_collection_encrypted_by_st_for_boomlet</text></g><polygon fill="#FEFFDD" points="904,1871.1309,1938,1871.1309,1948,1890.1309,1938,1909.1309,904,1909.1309,894,1890.1309,904,1871.1309" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.3652" x="906" y="1887.6992">Boomlet will decrypt the received message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1030.853" x="906" y="1903.0098">duress_message_collection_index_collection:=AES_decrypt(shared_boomlet_st_privkey, duress_message_collection_index_collection_encrypted_by_st_for_boomlet)</text><path d="M1265,1919.752 L1265,2086.752 L1578,2086.752 L1578,1929.752 L1568,1919.752 L1265,1919.752" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1568,1919.752 L1568,1929.752 L1578,1929.752 L1568,1919.752" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.5137" x="1271" y="1937.3203">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1271" y="1952.6309">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0181" x="1271" y="1967.9414">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1271" y="1983.252">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1271" y="1998.5625">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1271" y="2013.873">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3096" x="1271" y="2029.1836">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.8853" x="1271" y="2059.8047">temp_duress_message_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="286.4189" x="1271" y="2075.1152">_duress_message_collection_index_collection</text><line style="stroke:#181818;stroke-width:1;" x1="1266" x2="1378.5613" y1="2039.5811" y2="2039.5811"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1378.5613" y="2043.9941">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1464.8577" x2="1577.4189" y1="2039.5811" y2="2039.5811"/><polygon fill="#FEFFDD" points="1139,2096.8574,1704,2096.8574,1714,2130.8574,1704,2165.8574,1139,2165.8574,1129,2130.8574,1139,2096.8574" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="490.4009" x="1141" y="2113.4258">Boomlet will search for the indices in `temp_duress_message_collection` and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="525.4907" x="1141" y="2128.7363">if the resulting 5 numbers corresponding to the aforementioned indices, constitute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="561.2026" x="1141" y="2144.0469">the same set as the `duress_consent_set`, boomlet knows that the user is not in duress.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.6211" x="1141" y="2159.3574">Otherwise the user is in duress.</text><polygon fill="#FEFFDD" points="1192,2176.0996,1651,2176.0996,1661,2202.0996,1651,2229.0996,1192,2229.0996,1182,2202.0996,1192,2176.0996" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="455.1714" x="1194" y="2192.668">Boomlet will drop redundant data and indicate user's duress situation in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.3179" x="1194" y="2207.9785">a variable based on the latest evaluation:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.3911" x="1194" y="2223.2891">user_is_in_duress:=bool</text><path d="M1325,2240.0313 L1325,2391.0313 L1519,2391.0313 L1519,2250.0313 L1509,2240.0313 L1325,2240.0313" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1509,2240.0313 L1509,2250.0313 L1519,2250.0313 L1509,2240.0313" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.5137" x="1331" y="2257.5996">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1331" y="2272.9102">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0181" x="1331" y="2288.2207">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1331" y="2303.5313">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1331" y="2318.8418">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1331" y="2334.1523">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3096" x="1331" y="2349.4629">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="111.0332" x="1331" y="2380.084">user_is_in_duress</text><line style="stroke:#181818;stroke-width:1;" x1="1326" x2="1379.083" y1="2359.8604" y2="2359.8604"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1379.083" y="2364.2734">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1465.3794" x2="1518.4624" y1="2359.8604" y2="2359.8604"/><polygon fill="#FEFFDD" points="1190,2401.8262,1654,2401.8262,1664,2420.8262,1654,2439.8262,1190,2439.8262,1180,2420.8262,1190,2401.8262" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460.1924" x="1192" y="2418.3945">Boomlet in any duress check instance will need to send another message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.9546" x="1192" y="2433.7051">in withdrawal procedure. Lets name it</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137.2744" x="1434.0679" y="2433.7051">Withdrawal Message</text><polygon fill="#FEFFDD" points="1130,2450.4473,1713,2450.4473,1723,2507.4473,1713,2565.4473,1130,2565.4473,1120,2507.4473,1130,2450.4473" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="469.3774" x="1132" y="2467.0156">Boomlet will create its usual WithdrawalMessage. Each WithdrawalMessage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.5425" x="1132" y="2482.3262">has a `duress_bearing_payload`:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="321.4199" x="1132" y="2497.6367">WithdrawalMessage:=[...]+duress_bearing_payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="579.0967" x="1132" y="2512.9473">In case of duress, boomlet will fill the `duress_bearing_payload` with the doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="552.8301" x="1132" y="2528.2578">encrypted by the shared key between itself and the SAR. Otherwise, a random data with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366.8501" x="1132" y="2543.5684">equal length to 'doxing_password' will be replaced with it.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.645" x="1132" y="2558.8789">Here we need something from setup, so we show them in the state.</text><path d="M1322,2575.6211 L1322,2772.6211 L1522,2772.6211 L1522,2585.6211 L1512,2575.6211 L1322,2575.6211" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1512,2575.6211 L1512,2585.6211 L1522,2585.6211 L1512,2575.6211" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.5137" x="1328" y="2593.1895">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1328" y="2608.5">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.0166" x="1328" y="2623.8105">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6904" x="1328" y="2639.1211">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1328" y="2654.4316">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0181" x="1328" y="2669.7422">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1328" y="2685.0527">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1328" y="2700.3633">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1328" y="2715.6738">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3096" x="1328" y="2730.9844">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="111.0332" x="1328" y="2761.6055">user_is_in_duress</text><line style="stroke:#181818;stroke-width:1;" x1="1323" x2="1378.8601" y1="2741.3818" y2="2741.3818"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1378.8601" y="2745.7949">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1465.1565" x2="1521.0166" y1="2741.3818" y2="2741.3818"/><path d="M1090,2785.3477 L1238.2256,2785.3477 L1238.2256,2792.6582 L1228.2256,2802.6582 L1090,2802.6582 L1090,2785.3477" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.5527" style="stroke:#000000;stroke-width:1.5;" width="663.855" x="1090" y="2785.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.9409" x="1105" y="2798.916">User In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132.3706" x="1253.2256" y="2797.9824">[user_in_duress = true]</text><polygon fill="#FEFFDD" points="1110,2807.6582,1733,2807.6582,1743,2826.6582,1733,2845.6582,1110,2845.6582,1100,2826.6582,1110,2807.6582" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="619.855" x="1112" y="2824.2266">salted_doxing_password := "real" || doxing_password || rand_string(doxing_password.length())+4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.4868" x="1112" y="2839.5371">The purpose of salting is for others not to be able to distinguish messages.</text><polygon fill="#FEFFDD" points="1146,2856.2793,1697,2856.2793,1707,2867.2793,1697,2879.2793,1146,2879.2793,1136,2867.2793,1146,2856.2793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="547.8789" x="1148" y="2872.8477">duress_payload := AES_encrypt(shared_boomlet_sar_privkey, salted_doxing_password)</text><polygon fill="#FEFFDD" points="1272,2889.5898,1571,2889.5898,1581,2900.5898,1571,2912.5898,1272,2912.5898,1262,2900.5898,1272,2889.5898" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.8452" x="1274" y="2906.1582">WithdrawalMessage 01 := [...]+duress_payload</text><path d="M1000,2931.9004 L1176.0728,2931.9004 L1176.0728,2939.2109 L1166.0728,2949.2109 L1000,2949.2109 L1000,2931.9004" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.5527" style="stroke:#000000;stroke-width:1.5;" width="843.6333" x="1000" y="2931.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="126.7881" x="1015" y="2945.4688">User Not In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="136.5117" x="1191.0728" y="2944.5352">[user_in_duress = false]</text><polygon fill="#FEFFDD" points="1020,2954.2109,1823,2954.2109,1833,2973.2109,1823,2992.2109,1020,2992.2109,1010,2973.2109,1020,2954.2109" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="799.6333" x="1022" y="2970.7793">salted_decoy_doxing_password := "fake" || rand_string(doxing_password.length()) || rand_string(doxing_password.length()+4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.4868" x="1022" y="2986.0898">The purpose of salting is for others not to be able to distinguish messages.</text><polygon fill="#FEFFDD" points="1124,3002.832,1719,3002.832,1729,3013.832,1719,3025.832,1124,3025.832,1114,3013.832,1124,3002.832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="591.2397" x="1126" y="3019.4004">duress_payload := AES_encrypt(shared_boomlet_sar_privkey, salted_decoy_doxing_password)</text><polygon fill="#FEFFDD" points="1272,3036.1426,1571,3036.1426,1581,3047.1426,1571,3059.1426,1272,3059.1426,1262,3047.1426,1272,3036.1426" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.8452" x="1274" y="3052.7109">WithdrawalMessage 01 := [...]+duress_payload</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><polygon fill="#181818" points="2627.2271,3088.7637,2637.2271,3092.7637,2627.2271,3096.7637,2631.2271,3092.7637" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1422.2417" x2="2633.2271" y1="3092.7637" y2="3092.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="157.6377" x="1429.2417" y="3088.0215">WithdrawalMessage 01:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.1792" x="1590.8794" y="3088.0215">[...] + duress_payload</text></g><path d="M2549,3105.7637 L2549,3180.7637 L2728,3180.7637 L2728,3115.7637 L2718,3105.7637 L2549,3105.7637" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2718,3105.7637 L2718,3115.7637 L2728,3115.7637 L2718,3105.7637" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.8721" x="2555" y="3123.332">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="2555" y="3138.6426">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="152.9404" x="2555" y="3169.2637">withdrawal_message_01</text><line style="stroke:#181818;stroke-width:1;" x1="2550" x2="2595.822" y1="3149.04" y2="3149.04"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="2595.822" y="3153.4531">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="2682.1184" x2="2727.9404" y1="3149.04" y2="3149.04"/><g class="message" data-participant-1="Niso" data-participant-2="WTs"><ellipse cx="2638.7271" cy="3206.5664" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3233.8086,3203.3164,3243.8086,3207.3164,3233.8086,3211.3164,3237.8086,3207.3164" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2643.2271" x2="3239.8086" y1="3207.3164" y2="3207.3164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92.2378" x="2646.2271" y="3202.5742">Message [07]:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.9404" x="2742.4648" y="3202.5742">withdrawal_message_01</text></g><polygon fill="#FEFFDD" points="2990,3220.3164,3500,3220.3164,3510,3246.3164,3500,3273.3164,2990,3273.3164,2980,3246.3164,2990,3220.3164" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="506.9746" x="2992" y="3236.8848">WT will decompose the message into two parts. The first is the usual withdrawal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.0537" x="2992" y="3252.1953">part and the second is the `duress_payload`.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="363.1812" x="2992" y="3267.5059">WT will send the `duress_payload` to the pertinent SARs.</text><g class="message" data-participant-1="WTs" data-participant-2="SARs"><ellipse cx="3245.3086" cy="3299.8086" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3840.3901,3296.5586,3850.3901,3300.5586,3840.3901,3304.5586,3844.3901,3300.5586" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3249.8086" x2="3846.3901" y1="3300.5586" y2="3300.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92.2378" x="3252.8086" y="3295.8164">Message [08]:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.8237" x="3349.0464" y="3295.8164">duress_payload</text></g><path d="M3752,3313.5586 L3752,3418.5586 L3952,3418.5586 L3952,3323.5586 L3942,3313.5586 L3752,3313.5586" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3942,3313.5586 L3942,3323.5586 L3952,3323.5586 L3942,3313.5586" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.9683" x="3758" y="3331.127">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3758" y="3346.4375">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.0166" x="3758" y="3361.748">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3758" y="3377.0586">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="136.7476" x="3758" y="3407.6797">temp_duress_payload</text><line style="stroke:#181818;stroke-width:1;" x1="3753" x2="3808.8601" y1="3387.4561" y2="3387.4561"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="3808.8601" y="3391.8691">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="3895.1565" x2="3951.0166" y1="3387.4561" y2="3387.4561"/><polygon fill="#FEFFDD" points="3537,3429.4219,4167,3429.4219,4177,3448.4219,4167,3467.4219,3537,3467.4219,3527,3448.4219,3537,3429.4219" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.3843" x="3539" y="3445.9902">SAR will decrypt the duress payload received.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.1392" x="3539" y="3461.3008">supposedly_salted_doxing_password := AES_decrypt(shared_boomlet_sar_privkey, duress_payload)</text><path d="M3702,3478.043 L3702,3599.043 L4001,3599.043 L4001,3488.043 L3991,3478.043 L3702,3478.043" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3991,3478.043 L3991,3488.043 L4001,3488.043 L3991,3478.043" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.9683" x="3708" y="3495.6113">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3708" y="3510.9219">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.0166" x="3708" y="3526.2324">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3708" y="3541.543">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.7476" x="3708" y="3572.1641">temp_duress_payload</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="272.1113" x="3708" y="3587.4746">temp_supposedly_salted_doxing_password</text><line style="stroke:#181818;stroke-width:1;" x1="3703" x2="3808.4075" y1="3551.9404" y2="3551.9404"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="3808.4075" y="3556.3535">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="3894.7039" x2="4000.1113" y1="3551.9404" y2="3551.9404"/><polygon fill="#FEFFDD" points="3611,3609.2168,4093,3609.2168,4103,3651.2168,4093,3693.2168,3611,3693.2168,3601,3651.2168,3611,3609.2168" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.6294" x="3613" y="3625.7852">SAR will check the first 4 characters of the plain text.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435.5444" x="3613" y="3641.0957">temp_duress_tag := temp_supposedly_salted_doxing_password[0..4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.645" x="3613" y="3656.4063">If it's "real" we are in duress.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337.0669" x="3613" y="3671.7168">If it's "fake" we are not in duress and SAR will not act.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="478.6196" x="3613" y="3687.0273">If it's anything else, the message is malformed and SAR will act accordingly.</text><path d="M3496,3705.7695 L3644.2256,3705.7695 L3644.2256,3713.0801 L3634.2256,3723.0801 L3496,3723.0801 L3496,3705.7695" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="129.8633" style="stroke:#000000;stroke-width:1.5;" width="712.5859" x="3496" y="3705.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.9409" x="3511" y="3719.3379">User In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152.0181" x="3659.2256" y="3718.4043">[temp_duress_tag = "real"]</text><polygon fill="#FEFFDD" points="3522,3728.0801,4181,3728.0801,4191,3747.0801,4181,3766.0801,3522,3766.0801,3512,3747.0801,3522,3728.0801" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="655.9351" x="3524" y="3744.6484">doxing_password:= temp_supposedly_duress_password[5..(temp_supposedly_duress_password/2 + 1)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="383.3159" x="3524" y="3759.959">sar_service_identifier := SHA256(SHA256(doxing_password))</text><polygon fill="#FEFFDD" points="3516,3776.7012,4188,3776.7012,4198,3802.7012,4188,3829.7012,3516,3829.7012,3506,3802.7012,3516,3776.7012" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="668.5859" x="3518" y="3793.2695">SAR search for the `sar_service_identifier` in its database. If it finds a match, the `doxing_password` will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="617.189" x="3518" y="3808.5801">be used to decrypt dynamic and static doxing data and the search and rescue operation will start.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="425.3818" x="3518" y="3823.8906">If a match is not found, the message will be deemed as malformed.</text><path d="M3636,3849.6328 L3812.0728,3849.6328 L3812.0728,3856.9434 L3802.0728,3866.9434 L3636,3866.9434 L3636,3849.6328" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="50.6211" style="stroke:#000000;stroke-width:1.5;" width="431.8799" x="3636" y="3849.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="126.7881" x="3651" y="3863.2012">User Not In Duress</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154.9614" x="3827.0728" y="3862.2676">[temp_duress_tag = "fake"]</text><polygon fill="#FEFFDD" points="3656,3871.9434,4047,3871.9434,4057,3882.9434,4047,3894.9434,3656,3894.9434,3646,3882.9434,3656,3871.9434" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.8799" x="3658" y="3888.5117">SAR does nothing regarding the search and rescue operation.</text><path d="M3637,3914.2539 L3820.6328,3914.2539 L3820.6328,3921.5645 L3810.6328,3931.5645 L3637,3931.5645 L3637,3914.2539" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="96.5527" style="stroke:#000000;stroke-width:1.5;" width="436.1582" x="3637" y="3914.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="134.3481" x="3652" y="3927.8223">Malformed Message</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="232.5254" x="3835.6328" y="3926.8887">[temp_duress_tag = not["real" or "fake"]]</text><polygon fill="#FEFFDD" points="3657,3936.5645,4046,3936.5645,4056,3970.5645,4046,4005.5645,3657,4005.5645,3647,3970.5645,3657,3936.5645" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.8105" x="3659" y="3953.1328">SAR detects that something is wrong, either in Niso or in WT.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="383.4492" x="3659" y="3968.4434">The SAR will keep a counter of this event and should it reach</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343.0591" x="3659" y="3983.7539">a predefined limit, will deem the setup malfunctioning</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.5049" x="3659" y="3999.0645">and stop responding to halt the procedure.</text><polygon fill="#FEFFDD" points="3528,4022.8066,4175,4022.8066,4185,4041.8066,4175,4060.8066,3528,4060.8066,3518,4041.8066,3528,4022.8066" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643.5444" x="3530" y="4039.375">SAR will sign the received message, drop the redundant data and send the signed message to the WT.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="521.7139" x="3530" y="4054.6855">duress_payload_signed_by_sar := Sign(sar_identity_privkey, temp_duress_payload)</text><g class="message" data-participant-1="SARs" data-participant-2="WTs"><polygon fill="#181818" points="3256.8086,4083.7383,3246.8086,4087.7383,3256.8086,4091.7383,3252.8086,4087.7383" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3851.8901" cy="4086.9883" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3250.8086" x2="3847.3901" y1="4087.7383" y2="4087.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92.2378" x="3262.8086" y="4082.9961">Message [09]:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.4067" x="3359.0464" y="4082.9961">duress_payload_signed_by_sar</text></g><polygon fill="#FF0000" points="3055,4100.7383,3435,4100.7383,3445,4126.7383,3435,4153.7383,3055,4153.7383,3045,4126.7383,3055,4100.7383" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.0669" x="3057" y="4117.3066">WT will include this signature in its reply to the participants</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.042" x="3057" y="4132.6172">and boomlet will check the inclusion and soundness of this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.2402" x="3057" y="4147.9277">payload to further the protocol.</text><path d="M1322,4164.6699 L1322,4377.6699 L1522,4377.6699 L1522,4174.6699 L1512,4164.6699 L1322,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1512,4164.6699 L1512,4174.6699 L1522,4174.6699 L1512,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.5137" x="1328" y="4182.2383">Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1328" y="4197.5488">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.0166" x="1328" y="4212.8594">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6904" x="1328" y="4228.1699">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.7368" x="1328" y="4243.4805">[..sar_identity_pubkey...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="1328" y="4258.791">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0181" x="1328" y="4274.1016">boomlet_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1328" y="4289.4121">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1328" y="4304.7227">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1328" y="4320.0332">shared_boomlet_st_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.3096" x="1328" y="4335.3438">duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0332" x="1328" y="4365.9648">user_is_in_duress</text><line style="stroke:#181818;stroke-width:1;" x1="1323" x2="1378.8601" y1="4345.7412" y2="4345.7412"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.2964" x="1378.8601" y="4350.1543">Duress Check</text><line style="stroke:#181818;stroke-width:1;" x1="1465.1565" x2="1521.0166" y1="4345.7412" y2="4345.7412"/><path d="M1931,4164.6699 L1931,4250.6699 L2125,4250.6699 L2125,4174.6699 L2115,4164.6699 L1931,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2115,4164.6699 L2115,4174.6699 L2125,4174.6699 L2115,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.396" x="1937" y="4182.2383">ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1937" y="4197.5488">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.355" x="1937" y="4212.8594">st_0_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1937" y="4228.1699">st_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3804" x="1937" y="4243.4805">shared_boomlet_st_privkey</text><path d="M2613,4164.6699 L2613,4204.6699 L2663,4204.6699 L2663,4174.6699 L2653,4164.6699 L2613,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2653,4164.6699 L2653,4174.6699 L2663,4174.6699 L2653,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.8721" x="2619" y="4182.2383">Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="2619" y="4197.5488">[...]</text><path d="M3224,4164.6699 L3224,4204.6699 L3265,4204.6699 L3265,4174.6699 L3255,4164.6699 L3224,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3255,4164.6699 L3255,4174.6699 L3265,4174.6699 L3255,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.7188" x="3230" y="4182.2383">WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3230" y="4197.5488">[...]</text><path d="M794,4164.6699 L794,4204.6699 L835,4204.6699 L835,4174.6699 L825,4164.6699 L794,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,4164.6699 L825,4174.6699 L835,4174.6699 L825,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.9634" x="800" y="4182.2383">Iso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="800" y="4197.5488">[...]</text><path d="M46,4164.6699 L46,4219.6699 L372,4219.6699 L372,4174.6699 L362,4164.6699 L46,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M362,4164.6699 L362,4174.6699 L372,4174.6699 L362,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.4497" x="52" y="4182.2383">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="52" y="4197.5488">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.1572" x="52" y="4212.8594">name_of_5_consent_countries_in_brain_memory</text><path d="M3752,4164.6699 L3752,4235.6699 L3952,4235.6699 L3952,4174.6699 L3942,4164.6699 L3752,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3942,4164.6699 L3942,4174.6699 L3952,4174.6699 L3942,4164.6699" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.9683" x="3758" y="4182.2383">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3758" y="4197.5488">[...]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.0166" x="3758" y="4212.8594">shared_boomlet_sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.7949" x="3758" y="4228.1699">[...]</text><polygon fill="#FEFFDD" points="1112,4387.707,1732,4387.707,1742,4398.707,1732,4410.707,1112,4410.707,1102,4398.707,1112,4387.707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616.3066" x="1114" y="4404.2754">From now on, all messages bear the duress signal, regardless of user's input to the duress check.</text><!--SRC=[vLfjRziu4lxkNq6a7vguhffqazrjhYcGjhbhxlgsiNUBGnpOj4J7H6JIAr9n3UoFlsT8IhPisKdJBjBY0jHsnU5mEFFC6obp9TM4PtpCZFWp5oeMxuGn_58Sf_9IiLGCRSDAcmhsEiymmZvcsehOIgtO9sb7ISQdF6NjC9czblmIt1e3_Pbj_Mv4njeo4Lli0VZ5ucMQYmQFhSwO6zDPWiyzzk2jl1pPLpEk6X36obXEkBBirEX0yZIGE0QB92-r7gV21hAV0jb7gQugPErEeDXd3_wG6ZCgm-zbkT91OF6lJ0ZL42fXs4g5-5F71Dfdlx87PoAfhdHyLWu_Om_-Az9KJyEUFmgH5ODxkxkDHeFdLgjyFC23hUU35q7tR7VtSAioQAoUD9pAdZz-GNevP5T2JAIwPFL_TYJOnZ-ZOmd3VV5V8etbi7I3Z4F210lSlq0554YeTkV-vG7cI1J2rlqBun1EuW2zzoyDkP0p4vpbEp0KkIo9u_pp_kLPy7k4t7mi6es7x5H9Apd5tOP216Rw6iEbxpMRuMUpsLNdKHHTTDN0F-djzX215OBuh3V9vFMLcDMFvGCtPEgVZdWcabun3qGbhyGbXbwibS6ada5iVSBcCf8hDflj3abs-sKBvbyeJUF9V64N9PjDVD7I5Paeaj8OVTEWucFHqyFUGRcBMEVAPbAOdbIzGSRnEHPZdSqQZT6A_bqME6IlVpyxQRVPgpSdh_x3Jj-VTawFEoUlsH-dn-pbXm_ltfvqQkOUbaocCarPd0aEYWEMSPNW-Sod2v4WFoFB3Pa7Xe4kXPqYHI5xWfBj8HT95QUvaTV2FK4wpcOJw_2ANLbi0Ql6Ear3-fuYVNU1AiEyEe7xcNj89kigAyQJNh3jsEUbtdpsuT4vITXpqftlHH44kFW7Em3kra_g1Pd8TBFIUaETmOA7HySdxO9WUws1MsopN3lVltTqrUF7ePXwDHBnrUF7NVLSljYyBqToDyrIz6XRCM5xPOeiqzBT62wWsBDnsSNX5zDq8XpeCX4BWB548dw5TPZLZBFVpXZHTXMXrKr619oaVCOaaAuO8NEi0L1KJbYOQZZCCp5NKMDPW6QJlXVCMwlYhzJVKvz5TQWlcitVpfhDxJlnt5dK8J73vhmAnDnhImK6teSbckhyaTmdpDxaFdSKzvxY-HSRSfrUkJ7Kpt3c0_kCe2HuFAAGIhe-eFXge78A-j0vK3cqu14qIl5IAaSvoSIrr3cmoHL5L4Al6UafM42CVAmGcy6SI7FNurIG79Le-eaAHC9IaOpUUOfDaAh0nizpJO7ReX54XNnGR76OwR7Vf1VCYQb881AktN5oabfGhU29p08uyCpcowN6LwJCctnFgaHyNhHXeQ9zt_BC7QxTUMZOl_NCeDswskXxopn_70IlgcCDf8i4txyzgtvNkGJVNojkVrEGMU5NZHd6Xul0zDO9_V_2Y9iqLUBze0W9HLAx8S5yoI8xtpvdtccFFy-JQ5cVVQCbRYokxvfSLyJu1jdshhRxWOhQhwjeDuN1UlCQmJCaEweLoS9W86DXA6_tDulIfoIELcWOa67orD81m47HRI61PdWyqM29vo6zSwmangGrhG2ai5wBkYqaA9jRrBP4Pv0gNVl6ZPlNNrLVlyM2djcLqbEYutPUGqX3pIljn4-Dkke31hEfDA92DQUuXJTaUeBD9hbAwE0ouPQxOiRjWvfGOefykrmKW03L4RlccUI3LB01DzXzg2fIJ3IMYMkUUchu5V7fILSMU5w7HzXi-iDsQYlxsQXhc8IhMQ75cFZWcJ_gyOPG0lgZKenEcpbOmR95M08gVQSU3jedcOu5yOhOMofOgGoZVgdPN3YD3yV8pUQjpnkeGirDZhbpDe5Bn4weX5nvtbKZu9cNQ1x0- -0SlGcVfPedL4Yip3aySZPzL3-bgquLYu4cAiezoTmjdBH3-bXqeUL5_Va5KIJwinymPgepy9vteOEPerWuzIZEKg06aGwT5xWI-VWiOgMZjR1PVohZVSMVduW_IMkfK9Uqi6OFbnP-w2KVK5n1SmlZUHcbXHE_4Ham83m2Z1uBEwBuuWftu2-Vj1Wrri8t611aN7GXm8yLqMrTQ1drF5k0_RAYVXotmzzbflE9Ru80dZ3ht9CMTEo8sImN5xNUO7XAENT92-pmY6t1DT8jzjTVorYYH-xmorW2t_RISEJ1iBspysY_gphKCkRPH7jOqt9aOiHgobFErtrm1tO04XTHyPCEWq6NIpCgGi6Qc1xq5po01DzKTyyjtrgpzPtQLLPScUtkqLeLVmuoqArPnJBliRrDrXdorDnW7X7hMQsHXlnARDtQ8hSbVBI_yqEOhaujtyg0ItUJDGpebdBbID4nP8-MDdV7xcEU-SgoRNUlx2L-MPJnbyeDwldkxWMaAtiDT-rLpsr1Muxgq_meJe-TyIdW5aUNqXtkJ3MZIryJCGB9K6QeUQG9fHWbXFbINRfVjsLECU1AHLQr52po5t92iRoh1kfeYl9p8ZBWJ8GxvwXGog_kTasNjsjhxU27qKCVdzqoLMoor6A5NQmrMbuCdwkTM0W3XHSKZHbKOV89wJz9qH2j3TEREh55bwdAjlFtAA962tFjtBYT3GhpTQCjmRQF9ppZiNLl5FZ61UK5LGVYCvKMYv9OVacQkfqGvxjHj8_DdGvHew3y3saGHGZqKMb1IWeVWmD5fL5ni2ytGKCGUM4gAcDVyeYK2goAez49Quf8EnP9bGrOu1zQCch6qbcqjWnOra6HqoyQgvfUqaADkagp1ZqTHD7s3JHFdY8GxkqGcW0VI7UD3Z5KHqE9jR5C-ytnquEVjyFNSYpVgSV4KglRhsVV9qDGQK_rAhLf4NEA1uPKGhNxcDjur0fHfhfot-cQhXcf3tJzIU6qoGnTXupzoJVgKFpqa-Szf8zqJaRwBvGIvzW4GXOFTuyKuIm2emT34ALeT8SQJMaL3aKLdGZX0B60ZiZdgmqLHmqG76OlwhMRQE7aSCZCn2NFVDk_ULDLCTwLs2rJqgeKMECy-1Si6MHQ9vIWzwx2oS2yLu36ffbMboqcf6iSOVBmEXFz_DI9V25JUW-ztL3SWz3XEiKEC17Nb4d2PKQU9WIJZ2uFgDUV818AW0QxIULOsbOHnT6GUAsWLt46oPKxKO5a_bwFNbnYrQEJ4S9Ek4afUbclkVNHpztTr9tQjVmfXXzQESaeKoZDhru_qbEdcsgmxdbATmJ7lNlYmJQvrt8NLBs9BjDAaOQV-TTAojfZqpgDfHeal4zGL0BkNjzTgahZxsjixaEnT5TMatHMrWJpDz6CDq2bVvvdaV2kW5PUKUHlYbmbm86A5f-EmNYOPmvPmMPMnpf5qFsRUi-ghbt_w1bzbttfQbFwv3juzSMLs4iLzkAuGsIp-QbJErfzSMPbUFacCDZbIzwXUVBLnLUZjidv9nsSA3rbMhKO1-2B_elHGT5YjUclFLiXkgS1-k74Kwf9RWkNMZouY_u7]--></g></svg>