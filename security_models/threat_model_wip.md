


| Channel                                  | Attacker Capabilities |
| ---------------------------------------- | --------------------- |
| User ←→ Phone                            | E_p                   |
| User ←→ Iso                              |                       |
| User ←→ Niso                             | E_p                   |
| User ←→ SecureTerminal                   |                       |
| Iso ←→ Boomlet                           |                       |
| Iso ←→ Boomletwo                         |                       |
| Niso ←→ Boomlet                          | E                     |
| Niso ←(TOR)→ Watchtower                  |                       |
| Niso ←(TOR)→ Peers' Niso                 |                       |
| Watchtower ←(TOR)→ SAR                   |                       |
| Phone ←→ SAR                             | E*,                   |
| User ←→ Peers (out-of-band)              |                       |
| User ←→ Phone(Compromised)               |                       |
| User(Compromised) ←→ Iso                 | E                     |
| User ←→ Niso(Compromised)                | E                     |
| User(Compromised) ←→ SecureTerminal      | E                     |
| Niso(Compromised) ←→ Boomlet             | E                     |
| Niso ←(TOR)→ Watchtower(Compromised)     | E                     |
| Niso ←(TOR)→ Peers' Niso(Compromised)    | E                     |
| Watchtower(Compromised) ←(TOR)→ SAR      | E                     |
| Phone(Compromised) ←→ SAR                | E                     |
| User ←→ Peers (out-of-band)(Compromised) | E                     |
- per Iso requirements, No communication with Iso can be intercepted or eavesdropped unless the other party is compromised.
- per ST requirements, User ←→ SecureTerminal can not be intercepted or eavesdropped unless User is compromised..
- Compromised User is User under duress, only can lie about consent_set.
- out-of-band channel is assumed to be secure.
- Direct Inputs can not be manipulated unless one of the parties is compromised. Direct Inputs for non-compromised parties can't be eavesdropped unless via physical presence.
- 
 
## Impact

| Stolen Data                                                                                                                                                             | Impact                                                                                                                                                                                                                                                                                | Where data is kept/Messages data appeared in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| milestone_block_collection                                                                                                                                              | Privacy - reveals duration of physical protection                                                                                                                                                                                                                                     | None<br>...<br>Peers(Users)<br>SetupNisoInput2<br>Niso<br>SetupNisoBoomletMessage2<br>Boomlet<br>SetupIsoInput3<br>Iso<br>...<br>→boomerang_param_seed<br>→boomerang_descriptor<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| wt_ids_collection<wt_id>                                                                                                                                                | Privacy - makes the WT associated with the setup reachable - facilitates DoS                                                                                                                                                                                                          | None<br>...<br>Peers(Users)<br>SetupNisoInput2<br>Niso<br>SetupNisoBoomletMessage2<br>Boomlet<br>SetupIsoInput3<br>Iso<br>...<br>→boomerang_param_seed<br>→boomerang_params                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| sar_ids_collection<sar_id>                                                                                                                                              | Privacy - makes the SAR associated with the setup reachable - facilitates DoS and disabling physical protection                                                                                                                                                                       | None<br>...<br>User <br>SetupPhoneInput1<br>Phone<br>SetupIsoInput1<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>SetupBoomletNisoMessage8\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoWtMessage3\[Encrypted]<br>Wt<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| network                                                                                                                                                                 | Public Global - No Impact                                                                                                                                                                                                                                                             | None<br>...<br>Peers(Users)<br>SetupIsoInput1<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>SetupNisoInput1<br>Niso<br>IsoInput3<br>Iso<br><br>...Withdrawal...<br>WithdrawalIsoInput1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| entropy_bytes                                                                                                                                                           | Loss of Fund - Reducing bitcoin storage security to passphrase & boomlet_0_boom_musig2_privkey_share.<br>                                                                                                                                                                             | None<br>...<br>User<br>SetupIsoInput1<br>Iso<br>...<br>→mnemonic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| passphrase                                                                                                                                                              | Loss of Fund - Reducing bitcoin storage security to mnemonic/entropy_bytes & boomlet_0_boom_musig2_privkey_share.                                                                                                                                                                     | None<br>...<br>User<br>SetupIsoInput1<br>Iso<br>IsoInput3<br>Iso<br><br>...Withdrawal...<br>WithdrawalIsoInput1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| static_doxing_data                                                                                                                                                      | Privacy -<br>Loss of Physical Protection - Facilitates disabling physical protection                                                                                                                                                                                                  | None<br>...<br>User<br>SetupPhoneInput1<br>Phone<br>SetupPhoneSarMessage2\[Encrypted]<br>SAR\[Encrypted]<br>IsoInput3<br>Iso<br>...Withdrawal...<br>SAR\[Duress]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| doxing_password                                                                                                                                                         | Loss of Physical Protection-facilitates disabling physical protection<br>→ doxing_key                                                                                                                                                                                                 | None<br>...<br>User<br>SetupPhoneInput1<br>Phone<br>SetupIsoInput1<br>Iso<br>IsoInput3<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| rpc_client_url, rpc_client_auth                                                                                                                                         | Privacy - Facilitates DoS                                                                                                                                                                                                                                                             | None<br>...<br>User<br>SetupNisoInput1<br>Niso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| wt_privkey                                                                                                                                                              | Impersonation:<br>-Facilitates DoS<br>-Facilitates FastCount Attack<br>Privacy:<br>...<br>->wt_id                                                                                                                                                                                     | None<br>...<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wt_id: {<br>wt_tor_address<br>wt_pubkey<br>}                                                                                                                            | Privacy - Facilitates DoS                                                                                                                                                                                                                                                             | ->wt_privkey<br>...<br>WT<br>...<br>→ wt_ids_collection<br>→ wt_service_fee_payment_info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| most_work_bitcoin_block_height                                                                                                                                          | Public Global - No Impact                                                                                                                                                                                                                                                             | None<br>...<br>WT<br>Peers(Nisos)<br>...<br>→ niso_0_event_block_height                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| sar_privkey                                                                                                                                                             | Impersonation - Disabling Physical Protection<br>→sar_id                                                                                                                                                                                                                              | None<br>...<br>SAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| sar_id: { <br>sar_tor_address,<br>sar_pubkey<br>}                                                                                                                       | Privacy - Facilitates DoS <br>facilitates disabling physical protection                                                                                                                                                                                                               | →sar_privkey<br>...<br>SAR<br>...<br>→ sar_ids_collection<br>→ sar_service_fee_payment_info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| dynamic_doxing_data                                                                                                                                                     | Privacy -<br>Loss of Physical Protection-facilitates disabling physical protection                                                                                                                                                                                                    | None<br>...<br>Phone<br>SetupPhoneSarMessage2\[Encrypted]<br>SAR\[Encrypted]<br>...Withdrawal...<br>SAR\[Duress]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| doxing_key                                                                                                                                                              | Loss of Physical Protection-facilitates disabling physical protection<br>...<br>→doxing_data_identifier                                                                                                                                                                               | →doxing_password<br>...<br>Phone<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>Iso\[regenerated]<br>...<br>→boomlet_0_backup<br>→duress_placeholder_plaintext\[Duress]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| doxing_data_identifier                                                                                                                                                  | Privacy                                                                                                                                                                                                                                                                               | →doxing_password<br>→doxing_key<br>...<br>Phone<br>SetupPhoneSarMessage2<br>SAR<br>Boomlet\[regenerated]<br>SetupBoomletNisoMessage8\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoWtMessage3\[Encrypted]<br>Wt\[Encrypted]<br>SetupWtSarMessage1\[Encrypted]<br>SAR<br>Iso\[regenerated]<br>...<br>→sar_setup_response<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| sar_service_fee_payment_info: { <br>service_fee_invoice,<br>payment_deadline,<br>sar_id<br>}                                                                            | Privacy<br>→sar_id                                                                                                                                                                                                                                                                    | None<br>...<br>SAR<br>SetupSarPhoneMessage1<br>Phone<br>SetupPhoneOutput1<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| sar_service_fee_payment_receipts                                                                                                                                        | Privacy                                                                                                                                                                                                                                                                               | None<br>...<br>User<br>SetupPhoneInput2<br>Phone<br>SetupPhoneSarMessage2<br>SAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| mnemonic                                                                                                                                                                | →entropy_bytes                                                                                                                                                                                                                                                                        | →entropy_bytes<br>...<br>Iso<br>SetupIsoOutput1<br>User<br>IsoInput3<br>Iso<br>...Withdrawal...<br>WithdrawalIsoInput1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| normal_privkey_0                                                                                                                                                        | Loss of Fund - Reducing bitcoin storage security to boomlet_0_boom_musig2_privkey_share.                                                                                                                                                                                              | →(mnemonic+passphrase)<br>...<br>Iso<br>Iso\[regenerated]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| normal_pubkey_0                                                                                                                                                         | Privacy - ?                                                                                                                                                                                                                                                                           | →normal_privkey_0<br>...<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>...<br>→peer_0_id<br>→backup_request                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| boomlet_0_identity_privkey                                                                                                                                              | impersonation                                                                                                                                                                                                                                                                         | None<br>...<br>Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| boomlet_0_identity_pubkey                                                                                                                                               | Privacy - ?                                                                                                                                                                                                                                                                           | →boomlet_0_identity_privkey<br>...<br>Boomlet<br>SetupBoomletIsoMessage1<br>Iso<br>SetupIsoStMessage1<br>ST<br>SetupNisoWtMessage1<br>WT<br>SetupWtSarMessage1<br>SAR<br>SetupBoomletIsoMessage5<br>Iso<br>SetupIsoBoomletwo2<br>Boomletwo<br>...<br>Withdrawal:<br>WithdrawalWtSarsMessage1<br>WithdrawalWtSarsMessage2<br>...<br>→peer_0_id<br>→backup_done<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| boomlet_0_boom_musig2_privkey_share                                                                                                                                     | Loss of Fund - Reducing bitcoin storage security to normal_privkey_0.                                                                                                                                                                                                                 | None<br>...<br>Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| boomlet_0_boom_musig2_pubkey_share                                                                                                                                      | Privacy - ?                                                                                                                                                                                                                                                                           | →boomlet_0_boom_musig2_privkey_share<br>...<br>Boomlet<br><br>...Withdrawal...<br>WithdrawalBoomletIsoMessage1<br>Iso<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| boom_pubkey_0                                                                                                                                                           | Privacy - Loss of on-chain privacy, post-spend.                                                                                                                                                                                                                                       | None<br>...<br>Boomlet<br>...<br>→peer_0_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| peer_0_tor_secret_key                                                                                                                                                   | Impersonation - Denial of Service(?)                                                                                                                                                                                                                                                  | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage1<br>Niso<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}                                                                                    | → boom_pubkey_0,<br>→ normal_pubkey_0,<br>→ boomlet_0_identity_pubkey                                                                                                                                                                                                                 | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage1<br>Niso<br>SetupNisoStMessage1<br>St<br>SetupStOutput3<br>User<br>SetupUserPeersOutOfBandMessage1<br>Peers(Users)<br>...<br>→peer_addresses_collection<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| st_0_identity_privkey                                                                                                                                                   | Impersonation - tx_approval<br>→consent_set<br>→secureterminal_0_identity_pubkey                                                                                                                                                                                                      | None<br>...<br>ST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| st_0_identity_pubkey                                                                                                                                                    | No impact(?)                                                                                                                                                                                                                                                                          | →secureterminal_0_identity_privkey<br>...<br>ST<br>SetupStIsoMessage1<br>Iso<br>SetupIsoBoomletMessage2<br>Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| duress_check_space                                                                                                                                                      | {+duress_signal_index}→duress_consent_set                                                                                                                                                                                                                                             | None<br>...<br>Boomlet<br>SetupBoomletIsoMessage2\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoStMessage2\[Encrypted]<br>ST<br>SetupStOutput1<br>User<br>Boomlet\[Regenerated]<br>SetupBoomletIsoMessage3\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoStMessage3\[Encrypted]<br>ST<br>SetupStOutput2<br>User<br><br>...Withdrawal...<br>Boomlet\[Regenerated]<br>WithdrawalBoomletNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoStMessage2\[Encrypted]<br>ST<br>WithdrawalStOutput2<br>User<br>Boomlet\[Regenerated]<br>WithdrawalBoomletNisoMessage6\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoStMessage3\[Encrypted]<br>ST<br>WithdrawalStOutput3<br>User<br><br>...Non-initiator Withdrawal...<br>Boomlet\[Regenerated]<br>WithdrawalNonInitiatorBoomletNisoMessage4\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoStMessage2\[Encrypted]<br>ST<br>WithdrawalNonInitiatorStOutput2<br>User |
| duress_signal_index                                                                                                                                                     | {+duress_check_space}→duress_consent_set                                                                                                                                                                                                                                              | None<br>...<br>User<br>SetupStInput1<br>ST<br>SetupStIsoMessage2\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoBoomletMessage3\[Encrypted]<br>Boomlet<br>User\[Regenerated]<br>SetupStInput2<br>ST<br>SetupStIsoMessage3\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoBoomletMessage4\[Encrypted]<br>Boomlet<br><br>...Withdrawal...<br>User\[Regenerated]<br>WithdrawalStInput2<br>ST<br>WithdrawalStNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoBoomletMessage4\[Encrypted]<br>Boomlet<br>User\[Regenerated]<br>WithdrawalStInput3<br>ST<br>WithdrawalStNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoBoomletMessage7\[Encrypted]<br>Boomlet<br><br>...Non-initiator Withdrawal...<br>User\[Regenerated]<br>WithdrawalNonInitiatorStInput2<br>ST<br>WithdrawalNonInitiatorStNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoBoomletMessage5\[Encrypted]<br>Boomlet      |
| duress_consent_set                                                                                                                                                      | Loss of Physical Protection                                                                                                                                                                                                                                                           | None<br>...<br>User<br>ST\[inferred]<br>Boomlet\[inferred]<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| peer_0_tor_address_signed_by_boomlet_0                                                                                                                                  | →peer_0_tor_address                                                                                                                                                                                                                                                                   | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage1<br>Niso<br>SetupNisoStMessage1<br>ST<br>SetupStOutput3<br>User<br>SetupUserPeersOutOfBandMessage1<br>Peers(Users)<br>SetupNisoWtMessage1<br>Wt<br>...<br>→peer_addresses_collection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| peer_0_tor_address                                                                                                                                                      | Privacy - Facilitates DoS?                                                                                                                                                                                                                                                            | →peer_0_tor_secret_key<br>...<br>Boomlet<br>Niso\[regenerated]<br>...<br>→peer_0_tor_address_signed_by_boomlet_0<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| peer_addresses_collection: Collection<peer_i_id, peer_i_tor_address_signed_by_boomlet_i>                                                                                | →peer_ids_collection<br>→peer_0_tor_address<br>                                                                                                                                                                                                                                       | None<br>...<br>User<br>SetupNisoInput2<br>Niso<br>SetupNisoBoomletMessage2<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| peer_ids_collection<peer_i_id>                                                                                                                                          |                                                                                                                                                                                                                                                                                       | None<br>...<br>Boomlet<br>...<br>→boomerang_params_seed<br>→boomerang_params<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| boomerang_params_seed: {<br>peer_ids_collection,<br>wt_ids_collection,<br>milestone_block_collection<br>}                                                               | →peer_ids_collection<br>→wt_ids_collection<br>→milestone_block_collection<br>→boomerang_descriptor                                                                                                                                                                                    | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoStMessage2\[Encrypted]<br>ST<br>SetupStOutput4<br>User<br>...<br>boomerang_params_seed_signed_by_st<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| boomerang_params_seed_signed_by_st                                                                                                                                      | →boomerang_params_seed                                                                                                                                                                                                                                                                | None<br>...<br>ST<br>SetupStNisoMessage1\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoBoomletMessage3\[Encrypted]<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| boomerang_descriptor                                                                                                                                                    | →milestone_block_collection<br>→boom_pubkey_0                                                                                                                                                                                                                                         | None<br>...<br>Boomlet<br>Iso \[reconstructed]<br><br>...Withdrawal...<br>WithdrawalBoomletIsoMessage1<br>Iso<br>...<br><br>→boomerang_params                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| boomerang_params: {<br>peer_ids_collection,<br>wt_ids_collection,<br>boomerang_descriptor<br>}                                                                          | →peer_ids_collection<br>→wt_ids_collection<br>→boomerang_descriptor                                                                                                                                                                                                                   | None<br>...<br>Boomlet<br>SetupBoomletIsoMessage5<br>Iso<br>...<br>→boomerang_params_signed_by_boomlet_0<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| boomerang_params_signed_by_boomlet_0                                                                                                                                    | → boomerang_params                                                                                                                                                                                                                                                                    | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage3<br>Niso<br>SetupNisoPeerNisoMessage1<br>Peers(Nisos)<br>...<br>→ boomerang_params_signed_by_all_peers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| boomerang_params_signed_by_all_peers                                                                                                                                    | → boomerang_params_signed_by_boomlet_0                                                                                                                                                                                                                                                | None<br>...<br>SetupNisoPeerNisoMessage1<br>Peers(Nisos)<br>SetupNisoBoomletMessage4<br>Peers(Boomlet)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| mystery                                                                                                                                                                 | Loss of non-determinism                                                                                                                                                                                                                                                               | None<br>...<br>Boomlet<br>Boomletwo\[regenerated]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| counter                                                                                                                                                                 | {+milestone_blocks}: Loss of non-determinism                                                                                                                                                                                                                                          | None<br>...<br>Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| boomerang_params_fingerprint                                                                                                                                            |                                                                                                                                                                                                                                                                                       | →boomerang_params<br>...<br>Boomlet<br>...<br>→boomerang_params_fingerprint_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| boomerang_params_fingerprint_signed_by_boomlet_0                                                                                                                        |                                                                                                                                                                                                                                                                                       | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage5<br>Niso<br>SetupNisoWtMessage1<br>Wt<br>...<br>None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0                                                                                                           | →peer_ids_collection                                                                                                                                                                                                                                                                  | None<br>...<br>Boomlet<br>SetupBoomletNisoMessage5<br>Niso<br>SetupNisoWtMessage1<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wt_service_fee_payment_info: {<br>service_fee_invoice,<br>payment_deadline, <br>wt_id<br>}                                                                              | → wt_id                                                                                                                                                                                                                                                                               | None<br>...<br>Wt<br>SetupWtNisoMessage1<br>Niso<br>SetupNisoOutput1<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| wt_service_fee_payment_receipts                                                                                                                                         |                                                                                                                                                                                                                                                                                       | None<br>...<br>User<br>SetupNisoInput3<br>Niso<br>SetupNisoWtMessage2<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt                                                                                                                | →boomerang_params_fingerprint                                                                                                                                                                                                                                                         | None<br>...<br>Wt<br>SetupWtNisoMessage2<br>Niso<br>SetupNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| shared_state_active_wt: {<br>boomerang_params,<br>"setup_wt_service_initialized"<br>}                                                                                   | → boomerang_params                                                                                                                                                                                                                                                                    | None<br>...<br>Peers(Boomlets)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| shared_state_active_wt_fingerprint_signed_by_boomlet_0                                                                                                                  | →shared_state_active_wt                                                                                                                                                                                                                                                               | Peers(Boomlets)<br>SetupBoomletNisoMessage6<br>Peers(Nisos)<br>SetupNisoPeerNisoMessage2<br>SetupNisoBoomletMessage7<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| shared_state_active_wt_fingerprint_signed_by_all_peers                                                                                                                  | →shared_state_active_wt                                                                                                                                                                                                                                                               | Peers(Nisos)<br>SetupNisoBoomletMessage7<br>Peers(Boomlets)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| sar_setup_response: {<br>doxing_data_identifier,<br>fingerprint_of_static_doxing_data_encrypted_by_doxing_key,<br>iv_of_static_doxing_data_encrypted_by_doxing_key<br>} | →doxing_data_identifier                                                                                                                                                                                                                                                               | SAR<br>SetupSarWtMessage1\[Encrypted]<br>WT\[Encrypted]<br>SetupWtNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoBoomletMessage9\[Encrypted]<br>Boomlet<br>SetupBoomletIsoMessage5<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| shared_state_active_sar                                                                                                                                                 |                                                                                                                                                                                                                                                                                       | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| shared_state_active_sar_fingerprint                                                                                                                                     |                                                                                                                                                                                                                                                                                       | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| shared_state_active_sar_fingerprint_signed_by_boomlet_0                                                                                                                 |                                                                                                                                                                                                                                                                                       | Boomlet<br>SetupBoomletNisoMessage9<br>Niso<br>SetupNisoPeerNisoMessage3<br>Peers(Nisos)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| shared_state_active_sar_fingerprint_signed_by_all_peers                                                                                                                 |                                                                                                                                                                                                                                                                                       | Peers(Nisos)<br>SetupNisoBoomletMessage10<br>Peers(Boomlets)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| boomletwo_Identity_privkey                                                                                                                                              | →boomletwo_Identity_pubkey                                                                                                                                                                                                                                                            | Boomletwo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| boomletwo_Identity_pubkey                                                                                                                                               | <br>                                                                                                                                                                                                                                                                                  | →boomletwo_Identity_privkey<br>...<br>Boomletwo<br>SetupBoomletwoIso1<br>Iso<br>..<br>→ backup_request<br>→boomlet_backup_done                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| backup_request: {<br>"boomlet_backup_request",<br>boomletwo_Identity_pubkey,<br>normal_pubkey_0<br>}                                                                    | →boomletwo_Identity_pubkey<br>→normal_pubkey_0                                                                                                                                                                                                                                        | Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| backup_request_signed_by_normal_0                                                                                                                                       | →backup_request                                                                                                                                                                                                                                                                       | Iso<br>SetupIsoBoomletMessage5<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| boomlet_0_backup                                                                                                                                                        | →doxing_key<br>→boomlet_0_identity_privkey<br>→boomlet_0_boom_musig2_privkey_share<br>→boomlet_0_boom_musig2_pubkey_share<br>→peer_0_id<br>→sar_ids_collection<br>→peer_0_tor_secret_key<br>→secureterminal_0_identity_pubkey<br>→duress_consent_set<br>→boomerang_params<br>→counter | Boomlet<br>SetupBoomletIsoMessage5\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoBoomletwo2\[Encrypted]<br>Boomletwo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| backup_done:{<br>"boomlet_backup_done",<br>boomletwo_Identity_pubkey,<br>boomlet_0_identity_pubkey<br>}                                                                 | →boomletwo_Identity_pubkey<br>→boomlet_0_identity_pubkey                                                                                                                                                                                                                              | Boomletwo<br>...<br>→backup_done_signed_by_boomletwo<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| backup_done_signed_by_boomletwo                                                                                                                                         | →backup_done                                                                                                                                                                                                                                                                          | Boomletwo<br>SetupBoomletwoIso2<br>Iso<br>SetupIsoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| shared_state_active_backup: {<br>"boomlet_backup_done_and_setup_finish_initialized"<br>}                                                                                |                                                                                                                                                                                                                                                                                       | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| shared_state_active_backup_fingerprint                                                                                                                                  |                                                                                                                                                                                                                                                                                       | →shared_state_active_backup<br>...<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| shared_state_active_backup_fingerprint_signed_by_boomlet_0                                                                                                              | →shared_state_active_backup_fingerprint                                                                                                                                                                                                                                               | Boomlet<br>SetupBoomletNisoMessage11<br>Niso<br>SetupNisoPeerNisoMessage4<br>Peers(Nisos)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| shared_state_active_backup_fingerprint_signed_by_all_peers                                                                                                              | →shared_state_active_backup_fingerprint                                                                                                                                                                                                                                               | Peers(Nisos)<br>SetupNisoBoomletMessage12<br>Peers(Boomlets)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Withdrawal:                                                                                                                                                             |                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| psbt                                                                                                                                                                    | Privacy - Loss of on-chain privacy<br>→tx_id                                                                                                                                                                                                                                          | User<br>WithdrawalNisoInput1<br>Niso<br>WithdrawalNisoBoomletMessage1<br>Boomlet<br>WithdrawalBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage1\[Encrypted]<br>WT\[Encrypted]<br><br>Niso\[hydrated]<br>WithdrawalNisoBoomletMessage8<br>Boomlet<br>WithdrawalBoomletIsoMessage1<br>Iso<br>...<br>\[Non_init Diagram]:<br><br>WithdrawalWtNonInitiatorNisoMessage1\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoBoomletMessage1\[Encrypted]<br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage1<br>Niso<br>WithdrawalNonInitiatorNisoOutput1<br>User<br>...<br>→hydrated_psbt<br>→psbt_signed_0<br>→psbt_signed_i<br>→psbt_signed                                                                                                                                                                                                                                            |
| tx_id                                                                                                                                                                   | Privacy - Loss of on-chain privacy post-spend                                                                                                                                                                                                                                         | →psbt<br>...<br>Niso\[derived]<br>Boomlet\[derived]<br>ST\[derived]<br>WithdrawalStOutput1<br>User<br><br>WT\[derived]<br><br>...<br>\[Non_init Diagram]:<br><br>Nisos\[derived]<br>Boomlets\[derived]<br>ST\[derived]<br>WithdrawalStOutput1<br>User<br>...<br>→tx_id_with_nonce<br>→peer_0_tx_approval<br>→wt_tx_approval<br>→peer_1_tx_approval<br>→peer_i_tx_approval<br>→peer_0_tx_commit<br>→peer_1_tx_commit<br>→peer_i_tx_commit<br>→peer_0_ping<br>→peer_i_ping                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| niso_0_event_block_height                                                                                                                                               | Privacy - Revealing protcol execution?                                                                                                                                                                                                                                                | Niso<br>WithdrawalNisoBoomletMessage1<br>Boomlet<br><br>Niso\[regenerated]<br>WithdrawalNisoBoomletMessage3<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNisoBoomletMessage5<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| tx_id_with_nonce:{<br>content: tx_id,<br>nonce:rand() \[u8; 32]<br>}                                                                                                    | →tx_id<br>?                                                                                                                                                                                                                                                                           | Boomlet<br>WithdrawalBoomletNisoMessage1\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoStMessage1\[Encrypted]<br>ST<br>...<br>\[Non_init Diagram]:<br><br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoStMessage1\[Encrypted]<br>ST<br>...<br>→tx_id_with_nonce_signed_by_st                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| tx_id_with_nonce_signed_by_st                                                                                                                                           | Privacy - Revealing User's agreement on tx_id<br>→tx_id_message                                                                                                                                                                                                                       | ST<br>WithdrawalStNisoMessage1\[Encrypted]<br>WithdrawalNisoBoomletMessage2\[Encrypted]<br>Boomlet<br>...<br>\[Non_init Diagram]:<br><br>ST<br>WithdrawalNonInitiatorStNisoMessage1\[Encrypted]<br>WithdrawalNonInitiatorNisoBoomletMessage3\[Encrypted]<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| peer_0_tx_approval: {<br>"approved",<br>tx_id,<br>niso_0_event_block_height<br>}                                                                                        | →tx_id<br>→niso_0_event_block_height                                                                                                                                                                                                                                                  | None<br>...<br>Boomlet<br>...<br>→peer_0_tx_approval_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| peer_0_tx_approval_signed_by_boomlet_0                                                                                                                                  | →peer_0_tx_approval                                                                                                                                                                                                                                                                   | Boomlet<br>WithdrawalBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage1\[Encrypted]<br>WT<br>...<br>\[Non_init Diagram]:<br>WithdrawalWtNonInitiatorNisoMessage1<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage1<br>Boomlet<br>....<br>→approvals<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wt_tx_approval:{<br>"approved",<br> tx_id,<br> wt_event_block_height,<br>boomlet_0_identity_pubkey<br>}                                                                 | →tx_id<br>→wt_event_block_height<br>→boomlet_0_identity_pubkey                                                                                                                                                                                                                        | WT<br>...<br>→wt_tx_approval_signed_by_wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| wt_tx_approval_signed_by_wt                                                                                                                                             | →wt_tx_approval                                                                                                                                                                                                                                                                       | ...Non-init diagram...<br>WT<br>WithdrawalWtNonInitiatorNisoMessage1<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage1<br>Boomlet<br>...<br>WithdrawalWtNisoMessage1<br>Niso<br>WithdrawalNisoBoomletMessage3<br>Boomlet<br>...<br>→approvals                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| niso_1_event_block_height                                                                                                                                               |                                                                                                                                                                                                                                                                                       | None<br>...Non_init Diagram...<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage2<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNonInitiatorNisoBoomletMessage4<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNonInitiatorNisoBoomletMessage6<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNonInitiatorNisoBoomletMessage7<br>Boomlet<br>...<br>→peer_1_tx_approval                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| initiator_id                                                                                                                                                            | →peer_0_id                                                                                                                                                                                                                                                                            | ...Non-init diagram...<br>Niso<br>WithdrawalNonInitiatorNisoOutput1<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| peer_1_tx_approval{<br>"approval",<br>tx_id,<br>niso_1_event_block_height<br>}                                                                                          | →tx_id<br>→niso_1_event_block_height                                                                                                                                                                                                                                                  | Boomlet<br>...<br>→peer_1_tx_approval_signed_by_boomlet_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| peer_1_tx_approval_signed_by_boomlet_1                                                                                                                                  |                                                                                                                                                                                                                                                                                       | \[Non_init Diagram]:<br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoWtMessage1\[Encrypted]<br>WT<br>...<br>→Collection<peer_i_tx_approval_signed_by_boomlet_i>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Collection<peer_i_tx_approval_signed_by_boomlet_i>                                                                                                                      | →peer_1_tx_approval<br>→peer_0_tx_approval                                                                                                                                                                                                                                            | WithdrawalWtNisoMessage1<br>Niso<br>WithdrawalNisoBoomletMessage3<br>Boomlet<br><br>...Non_init Diagram...:<br>WithdrawalWtNonInitiatorNisoMessage2<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage4<br>Boomlet<br>...<br>→approvals                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| duress_placeholder_plaintext                                                                                                                                            | →doxing_key                                                                                                                                                                                                                                                                           | →doxing_key<br>...<br>Boomlet<br>SAR\[derived]<br>...<br>→duress_placeholder\[Encrypted]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| duress_placeholder                                                                                                                                                      | No impact (ciphertext, encrypted with sar_pubkey)                                                                                                                                                                                                                                     | Boomlet<br>WT\[derived]<br>WithdrawalWtSarsMessage1<br>SAR<br>WT\[derived]<br>WithdrawalWtSarsMessage2<br>SAR<br>...Non-init diagram...<br>WT\[derived]<br>WithdrawalNonInitiatorWtSarsMessage1<br>SAR<br>...<br>→peer_0_tx_commit_signed_by_boomlet_0_padded<br>→duress_placeholder_signed_by_sar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| peer_0_tx_commit:{<br>"commit",<br>tx_id,<br>niso_0_event_block_height<br>}                                                                                             | →tx_id<br>→niso_0_event_block_height                                                                                                                                                                                                                                                  | Boomlet<br><br>...<br>→peer_0_tx_commit_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| peer_0_tx_commit_signed_by_boomlet_0                                                                                                                                    | →peer_0_tx_commit                                                                                                                                                                                                                                                                     | Boomlet<br>WT\[derived]<br>...<br>→peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt<br>→peer_0_tx_commit_signed_by_boomlet_0_padded                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| peer_0_tx_commit_signed_by_boomlet_0_padded                                                                                                                             | →peer_0_tx_commit_signed_by_boomlet_0<br>→duress_placeholder                                                                                                                                                                                                                          | Boomlet<br>WT\[derived]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0                                                                                                         | →peer_0_tx_commit_signed_by_boomlet_0_padded                                                                                                                                                                                                                                          | Boomlet<br>WithdrawalBoomletNisoMessage4\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage2\[Encrypted]<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| approvals: \[peer_i_tx_approval_signed_by_peer_i , wt_tx_approval]                                                                                                      | →peer_0_tx_approval<br>→peer_1_tx_approval<br>→wt_tx_approval                                                                                                                                                                                                                         | ... Non-initiator Diagram...<br>Boomlet<br>...<br>→approvals_signed_by_boomlet_i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| approvals_signed_by_boomlet_1                                                                                                                                           | →approvals                                                                                                                                                                                                                                                                            | Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage5<br>Niso<br>WithdrawalNonInitiatorNisoWtMessage2<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| duress_placeholder_signed_by_sar                                                                                                                                        | →duress_placeholder                                                                                                                                                                                                                                                                   | SAR<br>WithdrawalSarsWtMessage1\[Encrypted]<br>WT\[Encrypted]<br>WithdrawalWtNisoMessage2\[Encrypted-Suffixed]<br>Niso\[Encrypted-Suffixed]<br>WithdrawalNisoBoomletMessage5\[Encrypted]<br>Boomlet<br><br>SAR\[regenerated]<br>WithdrawalSarsWtMessage2\[Encrypted]<br>WT\[Encrypted]<br>WithdrawalWtNisoMessage3\[Encrypted-Suffixed]<br>Niso\[Encrypted-Suffixed]<br>WithdrawalNisoBoomletMessage6\[Encrypted]<br>Boomlet<br>... Non-initiator Diagram...<br>SAR<br>WithdrawalNonInitiatorSarsWtMessage1\[Encrypted]<br>WT\[Encrypted]<br>WithdrawalWtNonInitiatorNisoMessage4\[Encrypted]<br>Niso\[Encrypted]                                                                                                                                                                                                                                                                                                              |
| peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt                                                                                                                       | →peer_0_tx_commit_signed_by_boomlet_0                                                                                                                                                                                                                                                 | ...Non_init Diagram...<br>WT<br>WithdrawalWtNonInitiatorNisoMessage3<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage6<br>Boomlet<br>...<br>→Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| peer_1_tx_commit: {<br>"commit",<br>tx_id,<br>niso_1_event_block_height<br>}                                                                                            | →tx_id<br>→niso_1_event_block_height                                                                                                                                                                                                                                                  | ...Non_init Diagram...<br>Boomlet<br>...<br>→peer_1_tx_commit_signed_by_boomlet_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| peer_1_tx_commit_signed_by_boomlet_1                                                                                                                                    | →peer_1_tx_commit                                                                                                                                                                                                                                                                     | ...Non_init Diagram...<br>Boomlet<br>...<br>→peer_1_tx_commit_signed_by_boomlet_1_signed_by_wt<br>→peer_1_tx_commit_signed_by_boomlet_1_padded<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| peer_1_tx_commit_signed_by_boomlet_1_padded                                                                                                                             | →peer_1_tx_commit_signed_by_boomlet_1<br>→placeholder                                                                                                                                                                                                                                 | ...Non_init Diagram...<br>Boomlet<br>...<br>→peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1                                                                                                         | →peer_1_tx_commit_signed_by_boomlet_1_padded                                                                                                                                                                                                                                          | ...Non_init Diagram...<br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage6\[Encrypted]<br>Niso \[Encrypted]<br>WithdrawalNonInitiatorNisoWtMessage3 \[Encrypted]<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| peer_1_tx_commit_signed_by_boomlet_1_signed_by_wt                                                                                                                       | →peer_1_tx_commit_signed_by_boomlet_1                                                                                                                                                                                                                                                 | WT<br>WithdrawalWtNisoMessage2<br>Niso<br>WithdrawalNisoBoomletMessage5<br>Boomlet<br>...<br>→Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt>                                                                                                           | →peer_1_tx_commit_signed_by_boomlet_1_signed_by_wt<br>→peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt                                                                                                                                                                              | WT<br>WithdrawalWtNisoMessage2<br>Niso<br>WithdrawalNisoBoomletMessage5<br>Boomlet<br><br>...Non-int diagram...<br>WT<br>WithdrawalWtNonInitiatorNisoMessage4<br>Niso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| reached_boomlets_collection                                                                                                                                             | →                                                                                                                                                                                                                                                                                     | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ping_seq_num                                                                                                                                                            | →                                                                                                                                                                                                                                                                                     | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| reached_mystery_flag                                                                                                                                                    | →                                                                                                                                                                                                                                                                                     | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| last_seen_block                                                                                                                                                         | →niso_event_block_height                                                                                                                                                                                                                                                              | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| peer_0_ping:{<br>"ping",<br>tx_id,<br>last_seen_block,<br>ping_seq_num,<br>reached_mystery_flag<br>}                                                                    | →tx_id<br>→last_seen_block<br>→ping_seq_num<br>→reached_mystery_flag                                                                                                                                                                                                                  | Boomlet<br>...<br>→peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| peer_0_ping_signed_by_boomlet_0                                                                                                                                         | →peer_0_ping                                                                                                                                                                                                                                                                          | Boomlet<br>WT\[derived]<br>...<br>→peer_0_ping_signed_by_boomlet_0_padded<br>→pong_i<br>→reached_pings_collection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| peer_0_ping_signed_by_boomlet_0_padded: {<br>content: peer_0_ping_signed_by_boomlet_0,<br>padding: duress_placeholder<br>}                                              | →peer_0_ping_signed_by_boomlet_0<br>→duress_placeholder                                                                                                                                                                                                                               | Boomlet<br>WT\[derived]<br>...<br>→peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0<br>→pong_i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0                                                                                                              | →peer_0_ping_signed_by_boomlet_0_padded                                                                                                                                                                                                                                               | Boomlet<br>WithdrawalBoomletNisoMessage5\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage3\[Encrypted]<br>WT<br><br>Boomlet\[Regenerated]<br>WithdrawalBoomletNisoMessage7\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage4\[Encrypted]<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| reached_pings_collection                                                                                                                                                | →peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                                                                      | WT<br>WithdrawalWtNisoMessage4<br>Niso<br>WithdrawalNisoBoomletMessage8<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Collection<peer_j_ping_signed_by_boomlet_j>                                                                                                                             | →peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                                                                      | WT<br>...<br>→pong_i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| pong_i:{<br>"pong",<br>tx_id,<br>most_work_bitcoin_block_height,<br>Collection<peer_j_ping_signed_by_boomlet_j><br>}                                                    | →tx_id<br>→most_work_bitcoin_block_height<br>→peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                         | WT<br><br>...<br>→pong_i_signed_by_wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| pong_i_signed_by_wt                                                                                                                                                     | →pong_i                                                                                                                                                                                                                                                                               | WT<br>WithdrawalWtNisoMessage3<br>Niso<br>WithdrawalNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| hydrated_psbt                                                                                                                                                           | →psbt                                                                                                                                                                                                                                                                                 | Niso<br>WithdrawalNisoBoomletMessage8<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| pubnonce_boom                                                                                                                                                           |                                                                                                                                                                                                                                                                                       | Boomlet<br>WithdrawalBoomletIsoMessage1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| pubnonce_normal                                                                                                                                                         |                                                                                                                                                                                                                                                                                       | Iso<br>WithdrawalIsoBoomletMessage2<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| partialsig_normal                                                                                                                                                       |                                                                                                                                                                                                                                                                                       | Iso<br>WithdrawalIsoBoomletMessage2<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| partialsig_boom                                                                                                                                                         |                                                                                                                                                                                                                                                                                       | Boomlet<br>WithdrawalBoomletIsoMessage2<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| psbt_signed_0                                                                                                                                                           | →psbt                                                                                                                                                                                                                                                                                 | Boomlet<br>Iso<br>WithdrawalBoomletNisoMessage9<br>Niso<br>WithdrawalNisoWtMessage5<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| psbt_signed_i                                                                                                                                                           | →psbt<br>                                                                                                                                                                                                                                                                             | WithdrawalNisoWtMessage5<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| psbt_signed                                                                                                                                                             | →psbt<br>                                                                                                                                                                                                                                                                             | Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



- what happens if Niso reports another peer_0_tor_address to User? Peers connect but can't get boomlet's signature on it.
- what are the risks associated with a lying bitcoin node inside Niso and/or leak of rpc_client/auth
- remove master_privkey and master pubkey from states and analysis. 
- At the moment boom_pubkeys are not checked anywhere to see if they're valid. For this check having musig_pub_share is necessary. it could accompany messages to niso and other peers but can be lied about when talking to iso. but is having valid keys enough? how about lying about normal_pubkey_0?  only user and iso can verify that. so no possible solution can avoid including user in this non-trivial overhead. We just keep assuming boomlet is honest and working as expected during setup.

### Data in each entity during it's lifetime


| Entity    | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| User<br>  | milestone_block_collection<br>wt_ids_collection<wt_id><br>sar_ids_collection<sar_id><br>network<br>entropy_bytes<br>passphrase<br>static_doxing_data<br>doxing_password<br>rpc_client_url, rpc_client_auth<br>sar_service_fee_payment_info: { <br>service_fee_invoice,<br>payment_deadline,<br>sar_id<br>}<br>sar_service_fee_payment_receipts<br>duress_check_space<br>duress_signal_index<br>duress_consent_set<br>mnemonic<br>peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}<br>peer_0_tor_address_signed_by_boomlet_0<br>peer_addresses_collection: Collection<peer_i_id, peer_i_tor_address_signed_by_boomlet_i><br>boomerang_params_seed<br>wt_service_fee_payment_info: {<br>service_fee_invoice,<br>payment_deadline, <br>wt_id<br>}<br>wt_service_fee_payment_receipt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Phone     | dynamic_doxing_data<br>static_doxing_data<br>doxing_password<br>sar_ids_collection<sar_id><br>doxing_key<br>doxing_data_identifier<br>sar_service_fee_payment_info: { <br>service_fee_invoice,<br>payment_deadline,<br>sar_id<br>}<br>sar_service_fee_payment_receipts                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| SAR       | sar_privkey<br>sar_id: { <br>sar_tor_address,<br>sar_pubkey<br>}<br>doxing_data_identifier<br>sar_service_fee_payment_info: { <br>service_fee_invoice,<br>payment_deadline,<br>sar_id<br>}<br>sar_service_fee_payment_receipts<br>static_doxing_data\[Encrypted]<br>dynamic_doxing_data\[Encrypted]<br>boomlet_0_identity_pubkey<br>sar_setup_response: {<br>doxing_data_identifier,<br>fingerprint_of_static_doxing_data_encrypted_by_doxing_key,<br>iv_of_static_doxing_data_encrypted_by_doxing_key<br>}<br>...Withdrawal...<br>boomlet_0_identity_pubkey<br>duress_placeholder<br>duress_placeholder_plaintext<br>doxing_key \[Duress]<br>static_doxing_data \[Duress]<br>dynamic_doxing_data \[Duress]<br>duress_placeholder_signed_by_sar<br><br>... Non-init diagram...<br>boomlet_1_identity_pubkey<br>duress_placeholder<br>duress_placeholder_plaintext<br>doxing_key \[Duress]<br>static_doxing_data \[Duress]<br>dynamic_doxing_data \[Duress]<br>duress_placeholder_signed_by_sar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Iso       | network<br>entropy_bytes<br>passphrase<br>doxing_password<br>doxing_key<br>sar_ids_collection<sar_id><br>mnemonic<br>normal_privkey_0<br>normal_pubkey_0<br>boomlet_0_identity_pubkey<br>st_0_identity_pubkey<br><br>boomletwo_Identity_pubkey<br>milestone_block_collection<br>static_doxing_data<br>doxing_password<br>doxing_key<br>backup_request: {<br>"boomlet_backup_request",<br>boomletwo_Identity_pubkey,<br>normal_pubkey_0<br>}<br>backup_request_signed_by_normal_0<br>boomlet_0_identity_pubkey<br>boomerang_params<br>sar_setup_response: {<br>doxing_data_identifier,<br>fingerprint_of_static_doxing_data_encrypted_by_doxing_key,<br>iv_of_static_doxing_data_encrypted_by_doxing_key<br>}<br>boomerang_descriptor<br>doxing_data_identifier<br>backup_done_signed_by_boomletwo<br><br>...Withdrawal...<br>network<br>mnemonic<br>passphrase<br>psbt<br>boomerang_descriptor<br>boomlet_0_boom_musig2_pubkey_share<br>pubnonce_boom<br>pubnonce_normal<br>partialsig_normal<br>partialsig_boom<br>psbt_signed_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Boomlet   | normal_pubkey_0<br>doxing_key<br>sar_ids_collection<br>network<br>boomlet_0_boom_musig2_privkey_share<br>boomlet_0_boom_musig2_pubkey_share<br>boomlet_0_identity_privkey<br>boomlet_0_identity_pubkey<br>peer_0_tor_secret_key<br>boom_pubkey_0<br>peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}<br>st_0_identity_pubkey<br>duress_check_space<br>duress_signal_index<br>duress_consent_set<br>peer_0_tor_address_signed_by_boomlet_0<br>peer_addresses_collection: Collection<peer_i_id, peer_i_tor_address_signed_by_boomlet_i><br>wt_ids_collection<wt_id><br>milestone_block_collection<br>peer_ids_collection<peer_i_id><br>boomerang_params_seed<br>boomerang_params_seed_signed_by_st<br>boomerang_descriptor<br>boomerang_params<br>boomerang_params_signed_by_boomlet_0<br>boomerang_params_signed_by_all_peers<br>mystery<br>counter<br>sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0<br>boomerang_params_fingerprint_signed_by_boomlet_0<br>boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt<br>shared_state_active_wt_fingerprint_signed_by_boomlet_0<br>shared_state_active_wt_fingerprint_signed_by_all_peers<br>sar_setup_response: {<br>doxing_data_identifier,<br>fingerprint_of_static_doxing_data_encrypted_by_doxing_key,<br>iv_of_static_doxing_data_encrypted_by_doxing_key<br>}<br>shared_state_active_sar<br>shared_state_active_sar_fingerprint<br>shared_state_active_sar_fingerprint_signed_by_all_peers<br>backup_request_signed_by_normal_0<br>backup_done_signed_by_boomletwo<br>shared_state_active_backup<br>shared_state_active_backup_fingerprint<br>shared_state_active_backup_fingerprint_signed_by_boomlet_0<br>shared_state_active_backup_fingerprint_signed_by_all_peers<br><br>... Withdrawal ...<br>psbt<br>tx_id<br>niso_0_event_block_height<br>tx_id_with_nonce:{<br>content: tx_id,<br>nonce:rand() \[u8; 32]<br>}<br>tx_id_with_nonce_signed_by_st<br>peer_0_tx_approval<br>peer_0_tx_approval_signed_by_boomlet_0<br>Collection<peer_i_tx_approval_signed_by_boomlet_i><br>wt_tx_approval_signed_by_wt<br>duress_check_space<br>duress_signal_index<br>duress_placeholder_plaintext<br>duress_placeholder<br>peer_0_tx_commit<br>peer_0_tx_commit_signed_by_boomlet_0<br>peer_0_tx_commit_signed_by_boomlet_0_padded<br>peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0<br>duress_placeholder_signed_by_sar<br>Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt><br>reached_boomlets_collection<br>ping_seq_num<br>last_seen_block<br>reached_mystery_flag<br>peer_0_ping<br>peer_0_ping_signed_by_boomlet_0<br>peer_0_ping_signed_by_boomlet_0_padded<br>peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0<br>pong_i_signed_by_wt<br>reached_pings_collection<br>hydrated_psbt<br>pubnonce_boom<br>pubnonce_normal<br>partialsig_boom<br>partialsig_normal<br>psbt_signed_0<br><br>...Non-Initiator_withdrawal...<br>peer_0_tx_approval_signed_by_boomlet_0<br>wt_tx_approval_signed_by_wt<br>niso_1_event_block_height<br>psbt<br>tx_id<br>tx_id_with_nonce:{<br>content: tx_id,<br>nonce:rand() \[u8; 32]<br>}<br>tx_id_with_nonce_signed_by_st<br>duress_check_space<br>duress_signal_index<br>duress_placeholder_plaintext<br>duress_placeholder<br>approvals: \[peer_i_tx_approval_signed_by_peer_i , wt_tx_approval]<br>approvals_signed_by_boomlet_1<br>peer_0_tx_commit_signed_by_boomlet_0_padded<br>peer_1_tx_commit<br>peer_1_tx_commit_signed_by_boomlet_1<br>peer_1_tx_commit_signed_by_boomlet_1_padded<br>peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1<br>duress_placeholder_signed_by_sar |
| Niso      | network<br>rpc_client_url, rpc_client_auth<br>peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}<br>peer_0_tor_secret_key<br>peer_0_tor_address<br>peer_0_tor_address_signed_by_boomlet_0<br>peer_addresses_collection: Collection<peer_i_id, peer_i_tor_address_signed_by_boomlet_i><br>wt_ids_collection<wt_id><br>milestone_block_collection<br>boomerang_params_signed_by_boomlet_0<br>boomerang_params_signed_by_all_peers<br>sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0<br>boomerang_params_fingerprint_signed_by_boomlet_0<br>wt_service_fee_payment_info: {<br>service_fee_invoice,<br>payment_deadline, <br>wt_id<br>}<br>wt_service_fee_payment_receipt<br>boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt<br>shared_state_active_wt_fingerprint_signed_by_boomlet_0<br>shared_state_active_wt_fingerprint_signed_by_all_peers<br>shared_state_active_sar_fingerprint_signed_by_all_peers<br><br>shared_state_active_backup_fingerprint_signed_by_boomlet_0<br>shared_state_active_backup_fingerprint_signed_by_all_peers<br><br>.. Withdrawal...<br>most_work_event_block_height<br>psbt<br>tx_id<br>niso_0_event_block_height<br>Collection<peer_i_tx_approval_signed_by_boomlet_i><br>wt_tx_approval_signed_by_wt<br>Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt><br>reached_pings_collection<br>hydrated_psbt<br>psbt_signed_0<br><br>...Non-Initiator_withdrawal...<br>most_work_event_block_height<br>peer_0_tx_approval_signed_by_boomlet_0<br>wt_tx_approval_signed_by_wt<br>niso_1_event_block_height<br>psbt<br>tx_id<br>Collection<peer_i_tx_approval_signed_by_boomlet_i><br>approvals_signed_by_boomlet_1<br>peer_0_tx_commit_signed_by_boomlet_0_padded<br>Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| WT        | boomlet_0_identity_pubkey<br>sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0<br>peer_0_tor_address_signed_by_boomlet_0<br>boomerang_params_fingerprint_signed_by_boomlet_0<br>wt_service_fee_payment_info: {<br>service_fee_invoice,<br>payment_deadline, <br>wt_id<br>}<br>wt_service_fee_payment_receipt<br>boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt<br>sar_ids_collection<sar_id><br><br>... Withdrawal...<br>most_work_event_block_height<br>peer_0_tx_approval_signed_by_boomlet_0<br>tx_id<br>wt_tx_approval<br>wt_tx_approval_signed_by_wt<br>peer_0_tx_commit_signed_by_boomlet_0_padded<br>duress_placeholder<br>peer_0_tx_commit_signed_by_boomlet_0<br>peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt<br>Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt><br>peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0<br>peer_0_ping_signed_by_boomlet_0<br>Collection<peer_j_ping_signed_by_boomlet_j><br>pong_i<br>pong_i_signed_by_wt<br>reached_pings_collection<br>psbt_signed_i<br>psbt_signed<br><br>...Non-Initiator_withdrawal...<br>Collection<peer_i_tx_approval_signed_by_boomlet_i> \[1 <= i <= 4]<br>approvals_signed_by_boomlet_i  \[1 <= i <= 4]<br>peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1<br>duress_placeholder<br>peer_1_tx_commit_signed_by_boomlet_1<br>peer_1_tx_commit_signed_by_boomlet_1_signed_by_wt<br>Collection<peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Peer      | milestone_block_collection<br>wt_ids_collection<wt_id><br>network<br>peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}<br>peer_0_tor_address_signed_by_boomlet_0<br>peer_addresses_collection: Collection<peer_i_id, peer_i_tor_address_signed_by_boomlet_i><br>boomerang_params_signed_by_boomlet_0<br>shared_state_active_wt_fingerprint_signed_by_boomlet_0<br>shared_state_active_wt_fingerprint_signed_by_all_peers<br>shared_state_active_sar_fingerprint_signed_by_all_peers<br>shared_state_active_backup_fingerprint_signed_by_all_peers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ST        | st_0_identity_privkey<br>st_0_identity_pubkey<br>boomlet_0_identity_pubkey<br>duress_check_space<br>duress_signal_index<br>peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}<br>peer_0_tor_address_signed_by_boomlet_0<br>boomerang_params_seed<br>boomerang_params_seed_signed_by_st<br><br>...Withdrawal...<br>tx_id_with_nonce:{<br>content: tx_id,<br>nonce:rand() \[u8; 32]<br>}<br>tx_id<br>tx_id_with_nonce_signed_by_st<br>duress_check_space<br>duress_signal_index<br><br>...Non-init Withdrawal...<br>tx_id_with_nonce:{<br>content: tx_id,<br>nonce:rand() \[u8; 32]<br>}<br>tx_id<br>tx_id_with_nonce_signed_by_st<br>duress_check_space<br>duress_signal_index                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Boomletwo | boomletwo_Identity_privkey<br>boomletwo_Identity_pubkey<br>boomlet_0_identity_pubkey<br>boomlet_0_backup<br><br>normal_pubkey_0<br>doxing_key<br>sar_ids_collection<br>network<br>boomlet_0_boom_musig2_privkey_share<br>boomlet_0_boom_musig2_pubkey_share<br>boomlet_0_identity_privkey<br>boomlet_0_identity_pubkey<br>peer_0_tor_secret_key<br>boom_pubkey_0<br>peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}<br>st_0_identity_pubkey<br>duress_check_space<br>duress_signal_index<br>duress_consent_set<br>peer_0_tor_address_signed_by_boomlet_0<br>peer_addresses_collection: Collection<peer_i_id, peer_i_tor_address_signed_by_boomlet_i><br>wt_ids_collection<wt_id><br>milestone_block_collection<br>peer_ids_collection<peer_i_id><br>boomerang_params_seed<br>boomerang_params_seed_signed_by_st<br>boomerang_descriptor<br>boomerang_params<br>boomerang_params_signed_by_boomlet_0<br>boomerang_params_signed_by_all_peers<br>counter<br>sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0<br>boomerang_params_fingerprint_signed_by_boomlet_0<br>boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt<br>shared_state_active_wt_fingerprint_signed_by_boomlet_0<br>shared_state_active_wt_fingerprint_signed_by_all_peers<br>sar_setup_response: {<br>doxing_data_identifier,<br>fingerprint_of_static_doxing_data_encrypted_by_doxing_key,<br>iv_of_static_doxing_data_encrypted_by_doxing_key<br>}<br>shared_state_active_sar<br>shared_state_active_sar_fingerprint<br>shared_state_active_sar_fingerprint_signed_by_all_peers<br><br>mystery<br>backup_done<br>backup_done_signed_by_boomletwo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |

## Data authentication

| Data | Authority | Receiver | Authentication via |
| ---- | --------- | -------- | ------------------ |
| psbt | User      | Boomlet  | ST_check(psbt)     |
|      |           |          |                    |

