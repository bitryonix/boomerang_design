


| Channel                                  | Attacker Capabilities |
| ---------------------------------------- | --------------------- |
| User ←→ Phone                            | E_p                   |
| User ←→ Iso                              |                       |
| User ←→ Niso                             | E_p                   |
| User ←→ SecureTerminal                   |                       |
| Iso ←→ Boomlet                           |                       |
| Iso ←→ Boomletwo                         |                       |
| Niso ←→ Boomlet                          | E                     |
| Niso ←(TOR)→ Watchtower                  |                       |
| Niso ←(TOR)→ Peers' Niso                 |                       |
| Watchtower ←(TOR)→ SAR                   |                       |
| Phone ←→ SAR                             | E*,                   |
| User ←→ Peers (out-of-band)              |                       |
| User ←→ Phone(Compromised)               |                       |
| User(Compromised) ←→ Iso                 | E                     |
| User ←→ Niso(Compromised)                | E                     |
| User(Compromised) ←→ SecureTerminal      | E                     |
| Niso(Compromised) ←→ Boomlet             | E                     |
| Niso ←(TOR)→ Watchtower(Compromised)     | E                     |
| Niso ←(TOR)→ Peers' Niso(Compromised)    | E                     |
| Watchtower(Compromised) ←(TOR)→ SAR      | E                     |
| Phone(Compromised) ←→ SAR                | E                     |
| User ←→ Peers (out-of-band)(Compromised) | E                     |
- per Iso requirements, No communication with Iso can be intercepted or eavesdropped unless the other party is compromised.
- per ST requirements, User ←→ SecureTerminal can not be intercepted or eavesdropped unless User is compromised..
- Compromised User is User under duress, only can lie about consent_set.
- out-of-band channel is assumed to be secure.
- Direct Inputs can not be manipulated unless one of the parties is compromised. Direct Inputs for non-compromised parties can't be eavesdropped unless via physical presence.
- 
 
## Impact

| Stolen Data                                                                                                                                                     | Impact                                                                                                                                                                                                                                                                                | Where data is kept/Messages data appeared in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| milestone_block_collection                                                                                                                                      | Privacy - reveals duration of physical protection                                                                                                                                                                                                                                     | Peers(Users)<br>SetupNisoInput2<br>Niso<br>SetupNisoBoomletMessage2<br>Boomlet<br>IsoInput3<br>Iso<br>...<br>→boomerang_param_candidates<br>→boomerang_descriptor → boomerang_params<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                              |
| wt_ids_collection<wt_id>                                                                                                                                        | Privacy - makes the WT associated with the setup reachable - facilitates DoS                                                                                                                                                                                                          | Peers(Users)<br>SetupNisoInput2<br>Niso<br>SetupNisoBoomletMessage2<br>Boomlet<br>IsoInput3<br>Iso<br>...<br>→boomerang_param_candidates<br>→boomerang_params                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| sar_ids_collection<sar_id>                                                                                                                                      | Privacy - makes the SAR associated with the setup reachable - facilitates DoS and disabling physical protection                                                                                                                                                                       | User <br>SetupPhoneInput1<br>Phone<br>SetupIsoInput1<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>SetupBoomletNisoMessage8\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoWtMessage3\[Encrypted]<br>Wt<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                     |
| network                                                                                                                                                         | Public Global - No Impact                                                                                                                                                                                                                                                             | Peers(Users)<br>SetupIsoInput1<br>Iso<br>SetupNisoInput1<br>Niso<br>IsoInput3<br>Iso<br><br>...Withdrawal...<br>WithdrawalIsoInput1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| entropy_bytes                                                                                                                                                   | Loss of Fund - Reducing bitcoin storage security to passphrase & boomlet_0_boom_musig2_privkey_share.<br>                                                                                                                                                                             | User<br>SetupIsoInput1<br>Iso<br>...<br>→mnemonic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| passphrase                                                                                                                                                      | Loss of Fund - Reducing bitcoin storage security to mnemonic/entropy_bytes & boomlet_0_boom_musig2_privkey_share.                                                                                                                                                                     | User<br>SetupIsoInput1<br>Iso<br>IsoInput3<br>Iso<br><br>...Withdrawal...<br>WithdrawalIsoInput1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| static_doxing_data                                                                                                                                              | Privacy -<br>Loss of Physical Protection-facilitates disabling physical protection                                                                                                                                                                                                    | User<br>SetupPhoneInput1<br>Phone<br>SetupPhoneSarMessage2\[Encrypted]<br>SAR\[Encrypted]<br>IsoInput3<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| doxing_password                                                                                                                                                 | Loss of Physical Protection-facilitates disabling physical protection<br>->doxing_key                                                                                                                                                                                                 | User<br>SetupPhoneInput1<br>Phone<br>SetupIsoInput1<br>Iso<br>IsoInput3<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| rpc_client_url, rpc_client_auth                                                                                                                                 | Privacy - Facilitates DoS                                                                                                                                                                                                                                                             | User<br>SetupNisoInput1<br>Niso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| wt_privkey                                                                                                                                                      | Impersonation:<br>-Facilitates DoS<br>-Facilitates FastCount Attack<br>Privacy:<br>...<br>->wt_id                                                                                                                                                                                     | Watchtower                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| wt_id: {<br>wt_tor_address<br>wt_pubkey<br>}                                                                                                                    | Privacy - Facilitates DoS                                                                                                                                                                                                                                                             | ->wt_privkey<br>...<br>Watchtower<br>...<br>→ wt_ids_collection → boomerang_param_candidates/boomerang_params<br>→ wt_service_fee_payment_info                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| most_work_bitcoin_block_height                                                                                                                                  | Public Global - No Impact                                                                                                                                                                                                                                                             | Watchtower<br>Peers(Nisos)<br>...<br>→ niso_0_event_block_height                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| sar_privkey                                                                                                                                                     | Impersonation - Disabling Physical Protection<br>→sar_id                                                                                                                                                                                                                              | SAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| sar_id: { <br>sar_tor_address,<br>sar_pubkey<br>}                                                                                                               | Privacy - Facilitates DoS <br>facilitates disabling physical protection                                                                                                                                                                                                               | →sar_privkey<br>SAR<br>...<br>→ sar_ids_collection<br>→ sar_service_fee_payment_info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| dynamic_doxing_data                                                                                                                                             | Privacy -<br>Loss of Physical Protection-facilitates disabling physical protection                                                                                                                                                                                                    | Phone<br>SetupPhoneSarMessage2\[Encrypted]<br>SAR\[Encrypted]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| doxing_key                                                                                                                                                      | Loss of Physical Protection-facilitates disabling physical protection<br>...<br>→doxing_data_identifier                                                                                                                                                                               | →doxing_password<br>...<br>Phone<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>Iso\[After 78]<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| doxing_data_identifier                                                                                                                                          | Privacy                                                                                                                                                                                                                                                                               | →doxing_password<br>→doxing_key<br>...<br>Phone<br>SetupPhoneSarMessage2<br>SAR<br>Boomlet\[regenerated]<br>SetupBoomletNisoMessage8\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoWtMessage3\[Encrypted]<br>Wt\[Encrypted]<br>SetupWtSarMessage1\[Encrypted]<br>SAR<br>Iso\[regenerated]<br>...<br>→sar_setup_response<br>                                                                                                                                                                                                                                                                                              |
| sar_service_fee_payment_info: { <br>service_fee_invoice,<br>payment_deadline,<br>sar_id<br>}                                                                    | Privacy<br>->sar_id                                                                                                                                                                                                                                                                   | SAR<br>SetupSarPhoneMessage1<br>Phone<br>SetupPhoneOutput1<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| sar_service_fee_payment_receipts                                                                                                                                | Privacy                                                                                                                                                                                                                                                                               | User<br>SetupPhoneInput2<br>Phone<br>SetupPhoneSarMessage2<br>SAR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| mnemonic                                                                                                                                                        | →entropy_bytes                                                                                                                                                                                                                                                                        | →entropy_bytes<br>...<br>Iso<br>SetupIsoOutput1<br>User<br>IsoInput3<br>Iso<br>...Withdrawal...<br>WithdrawalIsoInput1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| normal_privkey_0                                                                                                                                                | Loss of Fund - Reducing bitcoin storage security to boomlet_0_boom_musig2_privkey_share.                                                                                                                                                                                              | →(mnemonic+passphrase)<br>...<br>Iso<br>Iso\[regenerated]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| normal_pubkey_0                                                                                                                                                 | Privacy - ?                                                                                                                                                                                                                                                                           | →normal_privkey_0<br>...<br>Iso<br>SetupIsoBoomletMessage1<br>Boomlet<br>...<br>→peer_0_id<br>→backup_request                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| boomlet_0_identity_privkey                                                                                                                                      | impersonation                                                                                                                                                                                                                                                                         | Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| boomlet_0_identity_pubkey                                                                                                                                       | Privacy - ?                                                                                                                                                                                                                                                                           | →boomlet_0_identity_privkey<br>...<br>Boomlet<br>MotifMessage1<br>Iso<br>MotifMessage2<br>ST<br>SetupNisoWtMessage1<br>WT<br>SetupWtSarMessage1<br>SAR<br>SetupBoomletIsoMessage5<br>Iso<br>SetupIsoBoomletwo2<br>Boomletwo<br>...<br>Withdrawal:<br>WithdrawalWtSarsMessage1<br>WithdrawalWtSarsMessage2<br>...<br>→peer_0_id<br>→backup_done<br>                                                                                                                                                                                                                                                                     |
| boomlet_0_boom_musig2_privkey_share                                                                                                                             | Loss of Fund - Reducing bitcoin storage security to normal_privkey_0.                                                                                                                                                                                                                 | Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| boomlet_0_boom_musig2_pubkey_share                                                                                                                              | Privacy - ?                                                                                                                                                                                                                                                                           | →boomlet_0_boom_musig2_privkey_share<br>...<br>Boomlet<br><br>...Withdrawal...<br>WithdrawalBoomletIsoMessage1<br>Iso<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| boom_pubkey_0                                                                                                                                                   | Privacy - Loss of on-chain privacy, post-spend.                                                                                                                                                                                                                                       | Boomlet<br>...<br>→peer_0_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| peer_0_tor_secret_key                                                                                                                                           | Impersonation - Denial of Service(?)                                                                                                                                                                                                                                                  | Boomlet<br>SetupBoomletNisoMessage1<br>Niso<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| peer_0_id: {<br>boom_pubkey_0,<br>normal_pubkey_0,<br>boomlet_0_identity_pubkey<br>}                                                                            | → boom_pubkey_0,<br>→ normal_pubkey_0,<br>→ boomlet_0_identity_pubkey                                                                                                                                                                                                                 | Boomlet<br>SetupBoomletNisoMessage1<br>Niso<br>SetupNisoStMessage1<br>St<br>SetupStOutput3<br>User<br>SetupUserPeersOutOfBandMessage1<br>Peers(Users)<br>...<br>→boomlet_0_backup<br>→peer_addresses_collection                                                                                                                                                                                                                                                                                                                                                                                                        |
| secureterminal_0_identity_privkey                                                                                                                               | Impersonation - tx_approval<br>→consent_set<br>→secureterminal_0_identity_pubkey                                                                                                                                                                                                      | ST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| secureterminal_0_identity_pubkey                                                                                                                                | No impact(?)                                                                                                                                                                                                                                                                          | →secureterminal_0_identity_privkey<br>...<br>ST<br>SetupStIsoMessage1<br>Iso<br>SetupIsoBoomletMessage2<br>Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| randomly_sorted_duress_array                                                                                                                                    | {+randomly_sorted_duress_array_index_collection}→duress_consent_set                                                                                                                                                                                                                   | Boomlet<br>SetupBoomletIsoMessage2\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoStMessage2\[Encrypted]<br>ST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| randomly_sorted_duress_array_index_collection                                                                                                                   | {+randomly_sorted_duress_array}→duress_consent_set                                                                                                                                                                                                                                    | User<br>SetupStInput1<br>ST<br>SetupStIsoMessage2\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoBoomletMessage3\[Encrypted]<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| duress_consent_set                                                                                                                                              | Loss of Physical Protection                                                                                                                                                                                                                                                           | User<br>ST\[inferred]<br>Boomlet\[inferred]<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| test_duress_message_collection                                                                                                                                  | {+test_duress_message_collection_index_collection}→duress_consent_set                                                                                                                                                                                                                 | Boomlet<br>SetupBoomletIsoMessage3\[Encrypted]<br>Iso\[Encrypted]<br>\[SetupIsoStMessage3]<br>ST<br>SetupStOutput2<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| test_duress_message_collection_index_collection                                                                                                                 | {+test_duress_message_collection}→duress_consent_set                                                                                                                                                                                                                                  | User<br>SetupStInput2<br>ST<br>SetupStIsoMessage3\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoBoomletMessage4\[Encrypted]<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| peer_0_tor_address_signed_by_boomlet_0                                                                                                                          | →peer_0_tor_address                                                                                                                                                                                                                                                                   | Boomlet<br>SetupBoomletNisoMessage1<br>Niso<br>SetupNisoStMessage1<br>ST<br>SetupStOutput3<br>User<br>SetupUserPeersOutOfBandMessage1<br>Peers(Users)<br>SetupNisoWtMessage1<br>Wt<br>...<br>→peer_addresses_collection                                                                                                                                                                                                                                                                                                                                                                                                |
| peer_0_tor_address                                                                                                                                              | Privacy - Facilitates DoS?                                                                                                                                                                                                                                                            | Boomlet<br>Niso\[regenerated]<br>...<br>→peer_0_tor_address_signed_by_boomlet_0<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| peer_addresses_collection: Collection<(peer_i_id, peer_i_tor_address_signed_by_boomlet_i)>                                                                      | →peer_ids_collection<br>→peer_0_tor_address<br>                                                                                                                                                                                                                                       | User<br>SetupNisoInput2<br>Niso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| boomerang_param_candidates:{<br>peer_ids: peer_ids_collection<br>wt_ids: wt_ids_collection<br>milestone_block_collection:milestone_block_collection<br>}        | →peer_ids_collection<br>→wt_ids_collection<br>→milestone_block_collection                                                                                                                                                                                                             | Boomlet<br>SetupBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoStMessage2\[Encrypted]<br>ST<br>SetupStOutput4<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| boomerang_descriptor                                                                                                                                            | →milestone_block_collection<br>→boom_pubkey_0                                                                                                                                                                                                                                         | Boomlet<br>Iso<br>...Withdrawal...<br>WithdrawalBoomletIsoMessage1<br>Iso<br>...<br>→boomerang_params<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| boomerang_params: {<br>peer_ids_collection,<br>wt_ids_collection,<br>boomerang_descriptor<br>}                                                                  | →peer_ids_collection<br>→wt_ids_collection<br>→boomerang_descriptor                                                                                                                                                                                                                   | Boomlet<br>SetupBoomletNisoMessage3<br>Niso<br>SetupNisoPeerNisoMessage1<br>Peers(Nisos)<br>SetupNisoBoomletMessage4<br>Peers(Boomlets)<br>SetupBoomletIsoMessage5<br>Iso<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                  |
| peer_and_wt_ids                                                                                                                                                 | → wt_ids_collection<br>→ peer_ids_collection                                                                                                                                                                                                                                          | Boomlet<br>SetupBoomletNisoMessage2<br>Niso\[Encrypted]<br>SetupNisoStMessage2<br>ST<br>SetupStOutput4<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| boomerang_params_signed_by_boomlet_0                                                                                                                            | → boomerang_params                                                                                                                                                                                                                                                                    | Boomlet<br>SetupBoomletNisoMessage3<br>Niso<br>SetupNisoPeerNisoMessage1<br>Peers(Nisos)<br>\[SetupNisoBoomletMessage4]<br>Peers(Boomlet)                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| boomerang_params_signed_by_all_peers                                                                                                                            | → boomerang_params                                                                                                                                                                                                                                                                    | Peers(Nisos)<br>\[SetupNisoBoomletMessage4]<br>Peers(Boomlet)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| mystery                                                                                                                                                         | Loss of non-determinism                                                                                                                                                                                                                                                               | Boomlet<br>Boomletwo\[regenerated]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| counter                                                                                                                                                         | {+milestone_blocks}: Loss of non-determinism                                                                                                                                                                                                                                          | Boomlet<br>...<br>→boomlet_0_backup                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0                                                                                                   | →peer_ids_collection                                                                                                                                                                                                                                                                  | Boomlet<br>SetupBoomletNisoMessage5<br>Niso<br>SetupNisoWtMessage1<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| boomerang_params_fingerprint_signed_by_boomlet_0                                                                                                                |                                                                                                                                                                                                                                                                                       | Boomlet<br>SetupBoomletNisoMessage5<br>Niso<br>SetupNisoWtMessage1<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| wt_service_fee_payment_info: {<br>service_fee_invoice,<br>payment_deadline, <br>wt_id<br>}                                                                      | → wt_id                                                                                                                                                                                                                                                                               | Wt<br>SetupWtNisoMessage1<br>Niso<br>SetupNisoOutput1<br>User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| wt_service_fee_payment_receipts                                                                                                                                 |                                                                                                                                                                                                                                                                                       | User<br>SetupNisoInput3<br>Niso<br>SetupNisoWtMessage2<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| boomerang_params_fingerprint_signed_by_wt                                                                                                                       |                                                                                                                                                                                                                                                                                       | Wt<br>SetupWtNisoMessage2<br>Niso<br>SetupNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| shared_state:{<br>internal_state,<br>boomerang_params<br>}                                                                                                      | → boomerang_params                                                                                                                                                                                                                                                                    | Peers(Boomlets)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| shared_state_fingerprint                                                                                                                                        |                                                                                                                                                                                                                                                                                       | Peers(Boomlets)<br>SetupBoomletNisoMessage9<br>Peers(Nisos)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| shared_state_fingerprint_signed_by_boomlet_0                                                                                                                    |                                                                                                                                                                                                                                                                                       | Boomlet<br>SetupBoomletNisoMessage9<br>Niso<br>SetupNisoPeerNisoMessage3<br>Peers(Nisos)<br>\[SetupNisoBoomletMessage7]<br>Peers(Boomlets)<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| shared_state_fingerprint_signed_by_boomlet_i                                                                                                                    |                                                                                                                                                                                                                                                                                       | Peers(Nisos)<br>\[SetupNisoBoomletMessage7]<br>Peers(Boomlets)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| sar_setup_response:{<br>doxing_data_identifier,<br>SHA256(static_doxing_data_encrypted_by_doxing_key)<br>}                                                      | →doxing_data_identifier                                                                                                                                                                                                                                                               | SAR<br>SetupSarWtMessage1\[Encrypted]<br>WT\[Encrypted]<br>SetupWtNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>SetupNisoBoomletMessage9\[Encrypted]<br>Boomlet<br>SetupBoomletIsoMessage5<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                    |
| boomletwo_Identity_privkey                                                                                                                                      | →boomletwo_Identity_pubkey                                                                                                                                                                                                                                                            | Boomletwo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| boomletwo_Identity_pubkey                                                                                                                                       | <br>                                                                                                                                                                                                                                                                                  | →boomletwo_Identity_privkey<br>...<br>Boomletwo<br>SetupBoomletwoIso1<br>Iso<br>..<br>→ backup_request<br>→boomlet_backup_done                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| backup_request:{<br>"Backup_Req",<br>boomletwo_Identity_pubkey,<br>normal_pubkey_0<br>}                                                                         | →boomletwo_Identity_pubkey<br>→normal_pubkey_0                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| boomlet_0_backup                                                                                                                                                | →doxing_key<br>→boomlet_0_identity_privkey<br>→boomlet_0_boom_musig2_privkey_share<br>→boomlet_0_boom_musig2_pubkey_share<br>→peer_0_id<br>→sar_ids_collection<br>→peer_0_tor_secret_key<br>→secureterminal_0_identity_pubkey<br>→duress_consent_set<br>→boomerang_params<br>→counter | Boomlet<br>SetupBoomletIsoMessage5\[Encrypted]<br>Iso\[Encrypted]<br>SetupIsoBoomletwo2\[Encrypted]<br>Boomletwo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| backup_done:{<br>string: "Backup_Done",<br>backup_boomlet_pubkey: boomletwo_Identity_pubkey,<br>boomlet_pubkey: boomlet_0_identity_pubkey<br>}                  | →boomletwo_Identity_pubkey<br>→boomlet_0_identity_pubkey                                                                                                                                                                                                                              | Boomletwo<br>SetupBoomletwoIso2<br>Iso<br>SetupIsoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Withdrawal:                                                                                                                                                     |                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| psbt                                                                                                                                                            | Privacy - Loss of on-chain privacy<br>→tx_id                                                                                                                                                                                                                                          | User<br>WithdrawalNisoInput1<br>Niso<br>WithdrawalNisoBoomletMessage1<br>Boomlet<br>WithdrawalBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage1\[Encrypted]<br>WT\[Encrypted]<br>Niso\[hydrated]<br>WithdrawalNisoBoomletMessage8<br>Boomlet<br>...<br>\[Non_init Diagram]:<br><br>WithdrawalWtNonInitiatorNisoMessage1\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoBoomletMessage1\[Encrypted]<br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage1<br>Niso<br>WithdrawalNonInitiatorNisoOutput1<br>User<br>...<br>→psbt_signed_0<br>→psbt_signed_i<br>→psbt_signed |
| tx_id                                                                                                                                                           | Privacy - Loss of on-chain privacy post-spend                                                                                                                                                                                                                                         | →psbt<br>...<br>Niso<br>Boomlet\[derived]<br>ST\[derived]<br>WithdrawalStOutput1<br>User<br><br>WT\[derived]<br><br>...<br>\[Non_init Diagram]:<br><br>Nisos\[derived]<br>Boomlets\[derived]<br>ST\[derived]<br>WithdrawalStOutput1<br>User<br>...<br>→tx_id_message<br>→peer_0_tx_approval<br>→wt_tx_approval<br>→peer_1_tx_approval<br>→peer_i_tx_approval<br>→peer_0_tx_commit<br>→peer_1_tx_commit<br>→peer_i_tx_commit<br>→peer_0_ping<br>→peer_i_ping                                                                                                                                                            |
| niso_0_event_block_height                                                                                                                                       | Privacy - Revealing protcol execution?                                                                                                                                                                                                                                                | Niso<br>WithdrawalNisoBoomletMessage1<br>Boomlet<br><br>Niso\[regenerated]<br>WithdrawalNisoBoomletMessage3<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNisoBoomletMessage5<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                             |
| tx_id_message:{<br>content: tx_id,<br>nonce:rand() \[u8; 32]<br>}                                                                                               | →tx_id<br>?                                                                                                                                                                                                                                                                           | Boomlet<br>WithdrawalBoomletNisoMessage1\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoStMessage1\[Encrypted]<br>ST<br>...<br>\[Non_init Diagram]:<br><br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoStMessage1\[Encrypted]<br>ST<br>...<br>→tx_id_signed_by_st                                                                                                                                                                                                                                                                              |
| tx_id_signed_by_st                                                                                                                                              | Privacy - Revealing User's agreement on tx_id<br>→tx_id_message                                                                                                                                                                                                                       | ST<br>WithdrawalStNisoMessage1\[Encrypted]<br>WithdrawalNisoBoomletMessage2\[Encrypted]<br>Boomlet<br>...<br>\[Non_init Diagram]:<br><br>ST<br>WithdrawalNonInitiatorStNisoMessage1\[Encrypted]<br>WithdrawalNonInitiatorNisoBoomletMessage3\[Encrypted]<br>Boomlet                                                                                                                                                                                                                                                                                                                                                    |
| peer_0_tx_approval:{<br>"approved",<br>tx_id,<br>niso_0_event_block_height<br>}                                                                                 | →tx_id<br>→niso_0_event_block_height                                                                                                                                                                                                                                                  | Boomlet<br><br><br>→peer_0_tx_approval_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| peer_0_tx_approval_signed_by_boomlet_0                                                                                                                          | →peer_0_tx_approval                                                                                                                                                                                                                                                                   | Boomlet<br>WithdrawalBoomletNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage1\[Encrypted]<br>WT<br>WithdrawalWtNonInitiatorNisoMessage1<br>...<br>\[Non_init Diagram]:<br>WithdrawalWtNonInitiatorNisoMessage1<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage1<br>Boomlet<br>....<br>→approvals<br>                                                                                                                                                                                                                                                                                        |
| status                                                                                                                                                          |                                                                                                                                                                                                                                                                                       | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| wt_tx_approval:{<br>"approved",<br> tx_id,<br> wt_event_block_height,<br>boomlet_0_identity_pubkey<br>}                                                         | →tx_id<br>→wt_event_block_height<br>→boomlet_0_identity_pubkey                                                                                                                                                                                                                        | WT<br>...<br>→wt_tx_approval_signed_by_wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| wt_tx_approval_signed_by_wt                                                                                                                                     | →wt_tx_approval                                                                                                                                                                                                                                                                       | WT<br>WithdrawalWtNonInitiatorNisoMessage1<br>Peers(Nisos)<br>WithdrawalNonInitiatorNisoBoomletMessage1<br>Peers(Boomlets)<br>...<br>WithdrawalWtNisoMessage1<br>Niso<br>WithdrawalNisoBoomletMessage3<br>Boomlet<br>...<br>→approvals                                                                                                                                                                                                                                                                                                                                                                                 |
| niso_1_event_block_height                                                                                                                                       |                                                                                                                                                                                                                                                                                       | \[Non_init Diagram]:<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage2<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNonInitiatorNisoBoomletMessage4<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNonInitiatorNisoBoomletMessage6<br>Boomlet<br>Niso\[regenerated]<br>WithdrawalNonInitiatorNisoBoomletMessage7<br>Boomlet<br>...<br>→peer_1_tx_approval                                                                                                                                                                                                                                                           |
| niso_i_event_block_height                                                                                                                                       |                                                                                                                                                                                                                                                                                       | \...<br>→peer_i_tx_approval                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| peer_1_tx_approval{<br>"approval",<br>tx_id,<br>niso_1_event_block_height<br>}                                                                                  | →tx_id<br>→niso_1_event_block_height                                                                                                                                                                                                                                                  | Boomlet<br>...<br>→peer_1_tx_approval_signed_by_boomlet_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| peer_1_tx_approval_signed_by_boomlet_1                                                                                                                          |                                                                                                                                                                                                                                                                                       | \[Non_init Diagram]:<br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoWtMessage1\[Encrypted]<br>WT<br>...<br>→Collection<peer_i_tx_approval_signed_by_boomlet_i>                                                                                                                                                                                                                                                                                                                                                                                   |
| peer_i_tx_approval:{<br>"approval",<br>tx_id,<br>niso_i_event_block_height<br>}                                                                                 | →tx_id<br>→niso_i_event_block_height                                                                                                                                                                                                                                                  | ...<br>→peer_i_tx_approval_signed_by_boomlet_i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Collection<peer_i_tx_approval_signed_by_boomlet_i>                                                                                                              | →peer_i_tx_approval                                                                                                                                                                                                                                                                   | WithdrawalNonInitiatorNisoWtMessage1\[Encrypted]<br>WT<br>WithdrawalWtNisoMessage1<br>Niso<br>WithdrawalNisoBoomletMessage3<br>Boomlet<br>\[Non_init Diagram]:<br>WithdrawalNonInitiatorNisoWtMessage1\[Encrypted]<br>WT<br>WithdrawalWtNonInitiatorNisoMessage2<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage4<br>Boomlet<br>...<br>→approvals                                                                                                                                                                                                                                                                  |
| duress_message_collection:{<br>content: \[rand_order\[1..198]; 5],<br>nonce: rand() \[u8; 32]<br>}                                                              | +{duress_message_collection_index_collection} → duress_consent_set                                                                                                                                                                                                                    | Boomlet<br>WithdrawalBoomletNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoStMessage2\[Encrypted]<br>ST<br>WithdrawalStOutput2<br>User<br>Boomlet\[Regenerated]<br>WithdrawalBoomletNisoMessage6\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoStMessage3\[Encrypted]<br>ST<br>WithdrawalStOutput3<br>User<br>\[Non_init Diagram]:<br>Boomlet<br>WithdrawalNonInitiatorBoomletNisoMessage4\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNonInitiatorNisoStMessage2\[Encrypted]<br>ST<br>WithdrawalNonInitiatorStOutput2<br>User                                                                      |
| duress_message_collection_index_collection                                                                                                                      | +{duress_message_collection} → duress_consent_set                                                                                                                                                                                                                                     | User<br>WithdrawalStInput2<br>ST<br>User\[Regenerated]<br>WithdrawalStInput3<br>ST<br>\[Non_init Diagram]:<br>User\[Regenerated]<br>WithdrawalNonInitiatorStInput2<br>ST<br>...<br>→duress_answer_collection                                                                                                                                                                                                                                                                                                                                                                                                           |
| duress_answer_collection{<br>content: duress_message_collection_index_collection<br>nonce: duress_message_collection.nonce<br>}                                 | →duress_message_collection_index_collection                                                                                                                                                                                                                                           | ST<br>WithdrawalStNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoBoomletMessage4\[Encrypted]<br>Boomlet<br><br>ST\[Regenerated]<br>WithdrawalStNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoBoomletMessage7\[Encrypted]<br>Boomlet<br>\[Non_init Diagram]:<br>ST<br>WithdrawalNonInitiatorStNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>                                                                                                                                                                                                                                           |
| duress_placeholder_plaintext                                                                                                                                    | →duress_consent_set                                                                                                                                                                                                                                                                   | Boomlet<br>SAR\[derived]<br>SAR\[derived]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| duress_placeholder                                                                                                                                              | No impact (ciphertext encrypted with sar_privkey)                                                                                                                                                                                                                                     | Boomlet<br>WT\[derived]<br>WithdrawalWtSarsMessage1<br>SAR<br><br>WithdrawalWtSarsMessage2<br>SAR<br>...<br>→peer_0_tx_commit<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| peer_0_tx_commit:{<br>"commit",<br>tx_id,<br>niso_0_event_block_height<br>}                                                                                     | →tx_id<br>→niso_0_event_block_height                                                                                                                                                                                                                                                  | Boomlet<br>WT\[derived]<br>...<br>→peer_0_tx_commit_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| peer_0_tx_commit_signed_by_boomlet_0                                                                                                                            | →peer_0_tx_commit                                                                                                                                                                                                                                                                     | Boomlet<br>WT\[derived]<br>WithdrawalWtNonInitiatorNisoMessage3<br>Peers(Nisos)<br><br>...<br>→peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| peer_0_tx_commit_signed_by_boomlet_0_padded                                                                                                                     | →peer_0_tx_commit_signed_by_boomlet_0<br>→duress_placeholder                                                                                                                                                                                                                          | Boomlet<br>WT\[derived]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0                                                                                                 | →peer_0_tx_commit_signed_by_boomlet_0_padded                                                                                                                                                                                                                                          | Boomlet<br>WithdrawalBoomletNisoMessage4\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage2\[Encrypted]<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| approvals:\[peer_i_tx_approval_signed_by_peer_i\[j!=i], wt_tx_approval]                                                                                         | →peer_0_tx_approval<br>→peer_i_tx_approval<br>→wt_tx_approval                                                                                                                                                                                                                         | Peers(Boomlets)<br>...<br>→approvals_signed_by_boomlet_i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| approvals_signed_by_boomlet_1                                                                                                                                   | →approvals                                                                                                                                                                                                                                                                            | Peers(Boomlets)<br>WithdrawalNonInitiatorBoomletNisoMessage5<br>Peers(Nisos)<br>WithdrawalNonInitiatorNisoWtMessage2<br>WT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| duress_placeholder_signed_by_sar                                                                                                                                | →duress_placeholder                                                                                                                                                                                                                                                                   | SAR<br>WithdrawalSarsWtMessage1\[Encrypted]<br>WT\[Encrypted]<br>WithdrawalWtNisoMessage2\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoBoomletMessage5\[Encrypted]<br>Boomlet<br><br><br><br>SAR\[regenerated]<br>WithdrawalSarsWtMessage2\[Encrypted]<br>WT\[Encrypted]<br>WithdrawalWtNisoMessage3\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoBoomletMessage6\[Encrypted]<br>Boomlet                                                                                                                                                                                                                       |
| peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt                                                                                                               | →peer_0_tx_commit_signed_by_boomlet_0                                                                                                                                                                                                                                                 | \[Non_init Diagram]:<br>WT<br>WithdrawalWtNonInitiatorNisoMessage3<br>Niso<br>WithdrawalNonInitiatorNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| peer_i_tx_commit                                                                                                                                                |                                                                                                                                                                                                                                                                                       | →peer_i_tx_commit_signed_by_boomlet_i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| peer_i_tx_commit_signed_by_boomlet_i                                                                                                                            | →peer_i_tx_commit                                                                                                                                                                                                                                                                     | WithdrawalNonInitiatorNisoWtMessage3<br>WT<br>...<br>→peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt                                                                                                               | →peer_i_tx_commit_signed_by_boomlet_i                                                                                                                                                                                                                                                 | WT<br>WithdrawalWtNisoMessage2<br>Niso<br>WithdrawalNisoBoomletMessage5<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| reached_boomlets_collection                                                                                                                                     | →                                                                                                                                                                                                                                                                                     | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ping_seq_num                                                                                                                                                    | →                                                                                                                                                                                                                                                                                     | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| reached_mystery_flag                                                                                                                                            | →                                                                                                                                                                                                                                                                                     | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| last_seen_block                                                                                                                                                 | →niso_event_block_height                                                                                                                                                                                                                                                              | Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| peer_0_ping:{<br>"ping",<br>tx_id,<br>last_seen_block,<br>ping_seq_num,<br>reached_mystery_flag<br>}                                                            | →tx_id<br>→last_seen_block<br>→ping_seq_num<br>→reached_mystery_flag                                                                                                                                                                                                                  | Boomlet<br>...<br>→peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| peer_0_ping_signed_by_boomlet_0                                                                                                                                 | →peer_0_ping                                                                                                                                                                                                                                                                          | Boomlet<br>WT\[derived]<br>...<br>→peer_0_ping_signed_by_boomlet_0_padded<br>→pong_i<br>→reached_pings_collection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| peer_0_ping_signed_by_boomlet_0_padded: {<br>content: peer_0_ping_signed_by_boomlet_0,<br>padding: duress_placeholder<br>}                                      | →peer_0_ping_signed_by_boomlet_0<br>→duress_placeholder                                                                                                                                                                                                                               | Boomlet<br>WT\[derived]<br>...<br>→peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0                                                                                                      | →peer_0_ping_signed_by_boomlet_0_padded                                                                                                                                                                                                                                               | Boomlet<br>WithdrawalBoomletNisoMessage5\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage3\[Encrypted]<br>WT<br><br>Boomlet<br>WithdrawalBoomletNisoMessage7\[Encrypted]<br>Niso\[Encrypted]<br>WithdrawalNisoWtMessage4\[Encrypted]<br>WT                                                                                                                                                                                                                                                                                                                                                                   |
|                                                                                                                                                                 |                                                                                                                                                                                                                                                                                       | <br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| reached_pings_collection                                                                                                                                        | →peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                                                                      | WT<br>WithdrawalWtNisoMessage4<br>Niso<br>WithdrawalNisoBoomletMessage8<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| pong_i:{<br>string:"pong"<br>tx_id: tx_id<br>event_block_height:=most_work_bitcoin_block_height<br>prev_pings: Collection<peer_j_ping_signed_by_boomlet_j><br>} | tx_id: tx_id<br>→most_work_bitcoin_block_height<br>→peer_0_ping_signed_by_boomlet_0                                                                                                                                                                                                   | WT<br>...<br>→pong_i_signed_by_wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| pong_i_signed_by_wt                                                                                                                                             | →pong_i                                                                                                                                                                                                                                                                               | WT<br>WithdrawalWtNisoMessage3<br>Niso<br>WithdrawalNisoBoomletMessage6<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                 |                                                                                                                                                                                                                                                                                       | <br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| pubnonce_boom                                                                                                                                                   |                                                                                                                                                                                                                                                                                       | Boomlet<br>WithdrawalBoomletIsoMessage1<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| pubnonce_normal                                                                                                                                                 |                                                                                                                                                                                                                                                                                       | Iso<br>WithdrawalIsoBoomletMessage2<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| partialsig_normal                                                                                                                                               |                                                                                                                                                                                                                                                                                       | Iso<br>WithdrawalIsoBoomletMessage2<br>Boomlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| partialsig_boom                                                                                                                                                 |                                                                                                                                                                                                                                                                                       | Boomlet<br>WithdrawalBoomletIsoMessage2<br>Iso                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| psbt_signed_0                                                                                                                                                   | →psbt                                                                                                                                                                                                                                                                                 | Boomlet<br>Iso<br>WithdrawalBoomletNisoMessage9<br>Niso<br>WithdrawalNisoWtMessage5<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| psbt_signed_i                                                                                                                                                   | →psbt<br>                                                                                                                                                                                                                                                                             | WithdrawalNisoWtMessage5<br>Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| psbt_signed                                                                                                                                                     | →psbt<br>                                                                                                                                                                                                                                                                             | Wt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                 |                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |


- what happens if Niso reports another peer_0_tor_address to User? Peers connect but can't get boomlet's signature on it.
- what are the risks associated with a lying bitcoin node inside Niso and/or leak of rpc_client/auth
- remove master_privkey and master pubkey from states and analysis. 
- At the moment boom_pubkeys are not checked anywhere to see if they're valid. For this check having musig_pub_share is necessary. it could accompany messages to niso and other peers but can be lied about when talking to iso. but is having valid keys enough? how about lying about normal_pubkey_0?  only user and iso can verify that. so no possible solution can avoid including user in this non-trivial overhead. We just keep assuming boomlet is honest and working as expected during setup.

## Data authentication

| Data | Authority | Receiver | Authentication via |
| ---- | --------- | -------- | ------------------ |
| psbt | User      | Boomlet  | ST_check(psbt)     |
|      |           |          |                    |

