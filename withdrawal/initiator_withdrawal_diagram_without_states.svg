<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="15123px" preserveAspectRatio="none" style="width:4281px;height:15123px;background:#FFFFFF;" version="1.1" viewBox="0 0 4281 15123" width="4281px" zoomAndPan="magnify"><title>Initiator Withdrawal Sequence Diagram (Without Stated)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="402.0352" x="1941.0864" y="28.5352">Initiator Withdrawal Sequence Diagram (Without Stated)</text><rect fill="#F0F8FF" height="15073.5957" style="stroke:#181818;stroke-width:0.5;" width="1616.2959" x="488" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.6196" x="1264.8381" y="56.0566">User Side</text><rect fill="none" height="1660.9805" style="stroke:#000000;stroke-width:1.5;" width="3638.5298" x="45" y="323.7715"/><rect fill="none" height="963.043" style="stroke:#000000;stroke-width:1.5;" width="2404.5415" x="55" y="1014.709"/><rect fill="none" height="2283.6074" style="stroke:#000000;stroke-width:1.5;" width="3463.3413" x="169" y="1998.752"/><rect fill="none" height="3788.7246" style="stroke:#000000;stroke-width:1.5;" width="4246.208" x="19" y="4296.3594"/><rect fill="none" height="990.9746" style="stroke:#000000;stroke-width:1.5;" width="2435.1045" x="29" y="4320.6699"/><rect fill="#ADD8E6" height="145.1738" style="stroke:#000000;stroke-width:1.5;" width="926.2842" x="3243" y="6214.6191"/><rect fill="none" height="5088.5996" style="stroke:#000000;stroke-width:1.5;" width="4266.208" x="9" y="8099.084"/><rect fill="none" height="4219.5566" style="stroke:#000000;stroke-width:1.5;" width="4246.208" x="19" y="8760.6426"/><rect fill="#ADD8E6" height="145.1738" style="stroke:#000000;stroke-width:1.5;" width="926.2842" x="3243" y="9279.0957"/><rect fill="none" height="960.3535" style="stroke:#000000;stroke-width:1.5;" width="2435.1045" x="29" y="11305.0449"/><rect fill="none" height="1818.9121" style="stroke:#000000;stroke-width:1.5;" width="3605.3413" x="27" y="13201.6836"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="506.1826" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="510" x2="510" y1="139.2871" y2="15037.5957"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="1009.4507" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1012.5659" x2="1012.5659" y1="139.2871" y2="15037.5957"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="1349.0825" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1352.3799" x2="1352.3799" y1="139.2871" y2="15037.5957"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="1408.9814" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1412.7852" x2="1412.7852" y1="139.2871" y2="15037.5957"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="2074.2329" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2078.1699" x2="2078.1699" y1="139.2871" y2="15037.5957"/></g><g><title>WT</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="2799.3833" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2802.9688" x2="2802.9688" y1="139.2871" y2="15037.5957"/></g><g><title>Peers</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="3597.2397" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3601.1382" x2="3601.1382" y1="139.2871" y2="15037.5957"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="14898.3086" width="8" x="3651.9355" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3655.3413" x2="3655.3413" y1="139.2871" y2="15037.5957"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="492" y="136.334">User</text><ellipse cx="510.1826" cy="71.2988" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M510.1826,79.2988 L510.1826,106.2988 M497.1826,87.2988 L523.1826,87.2988 M510.1826,106.2988 L497.1826,121.2988 M510.1826,106.2988 L523.1826,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="492" y="15050.1309">User</text><ellipse cx="510.1826" cy="15061.584" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M510.1826,15069.584 L510.1826,15096.584 M497.1826,15077.584 L523.1826,15077.584 M510.1826,15096.584 L497.1826,15111.584 M510.1826,15096.584 L523.1826,15111.584" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="996.5659" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="1003.5659" y="128.334">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="996.5659" y="15036.5957"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="1003.5659" y="15057.1309">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="1318.3799" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="1325.3799" y="128.334">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="1318.3799" y="15036.5957"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="1325.3799" y="15057.1309">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="1397.7852" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="1404.7852" y="128.334">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="1397.7852" y="15036.5957"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="1404.7852" y="15057.1309">ST</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2056.1699" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2063.1699" y="128.334">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2056.1699" y="15036.5957"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2063.1699" y="15057.1309">Niso</text></g><g class="participant participant-head" data-participant="WT"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8291" x="2785.9688" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8291" x="2792.9688" y="128.334">WT</text></g><g class="participant participant-tail" data-participant="WT"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8291" x="2785.9688" y="15036.5957"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8291" x="2792.9688" y="15057.1309">WT</text></g><g class="participant participant-head" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="3580.1382" y="136.334">Peers</text><ellipse cx="3601.2397" cy="71.2988" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3601.2397,79.2988 L3601.2397,106.2988 M3588.2397,87.2988 L3614.2397,87.2988 M3601.2397,106.2988 L3588.2397,121.2988 M3601.2397,106.2988 L3614.2397,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="3580.1382" y="15050.1309">Peers</text><ellipse cx="3601.2397" cy="15061.584" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3601.2397,15069.584 L3601.2397,15096.584 M3588.2397,15077.584 L3614.2397,15077.584 M3601.2397,15096.584 L3588.2397,15111.584 M3601.2397,15096.584 L3614.2397,15111.584" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="3632.3413" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="3639.3413" y="128.334">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="3632.3413" y="15036.5957"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="3639.3413" y="15057.1309">SARs</text></g><path d="M491,179.2871 L491,311.2871 L3673,311.2871 L3673,189.2871 L3663,179.2871 L491,179.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3663,179.2871 L3663,189.2871 L3673,189.2871 L3663,179.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.5415" x="1453.5554" y="196.8555">Notation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1511.0969" y="196.8555">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="805.1558" x="1457.6687" y="212.166">withdrawal follows Setup and the state at the end of setup is inherited for all entities except Iso which loses state on shutdown.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1240.1924" x="1457.6687" y="227.4766">"_i" in variable name indicates an integer less than 5, identifying peers, any operation done on this kind of variable is done on each element of a vector containing every peers' version of that value.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.8042" x="1457.6687" y="242.7871">Boomlet's niso_0_event_block_height is updated with freshly received value in each message containing it.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="992.7671" x="1457.6687" y="258.0977">Each message is represented by a name composed of stage||sender||receiver||# in which # represents the #th message from sender to receiver in that stage.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="862.7861" x="1457.6687" y="273.4082">In the withdrawal diagram peer_0 represents the peer that initiates the transaction and peer_1 represents one of the non-initiator peers.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.313" x="1457.6687" y="288.7188">Each entity inside user-side box of each peer_i is represented by entityName_i.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1164.8076" x="1457.6687" y="304.0293">Some steps between initiator and non-initiator run asynchronously and concurrently, these steps when associated with non-initiator are denoted by an 'n' character at the end of step#.</text><path d="M45,323.7715 L234.1426,323.7715 L234.1426,331.082 L224.1426,341.082 L45,341.082 L45,323.7715" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1660.9805" style="stroke:#000000;stroke-width:1.5;" width="3638.5298" x="45" y="323.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144.1426" x="60" y="337.3398">Transaction Initiation</text><path d="M491,346.082 L491,570.082 L3673,570.082 L3673,356.082 L3663,346.082 L491,346.082" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3663,346.082 L3663,356.082 L3673,356.082 L3663,346.082" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88.8672" x="1515.5815" y="363.6504">PARAMETERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="378.9609">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.0513" x="1532.0283" y="378.9609">define DURESS_CHECK_INTERVAL_IN_BLOCKS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="394.2715">2.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="629.5605" x="1532.0283" y="394.2715">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="409.582">3.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="933.2642" x="1532.0283" y="409.582">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="424.8926">4.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="926.7896" x="1532.0283" y="424.8926">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="440.2031">5.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="730.793" x="1532.0283" y="440.2031">define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_SAR_RESPONSE_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="455.5137">6.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="944.4551" x="1532.0283" y="455.5137">define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_AND_NON_INITIATOR_PEERS_TO_RECEIVING_TX_COMMITMENT_BY_ALL_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="470.8242">7.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.8223" x="1532.0283" y="470.8242">define TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_TO_RECEIVING_ALL_PINGS_BY_WT_AND_HAVING_SAR_RESPONSE_BACK_TO_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="486.1348">8.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="702.5015" x="1532.0283" y="486.1348">define TOLERANCE_IN_BLOCKS_FROM_CREATING_PONG_BY_WT_TO_REVIEWING_THE_PONG_IN_PEERS_BOOMLET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1515.5815" y="501.4453">9.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="749.5884" x="1532.0283" y="501.4453">define TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_BY_OTHER_PEERS_TO_REVIEWING_THE_PING_IN_PEER_BOOMLET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.5537" x="1515.5815" y="516.7559">10.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="656.9316" x="1540.2485" y="516.7559">define JUMP_IN_BLOCKS_IF_LAST_SEEN_BLOCK_LAGS_BEHIND_NISO_EVENT_BLOCK_HEIGHT_IN_BOOMLET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.5537" x="1515.5815" y="532.0664">11.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1059.7793" x="1540.2485" y="532.0664">define REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_APPROVAL_AND_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.5537" x="1515.5815" y="547.377">12.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1099.6997" x="1540.2485" y="547.377">define REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_COMMITMENT_AND_RECEIVING_ALL_NON_INITIATOR_TX_COMMITMENT_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20.5537" x="1515.5815" y="562.6875">13.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="495.9424" x="1540.2485" y="562.6875">define REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PING_AND_PONG</text><rect fill="#FEFFDD" height="23" style="stroke:#181818;stroke-width:0.5;" width="506" x="257" y="580.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="498.2275" x="261" y="596.998">User generates PSBT using a otherwise independent watch-only wallet module.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="509.6826" cy="644.6113" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,641.3613,2076.2329,645.3613,2066.2329,649.3613,2070.2329,645.3613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.1826" x2="2072.2329" y1="645.3613" y2="645.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="517.1826" y="632.9639">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.751" x="547.9697" y="625.3086">WithdrawalNisoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.8535" x="552.083" y="640.6191">psbt</text></g><polygon fill="#FFF0F5" points="1631,658.3613,2523,658.3613,2533,684.3613,2523,711.3613,1631,711.3613,1621,684.3613,1631,658.3613" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="884.7109" x="1633" y="674.9297">Niso receives psbt from User. Niso checks that most_work_bitcoin_block_height has passed milestone_block_0 from boomerang_descriptor,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="806.9712" x="1637.1133" y="690.2402">derives tx_id from psbt and stores it. Niso also checks to see if psbt inputs are satisfiable. It sends the psbt alongside the latest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.4219" x="1637.1133" y="705.5508">block_height to Boomlet.</text><polygon fill="#FFC0CB" points="1736,722.293,2420,722.293,2430,733.293,2420,745.293,1736,745.293,1726,733.293,1736,722.293" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.4497" x="1738" y="738.8613">Assert most_work_bitcoin_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><polygon fill="#E6E6FA" points="1875,755.6035,2280,755.6035,2290,774.6035,2280,793.6035,1875,793.6035,1865,774.6035,1875,755.6035" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.7319" x="1877" y="772.1719">tx_id := psbt.derive_tx_id().</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="1881.1133" y="787.4824">niso_0_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1971,804.2246,2184,804.2246,2194,815.2246,2184,827.2246,1971,827.2246,1961,815.2246,1971,804.2246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.9297" x="1973" y="820.793">Assert hydrate_psbt(psbt) != Null</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,880.4668,1354.0825,884.4668,1364.0825,888.4668,1360.0825,884.4668" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="883.7168" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="884.4668" y2="884.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="864.4141">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="849.1035">WithdrawalNisoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.8535" x="1404.9829" y="864.4141">psbt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="1404.9829" y="879.7246">niso_0_event_block_height</text></g><polygon fill="#FFF0F5" points="924,897.4668,1781,897.4668,1791,916.4668,1781,935.4668,924,935.4668,914,916.4668,924,897.4668" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.5146" x="926" y="914.0352">Boomlet receives {psbt, niso_0_event_block_height} from Niso and checks to see if the niso_0_event_block_height has passed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="849.6528" x="930.1133" y="929.3457">milestone_block_0. Boomlet then derives tx_id from psbt, adds a nonce to it, encrypts it for st_0_identity_pubkey and sends it to Niso.</text><polygon fill="#FFC0CB" points="1029,946.0879,1676,946.0879,1686,957.0879,1676,969.0879,1029,969.0879,1019,957.0879,1029,946.0879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643.4492" x="1031" y="962.6563">Assert niso_0_event_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><polygon fill="#E6E6FA" points="1265,979.3984,1439,979.3984,1449,990.3984,1439,1002.3984,1265,1002.3984,1255,990.3984,1265,979.3984" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.6187" x="1267" y="995.9668">tx_id := psbt.derive_tx_id()</text><path d="M55,1014.709 L203.0415,1014.709 L203.0415,1022.0195 L193.0415,1032.0195 L55,1032.0195 L55,1014.709" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="963.043" style="stroke:#000000;stroke-width:1.5;" width="2404.5415" x="55" y="1014.709"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="103.0415" x="70" y="1028.2773">ST_check(tx_id)</text><polygon fill="#E6E6FA" points="832,1037.0195,1874,1037.0195,1884,1079.0195,1874,1121.0195,832,1121.0195,822,1079.0195,832,1037.0195" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.4927" x="834" y="1053.5879">tx_id_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.3618" x="838.1133" y="1068.8984">content: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.9761" x="838.1133" y="1084.209">nonce: rand() [u8; 32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="834" y="1099.5195">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1033.9063" x="838.1133" y="1114.8301">tx_id_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: tx_id_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="1162.4434" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,1159.1934,2076.2329,1163.1934,2066.2329,1167.1934,2070.2329,1163.1934" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="1163.1934" y2="1163.1934"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="1150.7959">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="1143.1406">WithdrawalBoomletNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.4722" x="1394.9829" y="1158.4512">tx_id_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1759,1176.1934,2395,1176.1934,2405,1187.1934,2395,1199.1934,1759,1199.1934,1749,1187.1934,1759,1176.1934" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="632.5947" x="1761" y="1192.7617">Niso receives tx_id_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1423.9814,1237.125,1413.9814,1241.125,1423.9814,1245.125,1419.9814,1241.125" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="1240.375" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1417.9814" x2="2073.2329" y1="1241.125" y2="1241.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1429.9814" y="1228.7275">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.1328" x="1460.7686" y="1221.0723">WithdrawalNisoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.4722" x="1464.8818" y="1236.3828">tx_id_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="987,1254.125,1838,1254.125,1848,1265.125,1838,1277.125,987,1277.125,977,1265.125,987,1254.125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="847.5581" x="989" y="1270.6934">ST receives tx_id_with_nonce_encrypted_by_boomlet_0_for_st from Niso, decrypts it, separates the nonce and sends the tx_id to User.</text><polygon fill="#E6E6FA" points="891,1287.4355,1933,1287.4355,1943,1306.4355,1933,1325.4355,891,1325.4355,881,1306.4355,891,1287.4355" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1034.0205" x="893" y="1304.0039">tx_id_with_nonce := AES_decrypt(private_key: ECDH(st_0_identity_privkey, boomlet_0_identity_pubkey), content: tx_id_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.811" x="897.1133" y="1319.3145">tx_id := tx_id_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="521.1826,1363.6777,511.1826,1367.6777,521.1826,1371.6777,517.1826,1367.6777" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1412.4814" cy="1366.9277" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="515.1826" x2="1407.9814" y1="1367.6777" y2="1367.6777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="527.1826" y="1355.2803">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.2349" x="557.9697" y="1347.625">WithdrawalStOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.2749" x="562.083" y="1362.9355">tx_id</text></g><polygon fill="#FFF0F5" points="75,1380.6777,943,1380.6777,953,1391.6777,943,1403.6777,75,1403.6777,65,1391.6777,75,1380.6777" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="864.8428" x="77" y="1397.2461">User receives tx_id from User and checks to see if it matches that of the psbt he generated. He then informs ST of his acknowledgement.</text><polygon fill="#FFC0CB" points="397,1413.9883,621,1413.9883,631,1424.9883,621,1436.9883,397,1436.9883,387,1424.9883,397,1413.9883" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.6001" x="399" y="1430.5566">Assert tx_id == psbt.derive_tx_id()</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="509.6826" cy="1478.1699" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1400.9814,1474.9199,1410.9814,1478.9199,1400.9814,1482.9199,1404.9814,1478.9199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.1826" x2="1406.9814" y1="1478.9199" y2="1478.9199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="517.1826" y="1466.5225">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.5742" x="547.9697" y="1458.8672">WithdrawalStInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="760.8618" x="552.083" y="1474.1777">magic: "withdrawal_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"</text></g><polygon fill="#FFF0F5" points="951,1491.9199,1873,1491.9199,1883,1517.9199,1873,1544.9199,951,1544.9199,941,1517.9199,951,1491.9199" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="914.3418" x="953" y="1508.4883">ST receives {magic: "withdrawal_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"} from User.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="880.7119" x="957.1133" y="1523.7988">ST then signs the tx_id_with_nonce it received with st_privkey and encrypts it with boomlet_0_identity_pubkey. It then sends this encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.3228" x="957.1133" y="1539.1094">message to Niso.</text><polygon fill="#E6E6FA" points="804,1555.8516,2021,1555.8516,2031,1597.8516,2021,1639.8516,804,1639.8516,794,1597.8516,804,1555.8516" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.8433" x="806" y="1572.4199">tx_id_with_nonce_signed_by_st := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.5991" x="810.1133" y="1587.7305">signature: schnorr_sign(st_0_identity_privkey, tx_id_with_nonce)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.9756" x="810.1133" y="1603.041">content: tx_id_with_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="806" y="1618.3516">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1209.7998" x="810.1133" y="1633.6621">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(st_0_identity_privkey, boomlet_0_identity_pubkey), content: tx_id_with_nonce_signed_by_st)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1412.4814" cy="1681.2754" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,1678.0254,2076.2329,1682.0254,2066.2329,1686.0254,2070.2329,1682.0254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1416.9814" x2="2072.2329" y1="1682.0254" y2="1682.0254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1419.9814" y="1669.6279">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.1328" x="1450.7686" y="1661.9727">WithdrawalStNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.4189" x="1454.8818" y="1677.2832">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1715,1695.0254,2439,1695.0254,2449,1706.0254,2439,1718.0254,1715,1718.0254,1705,1706.0254,1715,1695.0254" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="720.5415" x="1717" y="1711.5938">Niso receives tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,1755.957,1354.0825,1759.957,1364.0825,1763.957,1360.0825,1759.957" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="1759.207" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="1759.957" y2="1759.957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="1747.5596">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="1739.9043">WithdrawalNisoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.4189" x="1404.9829" y="1755.2148">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="889,1772.957,1815,1772.957,1825,1814.957,1815,1856.957,889,1856.957,879,1814.957,889,1772.957" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="918.7026" x="891" y="1789.5254">Boomlet receives tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from Niso, decrypts it, verifies st_0_identity_pubkey's signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.3896" x="895.1133" y="1804.8359">and checks if the content is the same as the one sent i.e. User has acknowledged the tx_id and the message is fresh. It then generates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="877.7476" x="895.1133" y="1820.1465">peer_0_tx_approval composed of {"approved", tx_id, event_block_height}, signs it with boomlet_0_identity_privkey and encrypts it for wt. It</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="879.0996" x="895.1133" y="1835.457">then encrypts psbt for every other boomlet_i using their respective identity_pubkey. Boomlet sends the resulting psbt_encrypted_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="594.4263" x="895.1133" y="1850.7676">alongside peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt to Niso.</text><polygon fill="#E6E6FA" points="759,1867.5098,1947,1867.5098,1957,1878.5098,1947,1890.5098,759,1890.5098,749,1878.5098,759,1867.5098" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1184.1299" x="761" y="1884.0781">tx_id_with_nonce_signed_by_st := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1050,1900.8203,1654,1900.8203,1664,1911.8203,1654,1923.8203,1050,1923.8203,1040,1911.8203,1050,1900.8203" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="600.4438" x="1052" y="1917.3887">Assert schnorr_verify(st_0_identity_pubkey, tx_id_with_nonce_signed_by_st.signature) == True</text><polygon fill="#FFC0CB" points="1133,1934.1309,1571,1934.1309,1581,1953.1309,1571,1972.1309,1133,1972.1309,1123,1953.1309,1133,1934.1309" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1135" y="1950.6992">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="430.4663" x="1139.1133" y="1966.0098">Assert tx_id_with_nonce_signed_by_st.content == tx_id_with_nonce</text><path d="M169,1998.752 L358.187,1998.752 L358.187,2006.0625 L348.187,2016.0625 L169,2016.0625 L169,1998.752" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2283.6074" style="stroke:#000000;stroke-width:1.5;" width="3463.3413" x="169" y="1998.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144.187" x="184" y="2012.3203">Transaction Approval</text><polygon fill="#E6E6FA" points="697,2021.0625,2008,2021.0625,2018,2116.0625,2008,2212.0625,697,2212.0625,687,2116.0625,697,2021.0625" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.4536" x="699" y="2037.6309">peer_0_tx_approval := TxApproval{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.8916" x="703.1133" y="2052.9414">magic: "approved",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="703.1133" y="2068.252">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.7461" x="703.1133" y="2083.5625">event_block_height: niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="699" y="2098.873">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="425.2803" x="703.1133" y="2114.1836">peer_0_tx_approval_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.3159" x="703.1133" y="2129.4941">signature: schnorr_sign(boomlet_0_identity_privkey, peer_0_tx_approval)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.0293" x="703.1133" y="2144.8047">content: peer_0_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="699" y="2160.1152">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1299.708" x="703.1133" y="2175.4258">_peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: _peer_0_tx_approval_signed_by_boomlet_0)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1048.8423" x="703.1133" y="2190.7363">psbt_encrypted_by_boomlet_0_for_boomlet_i := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, boomlet_i_identity_privkey), content: psbt) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.3501" x="703.1133" y="2206.0469">psbt_encrypted_collection := Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="2268.9707" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,2265.7207,2076.2329,2269.7207,2066.2329,2273.7207,2070.2329,2269.7207" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="2269.7207" y2="2269.7207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="2249.668">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="2234.3574">WithdrawalBoomletNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.2456" x="1394.9829" y="2249.668">peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="631.9028" x="1394.9829" y="2264.9785">psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1468,2282.7207,2687,2282.7207,2697,2301.7207,2687,2320.7207,1468,2320.7207,1458,2301.7207,1468,2282.7207" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1211.8501" x="1470" y="2299.2891">Niso receives {peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.7983" x="1474.1133" y="2314.5996">from Boomlet and forwards them to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2077.7329" cy="2392.834" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2791.3833,2389.584,2801.3833,2393.584,2791.3833,2397.584,2795.3833,2393.584" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2082.2329" x2="2797.3833" y1="2393.584" y2="2393.584"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2085.2329" y="2365.876">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2116.02" y="2342.9102">WithdrawalNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="2116.02" y="2358.2207">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210.1328" x="2120.1333" y="2358.2207">[start of non-initiator diagram]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.2456" x="2120.1333" y="2373.5313">peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="631.9028" x="2120.1333" y="2388.8418">psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2197,2406.584,3408,2406.584,3418,2448.584,3408,2490.584,2197,2490.584,2187,2448.584,2197,2406.584" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1203.2173" x="2199" y="2423.1523">WT receives {peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="932.4199" x="2203.1133" y="2438.4629">from Niso. WT decrypts peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, verifies boomlet_0_identity_pubkey's signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="868.0483" x="2203.1133" y="2453.7734">and checks the string to match "approved". WT stores the tx_id from peer_0_tx_approval and checks that the event_block_height is fresh.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="920.9053" x="2203.1133" y="2469.084">Then it constructs it's own tx_approval composed of {"approved",tx_id,most_work_bitcoin_block_height, boomlet_0_identity_pubkey} and signs it.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1065.4033" x="2203.1133" y="2484.3945">It sends to each non-initiator peer wt_tx_approval_signed_by_wt, peer_0_tx_approval_signed_by_boomlet_0 and psbt encrypted by that peer's boomlet_identity_pubkey.</text><polygon fill="#E6E6FA" points="2170,2501.1367,3435,2501.1367,3445,2512.1367,3435,2524.1367,2170,2524.1367,2160,2512.1367,2170,2501.1367" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1261.0381" x="2172" y="2517.7051">peer_0_tx_approval_signed_by_boomlet_0 := AES_decrypt(privkey: ECDH(wt_privkey, boomlet_0_identity_pubkey), content: peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt)</text><polygon fill="#FFC0CB" points="2446,2534.4473,3160,2534.4473,3170,2545.4473,3160,2557.4473,2446,2557.4473,2436,2545.4473,2446,2534.4473" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="710.5439" x="2448" y="2551.0156">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_approval_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2569,2567.7578,3036,2567.7578,3046,2578.7578,3036,2590.7578,2569,2590.7578,2559,2578.7578,2569,2567.7578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.9756" x="2571" y="2584.3262">peer_0_tx_approval := peer_0_tx_approval_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2648,2601.0684,2958,2601.0684,2968,2612.0684,2958,2624.0684,2648,2624.0684,2638,2612.0684,2648,2601.0684" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.376" x="2650" y="2617.6367">Assert peer_0_tx_approval.magic == "approved"</text><polygon fill="#E6E6FA" points="2695,2634.3789,2911,2634.3789,2921,2645.3789,2911,2657.3789,2695,2657.3789,2685,2645.3789,2695,2634.3789" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.3926" x="2697" y="2650.9473">tx_id := peer_0_tx_approval.tx_id</text><polygon fill="#FFC0CB" points="2228,2667.6895,3377,2667.6895,3387,2693.6895,3377,2720.6895,2228,2720.6895,2218,2693.6895,2228,2667.6895" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="2230" y="2684.2578">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1137.7222" x="2234.1133" y="2699.5684">Assert peer_0_tx_approval.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="535.5708" x="2234.1133" y="2714.8789">Assert peer_0_tx_approval.event_block_height &lt;= most_work_bitcoin_block_height .</text><polygon fill="#E6E6FA" points="2626,2731.6211,2979,2731.6211,2989,2803.6211,2979,2876.6211,2626,2876.6211,2616,2803.6211,2626,2731.6211" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.1255" x="2628" y="2748.1895">_wt_tx_approval := TxApproval{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.8916" x="2632.1133" y="2763.5">magic: "approved",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="2632.1133" y="2778.8105">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.8599" x="2632.1133" y="2794.1211">event_block_height: most_work_bitcoin_block_height,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.9063" x="2632.1133" y="2809.4316">initiator_id: boomlet_0_identity_pubkey}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.4585" x="2632.1133" y="2824.7422">wt_tx_approval_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333.9692" x="2632.1133" y="2840.0527">signature: schnorr_sign(wt_privkey, _wt_tx_approval)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.7012" x="2632.1133" y="2855.3633">content: _wt_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2628" y="2870.6738">}</text><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2802.8833" cy="2948.9082" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3589.2397,2945.6582,3599.2397,2949.6582,3589.2397,2953.6582,3593.2397,2949.6582" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3595.2397" y1="2949.6582" y2="2949.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="2921.9502">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2841.1704" y="2898.9844">WithdrawalWtNonInitiatorNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="2845.2837" y="2914.2949">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.3857" x="2845.2837" y="2929.6055">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.2446" x="2845.2837" y="2944.916">psbt_encrypted_by_boomlet_0_for_boomlet_i</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,2990.2793,2804.3833,2994.2793,2814.3833,2998.2793,2810.3833,2994.2793" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3600.7397" cy="2993.5293" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3596.2397" y1="2994.2793" y2="2994.2793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="2981.8818">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2851.1704" y="2974.2266">WithdrawalNonInitiatorNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="553.4141" x="2855.2837" y="2989.5371">peer_i_tx_approval_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2089.2329,3050.2109,2079.2329,3054.2109,2089.2329,3058.2109,2085.2329,3054.2109" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2802.8833" cy="3053.4609" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2083.2329" x2="2798.3833" y1="3054.2109" y2="3054.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2095.2329" y="3034.1582">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2126.02" y="3018.8477">WithdrawalWtNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.7549" x="2130.1333" y="3034.1582">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="2130.1333" y="3049.4688">wt_tx_approval_signed_by_wt</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2802.8833" cy="3098.082" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3589.2397,3094.832,3599.2397,3098.832,3589.2397,3102.832,3593.2397,3098.832" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3595.2397" y1="3098.832" y2="3098.832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="3086.4346">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2841.1704" y="3078.7793">WithdrawalWtNonInitiatorNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.7549" x="2845.2837" y="3094.0898">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1575,3111.832,2580,3111.832,2590,3145.832,2580,3180.832,1575,3180.832,1565,3145.832,1575,3111.832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.8408" x="1577" y="3128.4004">Niso receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4], wt_tx_approval_signed_by_wt} from WT. Niso verifies each</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="993.5225" x="1581.1133" y="3143.7109">boomlet_i_identity_pubkey's signature on each peer_i_tx_approval_signed_by_boomlet_i and verifies wt_pubkey's signature on wt_tx_approval_signed_by_wt.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="891.3125" x="1581.1133" y="3159.0215">It checks the magic string for every approval to match "approved", the tx_id to match what was sent and the event_block_heights to be in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="873.5327" x="1581.1133" y="3174.332">appropriate range. It forwards Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4] along with the latest block to Boomlet.</text><polygon fill="#FFC0CB" points="1682,3191.0742,2473,3191.0742,2483,3202.0742,2473,3214.0742,1682,3214.0742,1672,3202.0742,1682,3191.0742" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="787.7124" x="1684" y="3207.6426">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1813,3224.3848,2341,3224.3848,2351,3235.3848,2341,3247.3848,1813,3247.3848,1803,3235.3848,1813,3224.3848" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="524.7036" x="1815" y="3240.9531">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1800,3257.6953,2355,3257.6953,2365,3283.6953,2355,3310.6953,1800,3310.6953,1790,3283.6953,1800,3257.6953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="547.644" x="1802" y="3274.2637">_peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362.8257" x="1806.1133" y="3289.5742">_wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="1806.1133" y="3304.8848">niso_0_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1874,3321.627,2281,3321.627,2291,3332.627,2281,3344.627,1874,3344.627,1864,3332.627,1874,3321.627" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.0825" x="1876" y="3338.1953">Assert _peer_i_tx_approval.magic == "approved". [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1931,3354.9375,2224,3354.9375,2234,3365.9375,2224,3377.9375,1931,3377.9375,1921,3365.9375,1931,3354.9375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.1611" x="1933" y="3371.5059">Assert _wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="1896,3388.248,2259,3388.248,2269,3399.248,2259,3411.248,1896,3411.248,1886,3399.248,1896,3388.248" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.0806" x="1898" y="3404.8164">Assert _peer_i_tx_approval.tx_id == tx_id. [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1951,3421.5586,2204,3421.5586,2214,3432.5586,2204,3444.5586,1951,3444.5586,1941,3432.5586,1951,3421.5586" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.2725" x="1953" y="3438.127">Assert  _wt_tx_approval.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="1393,3454.8691,2761,3454.8691,2771,3480.8691,2761,3507.8691,1393,3507.8691,1383,3480.8691,1393,3454.8691" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1395" y="3471.4375">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="542.0264" x="1399.1133" y="3486.748">Assert wt_tx_approval.event_block_height &gt;= peer_0_tx_approval.event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1360.6074" x="1399.1133" y="3502.0586">Assert wt_tx_approval.event_block_height &lt;= min (peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT, niso_0_event_block_height)</text><polygon fill="#FFC0CB" points="1175,3518.8008,2979,3518.8008,2989,3544.8008,2979,3571.8008,1175,3571.8008,1165,3544.8008,1175,3518.8008" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1177" y="3535.3691">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1792.2607" x="1181.1133" y="3550.6797">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_INITIATOR_PEER)) [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1662.2607" x="1181.1133" y="3565.9902">Assert  peer_i_tx_approval.event_block_height &lt;= (most_work_bitcoin_block_height - REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_APPROVAL_AND_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER)  [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="915,3582.7324,3241,3582.7324,3251,3608.7324,3241,3635.7324,915,3635.7324,905,3608.7324,915,3582.7324" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="917" y="3599.3008">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="2314.1841" x="921.1133" y="3614.6113">Assert peer_0_tx_approval.event_block_height &gt;= max((wt_tx_approval.event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT) , (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="546.1396" x="921.1133" y="3629.9219">Assert  peer_0_tx_approval.event_block_height &lt;= wt_tx_approval.event_block_height</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,3704.9063,1354.0825,3708.9063,1364.0825,3712.9063,1360.0825,3708.9063" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="3708.1563" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="3708.9063" y2="3708.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="3681.1982">[27]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="3658.2324">WithdrawalNisoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.7549" x="1404.9829" y="3673.543">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="1404.9829" y="3688.8535">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="1404.9829" y="3704.1641">niso_0_event_block_height</text></g><polygon fill="#FFF0F5" points="887,3721.9063,1817,3721.9063,1827,3770.9063,1817,3820.9063,887,3820.9063,877,3770.9063,887,3721.9063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="922.8096" x="889" y="3738.4746">Boomlet receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4], wt_tx_approval_signed_by_wt, niso_0_event_block_height}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="892.0869" x="893.1133" y="3753.7852">from WT. Boomlet verifies each boomlet_i_identity_pubkey's signature on each peer_i_tx_approval_signed_by_boomlet_i, verifies wt_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="877.4365" x="893.1133" y="3769.0957">signature on wt_tx_approval_signed_by_wt and updates niso_0_event_block_height with the new value. It checks the magic string for every</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="897.6221" x="893.1133" y="3784.4063">approval to match "approved", the tx_id to match what was sent and the event_block_heights to be in the appropriate range. It then generates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="842.4419" x="893.1133" y="3799.7168">duress_check_space which is an array of 5 integers between 1 and 198, adds a nonce to it and encrypts it using. Then Boomlet sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="464.5405" x="893.1133" y="3815.0273">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st to Niso.</text><polygon fill="#FFC0CB" points="1002,3831.7695,1703,3831.7695,1713,3842.7695,1703,3854.7695,1002,3854.7695,992,3842.7695,1002,3831.7695" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.1567" x="1004" y="3848.3379">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True</text><polygon fill="#FFC0CB" points="1088,3865.0801,1616,3865.0801,1626,3876.0801,1616,3888.0801,1088,3888.0801,1078,3876.0801,1088,3865.0801" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="524.7036" x="1090" y="3881.6484">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1120,3898.3906,1585,3898.3906,1595,3924.3906,1585,3951.3906,1120,3951.3906,1110,3924.3906,1120,3898.3906" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.0884" x="1122" y="3914.959">_peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362.8257" x="1126.1133" y="3930.2695">_wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.4268" x="1126.1133" y="3945.5801">update niso_0_event_block_height with received value.</text><polygon fill="#FFC0CB" points="1194,3962.3223,1510,3962.3223,1520,3973.3223,1510,3985.3223,1194,3985.3223,1184,3973.3223,1194,3962.3223" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312.5269" x="1196" y="3978.8906">Assert _peer_i_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="1206,3995.6328,1499,3995.6328,1509,4006.6328,1499,4018.6328,1206,4018.6328,1196,4006.6328,1206,3995.6328" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.1611" x="1208" y="4012.2012">Assert _wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="1216,4028.9434,1488,4028.9434,1498,4039.9434,1488,4051.9434,1216,4051.9434,1206,4039.9434,1216,4028.9434" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.5249" x="1218" y="4045.5117">Assert _peer_i_tx_approval.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="1226,4062.2539,1479,4062.2539,1489,4073.2539,1479,4085.2539,1226,4085.2539,1216,4073.2539,1226,4062.2539" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.2725" x="1228" y="4078.8223">Assert  _wt_tx_approval.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="668,4095.5645,2036,4095.5645,2046,4121.5645,2036,4148.5645,668,4148.5645,658,4121.5645,668,4095.5645" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="670" y="4112.1328">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="542.0264" x="674.1133" y="4127.4434">Assert wt_tx_approval.event_block_height &gt;= peer_0_tx_approval.event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1360.6074" x="674.1133" y="4142.7539">Assert wt_tx_approval.event_block_height &lt;= min (peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT, niso_0_event_block_height)</text><polygon fill="#FFC0CB" points="450,4159.4961,2254,4159.4961,2264,4185.4961,2254,4212.4961,450,4212.4961,440,4185.4961,450,4159.4961" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="452" y="4176.0645">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1792.2607" x="456.1133" y="4191.375">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_INITIATOR_PEER)) [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1662.2607" x="456.1133" y="4206.6855">Assert  peer_i_tx_approval.event_block_height &lt;= (most_work_bitcoin_block_height - REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_APPROVAL_AND_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER)  [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="189,4223.4277,2515,4223.4277,2525,4249.4277,2515,4276.4277,189,4276.4277,179,4249.4277,189,4223.4277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="191" y="4239.9961">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="2314.1841" x="195.1133" y="4255.3066">Assert peer_0_tx_approval.event_block_height &gt;= max((wt_tx_approval.event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT) , (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="546.1396" x="195.1133" y="4270.6172">Assert  peer_0_tx_approval.event_block_height &lt;= wt_tx_approval.event_block_height</text><path d="M19,4296.3594 L233.895,4296.3594 L233.895,4303.6699 L223.895,4313.6699 L19,4313.6699 L19,4296.3594" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3788.7246" style="stroke:#000000;stroke-width:1.5;" width="4246.208" x="19" y="4296.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.895" x="34" y="4309.9277">Transaction Commitment</text><path d="M29,4320.6699 L167.3105,4320.6699 L167.3105,4327.9805 L157.3105,4337.9805 L29,4337.9805 L29,4320.6699" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="990.9746" style="stroke:#000000;stroke-width:1.5;" width="2435.1045" x="29" y="4320.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.3105" x="44" y="4334.2383">duress_check:</text><polygon fill="#E6E6FA" points="736,4342.9805,1969,4342.9805,1979,4384.9805,1969,4426.9805,736,4426.9805,726,4384.9805,736,4342.9805" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9736" x="738" y="4359.5488">duress_check_space := DuressCheckSpace{space: rand([1..198;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.3994" x="742.1133" y="4374.8594">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1553" x="742.1133" y="4390.1699">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="742.1133" y="4405.4805">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.7197" x="742.1133" y="4420.791">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="4468.4043" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,4465.1543,2076.2329,4469.1543,2066.2329,4473.1543,2070.2329,4469.1543" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="4469.1543" y2="4469.1543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="4456.7568">[28]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="4449.1016">WithdrawalBoomletNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1394.9829" y="4464.4121">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1711,4482.1543,2443,4482.1543,2453,4493.1543,2443,4505.1543,1711,4505.1543,1701,4493.1543,1711,4482.1543" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="728.5015" x="1713" y="4498.7227">Niso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1423.9814,4543.0859,1413.9814,4547.0859,1423.9814,4551.0859,1419.9814,4547.0859" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="4546.3359" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1417.9814" x2="2073.2329" y1="4547.0859" y2="4547.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1429.9814" y="4534.6885">[29]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.1328" x="1460.7686" y="4527.0332">WithdrawalNisoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1464.8818" y="4542.3438">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="865,4560.0859,1960,4560.0859,1970,4586.0859,1960,4613.0859,865,4613.0859,855,4586.0859,865,4560.0859" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1087.7852" x="867" y="4576.6543">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Niso, decrypts it to get duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="876.3003" x="871.1133" y="4591.9648">assign a country to each of the numbers in the duress_check_space corresponding to its alphabetical rank and shows this array to User for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1758" x="871.1133" y="4607.2754">him to select 5 of them.</text><polygon fill="#E6E6FA" points="796,4624.0176,2029,4624.0176,2039,4643.0176,2029,4662.0176,796,4662.0176,786,4643.0176,796,4624.0176" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.834" x="798" y="4640.5859">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.6245" x="802.1133" y="4655.8965">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="521.1826,4700.2598,511.1826,4704.2598,521.1826,4708.2598,517.1826,4704.2598" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1412.4814" cy="4703.5098" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="515.1826" x2="1407.9814" y1="4704.2598" y2="4704.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="527.1826" y="4691.8623">[30]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.2349" x="557.9697" y="4684.207">WithdrawalStOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.1816" x="562.083" y="4699.5176">duress_check_space</text></g><polygon fill="#FFF0F5" points="49,4717.2598,970,4717.2598,980,4736.2598,970,4755.2598,49,4755.2598,39,4736.2598,49,4717.2598" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="913.1738" x="51" y="4733.8281">User receives duress_check_space from ST. If he is not being coerced he will select 1 country in each column to replicate the duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.25" x="55.1133" y="4749.1387">and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="509.6826" cy="4796.752" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1400.9814,4793.502,1410.9814,4797.502,1400.9814,4801.502,1404.9814,4797.502" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.1826" x2="1406.9814" y1="4797.502" y2="4797.502"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="517.1826" y="4785.1045">[31]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.5742" x="547.9697" y="4777.4492">WithdrawalStInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7847" x="552.083" y="4792.7598">duress_signal_index</text></g><polygon fill="#FFF0F5" points="878,4810.502,1947,4810.502,1957,4829.502,1947,4848.502,878,4848.502,868,4829.502,878,4810.502" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1061.0615" x="880" y="4827.0703">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the nonce from previously received duress_check_space_with_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.5415" x="884.1133" y="4842.3809">encrypts it for Boomlet and sends it to Niso.</text><polygon fill="#E6E6FA" points="795,4859.123,2030,4859.123,2040,4893.123,2030,4928.123,795,4928.123,785,4893.123,795,4859.123" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.0024" x="797" y="4875.6914">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.7583" x="801.1133" y="4891.002">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="801.1133" y="4906.3125">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1226.9258" x="801.1133" y="4921.623">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1412.4814" cy="4969.2363" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,4965.9863,2076.2329,4969.9863,2066.2329,4973.9863,2070.2329,4969.9863" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1416.9814" x2="2072.2329" y1="4969.9863" y2="4969.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1419.9814" y="4957.5889">[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.1328" x="1450.7686" y="4949.9336">WithdrawalStNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1454.8818" y="4965.2441">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1711,4982.9863,2444,4982.9863,2454,4993.9863,2444,5005.9863,1711,5005.9863,1701,4993.9863,1711,4982.9863" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.1045" x="1713" y="4999.5547">Niso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,5043.918,1354.0825,5047.918,1364.0825,5051.918,1360.0825,5047.918" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="5047.168" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="5047.918" y2="5047.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="5035.5205">[33]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="5027.8652">WithdrawalNisoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1404.9829" y="5043.1758">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="868,5060.918,1837,5060.918,1847,5109.918,1837,5159.918,868,5159.918,858,5109.918,868,5060.918" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961.3081" x="870" y="5077.4863">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Niso. Boomlet will search for the indices in duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.8428" x="874.1133" y="5092.7969">assigning the resulting value to duress_signal.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="558.2827" x="874.1133" y="5108.1074">If the duress_signal is composed of the same set of numbers as the duress_consent_set,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="935.7017" x="874.1133" y="5123.418">duress_placeholder_plaintext will be assigned an empty padding otherwise it will be the doxing_key. duress_placeholder_plaintext will be encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="888.2021" x="874.1133" y="5138.7285">to make up duress_placeholder. Boomlet then constructs peer_0_tx_commit composed of {"commit" ,tx_id , niso_0_event_block_height}, and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="691.939" x="874.1133" y="5154.0391">signs it, pads it with duress_placeholder, resigns it,d encrypts it with wt_pubkey and sends the result to Niso.</text><polygon fill="#E6E6FA" points="737,5170.7813,1968,5170.7813,1978,5181.7813,1968,5193.7813,737,5193.7813,727,5181.7813,737,5170.7813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1227.04" x="739" y="5187.3496">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1065,5204.0918,1640,5204.0918,1650,5223.0918,1640,5242.0918,1065,5242.0918,1055,5223.0918,1065,5204.0918" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1067" y="5220.6602">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="567.3472" x="1071.1133" y="5235.9707">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="934,5252.7129,1771,5252.7129,1781,5278.7129,1771,5305.7129,934,5305.7129,924,5278.7129,934,5252.7129" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="501.7441" x="936" y="5269.2813">duress_signal := duress_check_space[duress_signal_index_with_nonce.content]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="817.083" x="940.1133" y="5284.5918">duress_placeholder_plaintext := Evaluate(duress_signal, duress_consent_set, doxing_key) [either padding of False or doxing_key]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="829.207" x="940.1133" y="5299.9023">duress_placeholder := AES_encrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_plaintext)</text><polygon fill="#E6E6FA" points="593,5323.6445,2111,5323.6445,2121,5457.6445,2111,5591.6445,593,5591.6445,583,5457.6445,593,5323.6445" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5474" x="595" y="5340.2129">_peer_0_tx_commit := TxCommit{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.4277" x="599.1133" y="5355.5234">magic: "commit",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="599.1133" y="5370.834">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.7461" x="599.1133" y="5386.1445">event_block_height: niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="595" y="5401.4551">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.8042" x="599.1133" y="5416.7656">_peer_0_tx_commit_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="464.9531" x="599.1133" y="5432.0762">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_tx_commit),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5532" x="599.1133" y="5447.3867">content: _peer_0_tx_commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="595" y="5462.6973">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="772.8335" x="599.1133" y="5478.0078">_peer_0_tx_commit_signed_by_boomlet_0_padded := PaddedMessage{content: _peer_0_tx_commit_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0254" x="599.1133" y="5493.3184">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="595" y="5508.6289">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.7847" x="599.1133" y="5523.9395">_peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.9336" x="599.1133" y="5539.25">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_tx_commit_signed_by_boomlet_0_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.5337" x="599.1133" y="5554.5605">content: _peer_0_tx_commit_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="595" y="5569.8711">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1510.6025" x="599.1133" y="5585.1816">_peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(privkey: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: _peer_0_tx_commit_signed_by_boomlet_0_padded)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="5632.7949" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,5629.5449,2076.2329,5633.5449,2066.2329,5637.5449,2070.2329,5633.5449" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="5633.5449" y2="5633.5449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="5621.1475">[34]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="5613.4922">WithdrawalBoomletNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.25" x="1394.9829" y="5628.8027">peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="1582,5646.5449,2573,5646.5449,2583,5657.5449,2573,5669.5449,1582,5669.5449,1572,5657.5449,1582,5646.5449" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="987.4922" x="1584" y="5663.1133">Niso receives peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2077.7329" cy="5710.7266" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2791.3833,5707.4766,2801.3833,5711.4766,2791.3833,5715.4766,2795.3833,5711.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2082.2329" x2="2797.3833" y1="5711.4766" y2="5711.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2085.2329" y="5699.0791">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2116.02" y="5691.4238">WithdrawalNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.25" x="2120.1333" y="5706.7344">peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="2259,5724.4766,3347,5724.4766,3357,5758.4766,3347,5793.4766,2259,5793.4766,2249,5758.4766,2259,5724.4766" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1042.7231" x="2261" y="5741.0449">WT receives peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Niso and approvals_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="954.3701" x="2265.1133" y="5756.3555">from each non-initiator Peer (async). It decrypts the message from Niso to get peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1075.9658" x="2265.1133" y="5771.666">and verifies boomlet_0_identity_pubkey's signature. It then derives duress_placeholder by separating the padding from _peer_0_tx_commit_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="505.9209" x="2265.1133" y="5786.9766">and sends it to ST. It also saves peer_0_tx_commit_signed_by_boomlet for later.</text><polygon fill="#E6E6FA" points="1974,5803.7188,3632,5803.7188,3642,5814.7188,3632,5826.7188,1974,5826.7188,1964,5814.7188,1974,5803.7188" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1654.0469" x="1976" y="5820.2871">_peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0 := AES_decrypt(privkey: ECDH(wt_privkey, boomlet_0_identity_pubkey), content: _peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt)</text><polygon fill="#FFC0CB" points="2376,5837.0293,3229,5837.0293,3239,5848.0293,3229,5860.0293,2376,5860.0293,2366,5848.0293,2376,5837.0293" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="849.3037" x="2378" y="5853.5977">Assert schnorr_verify(boomlet_0_identity_pubkey, _peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0.signature)</text><polygon fill="#E6E6FA" points="2370,5870.3398,3235,5870.3398,3245,5896.3398,3235,5923.3398,2370,5923.3398,2360,5896.3398,2370,5870.3398" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="856.9844" x="2372" y="5886.9082">_peer_0_tx_commit_signed_by_boomlet_0_padded := _peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520.146" x="2376.1133" y="5902.2188">duress_placeholder := _peer_0_tx_commit_signed_by_boomlet_0_padded.padding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="653.5039" x="2376.1133" y="5917.5293">peer_0_tx_commit_signed_by_boomlet_0 := _peer_0_tx_commit_signed_by_boomlet_0_padded.content</text><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,5961.8926,2804.3833,5965.8926,2814.3833,5969.8926,2810.3833,5965.8926" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3600.7397" cy="5965.1426" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3596.2397" y1="5965.8926" y2="5965.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="2820.3833" y="5953.4951">[35n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2859.708" y="5945.8398">WithdrawalNonInitiatorNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.564" x="2863.8213" y="5961.1504">approvals_signed_by_boomlet_i [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="2802.8833" cy="6025.0742" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3643.9355,6021.8242,3653.9355,6025.8242,3643.9355,6029.8242,3647.9355,6025.8242" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3649.9355" y1="6025.8242" y2="6025.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="6005.7715">[36]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9131" x="2841.1704" y="5990.4609">WithdrawalWtSarsMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="2845.2837" y="6005.7715">duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="2845.2837" y="6021.082">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3200,6038.8242,4111,6038.8242,4121,6103.8242,4111,6168.8242,3200,6168.8242,3190,6103.8242,3200,6038.8242" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.2378" x="3202" y="6055.3926">SAR receives {duress_placeholder, boomlet_0_identity_pubkey} from WT. It decrypts duress_placeholder using boomlet_0_identity_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="834.9897" x="3206.1133" y="6070.7031">sar_privkey to get duress_placeholder_plaintext. It checks to see if it's a padding of False or a duress signal, if it was a duress signal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="824.8652" x="3206.1133" y="6086.0137">and the pair of the received boomlet_0_identity_pubkey and AES iv of duress_placeholder was not previously received, It calculates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="826.0332" x="3206.1133" y="6101.3242">doxing_data_identifier by hashing duress_placeholder, uses it to find which doxing_data is associated with this user and then uses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.4639" x="3206.1133" y="6116.6348">duress_placeholder which is equal to doxing_key to decrypt the associated static_doxing_data_encrypted_by_doxing_key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="819.9648" x="3206.1133" y="6131.9453">dynamic_doxing_data_encrypted_by_doxing_key. It then uses this doxing_data to enter SEARCH AND RESCUE. Regardless of if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="899.6152" x="3206.1133" y="6147.2559">duress_placeholder is a false signal or not SAR signs duress_placeholder with the doxing_key and encrypts it with boomlet_0_identity_pubkey.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="638.8853" x="3206.1133" y="6162.5664">It then responds to WT with the duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0.</text><polygon fill="#E6E6FA" points="3238,6179.3086,4072,6179.3086,4082,6190.3086,4072,6202.3086,3238,6202.3086,3228,6190.3086,3238,6179.3086" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830.8765" x="3240" y="6195.877">duress_placeholder_plaintext := AES_Decrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder)</text><path d="M3243,6214.6191 L3310.1851,6214.6191 L3310.1851,6221.9297 L3300.1851,6231.9297 L3243,6231.9297 L3243,6214.6191" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="145.1738" style="stroke:#000000;stroke-width:1.5;" width="926.2842" x="3243" y="6214.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.1851" x="3258" y="6228.1875">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="839.0991" x="3325.1851" y="6227.2539">[SEARCH AND RESCUE [duress_placeholder_plaintext != padding(False) and (boomlet_identity_pubkey, duress_placeholder.iv) not previously saved]]</text><polygon fill="#FFC0CB" points="3425,6236.9297,3886,6236.9297,3896,6247.9297,3886,6259.9297,3425,6259.9297,3415,6247.9297,3425,6236.9297" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.2661" x="3427" y="6253.498">Assert SHA256(duress_placeholder_plaintext) == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3263,6270.2402,4046,6270.2402,4056,6312.2402,4046,6354.2402,3263,6354.2402,3253,6312.2402,3263,6270.2402" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.4048" x="3265" y="6286.8086">doxing_key := duress_placeholder_plaintext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.9932" x="3269.1133" y="6302.1191">static_doxing_data := AES_decrypt(private_key: doxing_key, content: static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="767.6475" x="3273.2266" y="6317.4297">dynamic_doxing_data := AES_decrypt(private_key: doxing_key, content: dynamic_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="558.4668" x="3269.1133" y="6332.7402">save(boomlet_0_identity_pubkey, duress_placeholder.iv) (nonce of encryption algorithm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.6416" x="3269.1133" y="6348.0508">Enter SEARCH_AND_RESCUE_MODE</text><polygon fill="#E6E6FA" points="3065,6371.793,4245,6371.793,4255,6413.793,4245,6455.793,3065,6455.793,3055,6413.793,3065,6371.793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.6191" x="3067" y="6388.3613">duress_placeholder_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.6299" x="3071.1133" y="6403.6719">signature: schnorr_sign(sar_privkey, duress_placeholder)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.1152" x="3071.1133" y="6418.9824">content: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="3067" y="6434.293">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1172.0947" x="3071.1133" y="6449.6035">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 := AES_encrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,6493.9668,2804.3833,6497.9668,2814.3833,6501.9668,2810.3833,6497.9668" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3655.4355" cy="6497.2168" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3650.9355" y1="6497.9668" y2="6497.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="6485.5693">[37]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9131" x="2851.1704" y="6477.9141">WithdrawalSarsWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="2855.2837" y="6493.2246">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2299,6510.9668,3306,6510.9668,3316,6552.9668,3306,6594.9668,2299,6594.9668,2289,6552.9668,2299,6510.9668" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="999.5464" x="2301" y="6527.5352">WT receives duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 from SAR and continue processing peer_0_tx_commit_signed_by_boomlet_0.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="958.7437" x="2305.1133" y="6542.8457">It verifies boomlet_0_identity_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0, checks the magic to match "commit", tx_id to be the one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="975.8823" x="2305.1133" y="6558.1563">expected and for the event_block_height to be fresh. WT then signs peer_0_tx_commit_signed_by_boomlet_0 with wt_privkey and sends it to non-initiator</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="932.2549" x="2305.1133" y="6573.4668">peers. WT receives each peer i's peer_i_tx_commit_signed_by_boomlet_i in response and checks it's correctness in a similar manner. WT then sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="910.6221" x="2305.1133" y="6588.7773">the collection of peer_i_tx_commit_signed_by_boomlet_i to Niso alongside duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0.</text><polygon fill="#FFC0CB" points="2449,6605.5195,3156,6605.5195,3166,6616.5195,3156,6628.5195,2449,6628.5195,2439,6616.5195,2449,6605.5195" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.5679" x="2451" y="6622.0879">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_commit_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2576,6638.8301,3030,6638.8301,3040,6649.8301,3030,6661.8301,2576,6661.8301,2566,6649.8301,2576,6638.8301" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="450.0234" x="2578" y="6655.3984">peer_0_tx_commit := peer_0_tx_commit_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2657,6672.1406,2948,6672.1406,2958,6683.1406,2948,6695.1406,2657,6695.1406,2647,6683.1406,2657,6672.1406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.936" x="2659" y="6688.709">Assert peer_0_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="2673,6705.4512,2932,6705.4512,2942,6716.4512,2932,6728.4512,2673,6728.4512,2663,6716.4512,2673,6705.4512" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.3979" x="2675" y="6722.0195">Assert peer_0_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="2181,6738.7617,3425,6738.7617,3435,6764.7617,3425,6791.7617,2181,6791.7617,2171,6764.7617,2181,6738.7617" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="2183" y="6755.3301">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1231.9785" x="2187.1133" y="6770.6406">Assert peer_0_tx_commit.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_SAR_RESPONSE_BY_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520.3682" x="2187.1133" y="6785.9512">Assert peer_0_tx_commit.event_block_height &lt;= most_work_bitcoin_block_height</text><polygon fill="#E6E6FA" points="2546,6802.6934,3059,6802.6934,3069,6836.6934,3059,6871.6934,2546,6871.6934,2536,6836.6934,2546,6802.6934" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="509.6406" x="2548" y="6819.2617">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="491.6514" x="2552.1133" y="6834.5723">signature: schnorr_sign(wt_privkey, peer_0_tx_commit_signed_by_boomlet_0)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.3833" x="2552.1133" y="6849.8828">content: peer_0_tx_commit_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2548" y="6865.1934">}</text><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2802.8833" cy="6912.8066" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3589.2397,6909.5566,3599.2397,6913.5566,3589.2397,6917.5566,3593.2397,6913.5566" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3595.2397" y1="6913.5566" y2="6913.5566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="6901.1592">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2841.1704" y="6893.5039">WithdrawalWtNonInitiatorNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.7461" x="2845.2837" y="6908.8145">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,6954.1777,2804.3833,6958.1777,2814.3833,6962.1777,2810.3833,6958.1777" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3600.7397" cy="6957.4277" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3596.2397" y1="6958.1777" y2="6958.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="6945.7803">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2851.1704" y="6938.125">WithdrawalNonInitiatorNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="738.9561" x="2855.2837" y="6953.4355">peer_i_tx_commit_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2802.8833" cy="7017.3594" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3589.2397,7014.1094,3599.2397,7018.1094,3589.2397,7022.1094,3593.2397,7018.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3595.2397" y1="7018.1094" y2="7018.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="6998.0566">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="481.6982" x="2841.1704" y="6982.7461">WithdrawalWtNonInitiatorNisoMessage4 [=WithdrawalWtNisoMessage2]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.1152" x="2845.2837" y="6998.0566">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="517.9243" x="2845.2837" y="7013.3672">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2089.2329,7074.041,2079.2329,7078.041,2089.2329,7082.041,2085.2329,7078.041" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2802.8833" cy="7077.291" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2083.2329" x2="2798.3833" y1="7078.041" y2="7078.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2095.2329" y="7057.9883">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="481.6982" x="2126.02" y="7042.6777">WithdrawalWtNisoMessage2 [=WithdrawalWtNonInitiatorNisoMessage4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.1152" x="2130.1333" y="7057.9883">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="2130.1333" y="7073.2988">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1548,7091.041,2607,7091.041,2617,7133.041,2607,7175.041,1548,7175.041,1538,7133.041,1548,7091.041" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1051.6479" x="1550" y="7107.6094">Niso receives {Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4], duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="835.2944" x="1554.1133" y="7122.9199">from WT. It then verifies wt_pubkey's signature on peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt, each non-initiator peer i's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="937.1489" x="1554.1133" y="7138.2305">boomlet_i_identity_pubkey's signature on peer_i_tx_commit_signed_by_boomlet_i, peer_i_tx_commit's magic to match "commit", tx_id to be the one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="962.8569" x="1554.1133" y="7153.541">expected and for the event_block_height to be fresh. It then forwards Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [1 &lt;= i &lt;= 4],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="917.1602" x="1554.1133" y="7168.8516">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 and the latest block height it sees as niso_0_event_block_height to Boomlet.</text><polygon fill="#FFC0CB" points="1690,7185.5938,2464,7185.5938,2474,7196.5938,2464,7208.5938,1690,7208.5938,1680,7196.5938,1690,7185.5938" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="770.5166" x="1692" y="7202.1621">Assert schnorr_verify(wt_pubkey, peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1697,7218.9043,2458,7218.9043,2468,7229.9043,2458,7241.9043,1697,7241.9043,1687,7229.9043,1697,7218.9043" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="757.396" x="1699" y="7235.4727">peer_i_tx_commit_signed_by_boomlet_i := peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.content [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1685,7252.2148,2469,7252.2148,2479,7263.2148,2469,7275.2148,1685,7275.2148,1675,7263.2148,1685,7252.2148" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="780.7363" x="1687" y="7268.7832">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_commit_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1810,7285.5254,2345,7285.5254,2355,7304.5254,2345,7323.5254,1810,7323.5254,1800,7304.5254,1810,7285.5254" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="527.1919" x="1812" y="7302.0938">peer_i_tx_commit := peer_i_tx_commit_signed_by_boomlet_i.content [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="1816.1133" y="7317.4043">niso_0_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1889,7334.1465,2267,7334.1465,2277,7345.1465,2267,7357.1465,1889,7357.1465,1879,7345.1465,1889,7334.1465" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.0293" x="1891" y="7350.7148">Assert peer_i_tx_commit.magic == "commit" [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1905,7367.457,2250,7367.457,2260,7378.457,2250,7390.457,1905,7390.457,1895,7378.457,1905,7367.457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.4912" x="1907" y="7384.0254">Assert peer_i_tx_commit.tx_id == tx_id [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1253,7400.7676,2902,7400.7676,2912,7426.7676,2902,7453.7676,1253,7453.7676,1243,7426.7676,1253,7400.7676" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1255" y="7417.3359">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1494.7334" x="1259.1133" y="7432.6465">Assert peer_i_tx_commit.event_block_height &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_AND_NON_INITIATOR_PEERS_TO_RECEIVING_TX_COMMITMENT_BY_ALL_PEERS) [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1641.7515" x="1259.1133" y="7447.957">Assert peer_i_tx_commit.event_block_height &lt;= (niso_0_event_block_height-REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_COMMITMENT_AND_RECEIVING_ALL_NON_INITIATOR_TX_COMMITMENT_BY_INITIATOR_PEER) [0 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,7522.9414,1354.0825,7526.9414,1364.0825,7530.9414,1360.0825,7526.9414" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="7526.1914" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="7526.9414" y2="7526.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="7499.2334">[45]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="7476.2676">WithdrawalNisoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.1152" x="1404.9829" y="7491.5781">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="1404.9829" y="7506.8887">niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="1404.9829" y="7522.1992">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="823,7539.9414,1882,7539.9414,1892,7619.9414,1882,7700.9414,823,7700.9414,813,7619.9414,823,7539.9414" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="812.2651" x="825" y="7556.5098">Boomlet receives {Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4], niso_0_event_block_height,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1046.811" x="829.1133" y="7571.8203">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0} from Niso. It first decrypts duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="935.3716" x="829.1133" y="7587.1309">verifies sar_pubkey's signature on duress_placeholder_signed_by_sar and checks to see if the content matches of the duress_placeholder that it had</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1031.5513" x="829.1133" y="7602.4414">sent to WT. It then verifies wt_pubkey's signature on peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt, each non-initiator peer i's boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1015.7012" x="829.1133" y="7617.752">signature on peer_i_tx_commit_signed_by_boomlet_i, peer_i_tx_commit's magic to match "commit", tx_id to be the one expected and for the event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="919.6738" x="829.1133" y="7633.0625">to be fresh according to niso_0_event_block_height. After that Boomlet initializes counter with 0, reached_boomlets_collection with an empty set,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="928.2051" x="829.1133" y="7648.373">ping_seq_num with 0, reached_mystery_flag with 0, sets last_seen_block to niso_0_event_block_height. Boomlet then constructs Ping composed of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="911.5869" x="829.1133" y="7663.6836">{"ping", tx_id, last_seen_block, ping_seq_num, reached_mystery_flag}, signs it with boomlet_0_identity_privkey, pads it with duress_placeholder,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="816.5815" x="829.1133" y="7678.9941">signs peer_0_ping_signed_by_boomlet_0_padded with boomlet_0_identity_privkey, encrypts the result with wt_pubkey and sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.6528" x="829.1133" y="7694.3047">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt to Niso.</text><polygon fill="#E6E6FA" points="706,7711.0469,1998,7711.0469,2008,7722.0469,1998,7734.0469,706,7734.0469,696,7722.0469,706,7711.0469" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1288.3584" x="708" y="7727.6152">duress_placeholder_signed_by_sar_encrypted_by_sar := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1012,7744.3574,1692,7744.3574,1702,7755.3574,1692,7767.3574,1012,7767.3574,1002,7755.3574,1012,7744.3574" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.2603" x="1014" y="7760.9258">Assert schnorr_verify(sar_pubkey, duress_placeholder_signed_by_sar_encrypted_by_sar.signature) == True</text><polygon fill="#FFC0CB" points="1210,7777.668,1494,7777.668,1504,7796.668,1494,7815.668,1210,7815.668,1200,7796.668,1210,7777.668" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1212" y="7794.2363">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.3516" x="1216.1133" y="7809.5469">check if duress_placeholder is the one sent.</text><polygon fill="#FFC0CB" points="965,7826.2891,1739,7826.2891,1749,7837.2891,1739,7849.2891,965,7849.2891,955,7837.2891,965,7826.2891" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="770.5166" x="967" y="7842.8574">Assert schnorr_verify(wt_pubkey, peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="972,7859.5996,1733,7859.5996,1743,7870.5996,1733,7882.5996,972,7882.5996,962,7870.5996,972,7859.5996" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="757.396" x="974" y="7876.168">peer_i_tx_commit_signed_by_boomlet_i := peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.content [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="960,7892.9102,1744,7892.9102,1754,7903.9102,1744,7915.9102,960,7915.9102,950,7903.9102,960,7892.9102" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="780.7363" x="962" y="7909.4785">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_commit_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1087,7926.2207,1618,7926.2207,1628,7937.2207,1618,7949.2207,1087,7949.2207,1077,7937.2207,1087,7926.2207" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="527.1919" x="1089" y="7942.7891">peer_i_tx_commit := peer_i_tx_commit_signed_by_boomlet_i.content [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1164,7959.5313,1542,7959.5313,1552,7970.5313,1542,7982.5313,1164,7982.5313,1154,7970.5313,1164,7959.5313" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.0293" x="1166" y="7976.0996">Assert peer_i_tx_commit.magic == "commit" [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1180,7992.8418,1525,7992.8418,1535,8003.8418,1525,8015.8418,1180,8015.8418,1170,8003.8418,1180,7992.8418" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.4912" x="1182" y="8009.4102">Assert peer_i_tx_commit.tx_id == tx_id [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="528,8026.1523,2177,8026.1523,2187,8052.1523,2177,8079.1523,528,8079.1523,518,8052.1523,528,8026.1523" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="530" y="8042.7207">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1494.7334" x="534.1133" y="8058.0313">Assert peer_i_tx_commit.event_block_height &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_AND_NON_INITIATOR_PEERS_TO_RECEIVING_TX_COMMITMENT_BY_ALL_PEERS) [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1641.7515" x="534.1133" y="8073.3418">Assert peer_i_tx_commit.event_block_height &lt;= (niso_0_event_block_height-REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_COMMITMENT_AND_RECEIVING_ALL_NON_INITIATOR_TX_COMMITMENT_BY_INITIATOR_PEER) [0 &lt;= i &lt;= 4]</text><path d="M9,8099.084 L162.8306,8099.084 L162.8306,8106.3945 L152.8306,8116.3945 L9,8116.3945 L9,8099.084" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="5088.5996" style="stroke:#000000;stroke-width:1.5;" width="4266.208" x="9" y="8099.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108.8306" x="24" y="8112.6523">Ping Pong Game</text><polygon fill="#E6E6FA" points="1203,8121.3945,1502,8121.3945,1512,8140.3945,1502,8159.3945,1203,8159.3945,1193,8140.3945,1203,8121.3945" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.0981" x="1205" y="8137.9629">counter := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.5986" x="1209.1133" y="8153.2734">reached_boomlets_collection: Collection.new()</text><polygon fill="#E6E6FA" points="1201,8170.0156,1503,8170.0156,1513,8250.0156,1503,8331.0156,1201,8331.0156,1191,8250.0156,1201,8170.0156" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.332" x="1203" y="8186.584">ping_seq_num := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.3813" x="1207.1133" y="8201.8945">reached_mystery_flag := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.5513" x="1207.1133" y="8217.2051">last_seen_block := niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.8394" x="1207.1133" y="8232.5156">_peer_0_ping := Ping{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.0039" x="1207.1133" y="8247.8262">magic: "ping",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="1207.1133" y="8263.1367">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.917" x="1207.1133" y="8278.4473">last_seen_block: last_seen_block,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.2158" x="1207.1133" y="8293.7578">ping_seq_num: ping_seq_num,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.2012" x="1207.1133" y="8309.0684">reached_mystery_flag: reached_mystery_flag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1203" y="8324.3789">}</text><polygon fill="#E6E6FA" points="618,8341.1211,2086,8341.1211,2096,8444.1211,2086,8548.1211,618,8548.1211,608,8444.1211,618,8341.1211" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386.0454" x="620" y="8357.6895">_peer_0_ping_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.1943" x="624.1133" y="8373">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.7944" x="624.1133" y="8388.3105">content: _peer_0_ping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="620" y="8403.6211">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.0781" x="624.1133" y="8418.9316">_peer_0_ping_signed_by_boomlet_0_padded := PaddedMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.2378" x="624.1133" y="8434.2422">content: _peer_0_ping_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0254" x="624.1133" y="8449.5527">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="620" y="8464.8633">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="583.0259" x="624.1133" y="8480.1738">_peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="623.1748" x="624.1133" y="8495.4844">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping_signed_by_boomlet_0_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.7749" x="624.1133" y="8510.7949">content: _peer_0_ping_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="620" y="8526.1055">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1460.0942" x="624.1133" y="8541.416">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(ECDH(boomlet_0_identity_privkey, wt_pubkey), _peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="8589.0293" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,8585.7793,2076.2329,8589.7793,2066.2329,8593.7793,2070.2329,8589.7793" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="8589.7793" y2="8589.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="8577.3818">[46]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="8569.7266">WithdrawalBoomletNisoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="627.4912" x="1394.9829" y="8585.0371">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="1601,8602.7793,2553,8602.7793,2563,8613.7793,2553,8625.7793,1601,8625.7793,1591,8613.7793,1601,8602.7793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="948.7334" x="1603" y="8619.3477">Niso receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2077.7329" cy="8666.9609" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2791.3833,8663.7109,2801.3833,8667.7109,2791.3833,8671.7109,2795.3833,8667.7109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2082.2329" x2="2797.3833" y1="8667.7109" y2="8667.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2085.2329" y="8655.3135">[47]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2116.02" y="8647.6582">WithdrawalNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="627.4912" x="2120.1333" y="8662.9688">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,8708.332,2804.3833,8712.332,2814.3833,8716.332,2810.3833,8712.332" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3600.7397" cy="8711.582" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3596.2397" y1="8712.332" y2="8712.332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="8699.9346">[47]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="481.6982" x="2851.1704" y="8692.2793">WithdrawalNonInitiatorNisoWtMessage4 [=WithdrawalNisoWtMessage3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="700.1973" x="2855.2837" y="8707.5898">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><polygon fill="#E6E6FA" points="2660,8725.332,2946,8725.332,2956,8736.332,2946,8748.332,2660,8748.332,2650,8736.332,2660,8725.332" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.0073" x="2662" y="8741.9004">reached_pings_collection := Collection.new()</text><path d="M19,8760.6426 L93.4468,8760.6426 L93.4468,8767.9531 L83.4468,8777.9531 L19,8777.9531 L19,8760.6426" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="4219.5566" style="stroke:#000000;stroke-width:1.5;" width="4246.208" x="19" y="8760.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="34" y="8774.2109">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="732.8213" x="108.4468" y="8773.2773">[PING_PONG_LOOP until WT has Collection&lt;peer_i_id, peer_i_reached_ping_signed_by_boomlet_i&gt; for every peer_i_id in peer_ids]</text><polygon fill="#FFF0F5" points="2316,8782.9531,3289,8782.9531,3299,8824.9531,3289,8866.9531,2316,8866.9531,2306,8824.9531,2316,8782.9531" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="804.0703" x="2318" y="8799.5215">WT receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Niso (and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="914.6401" x="2322.1133" y="8814.832">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt from Peers). If this is the first ping received, WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="909.3081" x="2322.1133" y="8830.1426">initializes reached_pings_collection with an empty set and goes into a loop that ends when reached_pings_collection[peer_i_id] has a valid value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961.2637" x="2322.1133" y="8845.4531">for every peer. WT decrypts peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i and verifies boomlet_i_identity_pubkey's signature. Wt then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="937.8853" x="2322.1133" y="8860.7637">separates duress_placeholder, which is the padding, and peer_i_ping and sends duress_placeholder and boomlet_0_identity_pubkey to peer 0's SAR.</text><path d="M2569,8877.5059 L2569,8917.5059 L3035,8917.5059 L3035,8887.5059 L3025,8877.5059 L2569,8877.5059" fill="#E6E6FA" style="stroke:#181818;stroke-width:0.5;"/><path d="M3025,8877.5059 L3025,8887.5059 L3035,8887.5059 L3025,8877.5059" fill="#E6E6FA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437.5757" x="2575" y="8895.0742">if for peer_i_id in peer_ids reached_pings_collection[peer_i_id] exists:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.2759" x="2579.1133" y="8910.3848">break PING_PONG_LOOP.</text><polygon fill="#E6E6FA" points="2092,8928.127,3514,8928.127,3524,8939.127,3514,8951.127,2092,8951.127,2082,8939.127,2092,8928.127" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1418.0093" x="2094" y="8944.6953">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i := AES_decrypt(ECDH(wt_privkey, boomlet_i_identity_pubkey), peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt)</text><polygon fill="#FFC0CB" points="2379,8961.4375,3226,8961.4375,3236,8972.4375,3226,8984.4375,2379,8984.4375,2369,8972.4375,2379,8961.4375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="843.9399" x="2381" y="8978.0059">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i.signature) == True</text><polygon fill="#E6E6FA" points="2427,8994.748,3179,8994.748,3189,9020.748,3179,9047.748,2427,9047.748,2417,9020.748,2427,8994.748" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="744.1548" x="2429" y="9011.3164">peer_i_ping_signed_by_boomlet_i_padded := peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="465.9624" x="2433.1133" y="9026.627">duress_placeholder := peer_i_ping_signed_by_boomlet_i_padded.padding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="551.6367" x="2433.1133" y="9041.9375">peer_i_ping_signed_by_boomlet_i := peer_i_ping_signed_by_boomlet_i_padded.content</text><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="2802.8833" cy="9104.8613" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3643.9355,9101.6113,3653.9355,9105.6113,3643.9355,9109.6113,3647.9355,9105.6113" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3649.9355" y1="9105.6113" y2="9105.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="9085.5586">[48]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9131" x="2841.1704" y="9070.248">WithdrawalWtSarsMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="2845.2837" y="9085.5586">duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="2845.2837" y="9100.8691">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3111,9118.6113,4200,9118.6113,4210,9175.6113,4200,9233.6113,3111,9233.6113,3101,9175.6113,3111,9118.6113" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="973.5972" x="3113" y="9135.1797">SAR receives {duress_placeholder, boomlet_0_identity_pubkey} from WT. It decrypts duress_placeholder using boomlet_0_identity_pubkey and sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="881.1753" x="3117.1133" y="9150.4902">to get duress_placeholder_plaintext. It checks to see if it's a padding of False or a duress signal, if it was a duress signal and the pair of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="867.9658" x="3117.1133" y="9165.8008">received boomlet_0_identity_pubkey and AES iv of duress_placeholder was not previously received, It calculates doxing_data_identifier by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.3267" x="3117.1133" y="9181.1113">hashing duress_placeholder, uses it to find which doxing_data is associated with this user and then uses duress_placeholder which is equal to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="946.9814" x="3117.1133" y="9196.4219">doxing_key to decrypt the associated static_doxing_data_encrypted_by_doxing_key and dynamic_doxing_data_encrypted_by_doxing_key. It then uses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="889.167" x="3117.1133" y="9211.7324">this doxing_data to enter SEARCH AND RESCUE. Regardless of if the duress_placeholder is a false signal or not SAR signs duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1080.9551" x="3117.1133" y="9227.043">with the doxing_key and encrypts it with boomlet_0_identity_pubkey. It then responds to WT with the duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0.</text><polygon fill="#E6E6FA" points="3238,9243.7852,4072,9243.7852,4082,9254.7852,4072,9266.7852,3238,9266.7852,3228,9254.7852,3238,9243.7852" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830.8765" x="3240" y="9260.3535">duress_placeholder_plaintext := AES_Decrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder)</text><path d="M3243,9279.0957 L3310.1851,9279.0957 L3310.1851,9286.4063 L3300.1851,9296.4063 L3243,9296.4063 L3243,9279.0957" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="145.1738" style="stroke:#000000;stroke-width:1.5;" width="926.2842" x="3243" y="9279.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.1851" x="3258" y="9292.6641">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="839.0991" x="3325.1851" y="9291.7305">[SEARCH AND RESCUE [duress_placeholder_plaintext != padding(False) and (boomlet_identity_pubkey, duress_placeholder.iv) not previously saved]]</text><polygon fill="#FFC0CB" points="3425,9301.4063,3886,9301.4063,3896,9312.4063,3886,9324.4063,3425,9324.4063,3415,9312.4063,3425,9301.4063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.2661" x="3427" y="9317.9746">Assert SHA256(duress_placeholder_plaintext) == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3263,9334.7168,4046,9334.7168,4056,9376.7168,4046,9418.7168,3263,9418.7168,3253,9376.7168,3263,9334.7168" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.4048" x="3265" y="9351.2852">doxing_key := duress_placeholder_plaintext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.9932" x="3269.1133" y="9366.5957">static_doxing_data := AES_decrypt(private_key: doxing_key, content: static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="767.6475" x="3273.2266" y="9381.9063">dynamic_doxing_data := AES_decrypt(private_key: doxing_key, content: dynamic_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="558.4668" x="3269.1133" y="9397.2168">save(boomlet_0_identity_pubkey, duress_placeholder.iv) (nonce of encryption algorithm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.6416" x="3269.1133" y="9412.5273">Enter SEARCH_AND_RESCUE_MODE</text><polygon fill="#E6E6FA" points="3065,9436.2695,4245,9436.2695,4255,9478.2695,4245,9520.2695,3065,9520.2695,3055,9478.2695,3065,9436.2695" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.6191" x="3067" y="9452.8379">duress_placeholder_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.6299" x="3071.1133" y="9468.1484">signature: schnorr_sign(sar_privkey, duress_placeholder)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.1152" x="3071.1133" y="9483.459">content: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="3067" y="9498.7695">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1172.0947" x="3071.1133" y="9514.0801">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 := AES_encrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,9558.4434,2804.3833,9562.4434,2814.3833,9566.4434,2810.3833,9562.4434" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3655.4355" cy="9561.6934" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3650.9355" y1="9562.4434" y2="9562.4434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="9550.0459">[49]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9131" x="2851.1704" y="9542.3906">WithdrawalSarsWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="2855.2837" y="9557.7012">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2210,9575.4434,3394,9575.4434,3404,9655.4434,3394,9736.4434,2210,9736.4434,2200,9655.4434,2210,9575.4434" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1180.9688" x="2212" y="9592.0117">WT receives duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 from SAR and continue processing peer_0_ping_signed_by_boomlet_0(peer_i_ping_signed_by_boomlet_i).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="883.1938" x="2216.1133" y="9607.3223">It verifies boomlet_i_identity_pubkey's signature on peer_i_ping_signed_by_boomlet_i, checks the magic to match "ping" and tx_id to be the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="846.187" x="2216.1133" y="9622.6328">one expected. If this is not the first ping It also checks that the ping_seq_num has been increased. Using ping's event_block_height, it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.8125" x="2216.1133" y="9637.9434">checks that the ping is fresh and if it's the first ping received it checks that the reached_mystery_flag is not 1. If the mystery_flag is 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.7397" x="2216.1133" y="9653.2539">WT assigns peer_i_ping_signed_by_boomlet_i to reached_pings_collection[peer_i_id]. WT constructs pong composed of {"pong", tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="920.9751" x="2216.1133" y="9668.5645">most_work_bitcoin_block_height, Collection&lt;peer_j_ping_signed_by_boomlet_j&gt; [for each Peer i's pong include peer_j_ping_signed_by_boomlet_j</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="838.8428" x="2216.1133" y="9683.875">of all other peers (i != j)] }, if it isn't the first pong composed WT waits for at least 1 block to pass. WT signs the pong and encrypts it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="900.7959" x="2216.1133" y="9699.1855">for Boomlet to get pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i. It then sends pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1007.4429" x="2216.1133" y="9714.4961">alongside duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 to Niso and pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.2788" x="2216.1133" y="9729.8066">to other peers.</text><polygon fill="#FFC0CB" points="2475,9746.5488,3130,9746.5488,3140,9757.5488,3130,9769.5488,2475,9769.5488,2465,9757.5488,2475,9746.5488" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="651.4219" x="2477" y="9763.1172">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_ping_signed_by_boomlet_i.signature) == True</text><polygon fill="#E6E6FA" points="2621,9779.8594,2984,9779.8594,2994,9790.8594,2984,9802.8594,2621,9802.8594,2611,9790.8594,2621,9779.8594" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.1187" x="2623" y="9796.4277">peer_i_ping := peer_i_ping_signed_by_boomlet_i.content</text><polygon fill="#FFC0CB" points="2686,9813.1699,2919,9813.1699,2929,9824.1699,2919,9836.1699,2686,9836.1699,2676,9824.1699,2686,9813.1699" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.4043" x="2688" y="9829.7383">Assert peer_i_ping.magic == "ping".</text><polygon fill="#FFC0CB" points="2693,9846.4805,2913,9846.4805,2923,9857.4805,2913,9869.4805,2693,9869.4805,2683,9857.4805,2693,9846.4805" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.29" x="2695" y="9863.0488">Assert peer_i_ping.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="2633,9879.791,2973,9879.791,2983,9898.791,2973,9917.791,2633,9917.791,2623,9898.791,2633,9879.791" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.4458" x="2635" y="9896.3594">if not the first ping received from peer i:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.3252" x="2639.1133" y="9911.6699">check that peer_i_ping.ping_seq_num has increased.</text><polygon fill="#FFC0CB" points="2157,9928.4121,3449,9928.4121,3459,9954.4121,3449,9981.4121,2157,9981.4121,2147,9954.4121,2157,9928.4121" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="2159" y="9944.9805">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1280.1445" x="2163.1133" y="9960.291">Assert peer_i_ping.last_seen_block &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_TO_RECEIVING_ALL_PINGS_BY_WT_AND_HAVING_SAR_RESPONSE_BACK_TO_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="454.5049" x="2163.1133" y="9975.6016">Assert peer_i_ping.last_seen_block &lt;= most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="2653,9992.3438,2953,9992.3438,2963,10011.3438,2953,10030.3438,2653,10030.3438,2643,10011.3438,2653,9992.3438" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.8037" x="2655" y="10008.9121">if the first ping received from peer_i:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.2271" x="2659.1133" y="10024.2227">Assert peer_i_ping.reached_mystery_flag != 1.</text><polygon fill="#E6E6FA" points="2570,10040.9648,3036,10040.9648,3046,10059.9648,3036,10078.9648,2570,10078.9648,2560,10059.9648,2570,10040.9648" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.3379" x="2572" y="10057.5332">if peer_i_ping.reached_mystery_flag == 1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.9072" x="2576.1133" y="10072.8438">reached_pings_collection[peer_i_id] := peer_i_ping_signed_by_boomlet_i</text><polygon fill="#FFC0CB" points="1912,10089.5859,3694,10089.5859,3704,10100.5859,3694,10112.5859,1912,10112.5859,1902,10100.5859,1912,10089.5859" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1778.2324" x="1914" y="10106.1543">if not the first pong Assert most_work_bitcoin_block_height &gt;= (pong.event_block_height + REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PING_AND_PONG)  [wait until a block has passed since the last sent pong (in case there's no immediate need to send due to ancillary)]</text><polygon fill="#E6E6FA" points="2325,10122.8965,3280,10122.8965,3290,10187.8965,3280,10252.8965,2325,10252.8965,2315,10187.8965,2325,10122.8965" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.9634" x="2327" y="10139.4648">pong_i := Pong{magic: "pong"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.7764" x="2331.1133" y="10154.7754">tx_id: tx_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.1938" x="2331.1133" y="10170.0859">event_block_height := most_work_bitcoin_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="942.7856" x="2331.1133" y="10185.3965">prev_pings: Collection&lt;peer_j_ping_signed_by_boomlet_j&gt; [for each Peer i's pong include peer_j_ping_signed_by_boomlet_j of all other peers (i != j)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2327" y="10200.707">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="571.7842" x="2331.1133" y="10216.0176">pong_i_signed_by_wt := SignatureOnMessage{signature: schnorr_sign(wt_privkey, pong_i),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.8003" x="2331.1133" y="10231.3281">content: pong_i}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="931.125" x="2331.1133" y="10246.6387">pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i := AES_encrypt(privkey: ECDH(wt_privkey, boomlet_i_identity_pubkey), pong_i_signed_by_wt)</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2089.2329,10306.3125,2079.2329,10310.3125,2089.2329,10314.3125,2085.2329,10310.3125" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2802.8833" cy="10309.5625" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2083.2329" x2="2798.3833" y1="10310.3125" y2="10310.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2095.2329" y="10290.2598">[50]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2126.02" y="10274.9492">WithdrawalWtNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.2578" x="2130.1333" y="10290.2598">pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="2130.1333" y="10305.5703">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2802.8833" cy="10369.4941" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3589.2397,10366.2441,3599.2397,10370.2441,3589.2397,10374.2441,3593.2397,10370.2441" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3595.2397" y1="10370.2441" y2="10370.2441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="10350.1914">[50]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2841.1704" y="10334.8809">WithdrawalWtNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.333" x="2845.2837" y="10350.1914">pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.3687" x="2845.2837" y="10365.502">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i</text></g><polygon fill="#FFF0F5" points="1589,10383.2441,2566,10383.2441,2576,10402.2441,2566,10421.2441,1589,10421.2441,1579,10402.2441,1589,10383.2441" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="969.1221" x="1591" y="10399.8125">Niso receives {pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0, duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0} from WT and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.7407" x="1595.1133" y="10415.123">forwards them to Boomlet alongside the latest most_work_bitcoin_block_height as niso_0_event_block_height.</text><polygon fill="#E6E6FA" points="1877,10431.8652,2278,10431.8652,2288,10442.8652,2278,10454.8652,1877,10454.8652,1867,10442.8652,1877,10431.8652" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="1879" y="10448.4336">niso_0_event_block_height := most_work_bitcoin_block_height</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,10523.418,1354.0825,10527.418,1364.0825,10531.418,1360.0825,10527.418" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="10526.668" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="10527.418" y2="10527.418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="10499.71">[51]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="10476.7441">WithdrawalNisoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.2578" x="1404.9829" y="10492.0547">pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="1404.9829" y="10507.3652">niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="1404.9829" y="10522.6758">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="806,10540.418,1898,10540.418,1908,10620.418,1898,10701.418,806,10701.418,796,10620.418,806,10540.418" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1084.5796" x="808" y="10556.9863">Boomlet receives {pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0, niso_0_event_block_height, duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="825.1255" x="812.1133" y="10572.2969">from Niso. It first decrypts duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0, verifies sar_pubkey's signature on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="895.3813" x="812.1133" y="10587.6074">duress_placeholder_signed_by_sar and checks to see if the content matches of the duress_placeholder that it had sent to WT. It then decrypts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="975.7808" x="812.1133" y="10602.918">pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0 to get pong_0_signed_by_wt and verifies wt_pubkey's signature. Boomlet then checks the magic of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="857.0098" x="812.1133" y="10618.2285">pong_0 to match "pong", tx_id to match the expected value, pong to be fresh according to niso_0_event_block_height. It then takes out</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="894.5625" x="812.1133" y="10633.5391">prev_ping_i_signed_by_boomlet_i from pong_0 for every other peer i, verifies boomlet_i_identity_pubkey's signature, checks that the magic is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="638.79" x="812.1133" y="10648.8496">"ping", tx_id is the one expected, if it's not the first ping received the ping_seq_num has increased, if</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="883.689" x="812.1133" y="10664.1602">reached_boomlets_collection[peer_i_id] was previously assigned a value reached_mystery_flag is not 0. At this moment Boomlet generates a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1011.0229" x="812.1133" y="10679.4707">pseudorandom number which if modulo DURESS_CHECK_INTERVAL_IN_BLOCKS is 0 Boomlet enters into a duress_check to update duress_placeholder_plaintext.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280.541" x="812.1133" y="10694.7813">Otherwise it will continue with the old value.</text><polygon fill="#E6E6FA" points="706,10711.5234,1998,10711.5234,2008,10722.5234,1998,10734.5234,706,10734.5234,696,10722.5234,706,10711.5234" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1288.3584" x="708" y="10728.0918">duress_placeholder_signed_by_sar_encrypted_by_sar := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1012,10744.834,1692,10744.834,1702,10755.834,1692,10767.834,1012,10767.834,1002,10755.834,1012,10744.834" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.2603" x="1014" y="10761.4023">Assert schnorr_verify(sar_pubkey, duress_placeholder_signed_by_sar_encrypted_by_sar.signature) == True</text><polygon fill="#FFC0CB" points="1210,10778.1445,1494,10778.1445,1504,10797.1445,1494,10816.1445,1210,10816.1445,1200,10797.1445,1210,10778.1445" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1212" y="10794.7129">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.3516" x="1216.1133" y="10810.0234">check if duress_placeholder is the one sent.</text><polygon fill="#E6E6FA" points="848,10826.7656,1857,10826.7656,1867,10837.7656,1857,10849.7656,848,10849.7656,838,10837.7656,848,10826.7656" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1005.0625" x="850" y="10843.334">pong_0_signed_by_wt := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1112,10860.0762,1592,10860.0762,1602,10871.0762,1592,10883.0762,1112,10883.0762,1102,10871.0762,1112,10860.0762" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.5376" x="1114" y="10876.6445">Assert schnorr_verify(wt_pubkey, pong_0_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1120,10893.3867,1584,10893.3867,1594,10912.3867,1584,10931.3867,1120,10931.3867,1110,10912.3867,1120,10893.3867" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.9937" x="1122" y="10909.9551">pong_0 := pong_0_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="456.5425" x="1126.1133" y="10925.2656">prev_ping_i_signed_by_boomlet_i := pong_0.prev_pings[i] [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1249,10942.0078,1456,10942.0078,1466,10953.0078,1456,10965.0078,1249,10965.0078,1239,10953.0078,1249,10942.0078" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.7217" x="1251" y="10958.5762">Assert pong_0.magic == "pong"</text><polygon fill="#FFC0CB" points="1257,10975.3184,1447,10975.3184,1457,10986.3184,1447,10998.3184,1257,10998.3184,1247,10986.3184,1257,10975.3184" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.3799" x="1259" y="10991.8867">Assert pong_0.tx_id == tx_id</text><polygon fill="#FFC0CB" points="798,11008.6289,1907,11008.6289,1917,11034.6289,1907,11061.6289,798,11061.6289,788,11034.6289,798,11008.6289" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="800" y="11025.1973">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1097.6685" x="804.1133" y="11040.5078">Assert pong_0.event_block_height &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_CREATING_PONG_BY_WT_TO_REVIEWING_THE_PONG_IN_PEERS_BOOMLET)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="414.3496" x="804.1133" y="11055.8184">Assert pong_0.event_block_height &lt;= niso_0_event_block_height</text><polygon fill="#FFC0CB" points="980,11072.5605,1725,11072.5605,1735,11083.5605,1725,11095.5605,980,11095.5605,970,11083.5605,980,11072.5605" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="741.4634" x="982" y="11089.1289">Assert schnorr_verify(boomlet_i_identity_pubkey, prev_ping_i_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1126,11105.8711,1578,11105.8711,1588,11116.8711,1578,11128.8711,1126,11128.8711,1116,11116.8711,1126,11105.8711" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="448.646" x="1128" y="11122.4395">prev_ping_i := prev_ping_i_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1193,11139.1816,1512,11139.1816,1522,11150.1816,1512,11162.1816,1193,11162.1816,1183,11150.1816,1193,11139.1816" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.3325" x="1195" y="11155.75">Assert prev_ping_i.magic == "ping" [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1199,11172.4922,1505,11172.4922,1515,11183.4922,1505,11195.4922,1199,11195.4922,1189,11183.4922,1199,11172.4922" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.2183" x="1201" y="11189.0605">Assert prev_ping_i.tx_id == tx_id [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1007,11205.8027,1698,11205.8027,1708,11224.8027,1698,11243.8027,1007,11243.8027,997,11224.8027,1007,11205.8027" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1009" y="11222.3711">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="683.1348" x="1013.1133" y="11237.6816">if not the first ping received from peer_i Assert that peer_i_ping.ping_seq_num has increased. [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1194,11254.4238,1510,11254.4238,1520,11273.4238,1510,11292.4238,1194,11292.4238,1184,11273.4238,1194,11254.4238" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.0581" x="1196" y="11270.9922">if reached_boomlets_collection[peer_i_id] != Null</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.5996" x="1200.1133" y="11286.3027">Assert prev_ping_i.reached_mystery_flag != 0</text><path d="M29,11305.0449 L558.4087,11305.0449 L558.4087,11312.3555 L548.4087,11322.3555 L29,11322.3555 L29,11305.0449" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="960.3535" style="stroke:#000000;stroke-width:1.5;" width="2435.1045" x="29" y="11305.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="484.4087" x="44" y="11318.6133">duress_check [ if PRNG()%#DURESS_CHECK_INTERVAL_IN_BLOCKS == 0]:</text><polygon fill="#E6E6FA" points="736,11327.3555,1969,11327.3555,1979,11369.3555,1969,11411.3555,736,11411.3555,726,11369.3555,736,11327.3555" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9736" x="738" y="11343.9238">duress_check_space := DuressCheckSpace{space: rand([1..198;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.3994" x="742.1133" y="11359.2344">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1553" x="742.1133" y="11374.5449">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="742.1133" y="11389.8555">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.7197" x="742.1133" y="11405.166">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="11452.7793" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,11449.5293,2076.2329,11453.5293,2066.2329,11457.5293,2070.2329,11453.5293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="11453.5293" y2="11453.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="11441.1318">[52]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="11433.4766">WithdrawalBoomletNisoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1394.9829" y="11448.7871">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1711,11466.5293,2443,11466.5293,2453,11477.5293,2443,11489.5293,1711,11489.5293,1701,11477.5293,1711,11466.5293" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="728.5015" x="1713" y="11483.0977">Niso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1423.9814,11527.4609,1413.9814,11531.4609,1423.9814,11535.4609,1419.9814,11531.4609" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="11530.7109" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1417.9814" x2="2073.2329" y1="11531.4609" y2="11531.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1429.9814" y="11519.0635">[53]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.1328" x="1460.7686" y="11511.4082">WithdrawalNisoStMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1464.8818" y="11526.7188">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="865,11544.4609,1960,11544.4609,1970,11570.4609,1960,11597.4609,865,11597.4609,855,11570.4609,865,11544.4609" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1087.7852" x="867" y="11561.0293">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Niso, decrypts it to get duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="904.376" x="871.1133" y="11576.3398">assign a country to each of the numbers in the duress_check_space corresponding to its alphabetical rank and shows this array to User for him</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.1001" x="871.1133" y="11591.6504">to select 5 of them.</text><polygon fill="#E6E6FA" points="796,11608.3926,2029,11608.3926,2039,11627.3926,2029,11646.3926,796,11646.3926,786,11627.3926,796,11608.3926" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.834" x="798" y="11624.9609">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.6245" x="802.1133" y="11640.2715">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="521.1826,11684.6348,511.1826,11688.6348,521.1826,11692.6348,517.1826,11688.6348" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1412.4814" cy="11687.8848" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="515.1826" x2="1407.9814" y1="11688.6348" y2="11688.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="527.1826" y="11676.2373">[54]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.2349" x="557.9697" y="11668.582">WithdrawalStOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.1816" x="562.083" y="11683.8926">duress_check_space</text></g><polygon fill="#FFF0F5" points="49,11701.6348,970,11701.6348,980,11720.6348,970,11739.6348,49,11739.6348,39,11720.6348,49,11701.6348" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="913.1738" x="51" y="11718.2031">User receives duress_check_space from ST. If he is not being coerced he will select 1 country in each column to replicate the duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.25" x="55.1133" y="11733.5137">and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="509.6826" cy="11781.127" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1400.9814,11777.877,1410.9814,11781.877,1400.9814,11785.877,1404.9814,11781.877" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.1826" x2="1406.9814" y1="11781.877" y2="11781.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="517.1826" y="11769.4795">[55]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.5742" x="547.9697" y="11761.8242">WithdrawalStInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7847" x="552.083" y="11777.1348">duress_signal_index</text></g><polygon fill="#FFF0F5" points="880,11794.877,1945,11794.877,1955,11813.877,1945,11832.877,880,11832.877,870,11813.877,880,11794.877" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1061.0615" x="882" y="11811.4453">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the nonce from previously received duress_check_space_with_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.9248" x="886.1133" y="11826.7559">encrypts it for Boomlet and sends it to Iso.</text><polygon fill="#E6E6FA" points="795,11843.498,2030,11843.498,2040,11877.498,2030,11912.498,795,11912.498,785,11877.498,795,11843.498" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.0024" x="797" y="11860.0664">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.7583" x="801.1133" y="11875.377">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="801.1133" y="11890.6875">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1226.9258" x="801.1133" y="11905.998">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1412.4814" cy="11953.6113" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,11950.3613,2076.2329,11954.3613,2066.2329,11958.3613,2070.2329,11954.3613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1416.9814" x2="2072.2329" y1="11954.3613" y2="11954.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1419.9814" y="11941.9639">[56]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.1328" x="1450.7686" y="11934.3086">WithdrawalStNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1454.8818" y="11949.6191">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1711,11967.3613,2444,11967.3613,2454,11978.3613,2444,11990.3613,1711,11990.3613,1701,11978.3613,1711,11967.3613" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.1045" x="1713" y="11983.9297">Niso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,12028.293,1354.0825,12032.293,1364.0825,12036.293,1360.0825,12032.293" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="12031.543" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="12032.293" y2="12032.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="12019.8955">[57]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="12012.2402">WithdrawalNisoBoomletMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1404.9829" y="12027.5508">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="934,12045.293,1772,12045.293,1782,12087.293,1772,12129.293,934,12129.293,924,12087.293,934,12045.293" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830.0132" x="936" y="12061.8613">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Niso. Boomlet will search for the indices in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.1377" x="940.1133" y="12077.1719">duress_check_space assigning the resulting value to duress_signal.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.7466" x="940.1133" y="12092.4824">If the duress_signal is composed of the same set of numbers as the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="766.9937" x="940.1133" y="12107.793">duress_consent_set, duress_placeholder_plaintext will be assigned an empty padding otherwise it will be the doxing_key.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.0933" x="940.1133" y="12123.1035">duress_placeholder_plaintext will be encrypted to make up duress_placeholder.</text><polygon fill="#E6E6FA" points="737,12139.8457,1968,12139.8457,1978,12150.8457,1968,12162.8457,737,12162.8457,727,12150.8457,737,12139.8457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1227.04" x="739" y="12156.4141">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1065,12173.1563,1640,12173.1563,1650,12192.1563,1640,12211.1563,1065,12211.1563,1055,12192.1563,1065,12173.1563" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1067" y="12189.7246">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="567.3472" x="1071.1133" y="12205.0352">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="940,12221.7773,1765,12221.7773,1775,12240.7773,1765,12259.7773,940,12259.7773,930,12240.7773,940,12221.7773" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="501.7441" x="942" y="12238.3457">duress_signal := duress_check_space[duress_signal_index_with_nonce.content]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="817.083" x="946.1133" y="12253.6563">duress_placeholder_plaintext := Evaluate(duress_signal, duress_consent_set, doxing_key) [either padding of False or doxing_key]</text><polygon fill="#FFF0F5" points="856,12277.3984,1848,12277.3984,1858,12342.3984,1848,12407.3984,856,12407.3984,846,12342.3984,856,12277.3984" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="984.6484" x="858" y="12293.9668">Regardless of executing duress procedure, Boomlet encrypts duress_placeholder_plaintext with sar_pubkey to get duress_placeholder. It then checks to see</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="795.1201" x="862.1133" y="12309.2773">if the conditions for incrementing counter are met namely if block_heights of last_seen_block, niso_0_event_block_height and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="821.9834" x="862.1133" y="12324.5879">prev_ping.last_seen_block are within a certain boundary. If for any of the peer_i_ids not appeared in reached_boomlets_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="958.4897" x="862.1133" y="12339.8984">peer_i_prev_ping contain 1-valued reached_mystery_flag, Boomlet assigns peer_i_ping_signed_by_boomlet_i to reached_boomlets_collection[peer_i_id].</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="904.4712" x="862.1133" y="12355.209">If Boomlet's own counter has reached it's mystery it updates reached_mystery_flag value to 1. It then updates the last_seen_block by taking the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="930.0078" x="862.1133" y="12370.5195">minimum of the current niso_0_event_block_height and the last_seen_block + 10. Boomlet then regenerates ping with incremented ping_seq_num,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="834.7549" x="862.1133" y="12385.8301">signs it with peer_0_identity_pubkey, pads it with duress_placeholder, resigns it, encrypts it with wt_pubkey and sends the resulting</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.6528" x="862.1133" y="12401.1406">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt to Niso.</text><polygon fill="#E6E6FA" points="936,12417.8828,1769,12417.8828,1779,12428.8828,1769,12440.8828,936,12440.8828,926,12428.8828,936,12417.8828" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="829.207" x="938" y="12434.4512">duress_placeholder := AES_encrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_plaintext)</text><polygon fill="#E6E6FA" points="426,12451.1934,2279,12451.1934,2289,12477.1934,2279,12504.1934,426,12504.1934,416,12477.1934,426,12451.1934" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125.0425" x="428" y="12467.7617">Counter Increment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1841.0044" x="432.1133" y="12483.0723">if last_seen_block != niso_0_event_block_height &amp;&amp; prev_ping_i.last_seen_block &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_BY_OTHER_PEERS_TO_REVIEWING_THE_PING_IN_PEER_BOOMLET) &amp;&amp; prev_ping_i.last_seen_block &lt;= niso_0_event_block_height :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.3188" x="432.1133" y="12498.3828">counter += 1</text><polygon fill="#E6E6FA" points="1053,12515.125,1652,12515.125,1662,12534.125,1652,12553.125,1053,12553.125,1043,12534.125,1053,12515.125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="591.8809" x="1055" y="12531.6934">if reached_boomlets_collection[peer_i_id] == Null and prev_ping_i.reached_mystery_flag==1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="481.9458" x="1059.1133" y="12547.0039">reached_boomlets_collection[peer_i_id] := peer_i_ping_signed_by_boomlet_i</text><polygon fill="#E6E6FA" points="1265,12563.7461,1440,12563.7461,1450,12582.7461,1440,12601.7461,1265,12601.7461,1255,12582.7461,1265,12563.7461" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.6348" x="1267" y="12580.3145">if counter &gt;= mystery:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.3813" x="1271.1133" y="12595.625">reached_mystery_flag := 1</text><polygon fill="#E6E6FA" points="813,12612.3672,1891,12612.3672,1901,12638.3672,1891,12665.3672,813,12665.3672,803,12638.3672,813,12612.3672" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155.4795" x="815" y="12628.9355">last_seen_block update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.2021" x="819.1133" y="12644.2461">if last_seen_block &lt; niso_0_event_block_height:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1070.5449" x="819.1133" y="12659.5566">last_seen_block := min(niso_0_event_block_height, (last_seen_block + JUMP_IN_BLOCKS_IF_LAST_SEEN_BLOCK_LAGS_BEHIND_NISO_EVENT_BLOCK_HEIGHT_IN_BOOMLET))</text><polygon fill="#E6E6FA" points="618,12676.2988,2086,12676.2988,2096,12825.2988,2086,12974.2988,618,12974.2988,608,12825.2988,618,12676.2988" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.8394" x="620" y="12692.8672">_peer_0_ping := Ping{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.0039" x="624.1133" y="12708.1777">magic: "ping",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="624.1133" y="12723.4883">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.104" x="624.1133" y="12738.7988">last_seen_block: niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.6724" x="624.1133" y="12754.1094">ping_seq_num: (ping_seq_num += 1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.4287" x="624.1133" y="12769.4199">reached_mystery_flag: reached_mystery_flag}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386.0454" x="624.1133" y="12784.7305">_peer_0_ping_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.1943" x="624.1133" y="12800.041">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.7944" x="624.1133" y="12815.3516">content: _peer_0_ping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="620" y="12830.6621">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.0781" x="624.1133" y="12845.9727">_peer_0_ping_signed_by_boomlet_0_padded := PaddedMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.2378" x="624.1133" y="12861.2832">content: _peer_0_ping_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0254" x="624.1133" y="12876.5938">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="620" y="12891.9043">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="583.0259" x="624.1133" y="12907.2148">_peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="623.1748" x="624.1133" y="12922.5254">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping_signed_by_boomlet_0_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.7749" x="624.1133" y="12937.8359">content: _peer_0_ping_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="620" y="12953.1465">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1460.0942" x="624.1133" y="12968.457">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(ECDH(boomlet_0_identity_privkey, wt_pubkey), _peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="13023.0703" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,13019.8203,2076.2329,13023.8203,2066.2329,13027.8203,2070.2329,13023.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="13023.8203" y2="13023.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="13011.4229">[58]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="13003.7676">WithdrawalBoomletNisoMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="627.4912" x="1394.9829" y="13019.0781">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="1601,13036.8203,2553,13036.8203,2563,13047.8203,2553,13059.8203,1601,13059.8203,1591,13047.8203,1601,13036.8203" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="948.7334" x="1603" y="13053.3887">Niso receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2077.7329" cy="13101.002" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2791.3833,13097.752,2801.3833,13101.752,2791.3833,13105.752,2795.3833,13101.752" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2082.2329" x2="2797.3833" y1="13101.752" y2="13101.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2085.2329" y="13089.3545">[59]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2116.02" y="13081.6992">WithdrawalNisoWtMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="627.4912" x="2120.1333" y="13097.0098">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,13127.0625,2804.3833,13131.0625,2814.3833,13135.0625,2810.3833,13131.0625" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3600.7397" cy="13130.3125" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3596.2397" y1="13131.0625" y2="13131.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="13126.3203">[59]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="700.1973" x="2851.1704" y="13126.3203">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2294,13144.0625,3310,13144.0625,3320,13163.0625,3310,13182.0625,2294,13182.0625,2284,13163.0625,2294,13144.0625" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1008.8457" x="2296" y="13160.6309">WT receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and jumps back to the beginning</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="600.7739" x="2300.1133" y="13175.9414">of the PING_PONG_LOOP. if the loop breaks WT sends it's reached_pings_collection to all Peers.</text><path d="M27,13201.6836 L302.9785,13201.6836 L302.9785,13208.9941 L292.9785,13218.9941 L27,13218.9941 L27,13201.6836" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1818.9121" style="stroke:#000000;stroke-width:1.5;" width="3605.3413" x="27" y="13201.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="230.9785" x="42" y="13215.252">Transaction Finalization and Relay</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2089.2329,13251.6152,2079.2329,13255.6152,2089.2329,13259.6152,2085.2329,13255.6152" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2802.8833" cy="13254.8652" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2083.2329" x2="2798.3833" y1="13255.6152" y2="13255.6152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2095.2329" y="13243.2178">[60]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2126.02" y="13235.5625">WithdrawalWtNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.3677" x="2130.1333" y="13250.873">reached_pings_collection</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2802.8833" cy="13299.4863" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3589.2397,13296.2363,3599.2397,13300.2363,3589.2397,13304.2363,3593.2397,13300.2363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2807.3833" x2="3595.2397" y1="13300.2363" y2="13300.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2810.3833" y="13287.8389">[60]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2841.1704" y="13280.1836">WithdrawalWtNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.3677" x="2845.2837" y="13295.4941">reached_pings_collection</text></g><polygon fill="#FFF0F5" points="1598,13313.2363,2556,13313.2363,2566,13332.2363,2556,13351.2363,1598,13351.2363,1588,13332.2363,1598,13313.2363" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="950.7773" x="1600" y="13329.8047">Niso receives reached_pings_collection from WT. Niso checks the validity of each peer's peer_i_reached_ping_signed_by_boomlet_i. Niso then hydrates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.6938" x="1604.1133" y="13345.1152">psbt and sends reached_pings_collection along with hydrated_psbt to Boomlet.</text><polygon fill="#FFC0CB" points="1706,13361.8574,2450,13361.8574,2460,13372.8574,2450,13384.8574,1706,13384.8574,1696,13372.8574,1706,13361.8574" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="740.3779" x="1708" y="13378.4258">check the presence and validity of each peer's peer_i_reached_ping_signed_by_boomlet_i in reached_pings_collection</text><polygon fill="#E6E6FA" points="1960,13395.168,2195,13395.168,2205,13406.168,2195,13418.168,1960,13418.168,1950,13406.168,1960,13395.168" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.1626" x="1962" y="13411.7363">hydrated_psbt := hydrate_psbt(psbt)</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,13471.4102,1354.0825,13475.4102,1364.0825,13479.4102,1360.0825,13475.4102" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="13474.6602" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="13475.4102" y2="13475.4102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="13455.3574">[61]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="13440.0469">WithdrawalNisoBoomletMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.3677" x="1404.9829" y="13455.3574">reached_pings_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.1812" x="1404.9829" y="13470.668">hydrated_psbt</text></g><polygon fill="#FFF0F5" points="893,13488.4102,1811,13488.4102,1821,13514.4102,1811,13541.4102,893,13541.4102,883,13514.4102,893,13488.4102" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="743.5073" x="895" y="13504.9785">Boomlet receives {reached_pings_collection, hydrated_psbt} from Niso. Boomlet first checks the validity of each peer's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="906.458" x="899.1133" y="13520.2891">peer_i_reached_ping_signed_by_boomlet_i in reached_pings_collection. It then derives tx_id from hydrated_psbt and checks that it matches the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="479.521" x="899.1133" y="13535.5996">one committed to and if so, updates the saved psbt with the hydrated_psbt.</text><polygon fill="#FFC0CB" points="980,13552.3418,1724,13552.3418,1734,13563.3418,1724,13575.3418,980,13575.3418,970,13563.3418,980,13552.3418" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="740.3779" x="982" y="13568.9102">check the presence and validity of each peer's peer_i_reached_ping_signed_by_boomlet_i in reached_pings_collection</text><polygon fill="#FFC0CB" points="1207,13585.6523,1498,13585.6523,1508,13596.6523,1498,13608.6523,1207,13608.6523,1197,13596.6523,1207,13585.6523" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.041" x="1209" y="13602.2207">Assert hydrated_psbt.derive_tx_id() == tx_id.</text><polygon fill="#E6E6FA" points="1278,13618.9629,1426,13618.9629,1436,13629.9629,1426,13641.9629,1278,13641.9629,1268,13629.9629,1278,13618.9629" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.8218" x="1280" y="13635.5313">psbt := hydrated_psbt.</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="13683.1445" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,13679.8945,2076.2329,13683.8945,2066.2329,13687.8945,2070.2329,13683.8945" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="13683.8945" y2="13683.8945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="13671.4971">[62]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="13663.8418">WithdrawalBoomletNisoMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.7373" x="1394.9829" y="13679.1523">magic: "withdrawal_ready_to_sign"</text></g><polygon fill="#FFF0F5" points="1697,13696.8945,2458,13696.8945,2468,13707.8945,2458,13719.8945,1697,13719.8945,1687,13707.8945,1697,13696.8945" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="757.3579" x="1699" y="13713.4629">Niso receives {magic: "withdrawal_ready_to_sign"} from Boomlet and proceeds to inform User to connect Boomlet to Iso.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="521.1826,13757.8262,511.1826,13761.8262,521.1826,13765.8262,517.1826,13761.8262" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="13761.0762" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="515.1826" x2="2073.2329" y1="13761.8262" y2="13761.8262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="527.1826" y="13749.4287">[63]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160.4116" x="557.9697" y="13741.7734">WithdrawalNisoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435.5254" x="562.083" y="13757.084">magic: "withdrawal_ready_to_sign_received_connect_boomlet_to_iso"</text></g><polygon fill="#FFF0F5" points="47,13774.8262,972,13774.8262,982,13793.8262,972,13812.8262,47,13812.8262,37,13793.8262,47,13774.8262" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="916.9443" x="49" y="13791.3945">User receives {magic: "withdrawal_ready_to_sign_received_connect_boomlet_to_iso"} from Niso and proceeds to connect Boomlet to Iso and input</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.8066" x="53.1133" y="13806.7051">network, mnemonic and passphrase to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="509.6826" cy="13884.9395" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1001.4507,13881.6895,1011.4507,13885.6895,1001.4507,13889.6895,1005.4507,13885.6895" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.1826" x2="1007.4507" y1="13885.6895" y2="13885.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="517.1826" y="13857.9814">[64]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.8423" x="547.9697" y="13835.0156">WithdrawalIsoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.0923" x="552.083" y="13850.3262">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.0537" x="552.083" y="13865.6367">mnemonic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.2334" x="552.083" y="13880.9473">passphrase</text></g><polygon fill="#FFF0F5" points="573,13898.6895,1453,13898.6895,1463,13917.6895,1453,13936.6895,573,13936.6895,563,13917.6895,573,13898.6895" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="872.3013" x="575" y="13915.2578">Iso receives {network, mnemonic, passphrase} from User and proceeds to inform Boomlet that they can start the musig protocol for tx_ins</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3091" x="579.1133" y="13930.5684">contained in the psbt.</text><rect fill="#FEFFDD" height="38" style="stroke:#181818;stroke-width:0.5;" width="386" x="990" y="13947.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.8745" x="1007.4192" y="13963.8789">MUSIG2(psbt)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.2676" x="1011.5325" y="13979.1895">Iso and Boomlet sign every tx_in contained in the psbt.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1012.9507" cy="14026.8027" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1341.0825,14023.5527,1351.0825,14027.5527,1341.0825,14031.5527,1345.0825,14027.5527" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1017.4507" x2="1347.0825" y1="14027.5527" y2="14027.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1020.4507" y="14015.1553">[65]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216.0425" x="1051.2378" y="14007.5">WithdrawalIsoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280.7314" x="1055.3511" y="14022.8105">magic: "withdrawal_initialized_start_signing"</text></g><polygon fill="#FFF0F5" points="906,14040.5527,1798,14040.5527,1808,14059.5527,1798,14078.5527,906,14078.5527,896,14059.5527,906,14040.5527" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="835.0088" x="908" y="14057.1211">Boomlet receives {magic: "withdrawal_initialized_start_signing"} from Iso and proceeds to share with it the information necessary for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="884.7998" x="912.1133" y="14072.4316">signing i.e. psbt, boomerang_descriptor, boomlet_0_boom_musig2_pubkey_share, alongside his own public nonce named pubnonce_boom.</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1024.4507,14162.7266,1014.4507,14166.7266,1024.4507,14170.7266,1020.4507,14166.7266" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1352.5825" cy="14165.9766" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1018.4507" x2="1348.0825" y1="14166.7266" y2="14166.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1030.4507" y="14131.3633">[66]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216.0425" x="1061.2378" y="14100.7422">WithdrawalBoomletIsoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.8535" x="1065.3511" y="14116.0527">psbt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.8413" x="1065.3511" y="14131.3633">boomerang_descriptor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.5786" x="1065.3511" y="14146.6738">boomlet_0_boom_musig2_pubkey_share</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2441" x="1065.3511" y="14161.9844">pubnonce_boom</text></g><polygon fill="#FFF0F5" points="532,14179.7266,1493,14179.7266,1503,14198.7266,1493,14217.7266,532,14217.7266,522,14198.7266,532,14179.7266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="953.1323" x="534" y="14196.2949">Iso receives {psbt, boomerang_descriptor, boomlet_0_boom_musig2_pubkey_share, pubnonce_boom} from Boomlet. Iso then generates it's own public</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="641.4116" x="538.1133" y="14211.6055">nonce and sends this pubnonce_normal alongside his partialsignature (partialsig_normal) to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1012.9507" cy="14274.5293" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1341.0825,14271.2793,1351.0825,14275.2793,1341.0825,14279.2793,1345.0825,14275.2793" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1017.4507" x2="1347.0825" y1="14275.2793" y2="14275.2793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1020.4507" y="14255.2266">[67]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216.0425" x="1051.2378" y="14239.916">WithdrawalIsoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.4009" x="1055.3511" y="14255.2266">pubnonce_normal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6748" x="1055.3511" y="14270.5371">partialsig_normal</text></g><polygon fill="#FFF0F5" points="924,14288.2793,1780,14288.2793,1790,14307.2793,1780,14326.2793,924,14326.2793,914,14307.2793,924,14288.2793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.5039" x="926" y="14304.8477">Boomlet receives {pubnonce_normal, partialsig_normal} from Iso, proceeds to produce it's own partial signature and shares it with Iso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.5552" x="930.1133" y="14320.1582">Boomlet saves signed psbt on it's own memory.</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1024.4507,14364.5215,1014.4507,14368.5215,1024.4507,14372.5215,1020.4507,14368.5215" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1352.5825" cy="14367.7715" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1018.4507" x2="1348.0825" y1="14368.5215" y2="14368.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1030.4507" y="14356.124">[68]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="216.0425" x="1061.2378" y="14348.4688">WithdrawalBoomletIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.5181" x="1065.3511" y="14363.7793">partialsig_boom</text></g><polygon fill="#FFF0F5" points="615,14381.5215,1410,14381.5215,1420,14392.5215,1410,14404.5215,615,14404.5215,605,14392.5215,615,14381.5215" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.3623" x="617" y="14398.0898">Iso receives partialsig_boom from Boomlet. Iso also keeps signed psbt but informs User that he can connect Boomlet to Niso.</text><rect fill="#FEFFDD" height="23" style="stroke:#181818;stroke-width:0.5;" width="386" x="990" y="14414.832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.4531" x="1142.3831" y="14431.4004">MUSIG2_END</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="521.1826,14475.7637,511.1826,14479.7637,521.1826,14483.7637,517.1826,14479.7637" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1012.9507" cy="14479.0137" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="515.1826" x2="1008.4507" y1="14479.7637" y2="14479.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="527.1826" y="14467.3662">[69]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.5029" x="557.9697" y="14459.7109">WithdrawalIsoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="444.3677" x="562.083" y="14475.0215">magic: "withdrawal_psbt_signature_created_connect_boomlet_to_niso"</text></g><polygon fill="#FFF0F5" points="75,14492.7637,944,14492.7637,954,14503.7637,944,14515.7637,75,14515.7637,65,14503.7637,75,14492.7637" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="865.3062" x="77" y="14509.332">User receives {magic: "withdrawal_psbt_signature_created_connect_boomlet_to_niso"} from Iso and proceeds to connect Boomlet to Niso.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="509.6826" cy="14556.9453" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,14553.6953,2076.2329,14557.6953,2066.2329,14561.6953,2070.2329,14557.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="514.1826" x2="2072.2329" y1="14557.6953" y2="14557.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="517.1826" y="14545.2979">[70]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.751" x="547.9697" y="14537.6426">WithdrawalNisoInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="524.4497" x="552.083" y="14552.9531">magic: "withdrawal_peer_is_informed_that_boomlet_should_be_connected_to_niso"</text></g><polygon fill="#FFF0F5" points="1626,14570.6953,2530,14570.6953,2540,14589.6953,2530,14608.6953,1626,14608.6953,1616,14589.6953,1626,14570.6953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="895.9019" x="1628" y="14587.2637">Niso receives {magic: "withdrawal_peer_is_informed_that_boomlet_should_be_connected_to_niso"} from User and proceeds to ask Boomlet for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.3496" x="1632.1133" y="14602.5742">the signed psbt.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1364.0825,14646.9375,1354.0825,14650.9375,1364.0825,14654.9375,1360.0825,14650.9375" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2077.7329" cy="14650.1875" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1358.0825" x2="2073.2329" y1="14650.9375" y2="14650.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1370.0825" y="14638.54">[71]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1400.8696" y="14630.8848">WithdrawalNisoBoomletMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364.9902" x="1404.9829" y="14646.1953">magic: "withdrawal_signing_finished_export_signed_psbt"</text></g><polygon fill="#FFF0F5" points="903,14663.9375,1802,14663.9375,1812,14682.9375,1802,14701.9375,903,14701.9375,893,14682.9375,903,14663.9375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="891.2871" x="905" y="14680.5059">Boomlet receives {magic: "withdrawal_signing_finished_export_signed_psbt"} from Niso and proceeds to respond to Niso with psbt_signed_0.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="581.458" x="909.1133" y="14695.8164">It also clears it's memory of other withdrawal-specific information and regenerates mystery.</text><polygon fill="#E6E6FA" points="1096,14712.5586,1610,14712.5586,1620,14731.5586,1610,14750.5586,1096,14750.5586,1086,14731.5586,1096,14712.5586" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.0894" x="1098" y="14729.127">mystery := mysterygen()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="505.8955" x="1102.1133" y="14744.4375">withdrawal_clear() [reset memory back to pre-withdrawal except psbt_signed_0]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1352.5825" cy="14792.0508" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2066.2329,14788.8008,2076.2329,14792.8008,2066.2329,14796.8008,2070.2329,14792.8008" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1357.0825" x2="2072.2329" y1="14792.8008" y2="14792.8008"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1360.0825" y="14780.4033">[72]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.9512" x="1390.8696" y="14772.748">WithdrawalBoomletNisoMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.0571" x="1394.9829" y="14788.0586">psbt_signed_0</text></g><polygon fill="#FFF0F5" points="1870,14805.8008,2286,14805.8008,2296,14816.8008,2286,14828.8008,1870,14828.8008,1860,14816.8008,1870,14805.8008" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.2993" x="1872" y="14822.3691">Niso receives psbt_signed_0 from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2077.7329" cy="14869.9824" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2791.3833,14866.7324,2801.3833,14870.7324,2791.3833,14874.7324,2795.3833,14870.7324" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2082.2329" x2="2797.3833" y1="14870.7324" y2="14870.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2085.2329" y="14858.335">[73]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2116.02" y="14850.6797">WithdrawalNisoWtMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.0571" x="2120.1333" y="14865.9902">psbt_signed_0</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2814.3833,14911.3535,2804.3833,14915.3535,2814.3833,14919.3535,2810.3833,14915.3535" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3600.7397" cy="14914.6035" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2808.3833" x2="3596.2397" y1="14915.3535" y2="14915.3535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2820.3833" y="14902.9561">[73]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="2851.1704" y="14895.3008">WithdrawalNisoWtMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.1504" x="2855.2837" y="14910.6113">psbt_signed_i [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2323,14928.3535,3282,14928.3535,3292,14947.3535,3282,14966.3535,2323,14966.3535,2313,14947.3535,2323,14928.3535" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="950.9424" x="2325" y="14944.9219">WT receives psbt_signed_0 from Niso and psbt_signed_i [1 &lt;= i &lt;= 4] from Peers. WT aggregates the signed_psbt's and relays the resulting signed_tx</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.4526" x="2329.1133" y="14960.2324">to the network.</text><polygon fill="#E6E6FA" points="2615,14976.9746,2990,14976.9746,3000,14995.9746,2990,15014.9746,2615,15014.9746,2605,14995.9746,2615,14976.9746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.2944" x="2617" y="14993.543">signed_tx := aggregate_psbt(psbt_signed_i) [0 &lt;= i &lt;= 5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.7183" x="2621.1133" y="15008.8535">relay_tx(signed_tx, network)</text><!--SRC=[xNrhTzF8ikZt_0fDM6TZpnYlF678WLad4pmJpmQI6uVXxWKiByLM4Wssv6t9X1pWlv-gwhVKUYk1pUJBJB2awkhgwkhgUaRl_M3XBjsv4td_Ndd1n7lXHP5xuUtF_8l0cNddyLhinpFF6GP-xBjnk7HU-_7bTEbUkJDdn3zodldk1KBfuCDm5JkZs8szQNVjBFpehB-AlAKpygVUkdCF04-yNsShRysT83HwTk-vVt4P7roxmHfW4_iJV-46iJECGlw8Fj0V_Hg6yvaNyyV7Vl3UU3mwTUxzwOVmXl7pIrz2_7tfUS6Q5qmTGD5uwVMf4owdWDNZnywz4s_A4Jtsl6N4dsnkR9Z3xP-eHvlElNzvirbuvQojkQiu35RpCtYm_kJibpSR6-_Mrpv__hmMXB7dX1yyHe0UGTXpd1z_V1a2vVmm-F57vstWN2bQduS8CmAQnwk5umBYyQNdH4Xdnutf7pYRy1oM4j_m8ySFBhsb3-i07oyTTpQ3Ds0rVIzol8yJRy4eV7NfJowTMHZ1pmnS63ZHvIgUXbT17x5O7_lh0Cpvu2vzzmoO8N3d7lmmzIVmUWJ8m3zYxm9cCmFs0LpWbzsU0oiEuvrV-y65iq3ozU3LQoTSU4kQepCD0nejlWHiWHK9VJaA_2PUy5n0qPjvSm28xxZE1uzMPH86iUi7E887rBncuzo7nyi8Hu1t0PiOW087qMGuvzoFd02uORmnXk-2U7ms2oVlnvSUyWQEl5fCaODf1PppfHTTpgwTfJVn_0_mAu53aX1YSxPdT6Jyc0ORw8y1wj9R02WO3s2SNSCqY9AJSBu0yhF5Y-7Lpv_X7U2cpv_vYF3NFHoEhTKz1IUYXRyNgr7Ebo7kPlpSYKE1yXA_9ahG08JSCA2FDHwRycsCH1nl94V1NnaCdma3Z_qUBzqWWas2z4Q-fAytzQzf5S_fvI0C7lXIbj1gAKeHUru3-0XOnrd1pdX0Vw4KWU-9s0JTjn2JVVmI23hs2UGedEC6yHQHS-R5Lx3V7JKo8chYibm1-j5rCBbSXa6uYc2zyILOrCbgkGJei-iUJY4IGAykFVmY2YU-OXKJfhlq7DW4eLZlmBaVt7Scbo1o9p5GCx5n0Uoz_jh5CeJzUwfHbGjV_DCgETP0jXpld-o_69mEJaPhzwRUkGyaV_RgP30QZGyE1mV_70zVmhC_zv_37-DVdnyT_5EzTthqV72o__9We9wDVpivUZ4-_V_Z_UFZaoFyxDT_mTFXwN3_zEXaV3mOd8nFZv8ll3wj3FFbqSi4t142FXaS38P_3b_-ddWX5wCM9gJ6tN_-F7liKVfhfzJe1qSlNWnFNmnUdXQD3-iA_neT7xqS3HXjcusm__9PCR5JtoCLwBqIWn-S3FPF4SenWKeI4tyTiPaGCeVxbddk0wV2bwKcgyOxWlymm3JgdyF1QqBXSC2UmOTiihyU7RruFZYjF1a0VWJG39ePempLAEb1_dZrubY3F_nj_7n_T3eU3GRyD_WtacPmECH56ewEneC_QG7euU5W-FlXAG58GZuP_BzNmvF1i_4BMDONhrwCdmr7fudf_3euVOqZ9PbDsmgu76rmVZDqDCuhWL3UJgg54AqX3emiGveXYjgrfIbmzvZ6Uk45gCJ02NWy-lKKZYeyz5qd16c-lF8Zqewy1Px2eB1SkV7aya4Om8a2fooghVDmkffv_RMr-w0fUmjdSusWXWz-8HqLD46Gw4hHnj-6mM8LR-AvjeZEuhLBXHRNQjqFTEY3gXnT0W3wbP_-4Nt3L0CSgC-UJYwzoVk87UdpC8h7L-7o_VZCZoUX7vWQqQKBCE2iWtDixeEI1sgjnz_OO73FGAy2aWGNuwaNJPR-0iw_7g8BE14AySUnFsNl4ZPuk08SEC99MoACt9c6LWXg313odBtku_mZEb4ZE0gZSr8I-yum9cs7goW4U1O65wGtu4ypNAKO4J4c1D2v9jXFqnBl4q32VPZlif0qlppLvawNgQXl8qO_JRX-zZB2y8nWUqzfLdr6nZ7zsEcIWfEjmC97-LXdpPbF-V9wYjmznf4x-9-kyyDJv-LgDfCikxL6to7BSaBQk9O_uhTAoRwvsEkugNjUWht50ydXdn1kBnlg5yPwZCrGhqjo6McdcHJLDW3WdbhAlaGeHgqmW-VX_ZC5JdLHIuHRCupjmszmWrvUBsBS1dHHWtNR6BExKtmzNgpEtdjC5MLyxXFpuZpwLagPp9izexRuDhL41QpBzLiu06a9ElHpjnJ4CQhOOqOy0Cwv2Zdk9Vxs2PS6Bs4mrpts1KaW-c3FWNd1yCwRrS__xMnllOCdN_1f4lAOhuSt7PzTZyyOBa12M9fnH5jhVp0IBtKMC3NSAR16UyxWuDbXHtsXrX1UWXTwrgNjzX8uQxXq7RdVjfqrGPUiOu8_nqVwXgismQedIqNoqLuG4q6cXj-ltANawz6fEXLtb8WPdTgaooXkPvveBahE4dvhD4V4hmU2GEvjM7qFjvcuDZCsLlkQhjAqRu0CT4fdePYn7P0j-NWMjepi76dZraAsp9z_Lou6OfNyji-XAixUNOF9uI8p_SfSvb5yj8g5vaEmTAfmws5YwUXNS_6KxcCN_i1ySzJIFAuESMi5dLNmVw7kJVlEeST4l1_0RESHBWoyZ0OiT_8-2AzctlI2x5Hz9usfSSWon9xQXQGWpaEb6QRtm2XMMk7SlV0dUywwCkUCfHrYJ4OJTx5O0YxJCSuG1e9b4GQjiH_1hzuuGkk9o_v6WS-GcewHUcCDCcAyNcK7VRfzzBxe-YwQWqxPmaN-HQ3jDdqJ-R4oyP4r1pODtod4Dlf9JSypTm_ffMmulhc1GUIkeVNYzZhRMLwmsSSu1RRts84qWd-xyMhf7GLS87vwooPAl-uvqGIWBvVqOPOaI9qzgSDK9rNMuQcZPee9-3VA1qcoufEqLP6b8wOTgu-4yB4TgAFYixJyV1iVh1L8IvmF4xCSiFBM8oZmSmr5Vgj5MfHNyHjJn78c0mR-kK-kZpH3tO_K9i8PQqS7lp28mynd4WK5bEEolz7e7T6pFbnJIOhZ9K8x9QRQcIySEfgpWBmEIf0eamDUeiX2ZwS54vlkpF0YV5eNqdIz9nHXovMenuLXdZZB47zuKRcA2Rkt0KDGFcR61dY1kMJ8A29X-znO0Z_wU4f72syIm_8wAGagrb-fH_3sQXQJEmc6q5Py4ivc7hELup990q2QJ1hFgDdcg3DN1RUjAc8wgQ3Tp9sXmgxebhX0YgE3DifrnuPDBn-7ljn3NTHsJfShBszS43s_8US7w4gatOPhgkjCcGE9tVWqhNQIGOzkdjfVQK_BFcUJehMsx3zOuDEFuljFcaQcjg8Gck9o2lzExygzd3ixFtNBiNLrpI2F3TDZ6Wg2XI20BBmnRcKFDhfrNyMMRLCIhwumMUKXg6HR8pmbcDGp7N5cZdkpwJnvwlZudvrt5XmrYGWu7SX_FIazbr_CCQI-yBY67MAhFDSMC4BUJFTQcMT5DUrJ6zFgtV2aI6facrxWR9tZCVTQCxviRYYzyBNL-lBQiBvWU4iKkqkwEvjUS1vMyEu_ambUMwwshq__Onc0L1cSW5I3sy5VAjAPrxCSRPg5CYr9BmoP9KOxDmbTxYfI6ZEpggUF7GEi2B2mnlXm1HjGEIMBJen25j1OJKZ71Np3Apgn2tLiTfpdkrnoBgvVc1cGw-8iE4VglI6BUqa7pk2vPbyqugToEW85xA2-hemJPzUCS0ZXlbhFf7wUjKUisb6MVfAj4b_55M_yRR1nrqdEAbSPpiIhBFaBLED2ifABfTn8d4xvyql3wfCMYyWfTdToS5IUdpGezYm3WrortmBCxj7g53Xh7xGPxDIjZE6J8h-iqyyZxjZSyIrUEOf4rrijTewWPSio35lD5apLBoMw84WGmBY198a3rm-bp6oklMPcFWhZJMeph-ENOI0Zd9CslxpPbB-CLRb6w773MpjQwB1qlk-iyNXaktQMc8sfgR48oWA4VJkYlb31x7U3hLr1Pzkzu7NAdAfhDgMm0hLc8t7noLaUXTV3Ukk_LHF7975UXXGddOWL5IIhUkDeIhLU7isusmIk0cnOgTUH5e9XD9PRQbg_4q7RvH0aDKIE9E_hIOWvQ0kbILCesSd5rKfbZfG2mg9fzamlB7jyXShGbHinQwumrAQbAEbgPnwBj6OQBi85uOL1zHXLmSALvBMhAMSnGoVZ9ItKYN2g4k2KeTNu6LfD8PeMhSPam8e8INx8PTm2NIeLNZLEJqRgBSLJ5AR6b3YodD5vI0iuDnFE9GXgcQjDiUjNMwR4LEqGww0cFUFqHqMiKcWbe6L-dwk19c3QjSzoIc0LeAWmWZpfb8FyKvlQRKuiNRSU3IqhRQVZtFtOAQHDhqLblyqiX6utBHG4QvQZm9CozvXl8lIxwoHEf0QCiL6ICOeve-rRNkz6hvKDgDzDyLQP6sWn_PJU_AX6SC3sBMZsDn50t5GTw-KRv78YauLj5fLkWPUfTz-4qjspQzpwLRn0wIPbc6LAvgLJIWKryAv49cOfLLseqBUWhTjLzNJWnHIe4aKiT7aSBTo9nvCoVSg3TPTBzngjmxiY9LOb7suIDfkFVxQ5WQS2B2XAeiyiqsOaX1MByj6f5OB7R-5YK1sBLcu3Dfz-EnU2HbS0jfUAjfAPXcogs1aqB7q1A0EhgjfV0QSSNJq3IXLrlrAeoPt6dwNnLoBZdTB_jrBwg_F6dTx_3UdzS1PQek8EmldSZp6fWJ_KzO-zedFLeZB1YVYCVZt07qVusoTwmhEqtcps-w0e_VVkk-wNGdt7cWgcUuOi26HdXNrfgb_TQ89OBc8gQsJhvnf1MjiDPrxLZz64o5NIoBOUbyuZssgH14KfCOsddufcnubV03qQG2PFhnkXVWhtaqcu2cAuXuaO5573XJoJaRWwMRRN1FHrBrg4mPI7zFYOkZrRNBfm6V8de1F3jdlFebukiQeHvSUmonFFVgDh821pwSzPdXRUpU5QnN2Ov-NB54gB_4ovdAWEQqPAwVrP8ctEBYjpeSh83fafkb4ceIw3rQjcrraGviadS84-nzmvM5W02RTWP8L9w2qdS7EXkaEpcLZMJSbgegRI99ojvW6hOBIOKQ4fWzd20E_tuyYBHIWPBn2Gtl_RcoLow7HoqDKHyzEctiSQErh_NCz14mbeawL7rWJBwpgVoZG9RYPWyMvBxuFFYXF9Ms0kTz26JYPkw88pDwdSlh6oC2vCoROHgDn9d35aqmop5hPw1cRgBDxUAfrYjjLqnZMFu7hKhP9ajhrTmv2yqoOvoXk2cnE5nTWAm5pGkKiGQxZxS4jJyJoFZb2xTihEO241LE8Jgpm793QmPD4Fvxg4P0zG-kf1gp993GKd1chpevpdhAMbQqzRWyKCaBiCPq0y_1iDd1_vzCuyZh67gMoEDr_4ryx2dTBvhrN5KQ_JSE57U3wcRAzIOnWPj6JoVG-2Sc7vE56GGmliLVUb2Lrh4a6zxCTrXyNqEdbs-nwn_jj0HkxsSCegdIwDLGzNKhnioIUMjir4NG2s_gKpqOhbT7KDgE8DfTRkgMzboX-rp-Rzj4YJOfbYLOXhryxU5A33YVMkS6y1z07kU5YUZW6pPzsgQZ_1CUhvb7SfD-6vyvixWps82HdolGmKR2TdIVPmbzbCOPraLql8AsMXr_SkHS0oyuGU_yetSSz9XhywTLFkKaFVVCPTQiXkpz2cqjIeWkiO6SEZKErZ-ajWcmtV1WO3YZcBsPOvdGHOYD5N86mEDaKqpoCjBeVJmkohvqQsanTPJ1obt-tKC3ZjcE7JDq2RocNoRdIXYenMUlhTzcxfzBkjMoLZKJhSBP1Grd0Jjkp86bCieYeiwLCO1UvqgDflbnpzqegcrs1GWt73MbCfnYqLrLBbL222g2fd4RDdrwAwbBWoY7EV9b5HRAKC0sJDYLbvniWjjynqry6Gv6LUgbWR9qEBIMGtAwgxRMMNDKLJYuveQMrm7HfZfKL2s7NIAYFqnGueAHqhmnTsLorPPtjN9Ei4MhREzcvGBrrdIu-0iWivCzL4H-MX9MzeM-R1y8O3YJIOaRkCzFmSgqANlPCCqo7sH4YRI_TFj8WxsmKv9qbMniZf0jk28hESPWAIjtQygl3oDgRdn7fFCMBMjC9nzp6IotRBSZauHrpPM9qvZ4rBF18YbybjVoaiDTB4cpyNa7-E_m4_iX03XqFxkyLotACPkRF9QYR3szZDSEh6BXyA3YewNYxTw19dQ5kpLUI9a-8SkpYmY3WD5aN79RAVoEMp4XNvw80ZE7Qsaq5sthzNB1fGNMBfNumVM2oV6WaRMlYJiJujGq9hG3XNJAy3Trxk4tKo4-8q8NtIw3OBiCp_QB1_Sd3exBzyvfmCHWUl1dtdnBi0pO_QPS2wyMfIzgaZxPnpuYhEBi1SkAIucPWroKOm4NIPc6AL6dOifOfcoDrv4TDJDUZf7QELv84TPXfyu0V3ujFF5XdAr99f6y63_vdruDVsTicJFprMrraB5x7MWIQzZiwRN1H_U2e4GuUaGfTMe9EHKT-pcJ7z3ztazaK5RFekJJXJcHWTxc_jFkpaMbx88cRTyVdBeZXAcR_i540nczg2kGP81LnRdFBRcBoejarSVT0Aag3BpfCFNfxIbh6w7MQSnFuc33ZrKPbTX4lOOtE2FD2a20_UGkuRlpXwDg2GdOgRoDYXDGf8wflBjcyiFh-4JIZ3ybb5TEJRFTeG02Owch7ZqHhh-6JLvb27CXEk6qwqoksxAKsPJm_E5Txw1gwJ8FT00Pq0MD77gKX15WT7nP8mOJazlPTE752v0TBmAxC2kAi9gp6YxVSZbXlqfiByabKTXdt82yIyDYh7bhfBI6-ELZvHlr2RvWX-GudwnbhAL0x7lnzfKQIPm_heJcG7TUGPnIfHIQMOd4bCxXCVetiYV-xFOF_FtI10XvcSfiWoO0KkPHqna52baE1UAgqCOvjAGZj5MNAOjsP95kMGA3LAnN8i398MQiyPlUBtPcnyiqei7EHDr65fqYMfMn7P9rLogmjMtsejQA_wIPdXpCEtp1TwdPJjd-lLoTWkRO8sodDevegTJOkvOcUpdjrasonpaYshierHrUgVw1EnrMlPsQb7rntdpTEC-YdKmCAUPfapNvtybepBPeBQhqsLmcenMqb2PD3hsoFAHZlbNUgXtskAl9cRAem1nPLQAYFUownovxESrD8Pi6M6xgNU0YYteaiA4kONWIc_scO2SWktAc67D8h9Y9g9c89AXOno0YRg5vxHCZihaw96pPdaGLwarngve6NHijQ9kOc2FDa8jKkQicJ8hf1pWtLkaeYb5UPg2v62PohG9O6Lp8_CLwYpgVRWQ_G3pSvtB3EX9taJUl2jj95Cp57fBRirWfbtRq0poOjQQrDjQLf4ewxoaZc_DawwBtgiDfPbyvTHhb-n4dJ2K3KNaL6HIMsbq3gRsQjGo5VHjoeypt38y9xTsCEG-JtnAnPkzFKqkZnrBbc1v7OqkhBg78iy5ngTuqucuLAakMKoRD_PFu_5KeXTmyWoy__NYrZ-at3RRM2SE10FvyZUZVI2_lIEZB8NGVeBz4L4th_7SELAWPbVHm3zUdm-So_aG_Wo0ZqlmkXXZn-q1RF82ge_PibTAf0U4FgqZYYf1ZI9aNe6ndPKAtIeAH5x_pPXmcNZPuUq58ueVQbQZ7vc7B-oa1ICsw15ZLCoUBsyL6lGjwPi97WLiLgdOut4eyPjk9NUDUmF_pp3kQytY-etgeTpixUcp3uuN-VYr6BDefRkJcK8rEpwL6B-JQv0PK6MlGNLB1HpTn7wnYz2gae8dVl7M8NuTtTUc3ebb1pO0nGCdQFaw5rF-e5trIdi46teFyaH3Fr7F4ogFl1xxergh9tVb3S3_zUpZhYwOyivIWorbrQ64XhSNa8xofZBdds6wDF99zUuG1V9y5Gv3LDkSBXkpvPHis2Xkb-IXAwKkvG5s1v7K9owL06PsqjRAa0acxn5kKetgQ4cWdKgvIOrM04LjBFpqD4w15zW9s5gLrKZRsdt9YbLCsMf_HMhagsqyuW5i3YnDvivx4B2ce6XSel4BftDj7sZnDLTaeziBib7e4MSrVCwcyvQSrBlb4CwOrAj-QApmnN4KO4OH9aT0lbfEmj3EDvHNJW-WlyyFpewTk3qzcS85HlPfYrzUDRnF_MXxALpLPLN-JM69R5_JACQAMStj0M8SJiyElp6rf268hRhzbab1xWPyiiXiqpI0Qb2zu40iYaFCo5bBc_ANaJR-IAa-XEmKrs75fjiKsIgk68HttPmR-HwlMCDZR4cXS-BaPAxs5XPIw-vMlIpPyxv-PbphxcbYgoUb1vdZP7igVG2BNMEbNVGCDQCEHPr0Hzcvsa0cSdskG48ZlPF-ckPkzG_9mfQTqMfHV4- -b6CCIReDOSFtYUsSM7djdhhap0KPURV-POWt9lQLZNxkMKR2sfWM2EWi70SpOfG1wF2FBjoi5CPTjbVL02QB6UsytFfdBMjxpjdJKzOOrw8hvcpPajOerlghUQiPIUiOUt0syfPAvMmfjBhMirPgv-mHY7UJNFMMajOUnkqahDsbx1sbx1sbx1sbx1sbx2csRuUbqvOs_fE4zQoZ0ET0gsqsy_8PIiRXvm5E3UDZJm9JCT8HAe0DdgmYc4hGB6Ri1U8eYt9XkY6imHlyMVOeSOFi3PjX61VCUB1Vs1UjW0iAZTcXIjRgxEol5pVp31aKDVr112hIuFFRxClwbmcdswIGHzuYnMYBBGriDh2XTTfib_evIF3HAJBftNyIOMve4Eee9joqdJsLnQIV_tYl25p2aPI7SjKG4G1rcgscdfE0G1Yc7DWWXahmydjj1qVp_g_kk-SBqB7zwFWli4_naHHXNAnYZUY0-iq0px1kiqoQ6W1P2TQCU8JCuJSPgBhRzn090E9U6KbU3KH0M3k_2kpLAIl53rca2406-K1i69CRMKegfn7j1XLdKkYdGQxscchrRyb8qPjIqM9sts5X4S6H8jR86dOB_zbJWSWxKFWUel0b7A9bTkcBRUdWdX8HkbZfGIfag6rqoivwAHxkbbQvS79OF-Kx80Kpv3iFuA_ZbW69IbiX_kM_ChzWt_YbvOaomoKAoTNghKfN9SnMnSB5jRp0yJTPfxbqpylXW4ijRcdk-BppB35Uw8qOw8SvVCiO03a4NpTtYkgIZm9iGbo0jgDiUKFYd_k0N95MX3mEyfzD5hurCgE4eUYcCKO4zuT7_OEx0TyjlJkuodk-FEvDwLMUu7dJPbb2YqPhBAr6qpysSnTNdVpd5bCob880FprISPWu5cS3C6mLtqjJZSXmoRSOzawxztgkPrxQBEggfQ39kDkL2gxcA2PqGFiDnOPKFbKoxtkbFOCf8S5PfGtczsDqYcast8MLTM4fjSXpUcyks5nEiEFw7Gko12spQJIUZJFxwsSobgPtBsMiZfUdufwNZ9g0Rl6QCc9clAdfJiMo8EynCT-RXfTawGtoIURDVAE7jPc-symkwW6F-Na4BMM6trZEKGb4eZUtduEaIs1ICwv5hVfjy2DT8lX_EoaP5PAqgp2ib4ORDt6ejtQrS-Kz2CoWIYaWPr1jN9-175YzpqITsKg58RqLcAQARWCMnLAeVG0Hs_SNCeQrKjPM1XXV5ej8qj7pqSGPEX96qxUVSbgLPAN8OAH7_6hwyxe0DGS2Agr28yooRCGRVIT_PZPnEOXzYoKxA4QERkq496tceROTGW8pizdxhKxXq-dgrdeF7i5jv_H-E1m05UVuSlJmGdsSvJQCewv8U6Juqp6rEXj8P1FU6_VV7Sje7MKwfOYpPhIYGNVyUQ_Tma_tsF2J_AUawuYL6-9h1N_AulhRhCafVHmDPfrSm69bsmBF2t0fKZSIWXzTTDxux_B3ghCIf9XG3Ih5PulvJ_CBirLBOk6GMipTqPPZZ22Z9c8o7xqvt3mcen9XmFs33vakJE_7XszU3umpKIPY3t9IxjeD-ChdnUioLwRLPAz57pYguBXP8gNCSPXCSSek4ahQIDOoRIkpKPfNMNjgq0hZaiLusg55jI0I4cruuUdpilLRAPphKQUBBFYXgKfilC6Xpq-UVbxf_jVzugq223vnhkxFihVNX_btQqQwI4FlzC-ohlRfVieRz_rKVwc-YXZ4sNcLhpherowZ_BkJfa-ojj_cpxAkxib-YXlVwzzb2kqKHxUTL5klOloxiFINPItlzikohkFQZW07lqjkYZRPVxNwQAiuM9qPxs5BifbcpMhHihvNPJlEWtVTHfkgTDmoJQ_Gg2OoIRUHs-oYbKk3ulmdP9pGvdVizrk-Ww8BpLJTNOMbNBVcAupPjhWthEfZpO45XL9nWbqE305ZPKwSPVOJp9s0X0Ne6p0bxfvY-QMAWMIRGqJMSZ2Af4AkCBXS8RKu642_0hJTiu0bwcxl2PDak8tWsiXngJrWscNxc818jQRiauIcKQJdfxo9v2XdOdZRJuW-JgrkcdKUjM8qysttmZvpGUu3zIz2kHAeFs8ms7UB8uLYbFccudiVYLvM6ng-LFy0n7mfA_1sJKw_CIXW-70Vk3FLtD1yiaABdL1NB3CDiW_EPiR2M_dqbDUBLe4uc_9YZ3NL1qPiw8UZuzFsqehTBAlsiZUxCfuS-NmhFRFNEVOxJO-Bq0Fpg43phn3iQ1S_2GvuuSy6_e__c7OCMrnfGqT0qFc63WwFHmOvRCC3y5GUGYKWw00jrpV08lBvHJwwQcpMNIWbhS4F-MMO8hdBh01Ftrg1eKMWAuM5ven3J5hM3kEobvUkQj2oW2h9KdF_TLsVdkIlInx6QMrG0fsSe9nEcbXzyUh5ySQpmr_6p_V7vsEHnYUIh_1lp5eUN0un1fkmz7HUF0d5J2ZXuU3uU-7fmI0SrjX3R4sAtpbXa-PfRuwXgC3ERbRhU3Nbn9rgkugUjrLzFekAdfX_gYqYFnSmq7pwAv-Lw9-r-xZqlMvTcwhFjVkOrkez6DRVQwlMrdhzajIwQlwrsg-Y9mpbmMPeOvzvbtuGS1rR7xdI5G04ZTOglj4DO8YIjtZHkpxESMaCBOD5ADZbfYcAe6UBjqWSjaxl_a1rgHoMMOu87dYpTnhkOWFomVjx-Hbs-ZSyj0MMF-mOc1z_cWLDtOc1ML967fV2rUbEbeWCydW8Pe_gjQFHJNLE42w5bvUJvUYf_SYEjDz59buKK0ykxxnp-4b_5OpHJj0sjCZvzU1St1qSZ8uE1qyosnx8ZBcC1tRWx4dh2TbmrdgbedK5793yCr9mV75Vw1_T_0_ojtmi4we_Szvx4FrQ7GCQeR0Py7lcT2_s6peB0wd1CSfwqwJvT2ZmvU4FGii8ipCrT0Zr7cakOX9rxBUMHrbRhNcoUNekzUjCLHiXF6y39SrniejiNxxF5iYmCr4dz5oJAJiTErfhjRWD9Fh1J4anzS9TI6E5vSZhRmgJ7PwFOv38iPweUHCP0qL0loIFWR97konSZz-08SbynRZFq5p3j0vhgMSauTMpboBQx5v-l4Xy_LlbfdkM3YKntnWoGVm0e1QhneQyAdnY9emI17BJXqL2K2kPI_6xAIUCm-yUHZu4mR5ZQB5vP9oEvCatL6X0iCq8y5F52omgG4dqWhmT8-Jq7M23Mq7xz1WdnIsFGtO5nL9aCKtohxAiYMkdOaRQELivoiWEduOXx2DcJCITc0G2I-zwmVCWavoX7RPqfX1JvqfBrwDXhzliTE7pDUSzW89YY1YAI0qICO0AYFouUxQCF_W6YRFhIosLiL5fwnMyfXxKzThdbsLnk0hDRJmR7Gf_1nqbo5FC2uTKpY1dN5UGB5prbjR-83zljSdSh6KKmyqrelnr8icItyHXqOTF_nhJ0kznM-jOngqfwKDOgWLEXZW-Gnubdd-qCypnP-O4nBXQDlYeI5ZXvaYTYWbxARKu7WHmoJMPd73BBm9YevKnJtLb6h6sARuxjDGf2OeLuOll3USk2A-nN0d0Fqbt02NVvPOdGNm4p2NofVhg5_u5rrheCN3HvKtqPP1OeuEoR74Y7LJ7qtGlJHWjM5wncw1lwUhYQVHb7sfvH6o049OAUN1GNcE-4j1v28QF3Y161AscWGv1qcxlDO8-7DbJjzAKAiwboO-jd0PrK9wxtaBSoPdgvXBa8Xh3IZwqLNd1hO3aZcN2cJwUF3ocQB7OybGDXLZMAHX89fZkLvZ5lfcFU-3jbICYaFcYEjC2WhgFDfGwe9DySJVI67OoY8FwU7Hc2qYO8aBA56CBiFL33HoJo2FBrWeLIgblTNHyxGHDtglBcvCpjFzHl6jHi0wrzN76SJan-Nu7Cxc2AyitiT5k9HTYd3a5XM0CgFbwQyyFbfMO69ERS6x0663XGM8GcWpprtoyuK9BRpJiUnQXTM3QE5D_7FCaTKK2nnQzxTp3qpXpKi46kn9Pnt0w7H5nLDE2C8C8pVnuXaBv8HX3wwZ3zJBZlTnuYrYSvwgGUcZEdUvnqBJa00hcxBrZolPdnzjbxO_xwRHrCo0ZxOjPa3uiR2fG-uGVWD3S9ecYespXz3w0L1HDVVY0ZXF6JdKvi1IpiINC_Sw6MF1Nui_yk1_2e9cjwEyKaZgC-1OER8oaqcSZRvGk- -O-GlmW4yx4aXF3CayD_y3_rcivhErjUWzN33TfJi7XUxVAxIrSFhlp_3IC_FEuxNOZsUU8_jjE6h5d17_o7dcknS8fOCFCSb-5ED9rLqx2pywwoHRHw0HhZlt0F34myAuQ-u4eV6Z4Pso1zTki4OAnCHVk47CrGrHITTufFOuFaPRZV4Omxt_z4Dum_YPxo3yvFUbvmKK3mSe6Y-XgNg9hih7Zvrx9zwK8yfPbvviRcoOmr5bJ_veqxdtBsys2w_WGgXj2xKdFd_-l6Rg1ZrHL_t77r-6CKcw7tyqPHDiNOGP0StZrKA69s6HMy_X9GLmDY198te3wr46859zjDLHnDbivf1348iMSE6556RvzhCGor4pS21deyjLF0MjaWJt-jXVnwlk1tVfksSpTiDYaRyibH_BLiOWbPSE1Gl2sHiukps7bmQ-5ZL0enuBUrkWy4PfFaMBOiXBOB_t6Vfo52gBpLuWWvytO-4tM9R9-U3Hgl2hE8wW-br4zx4wGuGZaEy5oCCozJLb-dvE6HaScTapUSrnAZcXvocmU3IHu35dUqP7ncU510RwOnyD_yocYP3Fhc4QH4azhXbMuCBx_3aYGV3vCnyH_hg7mx6rkgVWC75pBrQZaDHYdxEpcG5WfWgW10t0pcEcpMWyDkNRcBdEagDGvGjc6cR2W4l2M7CxoNOTc_hNj8hd8W4aqOiuKfHY_ce0JzT7BFB-WFv2AQARVT6Sco8c-_WbTfNo2UGenF3m66yQPo3-M7LLCJ8YQkAoN66ws7KmkLo60IzwmGhQycZ1sNKFfn09eDIY9LcUteI9rtxO1A5Oxy2v7znt9d3D0tfvo-J61R3t-XPd7XU-v5wnIOura2t7-oVxBmQdWvFHshsf1wgSLrGvGxwNrx9n__Zuv0W_ItKanF2on0klJol3B6pxcEgIc8rH2nCgwD0eFXwbltPAZPxNuj4StopxYBHjDaB37fib1c-rl6MbyQeMHQWycJg1bMgGjeFe5EHctKdbLYZHcxGKvtyhpL9h8MHKsoJD44MjRc9YPYFIMDKDz7ZqwobFS7Jr124uW1Tu2WVOkYMUN3u80pXHu9H5jPLA6tbm-IfdSv4Mw3hNGJrlqmntS0kBxMdLHUS-w7QWpNhy3NwJijkZtrhzpIeA0buYEoV7oAYFBgkZqUiy5HOFqWXEmEYST4DoQwkGTWROLamGBVFwX7HBSrRGHEaohshkT8UA-ZPYzDE4oozJo0Y68SffLtC_loZWNfLQl_gSJI-t5eqXwd6irJ1k6NwJJAJhskB96v89DMckifRUooQanlUKF99OmKG2I0QhmsrdEiL2PynjGgK3UgaCvYYprPIMpinijSLX2japQejTRSQrF8xbsYmSTxG47VgvMmfYfOni5GMUaOJDOt6JaBzc1PGaBbrdhORHSBFwjAeU8nM9LggYITaw9WsdLrJeeCxKKjLAUbfhIrNbm4oxaaKkwIJEgKrWu_ty3Dx8pdwbEjXKctzNBWPYbVnMLjDQArErGoriLLUP9cUbsyRIOKyBNtDZcMo9vn4sHEOAtBJl77fCZ0lt8-9-JivhT_8-2AzctlI2B4zz9usfSNxAwbqsGLYYSaT-50X8P-RdSXUBPVX1EBdYZx08Clp8Z-1NRuofyMEN_OsodE4o7IFHnWaFutgL_VBfzj7xeckmQDVXnKTKbvFKbl5ZPQjZsSQorddjRdPQo8DAtSVrueOtsp5TiBNrGfXnZPvQzdsVEbPIvwHEggnpKKUjQNMILWMKZbXNYPh2cYIR3QVP-D2iGD5I5KcgQ-HRBPAWlAxUc12MyrPLvRQmZr6VcvTKukT3ekYs7wb28gvP5PQ5gf7CfXRRwYYOQkUvyCDeDdvo5YYneIm5Aca7lcL2qfqb-bW9sQbwMLdkDhr4_dYs3feITdZZk69biLamWrPIYHaB4kMkLG2rBEBaBydZZx7J7pmd9Izbj98buvnSbsh5pT1yTO5Fawb91dh5kqPAADSinTn4hZMed99HaDbQ6YeNXrRACEkAKUP0OZS-JQkKMiKIzLVQGRBFsQGm03-z_s21Jp-Ax_L4OxKLaxd6rbOs-Td6N-ox_-RpMzDZ6kg0XI2iiSsubJtOwFfihPHT4g-kZ1_9GJ2tJqvvF6tLZjDLrfWvBTLcBbiY0avwiwEoS_ab4IXJmwAmLPvP2zO_Ru9xhKolSZkS5gRLk-59gQucLYEAwABpsZ2Z50HKaVQB8IWiYG8hfXcUQkxwV_UVkVH58M3_OSlEKWPX0bBdRGV_LC-IAgep2pTQyYgul8EBF2HPtr7crr7giQemRfunoLn32eAmnk5mRHfGEIKRJQmtWfMnxsKKQdPs5_M5pQJC5sRFuugt26ZbIYulAfmERi53pBven4_b508HgAZP7R30bIZLVb_hGPDGnejwXvPIHhBrNri7kLobjmqsxZgrUh5kPFHYBSIcHalMb8PPSgJo3LeDM5e70idkJWwEob-J1iMUrUwRQWBBQ85HluDgzO2aRcKC2nkcElqyuexD7T_Y_Q98TBtLuji8MhOimz3IRC5K_GQY2u840OphHf8uSDTOAweD4GOozZXfpSkRG_dxLfMRWXxHkxMZ1xhdXhOdvc1gPJo3FH_DQcLIIXVt80IIFLKBSVb53pfdzvYSfQYvmbirCJC9KVL-q9GMlJnAV4aK7f7w66aFMXPfRYyv6H1T3i4IxViGOWxQGjb9jVNZwg2o6SgDRT4GUwORb3s-GYK6MysHoLLOKzFIB-BD_tZ2DMgc21U43WQiOmm3YmcIbwIcdAENOj7YYLXTl0fHH9KxmnUWQMsGj95x8oxR5IoF0_9re5GCqpWz6QteOj4KPLEcf92ndArvI6ijo6uWPaeGr39NcqBMhxPCYQdQ8TP1pUmmLH6h55e9Q9dVvsgE2PXshR6SybO5w1CgYEbqoa7-gKsjD2TohLkFXfQLjjDnxdxi5DAcrwAItcQ4VxUR5Wg2DSjHu4cP-ySt4LRTTN8Qh5LaZ8sIZ57C6MtVpdetUXriGFrkYhVAt1oBwLV7Rxzz2rhwJGJfDbN2UldcivpetxTQZJ-1bwbjtuIgtRFhsVh5kK3L9XLOr5BBLbgaMXfuLoAtiPI2BXJdMz3HxGfwEYR2qZE6ju2cp5BMIIqyTtP5agbAvziaR3OV_smBjKx5Fb00Gv_PaSqWXOPj4Yi4QD_2TQ1HP-3wTu3iMjvDhm6D57zUGhrWAvc9lVqoBMzBg_rbO5LLzYlWbAEXPq2fekHNYWAvq_EpzFng_QNlLFs_awfVdJVkjFrlIDktb-S-e3Awc5HWwLnzruRw6sf3NJryQljxQpvTDbLhwwxbz3VLSXhBdVlpkvRJvLfEbqXPs_h-6qqN9wbjVQ_jfPqA_QMBChtk6anNQJ1TDeLhw_jhArtT6BppjsWcRTSmlqupQLlttR9TdXisawxOIPhLcCnf9cqMhj12QTMTXtNuI8JHiX_N7HP5w-JPtdkYHQxgJLgbaUcqQYVJqebUTusoxnfbbsoKRKVXTZlJbklLhNNCL7kNOawPYK6FEEMRsDuyirP6MshesslOA8VizXnRRqP5ZIguPZR1p8PlRODPt0Mp8aPVWR2vxJ3pQLxK5DDfOVRLKm_RIJii9auTez6E6R1y0nIfsHNpXfQdL6doiibjMxTAl9AD9s-ISBAkcR0zHzR8Nn45OKbEmbXifqFrRhlac9UMCBsSWHgC6yUQIYnkTwYMY9PkOcSHgMVNeWYJk1w8CvucKL54fIxyP9lX3GnO7vPYW7IlmS3XPLuYLXkdG8ifMZShbhjjvMurHLEBPcXfRN0T6cEbHIxOzSyg8_J53YWf7Il35xPJBIbcUrSanGIrisAsz30bksGpippqyH_gIJayyOHNrq_adOpSPQIdmLZrjEnDOrZ_i050skAvVw85mzdklJdPfZ9yJPVD5XIPyJCJaBoCums45uKn7HtMwuSHJgRLLCDM5zRBayl1EU8cnagmOTXOuf6Ghan4-qjXW95MslovWAXp_0_uaOKOE1mQpYt6tnxDo9rDLZCPUSOkV5CtTlbGS2RHINBfHfSuGzkQhI9F70hdsBA01Qjfi2XmBL4MdZmqAr6iZiuoWcDdEnd_vlrxnGBrrDsK_iNuWONPgP6mUuC_6UlJCeIn1eHpnVGwSEVbFb67C25E4z8dZLwk06lQZmRx9mU7plxBPyx9O7JmQj1tJhmBKEseDmIi6w_1P9ywqiuv9wxYx0BCXKkAcuaPYMm44_6GYIbMgVF6SfneXjpx5Z55L8EUtZ5Q8HlOOQOT1tum33dzR96XB2YP9WyyuvzPptXjRvSyvDDZTPsrS15hxLRIw-YyoKNnXwT2C7H8AdHf1JePgUazctNI_z1DRb_g9VmkJJXJRnWTxc_jFkpa6bJ8q6NTyVdBeZXAMRNi57WRMBPWhbrH0TSMf_ms9gUdRHDN7xI29EYoy-I3bwUVPQnkXzaSiPa70ywwdb-4IzXZSu8yqAG8Zwj2xXk_E7ese6YQYfl8sA4rYYpgcyksRonkkuIf9yEWMKLqv9ipsX009ZhebAEcHbRD3JKdCuUvuVIgNA-RKfAvvU0quTrTuBwuybW_koWIhOgAD61nN5Iig1AMKyHxwKX-5QmlhRWoJ9_xZR1o8HfoFowemw6mgcGLLs4VyleghusQggKk2z8revKQr6_Cfhs1Nq5OApMvbZAtml5LA_UyONaVTpoU8yyex8YgAGNEJ6BoXVWOWXFvSty6ktxk1W5wl-GqHTW_AmOfQsw1N2g5XEXqg4eMjgaQj5FJ98TvQrOqKTw5KgDKh6R286cnxvpHAtvl1gitAsJ2GTv46PCcZO2w5P5zKYN5kM3rhUQ0zeg7b1dEF7BBV56_pCXsQSkoKV52CqZiR3Qk4h9jLWd9balPbgLgvKDqz7SizfHgDDnntZpDA3z2VHdicOqvizH9RKboR2QA_OgqA2onifMSVWQLlZrIRBHJFQKU-hsco9j9eE9gNrm8fJBYlSpYRpvB_YoTQbfcw5xgBMoZV1iweY1XVesLygjjPlgsS4SILaMZLeie9OYvdXw5T6L7DTIlwwAbK5OcHOsIBia3kaXVDP8kow9bBSDo4_LkiX5gbpHboP1TWEO6oyWa4KihmjKM8WNFL8nB0YkPY9YlA6TJxS7NQ6MPdLXOPa9FyYRqu5lfW9YOOvquuzqRq4Vo0ihQL5QQrgYegx9apg-Dy-sB7aQDjSxyPPJh6wm4dJ1KRJLam69IHocqi6QssnDILRHb2iypd2gyoJIsuME-I_oAnGHzFJqkJubB5lYu7Jskh1B7WiA57kUuaqcu59bbcGpRT_RFOx4KOjSmiipy__KYbdmaN6yR6C8DnCCvidSZlPGzlIC3u4Ny_0Bz2P7txp5Shr9WvjSHGByUdy_S2_aGlen0kuimiDVZnsl1BBBYtOzPPfMASGU4FgqZIghrIcAade6n7TKAlLbAXCM_JHXasVZP4IY58qf_g1O-dnbYhomV1UCsQCxYb8mhBo_L6dHiAHkaNKMirkdL8l6eSGTkfMiB-yC_pt3GwssI-etApTpiNIcp0ypNkIwrM1AefHjJ6G8rkpILc7-JYqzPa6NlFZNhiDnTVxxnwuygma7d_Z6MzltTdHTcDGab1_O0nIxdA3bw2v1-u5rr2fiS6_fFSWH3_n4FaweF_9vxenfhvpUbjC3_zOGWhkxOqe4IG-sbbQ641hUNq8uovh9ddo5wQFB9DIxGHJByJax3R1WShjkp9RiiM6JjboIXAwKLPG6sHmKKPnLLGERsCeeA4CacRr4QqKrgg8c0cqffGmrMe5RoqEvDKg9ctb3xAz9goj3sZP9CTne-Qkp_DHsevZJUATTmnZHQymfd1ma8aOuOH9azxFYfE0j3E8RnM3y-WlyyFpewTk2KzMS85LkjfYroU2RnF_MXx1LaLR5J-JK60x5_JACQcLmtnCh4gXqUYNrZQqX34Tjr-wmO0jpW-2MEMH3f85DXya00sKc6cNeobpTbrw5jUH5I2GVOaQv3Yqqs938fNB7eQZkuDtAzth6MkrZMmUSrEScPQwoifK5QBVhP4zBy_8IqrzoYHDP9oZgpHYRsL2Y_bf76AYHe66j65yknZW-pSoA0p6IZt004H_id_RNCNGht-NDkqKpjYbABudtqenZZFj2d3H-yJspZmdPZzTOdOT39J6lpBG6lDxMjQZOXoxxKry2mHXXVuJZQRRyEHeNfQ-LWfnBNih-e05HM-YgR5RRrVMU5wIbXp4VmDRF2R2bXT8UyrQomx9GmBAPtMrbXfLB2L09RgrbXzLF2A9owQLPOQobXRuDMiiBkKiBkKiBkKiBkKiBkKi8gf8HjVQSfOLc6W4w11jhjPsIBbOq8pWAScoX6rdscMIIYHm0RFO34i0kWi4tO1aJTasJ7RiE1WJVsCspAuWTOjZL2iAyOyU0_C2zRK1HLvxB2bRs_MPrQhcLc62seBNW2YDNDmEUtsHTb8PDFDyd83hp5wZOMsXLOiTt2gpFPAlHgYs4Y-kJJElwaGa_GILFGxZTf9lih2yc_Vd7UaEa4evkEPR8TeW1hDLjDFQS0037CEJ31Z5MjPAbyJiV74_wlxZldYz3i_IYuR_2FCL5Kd5miPetem3hDW4-maB4Cv5a0sLadUI8-CKF8xIEwriQDGJAuXnSdWbSJNdbpvr-PbHLzfTunumi1s2WFWDKpQYi7K6KLedMewbmI7IJOXKvRhVuj6IngMoLAtEGhf1Go85ei0Kd3VlalSvhUQ1y2rri4ffHBh18rRRaz5LX3CaeVAoL8bGojdS38GITTniqI5mzE1lkdPFEZ68DaomtyTSHo54bDEzotP33k7_mJlxIaCMQWN3bzKQrDuRgCsRfOiB2U7o3kDlEidFvvCGnWgSqztJsUPt8jtXEb6HFbA9zd0GCWZ-3hzlP8LM8yY4sG4z16Z5rkKFnpRuyh4dI0tr7kewd2f-vjbC8JnIpkb_3k-B1tO3_WiwLt7qznnv_FlIbrbmiyRyhiKMY_O8MWtM3YpsRkyhgRvxXYKfRSyl3N9naNWMTnCYp2NYIrEF63Z9XmUsNhl7UhvtRkeSsAa5eEcemRKQdyNO9cUlJPRynRN_bKoxtabFO2f8S5PYoVmhajSQ-g73Iz16cEvDsD2fcuDjmhqRrv7ctbvD7A1Ewrb57n-bJKmv8H1TWaHKi7r9GyBS6mOD_dfHhsSnFNcgIPrSZqULYRlR_1V9uQN9IJjTDQ3lADPUsKIDbvU_jPExQK7JddMjoct_4sqZrpy_E1adaWIQC9o_zWi7KBYdOdLpzJcet8lQ7W17R2rCgo4SI9tVT8t9MfBXWoMmbdfhuoR5LGX3hb7RqJSIbRKozbFs64yMcrZBmOFGD0aA4dBJHvjo6hpKXUTGX6VeojhXcZKqzp2gW-6pnU9C_-iz5tzcDcyPg7s8HFieVgJEpIGaJUQXfYknqWE3-7kIVk73wThcQXy-mLt6r6uuF30LniXYzF1oVOe53gmZZcXeHFpZ0P7QFtI40-uSrgyrsmWDPHgdM8D5fAnnHynxlPtgNOV8yfDibRJBeAJxqbifQ_hookkytIWjB3rUW-pGKaNg4jyBHGbI9nAo7qrJtkZVykEpmoAos50T5iKdY-bFymkxHLjRmL1gtDR1Lb5y9OC6O08klGdyF1Qp8L7GxOC_YGPQlyUdJquld0D09b8lOaBz6XtHohV5wmfbTjLaclKl29hmg6aqbLnXY7nHoZu2Pje8rW9HEfDXibKfMrdWAjE2vLJASLUYe38YNLZX-UEYzNivdEjHfvieo66vOklyuR7FRuvENldUv_tIlI8e3a6-_k6WF_HpS6VlXtRGoyVTSO-9jg38nTWPc3yAunS2kDWRVl6WERHFYk6WDNw0iyl6iBVFjjWRVlsW9VU8_-5cs1xRBywxG5rd0nsetUGblWijs7LMVW_BR0TwrpxrhdjjGwjsJVMY5Gp2GGxwCtMSKgnuR5u4x9GQ5CwDckCtq7n9UQkJaxkqcvO4pt5pDFS0_Or4Sx08jR90C3EWsO2iOAXBXBR9eOEm682r0iu4lTH4LpInNGoBPeYPnWOLb8XKJXS3X3Qd8m0Nw5QJjdWClKNLwJhaWHbi6r46FIWi7qHtUn017hJLatXKp3HqzFm1F8qCx4yJOVa7oTMbqjQhrgHDBcss24_EO3t0VgNWLo9T06nE4mZnJ72iKfywz4Tj-GF2msjRmc_e48ITBNuEmQdNRYqC60NJ_mvwkv8Fba1PUr82vOPXladvpDZOJ7SkafpnGj0l6tP4MOQwhwYbc7ZaUmf-sT5LgpL-tCRhOUlBaYSbORPgw3wtOxUHUW1-VG0MVUeLXGBdwIdF53dXty7_ymR96soC-6nlqXC-uVdHuEZA9JXfL_gApyoiXVW5kkVPz5pd8A_VJKsImwKCjRSvzoQov5N1VOSPy-DSCs2q1NYzpCc8QODQmTHsKlhqXK8MM0rPAavpvdExyzoLwMlOo2L205Epa1DPsqiFlZrOjZZUU6lusVxuzEnoCC8ANVuDyOLZmu76Bbi-7eQ3puayf-qSF3mV3tmrC2mBcjiF9MctMnSaEWp09P7SDPWPpShLOcwqk9wavtTR3kwc1z5tMmCA-pXfFbqLqjhAgri7PkgnRMxkESMbXVjuhLxPT_qbVlhzLy4JbdBWi3GmtwpBlmWu1hqFn6aQYs8-wdL6E9wl54b3h7pT7tSmetOVGPg3t7B35CLSSyNRf1vB9tVlC3hF_aidniGFB4cxdNvOFcT_9oN7IkU5Wli3qVViMDcaafMN25tjS2Hwas5KW-Cbk8DeQgYM5HdJ8Ea2vtbzVJfUX9lOZETAz29buKaCukOVnpU0c_rSp8JcPR3v67XadE7emqORqK6yv9joQa4CuDU3Ud04SE_u7-tS7_TElOn7_EOn6gwAAFMpFWF0j-puJ-nMRjPb4l9RXAsM6QB88UYxqax5aO3s5che4U3yxZkaK4k9P1pke4S_ioJzH6xxbkDw5o7OolPN2gCLPk2V7RvzGIuMGc-eoMOo9bfsjF6RM6WfcyBeXHG-SXFXUNbolv8f9XUZsEGoB1Ug5CJEJZ50ByaZx8o5xhiJ8vVW377VFSuZz1imtGFQqbRPEtLErhcuST7p8V-sQPIOw5ItVCXvDh3Yy0gFMgBlbFZKVKDdwAH7QQA0yyENUz6BDzUiuyyEPXu4yO53UA5fTBoeaKX9Gk-c6QQU0dSj9lQY29e08etQaaJ9rCGzlnEJHO9OLZJmFsHNdmitX4sJfPzi6rCt6fSiwI9oEiWDJuOHp2HcMEGTXZGIIyuwuVC6isIGhQHqjZ1ZrrQhnuDHh-liLE5J8bSueB92XAXwLKq20P0pXhQyFy0scOF8-oM5WLsmHj4YSzvlxCzPfdKgKn-FeCBVmPNGfF0zqho1UB2yQKGc1Td1VGwPnrU1PUMB_lzOb8B2tJ0wtoOZpreidINyIXKU4E_nhJycxnU-EO1krfANSOn8GcVdW-0qvblZVqj4pn9-O6H3W9sJdC59r3AJatfSx5Y_ebSJMB_MLXIr1qL2hkdwQqCiOsnNAVXg93NxaGVE4ruIGLCII66H-eBk46kEYpn9eiW8k0fLIkMKVzmh_ecc4DLJVCba5OZWH9giGuTPC5JT2zD62rENh6pe2_fwk9fr6IVQbbth4mF5WVvIz1EOtuIr7Z8Xey583O4BQL13a7MRgyhi7LMmaQLUV8nCSMZgAAGEyzRs7YVxQAkOo8-CcF8XtTOMvWE-wO0wT0Ley7Bvyfvh6f2SCYBG6H6ykr6RC0CkkP7RIb9bGSCaSCPz9D7VasHH5_eqD_Auief2r7OxPWW1ikbaGikWnNCz2RFO4olc2XJwdaxbP7pzCetEYzkbun-Kst4CMZjSAh7cUGa1zvutCuNoEyJdWV5-5ITiZ1yLeynCkCbgTlykXXMMc8kOO5dmA43UPS5mM_PfwxvAS54qPuts9vfWgh1z72c_Zdc2sgAGSujEwrvdwCmbkHSDVlIPSNmEXqHJrFJWZ236CTyL8O2-I40GskYW_KouxtSU8jOdEUx-hSinuBRK62gMmGrZzkrugxcqPECx8zsYxTXY0NgD_0d9gUksBIx26q2lPK6iozk02-KkO5nVfOXfYuRkPU9-CG-6lnHnxuJa71xDQILz17VGRyA4TMPYc9iz5nQFSTCpm17l1fHmBfYI6PT-D_u3-BrNm6wp5pW_ZLY-UOjHtXxjdiRsrixVPtEYCuFVzO1SxMpyxcpjxsuxsjNUVt5wS_RMplRMyu-59thVDYUEf4uMe9-iZKZ-Ab3wSmGEck_U5-S9qJhBSpz_QSeuKN_F7id-87Pn1yy9TXWF46Qt_y-KAzy73dmQ_0WIDlYIJvyyNQC-_SnLw1Ws0IChVRgzFV7loyzXoKrHMmoPxZ1Mi7BEfypncU_1y0]--></g></svg>