<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="16997px" preserveAspectRatio="none" style="width:4102px;height:16997px;background:#FFFFFF;" version="1.1" viewBox="0 0 4102 16997" width="4102px" zoomAndPan="magnify"><title>Initiator Withdrawal Sequence Diagram (Without States)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="396.0446" x="1854.6716" y="29.9659">Initiator Withdrawal Sequence Diagram (Without States)</text><rect fill="#F0F8FF" height="16945.6391" style="stroke:#181818;stroke-width:0.5;" width="1555.7711" x="469" y="46.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="60.2941" x="1216.7385" y="59.9649">User Side</text><rect fill="none" height="1873.9512" style="stroke:#000000;stroke-width:1.5;" width="3507.4271" x="21" y="350.49"/><rect fill="none" height="1063.6527" style="stroke:#000000;stroke-width:1.5;" width="2335.7305" x="31" y="1153.7885"/><rect fill="none" height="2606.5438" style="stroke:#000000;stroke-width:1.5;" width="3296.3813" x="181" y="2238.4412"/><rect fill="none" height="4274.5529" style="stroke:#000000;stroke-width:1.5;" width="4067.3878" x="19" y="4858.985"/><rect fill="none" height="1098.7707" style="stroke:#000000;stroke-width:1.5;" width="2342.8445" x="29" y="4885.691"/><rect fill="#ADD8E6" height="161.9421" style="stroke:#000000;stroke-width:1.5;" width="888.7353" x="3106" y="6995.2325"/><rect fill="none" height="5727.738" style="stroke:#000000;stroke-width:1.5;" width="4087.3878" x="9" y="9147.5379"/><rect fill="none" height="4758.0853" style="stroke:#000000;stroke-width:1.5;" width="4067.3878" x="19" y="9890.5424"/><rect fill="#ADD8E6" height="161.9421" style="stroke:#000000;stroke-width:1.5;" width="888.7353" x="3106" y="10466.4868"/><rect fill="none" height="1063.3587" style="stroke:#000000;stroke-width:1.5;" width="2342.8445" x="29" y="12779.4404"/><rect fill="none" height="2003.3633" style="stroke:#000000;stroke-width:1.5;" width="3455.3813" x="22" y="14889.2758"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="487.3089" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="491" x2="491" y1="146.8419" y2="16909.6391"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="974.1313" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="977.1704" x2="977.1704" y1="146.8419" y2="16909.6391"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="1300.1306" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1303.2847" x2="1303.2847" y1="146.8419" y2="16909.6391"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="1359.7115" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1362.9765" x2="1362.9765" y1="146.8419" y2="16909.6391"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="1995.0571" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1998.3432" x2="1998.3432" y1="146.8419" y2="16909.6391"/></g><g><title>WT</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="2689.9836" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2693.5817" x2="2693.5817" y1="146.8419" y2="16909.6391"/></g><g><title>Peers</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="3442.0063" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3445.6314" x2="3445.6314" y1="146.8419" y2="16909.6391"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="16762.7973" width="8" x="3496.4042" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3500.3813" x2="3500.3813" y1="146.8419" y2="16909.6391"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="473" y="142.7399">User</text><ellipse cx="491.3089" cy="76.2739" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M491.3089,84.2739 L491.3089,111.2739 M478.3089,92.2739 L504.3089,92.2739 M491.3089,111.2739 L478.3089,126.2739 M491.3089,111.2739 L504.3089,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="473" y="16923.605">User</text><ellipse cx="491.3089" cy="16936.207" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M491.3089,16944.207 L491.3089,16971.207 M478.3089,16952.207 L504.3089,16952.207 M491.3089,16971.207 L478.3089,16986.207 M491.3089,16971.207 L504.3089,16986.207" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="961.1704" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="968.1704" y="134.7399">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="961.1704" y="16908.6391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="968.1704" y="16930.605">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="1269.2847" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="1276.2847" y="134.7399">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="1269.2847" y="16908.6391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="1276.2847" y="16930.605">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1348.9765" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1355.9765" y="134.7399">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1348.9765" y="16908.6391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1355.9765" y="16930.605">ST</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="1977.3432" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="1984.3432" y="134.7399">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="1977.3432" y="16908.6391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="1984.3432" y="16930.605">Niso</text></g><g class="participant participant-head" data-participant="WT"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8039" x="2676.5817" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8039" x="2683.5817" y="134.7399">WT</text></g><g class="participant participant-tail" data-participant="WT"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8039" x="2676.5817" y="16908.6391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8039" x="2683.5817" y="16930.605">WT</text></g><g class="participant participant-head" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7499" x="3424.6314" y="142.7399">Peers</text><ellipse cx="3446.0063" cy="76.2739" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3446.0063,84.2739 L3446.0063,111.2739 M3433.0063,92.2739 L3459.0063,92.2739 M3446.0063,111.2739 L3433.0063,126.2739 M3446.0063,111.2739 L3459.0063,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7499" x="3424.6314" y="16923.605">Peers</text><ellipse cx="3446.0063" cy="16936.207" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3446.0063,16944.207 L3446.0063,16971.207 M3433.0063,16952.207 L3459.0063,16952.207 M3446.0063,16971.207 L3433.0063,16986.207 M3446.0063,16971.207 L3459.0063,16986.207" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3477.3813" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3484.3813" y="134.7399">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3477.3813" y="16908.6391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3484.3813" y="16930.605">SARs</text></g><path d="M473,186.8419 L473,337.8419 L3518,337.8419 L3518,196.8419 L3508,186.8419 L473,186.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3508,186.8419 L3508,196.8419 L3518,196.8419 L3508,186.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="58.305" x="1390.9316" y="205.7389">Notation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="1449.2366" y="205.7389">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="774.7482" x="1394.3116" y="223.4449">withdrawal follows Setup and the state at the end of setup is inherited for all entities except Iso which loses state on shutdown.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1193.804" x="1394.3116" y="241.1509">"_i" in variable name indicates an integer less than 5, identifying peers, any operation done on this kind of variable is done on each element of a vector containing every peers' version of that value.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="647.3485" x="1394.3116" y="258.8569">Boomlet's niso_0_event_block_height is updated with freshly received value in each message containing it.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="978.6537" x="1394.3116" y="276.5629">Each message is represented by a name composed of stage||sender||receiver||# in which # represents the #th message from sender to receiver in that stage.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="833.3915" x="1394.3116" y="294.2689">In the withdrawal diagram peer_0 represents the peer that initiates the transaction and peer_1 represents one of the non-initiator peers.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="477.4125" x="1394.3116" y="311.975">Each entity inside user-side box of each peer_i is represented by entityName_i.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1121.9786" x="1394.3116" y="329.681">Some steps between initiator and non-initiator run asynchronously and concurrently, these steps when associated with non-initiator are denoted by an 'n' character at the end of step#.</text><path d="M21,350.49 L207.6091,350.49 L207.6091,360.196 L197.6091,370.196 L21,370.196 L21,350.49" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1873.9512" style="stroke:#000000;stroke-width:1.5;" width="3507.4271" x="21" y="350.49"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141.6091" x="36" y="365.387">Transaction Initiation</text><path d="M473,375.196 L473,632.196 L3518,632.196 L3518,385.196 L3508,375.196 L473,375.196" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3508,375.196 L3508,385.196 L3518,385.196 L3508,375.196" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="84.7731" x="1453.0782" y="394.093">PARAMETERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="411.799">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.1563" x="1467.4822" y="411.799">#define DURESS_CHECK_INTERVAL_IN_BLOCKS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="429.505">2.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.2575" x="1467.4822" y="429.505">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="447.2111">3.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="923.0917" x="1467.4822" y="447.2111">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="464.9171">4.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="915.1097" x="1467.4822" y="464.9171">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="482.6231">5.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="726.4667" x="1467.4822" y="482.6231">#define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_SAR_RESPONSE_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="500.3291">6.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="934.8569" x="1467.4822" y="500.3291">#define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_AND_NON_INITIATOR_PEERS_TO_RECEIVING_TX_COMMITMENT_BY_ALL_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="518.0351">7.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="836.6806" x="1467.4822" y="518.0351">#define TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_TO_RECEIVING_ALL_PINGS_BY_WT_AND_HAVING_SAR_RESPONSE_BACK_TO_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="535.7411">8.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="702.4947" x="1467.4822" y="535.7411">#define TOLERANCE_IN_BLOCKS_FROM_CREATING_PONG_BY_WT_TO_REVIEWING_THE_PONG_IN_PEERS_BOOMLET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1453.0782" y="553.4472">9.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="750.1917" x="1467.4822" y="553.4472">#define TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_BY_OTHER_PEERS_TO_REVIEWING_THE_PING_IN_PEER_BOOMLET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.356" x="1453.0782" y="571.1532">10.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="657.8266" x="1474.9182" y="571.1532">#define JUMP_IN_BLOCKS_IF_LAST_SEEN_BLOCK_LAGS_BEHIND_NISO_EVENT_BLOCK_HEIGHT_IN_BOOMLET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.356" x="1453.0782" y="588.8592">11.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1054.4308" x="1474.9182" y="588.8592">#define REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_APPROVAL_AND_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.356" x="1453.0782" y="606.5652">12.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="858.1569" x="1474.9182" y="606.5652">#define REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PEER_TX_COMMITMENT_AND_RECEIVING_ALL_TX_COMMITMENT_BY_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.356" x="1453.0782" y="624.2712">13.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="505.2065" x="1474.9182" y="624.2712">#define REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PING_AND_PONG</text><rect fill="#FEFFDD" height="25" style="stroke:#181818;stroke-width:0.5;" width="491" x="245" y="643.0802"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="483.6394" x="249" y="660.9772">User generates PSBT using a otherwise independent watch-only wallet module.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="490.8089" cy="714.4483" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,711.1983,1997.0571,715.1983,1987.0571,719.1983,1991.0571,715.1983" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="495.3089" x2="1993.0571" y1="715.1983" y2="715.1983"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="498.3089" y="700.5363">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.1351" x="525.787" y="691.6833">WithdrawalNisoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.91" x="529.167" y="709.3893">psbt</text></g><polygon fill="#FFF0F5" points="1570,728.1983,2427,728.1983,2437,758.1983,2427,789.1983,1570,789.1983,1560,758.1983,1570,728.1983" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="850.3954" x="1572" y="746.0953">Niso receives psbt from User. Niso checks that most_work_bitcoin_block_height has passed milestone_block_0 from boomerang_descriptor,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="769.6391" x="1575.38" y="763.8013">derives tx_id from psbt and stores it. Niso also checks to see if psbt inputs are satisfiable. It sends the psbt alongside the latest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.1262" x="1575.38" y="781.5073">block_height to Boomlet.</text><polygon fill="#E6E6FA" points="1802,799.3163,2194,799.3163,2204,811.3163,2194,824.3163,1802,824.3163,1792,811.3163,1802,799.3163" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="1804" y="817.2133">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="1671,835.0223,2325,835.0223,2335,847.0223,2325,860.0223,1671,860.0223,1661,847.0223,1671,835.0223" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.6373" x="1673" y="852.9194">Assert most_work_bitcoin_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><polygon fill="#E6E6FA" points="1806,870.7284,2190,870.7284,2200,891.7284,2190,913.7284,1806,913.7284,1796,891.7284,1806,870.7284" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.4982" x="1808" y="888.6254">tx_id := psbt.derive_tx_id().</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="1811.38" y="906.3314">niso_0_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1897,924.1404,2099,924.1404,2109,936.1404,2099,949.1404,1897,949.1404,1887,936.1404,1897,924.1404" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.5882" x="1899" y="942.0374">Assert hydrate_psbt(psbt) != Null</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,1009.9645,1305.1306,1013.9645,1315.1306,1017.9645,1311.1306,1013.9645" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="1013.2145" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="1013.9645" y2="1013.9645"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="990.4494">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="972.7434">WithdrawalNisoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.91" x="1351.9886" y="990.4494">psbt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="1351.9886" y="1008.1555">niso_0_event_block_height</text></g><polygon fill="#FFF0F5" points="895,1026.9645,1712,1026.9645,1722,1047.9645,1712,1069.9645,895,1069.9645,885,1047.9645,895,1026.9645" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="760.2533" x="897" y="1044.8615">Boomlet receives {psbt, niso_0_event_block_height} from Niso and checks to see if the niso_0_event_block_height has passed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="809.6794" x="900.38" y="1062.5675">milestone_block_0. Boomlet then derives tx_id from psbt, adds a nonce to it, encrypts it for st_0_identity_pubkey and sends it to Niso.</text><polygon fill="#FFC0CB" points="994,1080.3765,1612,1080.3765,1622,1092.3765,1612,1105.3765,994,1105.3765,984,1092.3765,994,1080.3765" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="614.6793" x="996" y="1098.2735">Assert niso_0_event_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><polygon fill="#E6E6FA" points="1223,1116.0825,1384,1116.0825,1394,1128.0825,1384,1141.0825,1223,1141.0825,1213,1128.0825,1223,1116.0825" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.0142" x="1225" y="1133.9795">tx_id := psbt.derive_tx_id()</text><path d="M31,1153.7885 L173.1881,1153.7885 L173.1881,1163.4945 L163.1881,1173.4945 L31,1173.4945 L31,1153.7885" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1063.6527" style="stroke:#000000;stroke-width:1.5;" width="2335.7305" x="31" y="1153.7885"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="97.1881" x="46" y="1168.6855">ST_check(tx_id)</text><polygon fill="#E6E6FA" points="807,1178.4945,1799,1178.4945,1809,1226.4945,1799,1274.4945,807,1274.4945,797,1226.4945,807,1178.4945" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.3782" x="809" y="1196.3916">tx_id_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.9301" x="812.38" y="1214.0976">content: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0002" x="812.38" y="1231.8036">nonce: rand() [u8; 32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="809" y="1249.5096">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="985.5306" x="812.38" y="1267.2156">tx_id_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: tx_id_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="1320.6867" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,1317.4367,1997.0571,1321.4367,1987.0571,1325.4367,1991.0571,1321.4367" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="1321.4367" y2="1321.4367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="1306.7746">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="1297.9216">WithdrawalBoomletNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.2372" x="1341.9886" y="1315.6277">tx_id_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1693,1334.4367,2304,1334.4367,2314,1346.4367,2304,1359.4367,1693,1359.4367,1683,1346.4367,1693,1334.4367" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="607.9325" x="1695" y="1352.3337">Niso receives tx_id_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1374.7115,1402.5547,1364.7115,1406.5547,1374.7115,1410.5547,1370.7115,1406.5547" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="1405.8047" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1368.7115" x2="1994.0571" y1="1406.5547" y2="1406.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1380.7115" y="1391.8927">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.5581" x="1408.1895" y="1383.0397">WithdrawalNisoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.2372" x="1411.5695" y="1400.7457">tx_id_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="955,1419.5547,1770,1419.5547,1780,1431.5547,1770,1444.5547,955,1444.5547,945,1431.5547,955,1419.5547" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="811.4604" x="957" y="1437.4517">ST receives tx_id_with_nonce_encrypted_by_boomlet_0_for_st from Niso, decrypts it, separates the nonce and sends the tx_id to User.</text><polygon fill="#E6E6FA" points="867,1455.2607,1859,1455.2607,1869,1476.2607,1859,1498.2607,867,1498.2607,857,1476.2607,867,1455.2607" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="985.4915" x="869" y="1473.1577">tx_id_with_nonce := AES_decrypt(private_key: ECDH(st_0_identity_privkey, boomlet_0_identity_pubkey), content: tx_id_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.7852" x="872.38" y="1490.8638">tx_id := tx_id_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="502.3089,1541.0848,492.3089,1545.0848,502.3089,1549.0848,498.3089,1545.0848" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1363.2115" cy="1544.3348" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="496.3089" x2="1358.7115" y1="1545.0848" y2="1545.0848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="508.3089" y="1530.4228">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142.8311" x="535.787" y="1521.5698">WithdrawalStOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.691" x="539.167" y="1539.2758">tx_id</text></g><polygon fill="#FFF0F5" points="51,1558.0848,931,1558.0848,941,1570.0848,931,1583.0848,51,1583.0848,41,1570.0848,51,1558.0848" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="876.5385" x="53" y="1575.9818">User receives tx_id from ST and checks to see if it matches that of the psbt he generated. User then informs ST of his acknowledgement of tx_id.</text><polygon fill="#FFC0CB" points="388,1593.7908,594,1593.7908,604,1605.7908,594,1618.7908,388,1618.7908,378,1605.7908,388,1593.7908" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.5012" x="390" y="1611.6878">Assert tx_id == psbt.derive_tx_id()</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="490.8089" cy="1665.1589" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1351.7115,1661.9089,1361.7115,1665.9089,1351.7115,1669.9089,1355.7115,1665.9089" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="495.3089" x2="1357.7115" y1="1665.9089" y2="1665.9089"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="498.3089" y="1651.2468">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.8981" x="525.787" y="1642.3938">WithdrawalStInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="738.3875" x="529.167" y="1660.0999">magic: "withdrawal_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"</text></g><polygon fill="#FFF0F5" points="916,1678.9089,1811,1678.9089,1821,1708.9089,1811,1739.9089,916,1739.9089,906,1708.9089,916,1678.9089" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="887.7185" x="918" y="1696.8059">ST receives {magic: "withdrawal_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"} from User.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="843.6874" x="921.38" y="1714.5119">ST then signs the tx_id_with_nonce it received with st_privkey and encrypts it with boomlet_0_identity_pubkey. It then sends this encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.6891" x="921.38" y="1732.2179">message to Niso.</text><polygon fill="#E6E6FA" points="783,1750.0269,1943,1750.0269,1953,1798.0269,1943,1846.0269,783,1846.0269,773,1798.0269,783,1750.0269" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.0824" x="785" y="1767.9239">tx_id_with_nonce_signed_by_st := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.4013" x="788.38" y="1785.6299">signature: schnorr_sign(st_0_identity_privkey, tx_id_with_nonce)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.7942" x="788.38" y="1803.336">content: tx_id_with_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="785" y="1821.042">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1153.127" x="788.38" y="1838.748">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(st_0_identity_privkey, boomlet_0_identity_pubkey), content: tx_id_with_nonce_signed_by_st)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1363.2115" cy="1892.219" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,1888.969,1997.0571,1892.969,1987.0571,1896.969,1991.0571,1892.969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1367.7115" x2="1993.0571" y1="1892.969" y2="1892.969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1370.7115" y="1878.307">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.5581" x="1398.1895" y="1869.454">WithdrawalStNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386.0353" x="1401.5695" y="1887.16">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1651,1905.969,2346,1905.969,2356,1917.969,2346,1930.969,1651,1930.969,1641,1917.969,1651,1905.969" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="691.7305" x="1653" y="1923.866">Niso receives tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,1974.0871,1305.1306,1978.0871,1315.1306,1982.0871,1311.1306,1978.0871" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="1977.3371" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="1978.0871" y2="1978.0871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="1963.4251">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="1954.5721">WithdrawalNisoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386.0353" x="1351.9886" y="1972.2781">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="860,1991.0871,1748,1991.0871,1758,2039.0871,1748,2087.0871,860,2087.0871,850,2039.0871,860,1991.0871" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="880.8544" x="862" y="2008.9841">Boomlet receives tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from Niso, decrypts it, verifies st_0_identity_pubkey's signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="815.5815" x="865.38" y="2026.6901">and checks if the content is the same as the one sent i.e. User has acknowledged the tx_id and the message is fresh. It then generates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="841.8804" x="865.38" y="2044.3961">peer_0_tx_approval composed of {"approved", tx_id, event_block_height}, signs it with boomlet_0_identity_privkey and encrypts it for wt. It</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.4323" x="865.38" y="2062.1021">then encrypts psbt for every other boomlet_i using their respective identity_pubkey. Boomlet sends the resulting psbt_encrypted_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="570.6094" x="865.38" y="2079.8082">alongside peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt to Niso.</text><polygon fill="#E6E6FA" points="738,2097.6172,1869,2097.6172,1879,2109.6172,1869,2122.6172,738,2122.6172,728,2109.6172,738,2097.6172" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1127.9976" x="740" y="2115.5142">tx_id_with_nonce_signed_by_st := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1017,2133.3232,1589,2133.3232,1599,2145.3232,1589,2158.3232,1017,2158.3232,1007,2145.3232,1017,2133.3232" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="568.8025" x="1019" y="2151.2202">Assert schnorr_verify(st_0_identity_pubkey, tx_id_with_nonce_signed_by_st.signature) == True</text><polygon fill="#FFC0CB" points="1097,2169.0292,1509,2169.0292,1519,2190.0292,1509,2212.0292,1097,2212.0292,1087,2190.0292,1097,2169.0292" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1099" y="2186.9262">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="405.4183" x="1102.38" y="2204.6322">Assert tx_id_with_nonce_signed_by_st.content == tx_id_with_nonce</text><path d="M181,2238.4412 L364.9831,2238.4412 L364.9831,2248.1472 L354.9831,2258.1472 L181,2258.1472 L181,2238.4412" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2606.5438" style="stroke:#000000;stroke-width:1.5;" width="3296.3813" x="181" y="2238.4412"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.9831" x="196" y="2253.3382">Transaction Approval</text><polygon fill="#E6E6FA" points="677,2263.1472,1930,2263.1472,1940,2373.1472,1930,2483.1472,677,2483.1472,667,2373.1472,677,2263.1472" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.6252" x="679" y="2281.0443">peer_0_tx_approval := TxApproval{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.4411" x="682.38" y="2298.7503">magic: "approved",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="682.38" y="2316.4563">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.0782" x="682.38" y="2334.1623">event_block_height: niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="679" y="2351.8683">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409.7083" x="682.38" y="2369.5743">peer_0_tx_approval_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442.8195" x="682.38" y="2387.2804">signature: schnorr_sign(boomlet_0_identity_privkey, peer_0_tx_approval)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.8731" x="682.38" y="2404.9864">content: peer_0_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="679" y="2422.6924">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1242.8397" x="682.38" y="2440.3984">_peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: _peer_0_tx_approval_signed_by_boomlet_0)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="989.7168" x="682.38" y="2458.1044">psbt_encrypted_by_boomlet_0_for_boomlet_i := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, boomlet_i_identity_privkey), content: psbt) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="599.2617" x="682.38" y="2475.8104">psbt_encrypted_collection := Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="2546.9875" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,2543.7375,1997.0571,2547.7375,1987.0571,2551.7375,1991.0571,2547.7375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="2547.7375" y2="2547.7375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="2524.2225">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="2506.5165">WithdrawalBoomletNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.6523" x="1341.9886" y="2524.2225">peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="588.4457" x="1341.9886" y="2541.9285">psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1422,2560.7375,2576,2560.7375,2586,2581.7375,2576,2603.7375,1422,2603.7375,1412,2581.7375,1422,2560.7375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1146.7175" x="1424" y="2578.6345">Niso receives {peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.5592" x="1427.38" y="2596.3405">from Boomlet and forwards them to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="1998.5571" cy="2685.2236" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2681.9836,2681.9736,2691.9836,2685.9736,2681.9836,2689.9736,2685.9836,2685.9736" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2003.0571" x2="2687.9836" y1="2685.9736" y2="2685.9736"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2006.0571" y="2653.6056">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2033.5351" y="2627.0465">WithdrawalNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2033.5351" y="2644.7526">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200.9541" x="2036.9151" y="2644.7526">[start of non-initiator diagram]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.6523" x="2036.9151" y="2662.4586">peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="588.4457" x="2036.9151" y="2680.1646">psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2120,2698.9736,3266,2698.9736,3276,2746.9736,3266,2794.9736,2120,2794.9736,2110,2746.9736,2120,2698.9736" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1138.7097" x="2122" y="2716.8706">WT receives {peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [1 &lt;= i &lt;= 4]}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="895.8174" x="2125.38" y="2734.5766">from Niso. WT decrypts peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, verifies boomlet_0_identity_pubkey's signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="832.5464" x="2125.38" y="2752.2826">and checks the string to match "approved". WT stores the tx_id from peer_0_tx_approval and checks that the event_block_height is fresh.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="882.8823" x="2125.38" y="2769.9886">Then it constructs it's own tx_approval composed of {"approved",tx_id,most_work_bitcoin_block_height, boomlet_0_identity_pubkey} and signs it.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1022.0474" x="2125.38" y="2787.6947">It sends to each non-initiator peer wt_tx_approval_signed_by_wt, peer_0_tx_approval_signed_by_boomlet_0 and psbt encrypted by that peer's boomlet_identity_pubkey.</text><polygon fill="#E6E6FA" points="2497,2805.5037,2889,2805.5037,2899,2817.5037,2889,2830.5037,2497,2830.5037,2487,2817.5037,2497,2805.5037" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2499" y="2823.4007">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#E6E6FA" points="2088,2841.2097,3298,2841.2097,3308,2853.2097,3298,2866.2097,2088,2866.2097,2078,2853.2097,2088,2841.2097" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1206.1666" x="2090" y="2859.1067">peer_0_tx_approval_signed_by_boomlet_0 := AES_decrypt(privkey: ECDH(wt_privkey, boomlet_0_identity_pubkey), content: peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt)</text><polygon fill="#FFC0CB" points="2353,2876.9157,3033,2876.9157,3043,2888.9157,3033,2901.9157,2353,2901.9157,2343,2888.9157,2353,2876.9157" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.7676" x="2355" y="2894.8127">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_approval_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2471,2912.6217,2916,2912.6217,2926,2924.6217,2916,2937.6217,2471,2937.6217,2461,2924.6217,2471,2912.6217" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.6363" x="2473" y="2930.5187">peer_0_tx_approval := peer_0_tx_approval_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2546,2948.3277,2840,2948.3277,2850,2960.3277,2840,2973.3277,2546,2973.3277,2536,2960.3277,2546,2948.3277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.8622" x="2548" y="2966.2247">Assert peer_0_tx_approval.magic == "approved"</text><polygon fill="#E6E6FA" points="2593,2984.0338,2793,2984.0338,2803,2996.0338,2793,3009.0338,2593,3009.0338,2583,2996.0338,2593,2984.0338" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.6642" x="2595" y="3001.9308">tx_id := peer_0_tx_approval.tx_id</text><polygon fill="#FFC0CB" points="2143,3019.7398,3243,3019.7398,3253,3049.7398,3243,3080.7398,2143,3080.7398,2133,3049.7398,2143,3019.7398" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="2145" y="3037.6368">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1089.6478" x="2148.38" y="3055.3428">Assert peer_0_tx_approval.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="506.8053" x="2148.38" y="3073.0488">Assert peer_0_tx_approval.event_block_height &lt;= most_work_bitcoin_block_height .</text><polygon fill="#E6E6FA" points="2523,3090.8578,2864,3090.8578,2874,3173.8578,2864,3257.8578,2523,3257.8578,2513,3173.8578,2523,3090.8578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.0721" x="2525" y="3108.7548">_wt_tx_approval := TxApproval{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.4411" x="2528.38" y="3126.4608">magic: "approved",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="2528.38" y="3144.1669">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.5203" x="2528.38" y="3161.8729">event_block_height: most_work_bitcoin_block_height,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.9582" x="2528.38" y="3179.5789">initiator_id: boomlet_0_identity_pubkey}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333.8273" x="2528.38" y="3197.2849">wt_tx_approval_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.8533" x="2528.38" y="3214.9909">signature: schnorr_sign(wt_privkey, _wt_tx_approval)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.3201" x="2528.38" y="3232.6969">content: _wt_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2525" y="3250.403">}</text><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2693.4836" cy="3339.286" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3434.0063,3336.036,3444.0063,3340.036,3434.0063,3344.036,3438.0063,3340.036" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3440.0063" y1="3340.036" y2="3340.036"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="3307.668">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2728.4617" y="3281.109">WithdrawalWtNonInitiatorNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="2731.8417" y="3298.815">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.4632" x="2731.8417" y="3316.521">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.5732" x="2731.8417" y="3334.227">psbt_encrypted_by_boomlet_0_for_boomlet_i</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,3385.4481,2694.9836,3389.4481,2704.9836,3393.4481,2700.9836,3389.4481" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3445.5063" cy="3388.6981" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3441.0063" y1="3389.4481" y2="3389.4481"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="3374.7861">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2738.4617" y="3365.933">WithdrawalNonInitiatorNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.8303" x="2741.8417" y="3383.6391">peer_i_tx_approval_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2010.0571,3452.5661,2000.0571,3456.5661,2010.0571,3460.5661,2006.0571,3456.5661" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2693.4836" cy="3455.8161" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2004.0571" x2="2688.9836" y1="3456.5661" y2="3456.5661"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2016.0571" y="3433.0511">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2043.5351" y="3415.3451">WithdrawalWtNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="395.9023" x="2046.9151" y="3433.0511">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="2046.9151" y="3450.7571">wt_tx_approval_signed_by_wt</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2693.4836" cy="3505.2281" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3434.0063,3501.9781,3444.0063,3505.9781,3434.0063,3509.9781,3438.0063,3505.9781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3440.0063" y1="3505.9781" y2="3505.9781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="3491.3161">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2728.4617" y="3482.4631">WithdrawalWtNonInitiatorNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="395.9023" x="2731.8417" y="3500.1691">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1515,3518.9781,2481,3518.9781,2491,3557.9781,2481,3596.9781,1515,3596.9781,1505,3557.9781,1515,3518.9781" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.9363" x="1517" y="3536.8752">Niso receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4], wt_tx_approval_signed_by_wt} from WT. Niso verifies each</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="955.7472" x="1520.38" y="3554.5812">boomlet_i_identity_pubkey's signature on each peer_i_tx_approval_signed_by_boomlet_i and verifies wt_pubkey's signature on wt_tx_approval_signed_by_wt.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="858.5596" x="1520.38" y="3572.2872">It checks the magic string for every approval to match "approved", the tx_id to match what was sent and the event_block_heights to be in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="823.6936" x="1520.38" y="3589.9932">appropriate range. It forwards Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4] along with the latest block to Boomlet.</text><polygon fill="#E6E6FA" points="1802,3607.8022,2194,3607.8022,2204,3619.8022,2194,3632.8022,1802,3632.8022,1792,3619.8022,1802,3607.8022" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="1804" y="3625.6992">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="1628,3643.5082,2369,3643.5082,2379,3655.5082,2369,3668.5082,1628,3668.5082,1618,3655.5082,1628,3643.5082" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="737.9457" x="1630" y="3661.4052">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1747,3679.2142,2250,3679.2142,2260,3691.2142,2250,3704.2142,1747,3704.2142,1737,3691.2142,1747,3679.2142" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.4734" x="1749" y="3697.1113">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1741,3714.9203,2256,3714.9203,2266,3744.9203,2256,3775.9203,1741,3775.9203,1731,3744.9203,1741,3714.9203" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="508.5864" x="1743" y="3732.8173">_peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.2022" x="1746.38" y="3750.5233">_wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="1746.38" y="3768.2293">niso_0_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1812,3786.0383,2185,3786.0383,2195,3798.0383,2185,3811.0383,1812,3811.0383,1802,3798.0383,1812,3786.0383" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369.4603" x="1814" y="3803.9353">Assert _peer_i_tx_approval.magic == "approved". [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1860,3821.7443,2137,3821.7443,2147,3833.7443,2137,3846.7443,1860,3846.7443,1850,3833.7443,1860,3821.7443" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.7932" x="1862" y="3839.6413">Assert _wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="1836,3857.4503,2160,3857.4503,2170,3869.4503,2160,3882.4503,1836,3882.4503,1826,3869.4503,1836,3857.4503" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.7493" x="1838" y="3875.3474">Assert _peer_i_tx_approval.tx_id == tx_id. [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1882,3893.1564,2114,3893.1564,2124,3905.1564,2114,3918.1564,1882,3918.1564,1872,3905.1564,1882,3893.1564" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.4622" x="1884" y="3911.0534">Assert  _wt_tx_approval.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="1325,3928.8624,2671,3928.8624,2681,3958.8624,2671,3989.8624,1325,3989.8624,1315,3958.8624,1325,3928.8624" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1327" y="3946.7594">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="514.8004" x="1330.38" y="3964.4654">Assert wt_tx_approval.event_block_height &gt;= peer_0_tx_approval.event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1339.3392" x="1330.38" y="3982.1714">Assert wt_tx_approval.event_block_height &lt;= min (peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT, most_work_bitcoin_block_height)</text><polygon fill="#FFC0CB" points="1136,3999.9804,2861,3999.9804,2871,4029.9804,2861,4060.9804,1136,4060.9804,1126,4029.9804,1136,3999.9804" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1138" y="4017.8774">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1714.4674" x="1141.38" y="4035.5835">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_INITIATOR_PEER)) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1598.9235" x="1141.38" y="4053.2895">Assert  peer_i_tx_approval.event_block_height &lt;= (most_work_bitcoin_block_height - REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_APPROVAL_AND_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER)  [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="878,4071.0985,3118,4071.0985,3128,4101.0985,3118,4132.0985,878,4132.0985,868,4101.0985,878,4071.0985" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="880" y="4088.9955">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="2230.23" x="883.38" y="4106.7015">Assert peer_0_tx_approval.event_block_height &gt;= max((wt_tx_approval.event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT) , (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.1804" x="883.38" y="4124.4075">Assert  peer_0_tx_approval.event_block_height &lt;= wt_tx_approval.event_block_height</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,4210.0406,1305.1306,4214.0406,1315.1306,4218.0406,1311.1306,4214.0406" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="4213.2906" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="4214.0406" y2="4214.0406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="4181.6726">[27]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="4155.1135">WithdrawalNisoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="395.9023" x="1351.9886" y="4172.8196">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="1351.9886" y="4190.5256">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="1351.9886" y="4208.2316">niso_0_event_block_height</text></g><polygon fill="#FFF0F5" points="864,4227.0406,1743,4227.0406,1753,4284.0406,1743,4341.0406,864,4341.0406,854,4284.0406,864,4227.0406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="869.1934" x="866" y="4244.9376">Boomlet receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4], wt_tx_approval_signed_by_wt, niso_0_event_block_height}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="867.3213" x="869.38" y="4262.6436">from Niso. Boomlet verifies each boomlet_i_identity_pubkey's signature on each peer_i_tx_approval_signed_by_boomlet_i, verifies wt_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.5193" x="869.38" y="4280.3496">signature on wt_tx_approval_signed_by_wt and updates niso_0_event_block_height with the new value. It checks the magic string for every</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="868.8033" x="869.38" y="4298.0557">approval to match "approved", the tx_id to match what was sent and the event_block_heights to be in the appropriate range. It then generates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="806.7672" x="869.38" y="4315.7617">duress_check_space which is an array of 5 integers between 1 and 195, adds a nonce to it and encrypts it using. Then Boomlet sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.2773" x="869.38" y="4333.4677">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st to Niso.</text><polygon fill="#FFC0CB" points="969,4351.2767,1637,4351.2767,1647,4363.2767,1637,4376.2767,969,4376.2767,959,4363.2767,969,4351.2767" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.5215" x="971" y="4369.1737">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True</text><polygon fill="#FFC0CB" points="1052,4386.9827,1555,4386.9827,1565,4398.9827,1555,4411.9827,1052,4411.9827,1042,4398.9827,1052,4386.9827" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.4734" x="1054" y="4404.8797">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1082,4422.6887,1524,4422.6887,1534,4452.6887,1524,4483.6887,1082,4483.6887,1072,4452.6887,1082,4422.6887" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435.1624" x="1084" y="4440.5857">_peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.2022" x="1087.38" y="4458.2918">_wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.6573" x="1087.38" y="4475.9978">update niso_0_event_block_height with received value.</text><polygon fill="#FFC0CB" points="1154,4493.8068,1454,4493.8068,1464,4505.8068,1454,4518.8068,1154,4518.8068,1144,4505.8068,1154,4493.8068" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296.0363" x="1156" y="4511.7038">Assert _peer_i_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="1165,4529.5128,1442,4529.5128,1452,4541.5128,1442,4554.5128,1165,4554.5128,1155,4541.5128,1165,4529.5128" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.7932" x="1167" y="4547.4098">Assert _wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="1178,4565.2188,1429,4565.2188,1439,4577.2188,1429,4590.2188,1178,4590.2188,1168,4577.2188,1178,4565.2188" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.3252" x="1180" y="4583.1158">Assert _peer_i_tx_approval.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="1187,4600.9248,1419,4600.9248,1429,4612.9248,1419,4625.9248,1187,4625.9248,1177,4612.9248,1187,4600.9248" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.4622" x="1189" y="4618.8218">Assert  _wt_tx_approval.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="648,4636.6308,1958,4636.6308,1968,4666.6308,1958,4697.6308,648,4697.6308,638,4666.6308,648,4636.6308" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="650" y="4654.5279">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="514.8004" x="653.38" y="4672.2339">Assert wt_tx_approval.event_block_height &gt;= peer_0_tx_approval.event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1303.3813" x="653.38" y="4689.9399">Assert wt_tx_approval.event_block_height &lt;= min (peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT, niso_0_event_block_height)</text><polygon fill="#FFC0CB" points="459,4707.7489,2148,4707.7489,2158,4737.7489,2148,4768.7489,459,4768.7489,449,4737.7489,459,4707.7489" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="461" y="4725.6459">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1678.5094" x="464.38" y="4743.3519">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_INITIATOR_PEER)) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1562.9655" x="464.38" y="4761.0579">Assert  peer_i_tx_approval.event_block_height &lt;= (niso_0_event_block_height - REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_INITIATOR_PEER_TX_APPROVAL_AND_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER)  [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="201,4778.8669,2406,4778.8669,2416,4808.8669,2406,4839.8669,201,4839.8669,191,4808.8669,201,4778.8669" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="203" y="4796.764">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="2194.272" x="206.38" y="4814.47">Assert peer_0_tx_approval.event_block_height &gt;= max((wt_tx_approval.event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT) , (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_RECEIVING_ALL_NON_INITIATOR_TX_APPROVALS_BY_INITIATOR_PEER))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.1804" x="206.38" y="4832.176">Assert  peer_0_tx_approval.event_block_height &lt;= wt_tx_approval.event_block_height</text><path d="M19,4858.985 L230.4911,4858.985 L230.4911,4868.691 L220.4911,4878.691 L19,4878.691 L19,4858.985" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="4274.5529" style="stroke:#000000;stroke-width:1.5;" width="4067.3878" x="19" y="4858.985"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="166.4911" x="34" y="4873.882">Transaction Commitment</text><path d="M29,4885.691 L163.9731,4885.691 L163.9731,4895.397 L153.9731,4905.397 L29,4905.397 L29,4885.691" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1098.7707" style="stroke:#000000;stroke-width:1.5;" width="2342.8445" x="29" y="4885.691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.9731" x="44" y="4900.588">duress_check:</text><polygon fill="#E6E6FA" points="713,4910.397,1893,4910.397,1903,4958.397,1893,5006.397,713,5006.397,703,4958.397,713,4910.397" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.2313" x="715" y="4928.294">duress_check_space := DuressCheckSpace{space: rand([1..195;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2902" x="718.38" y="4946.0001">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3582" x="718.38" y="4963.7061">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="718.38" y="4981.4121">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.355" x="718.38" y="4999.1181">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="5052.5891" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,5049.3391,1997.0571,5053.3391,1987.0571,5057.3391,1991.0571,5053.3391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="5053.3391" y2="5053.3391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="5038.6771">[28]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="5029.8241">WithdrawalBoomletNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1341.9886" y="5047.5301">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1646,5066.3391,2351,5066.3391,2361,5078.3391,2351,5091.3391,1646,5091.3391,1636,5078.3391,1646,5066.3391" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="701.8445" x="1648" y="5084.2362">Niso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1374.7115,5134.4572,1364.7115,5138.4572,1374.7115,5142.4572,1370.7115,5138.4572" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="5137.7072" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1368.7115" x2="1994.0571" y1="5138.4572" y2="5138.4572"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1380.7115" y="5123.7952">[29]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.5581" x="1408.1895" y="5114.9422">WithdrawalNisoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1411.5695" y="5132.6482">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="837,5151.4572,1888,5151.4572,1898,5181.4572,1888,5212.4572,837,5212.4572,827,5181.4572,837,5151.4572" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1044.1343" x="839" y="5169.3542">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Niso, decrypts it to get duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="843.9214" x="842.38" y="5187.0602">assign a country to each of the numbers in the duress_check_space corresponding to its alphabetical rank and shows this array to User for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.6501" x="842.38" y="5204.7662">him to select 5 of them.</text><polygon fill="#E6E6FA" points="773,5222.5752,1953,5222.5752,1963,5243.5752,1953,5265.5752,773,5265.5752,763,5243.5752,773,5222.5752" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.3156" x="775" y="5240.4723">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.6093" x="778.38" y="5258.1783">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="502.3089,5308.3993,492.3089,5312.3993,502.3089,5316.3993,498.3089,5312.3993" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1363.2115" cy="5311.6493" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="496.3089" x2="1358.7115" y1="5312.3993" y2="5312.3993"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="508.3089" y="5297.7373">[30]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142.8311" x="535.787" y="5288.8843">WithdrawalStOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6031" x="539.167" y="5306.5903">duress_check_space</text></g><polygon fill="#FFF0F5" points="49,5325.3993,932,5325.3993,942,5346.3993,932,5368.3993,49,5368.3993,39,5346.3993,49,5325.3993" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="876.473" x="51" y="5343.2963">User receives duress_check_space from ST. If he is not being coerced he will select 1 country in each column to replicate the duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.6331" x="54.38" y="5361.0023">and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="490.8089" cy="5414.4734" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1351.7115,5411.2234,1361.7115,5415.2234,1351.7115,5419.2234,1355.7115,5415.2234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="495.3089" x2="1357.7115" y1="5415.2234" y2="5415.2234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="498.3089" y="5400.5614">[31]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.8981" x="525.787" y="5391.7084">WithdrawalStInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5771" x="529.167" y="5409.4144">duress_signal_index</text></g><polygon fill="#FFF0F5" points="849,5428.2234,1877,5428.2234,1887,5449.2234,1877,5471.2234,849,5471.2234,839,5449.2234,849,5428.2234" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1020.9034" x="851" y="5446.1204">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the nonce from previously received duress_check_space_with_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.5793" x="854.38" y="5463.8264">encrypts it for Boomlet and sends it to Niso.</text><polygon fill="#E6E6FA" points="773,5481.6354,1953,5481.6354,1963,5520.6354,1953,5559.6354,773,5559.6354,763,5520.6354,773,5481.6354" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2642" x="775" y="5499.5324">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3322" x="778.38" y="5517.2384">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="778.38" y="5534.9445">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.303" x="778.38" y="5552.6505">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1363.2115" cy="5606.1215" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,5602.8715,1997.0571,5606.8715,1987.0571,5610.8715,1991.0571,5606.8715" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1367.7115" x2="1993.0571" y1="5606.8715" y2="5606.8715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1370.7115" y="5592.2095">[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.5581" x="1398.1895" y="5583.3565">WithdrawalStNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1401.5695" y="5601.0625">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1646,5619.8715,2351,5619.8715,2361,5631.8715,2351,5644.8715,1646,5644.8715,1636,5631.8715,1646,5619.8715" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="701.8185" x="1648" y="5637.7685">Niso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,5687.9896,1305.1306,5691.9896,1315.1306,5695.9896,1311.1306,5691.9896" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="5691.2396" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="5691.9896" y2="5691.9896"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="5677.3275">[33]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="5668.4745">WithdrawalNisoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1351.9886" y="5686.1806">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="837,5704.9896,1770,5704.9896,1780,5761.9896,1770,5818.9896,837,5818.9896,827,5761.9896,837,5704.9896" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="925.6393" x="839" y="5722.8866">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Niso. Boomlet will search for the indices in duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.7363" x="842.38" y="5740.5926">assigning the resulting value to duress_signal.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="536.9523" x="842.38" y="5758.2986">If the duress_signal is composed of the same set of numbers as the duress_consent_set,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="899.6132" x="842.38" y="5776.0046">duress_placeholder_plaintext will be assigned an empty padding otherwise it will be the doxing_key. duress_placeholder_plaintext will be encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="853.7364" x="842.38" y="5793.7106">to make up duress_placeholder. Boomlet then constructs peer_0_tx_commit composed of {"commit" ,tx_id , niso_0_event_block_height}, and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.4013" x="842.38" y="5811.4167">signs it, pads it with duress_placeholder, resigns it,d encrypts it with wt_pubkey and sends the result to Niso.</text><polygon fill="#E6E6FA" points="715,5829.2257,1892,5829.2257,1902,5841.2257,1892,5854.2257,715,5854.2257,705,5841.2257,715,5829.2257" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.2635" x="717" y="5847.1227">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1029,5864.9317,1577,5864.9317,1587,5885.9317,1577,5907.9317,1029,5907.9317,1019,5885.9317,1029,5864.9317" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1031" y="5882.8287">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.0215" x="1034.38" y="5900.5347">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="903,5918.3437,1705,5918.3437,1715,5948.3437,1705,5979.3437,903,5979.3437,893,5948.3437,903,5918.3437" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.3503" x="905" y="5936.2407">duress_signal := duress_check_space[duress_signal_index_with_nonce.content]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="781.8984" x="908.38" y="5953.9467">duress_placeholder_plaintext := Evaluate(duress_signal, duress_consent_set, doxing_key) [either padding of False or doxing_key]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.7034" x="908.38" y="5971.6528">duress_placeholder := AES_encrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_plaintext)</text><polygon fill="#E6E6FA" points="577,5996.4618,2029,5996.4618,2039,6150.4618,2029,6305.4618,577,6305.4618,567,6150.4618,577,5996.4618" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.7472" x="579" y="6014.3588">_peer_0_tx_commit := TxCommit{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.4551" x="582.38" y="6032.0648">magic: "commit",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="582.38" y="6049.7708">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.0782" x="582.38" y="6067.4768">event_block_height: niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="579" y="6085.1828">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.1743" x="582.38" y="6102.8888">_peer_0_tx_commit_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="444.7695" x="582.38" y="6120.5949">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_tx_commit),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.3392" x="582.38" y="6138.3009">content: _peer_0_tx_commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="579" y="6156.0069">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="740.7666" x="582.38" y="6173.7129">_peer_0_tx_commit_signed_by_boomlet_0_padded := PaddedMessage{content: _peer_0_tx_commit_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.6442" x="582.38" y="6191.4189">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="579" y="6209.1249">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="597.8965" x="582.38" y="6226.831">_peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="634.4916" x="582.38" y="6244.537">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_tx_commit_signed_by_boomlet_0_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360.0614" x="582.38" y="6262.243">content: _peer_0_tx_commit_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="579" y="6279.949">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1445.2372" x="582.38" y="6297.655">_peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(privkey: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: _peer_0_tx_commit_signed_by_boomlet_0_padded)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="6351.1261" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,6347.8761,1997.0571,6351.8761,1987.0571,6355.8761,1991.0571,6351.8761" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="6351.8761" y2="6351.8761"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="6337.2141">[34]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="6328.361">WithdrawalBoomletNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.0685" x="1341.9886" y="6346.0671">peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="1521,6364.8761,2475,6364.8761,2485,6376.8761,2475,6389.8761,1521,6389.8761,1511,6376.8761,1521,6364.8761" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="950.7166" x="1523" y="6382.7731">Niso receives peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="1998.5571" cy="6436.2441" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2681.9836,6432.9941,2691.9836,6436.9941,2681.9836,6440.9941,2685.9836,6436.9941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2003.0571" x2="2687.9836" y1="6436.9941" y2="6436.9941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2006.0571" y="6422.3321">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2033.5351" y="6413.4791">WithdrawalNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.0685" x="2036.9151" y="6431.1851">peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="2170,6449.9941,3217,6449.9941,3227,6488.9941,3217,6527.9941,2170,6527.9941,2160,6488.9941,2170,6449.9941" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1003.2235" x="2172" y="6467.8911">WT receives peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Niso and approvals_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="916.2793" x="2175.38" y="6485.5971">from each non-initiator Peer (async). It decrypts the message from Niso to get peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1036.9194" x="2175.38" y="6503.3032">and verifies boomlet_0_identity_pubkey's signature. It then derives duress_placeholder by separating the padding from _peer_0_tx_commit_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="483.0934" x="2175.38" y="6521.0092">and sends it to ST. It also saves peer_0_tx_commit_signed_by_boomlet for later.</text><polygon fill="#E6E6FA" points="1900,6538.8182,3486,6538.8182,3496,6550.8182,3486,6563.8182,1900,6563.8182,1890,6550.8182,1900,6538.8182" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1582.5432" x="1902" y="6556.7152">_peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0 := AES_decrypt(privkey: ECDH(wt_privkey, boomlet_0_identity_pubkey), content: _peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt)</text><polygon fill="#FFC0CB" points="2284,6574.5242,3103,6574.5242,3113,6586.5242,3103,6599.5242,2284,6599.5242,2274,6586.5242,2284,6574.5242" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="815.3605" x="2286" y="6592.4212">Assert schnorr_verify(boomlet_0_identity_pubkey, _peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0.signature)</text><polygon fill="#E6E6FA" points="2281,6610.2302,3106,6610.2302,3116,6640.2302,3106,6671.2302,2281,6671.2302,2271,6640.2302,2281,6610.2302" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="818.0124" x="2283" y="6628.1272">_peer_0_tx_commit_signed_by_boomlet_0_padded := _peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497.2504" x="2286.38" y="6645.8332">duress_placeholder := _peer_0_tx_commit_signed_by_boomlet_0_padded.padding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="622.5185" x="2286.38" y="6663.5393">peer_0_tx_commit_signed_by_boomlet_0 := _peer_0_tx_commit_signed_by_boomlet_0_padded.content</text><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,6713.7603,2694.9836,6717.7603,2704.9836,6721.7603,2700.9836,6717.7603" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3445.5063" cy="6717.0103" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3441.0063" y1="6717.7603" y2="6717.7603"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="2710.9836" y="6703.0983">[35n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2747.0027" y="6694.2453">WithdrawalNonInitiatorNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.6822" x="2750.3827" y="6711.9513">approvals_signed_by_boomlet_i [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="2693.4836" cy="6784.1283" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3488.4042,6780.8783,3498.4042,6784.8783,3488.4042,6788.8783,3492.4042,6784.8783" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3494.4042" y1="6784.8783" y2="6784.8783"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="6761.3633">[36]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.3021" x="2728.4617" y="6743.6573">WithdrawalWtSarsMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.1191" x="2731.8417" y="6761.3633">duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="2731.8417" y="6779.0693">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3063,6797.8783,3937,6797.8783,3947,6871.8783,3937,6946.8783,3063,6946.8783,3053,6871.8783,3063,6797.8783" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="867.3603" x="3065" y="6815.7754">SAR receives {duress_placeholder, boomlet_0_identity_pubkey} from WT. It decrypts duress_placeholder using boomlet_0_identity_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.8351" x="3068.38" y="6833.4814">sar_privkey to get duress_placeholder_plaintext. It checks to see if it's a padding of False or a duress signal, if it was a duress signal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.5345" x="3068.38" y="6851.1874">and the pair of the received boomlet_0_identity_pubkey and AES iv of duress_placeholder was not previously received, It calculates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="792.1161" x="3068.38" y="6868.8934">doxing_data_identifier by hashing duress_placeholder, uses it to find which doxing_data is associated with this user and then uses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="759.6292" x="3068.38" y="6886.5994">duress_placeholder which is equal to doxing_key to decrypt the associated static_doxing_data_encrypted_by_doxing_key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="788.2035" x="3068.38" y="6904.3054">dynamic_doxing_data_encrypted_by_doxing_key. It then uses this doxing_data to enter SEARCH AND RESCUE. Regardless of if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="862.5503" x="3068.38" y="6922.0115">duress_placeholder is a false signal or not SAR signs duress_placeholder with the doxing_key and encrypts it with boomlet_0_identity_pubkey.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616.6685" x="3068.38" y="6939.7175">It then responds to WT with the duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0.</text><polygon fill="#E6E6FA" points="3100,6957.5265,3900,6957.5265,3910,6969.5265,3900,6982.5265,3100,6982.5265,3090,6969.5265,3100,6957.5265" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.1594" x="3102" y="6975.4235">duress_placeholder_plaintext := AES_Decrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder)</text><path d="M3106,6995.2325 L3172.918,6995.2325 L3172.918,7004.9385 L3162.918,7014.9385 L3106,7014.9385 L3106,6995.2325" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="161.9421" style="stroke:#000000;stroke-width:1.5;" width="888.7353" x="3106" y="6995.2325"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.918" x="3121" y="7010.1295">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="801.8173" x="3187.918" y="7008.9914">[SEARCH AND RESCUE [duress_placeholder_plaintext != padding(False) and (boomlet_identity_pubkey, duress_placeholder.iv) not previously saved]]</text><polygon fill="#FFC0CB" points="3281,7019.9385,3718,7019.9385,3728,7031.9385,3718,7044.9385,3281,7044.9385,3271,7031.9385,3281,7019.9385" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="433.0953" x="3283" y="7037.8355">Assert SHA256(duress_placeholder_plaintext) == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3126,7055.6445,3873,7055.6445,3883,7103.6445,3873,7151.6445,3126,7151.6445,3116,7103.6445,3126,7055.6445" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.9922" x="3128" y="7073.5415">doxing_key := duress_placeholder_plaintext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.0063" x="3131.38" y="7091.2476">static_doxing_data := AES_decrypt(private_key: doxing_key, content: static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="733.4082" x="3134.76" y="7108.9536">dynamic_doxing_data := AES_decrypt(private_key: doxing_key, content: dynamic_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.5255" x="3131.38" y="7126.6596">save(boomlet_0_identity_pubkey, duress_placeholder.iv) (nonce of encryption algorithm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.6962" x="3131.38" y="7144.3656">Enter SEARCH_AND_RESCUE_MODE</text><polygon fill="#E6E6FA" points="2934,7169.1746,4066,7169.1746,4076,7217.1746,4066,7265.1746,2934,7265.1746,2924,7217.1746,2934,7169.1746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.1313" x="2936" y="7187.0716">duress_placeholder_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.3853" x="2939.38" y="7204.7776">signature: schnorr_sign(sar_privkey, duress_placeholder)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8742" x="2939.38" y="7222.4837">content: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2936" y="7240.1897">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1125.0078" x="2939.38" y="7257.8957">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 := AES_encrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,7308.1167,2694.9836,7312.1167,2704.9836,7316.1167,2700.9836,7312.1167" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3499.9042" cy="7311.3667" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3495.4042" y1="7312.1167" y2="7312.1167"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="7297.4547">[37]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.3021" x="2738.4617" y="7288.6017">WithdrawalSarsWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2741.8417" y="7306.3077">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2209,7325.1167,3178,7325.1167,3188,7373.1167,3178,7421.1167,2209,7421.1167,2199,7373.1167,2209,7325.1167" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961.7795" x="2211" y="7343.0137">WT receives duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 from SAR and continue processing peer_0_tx_commit_signed_by_boomlet_0.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="918.7755" x="2214.38" y="7360.7198">It verifies boomlet_0_identity_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0, checks the magic to match "commit", tx_id to be the one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="932.3867" x="2214.38" y="7378.4258">expected and for the event_block_height to be fresh. WT then signs peer_0_tx_commit_signed_by_boomlet_0 with wt_privkey and sends it to non-initiator</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="895.4406" x="2214.38" y="7396.1318">peers. WT receives each peer i's peer_i_tx_commit_signed_by_boomlet_i in response and checks it's correctness in a similar manner. WT then sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="874.2504" x="2214.38" y="7413.8378">the collection of peer_i_tx_commit_signed_by_boomlet_i to Niso alongside duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0.</text><polygon fill="#E6E6FA" points="2497,7431.6468,2889,7431.6468,2899,7443.6468,2889,7456.6468,2497,7456.6468,2487,7443.6468,2497,7431.6468" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2499" y="7449.5438">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="2357,7467.3528,3030,7467.3528,3040,7479.3528,3030,7492.3528,2357,7492.3528,2347,7479.3528,2357,7467.3528" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.4617" x="2359" y="7485.2498">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_commit_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2478,7503.0588,2909,7503.0588,2919,7515.0588,2909,7528.0588,2478,7528.0588,2468,7515.0588,2478,7503.0588" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.0244" x="2480" y="7520.9559">peer_0_tx_commit := peer_0_tx_commit_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2556,7538.7649,2831,7538.7649,2841,7550.7649,2831,7563.7649,2556,7563.7649,2546,7550.7649,2556,7538.7649" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.5703" x="2558" y="7556.6619">Assert peer_0_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="2574,7574.4709,2812,7574.4709,2822,7586.4709,2812,7599.4709,2574,7599.4709,2564,7586.4709,2574,7574.4709" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8452" x="2576" y="7592.3679">Assert peer_0_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="2094,7610.1769,3292,7610.1769,3302,7640.1769,3292,7671.1769,2094,7671.1769,2084,7640.1769,2094,7610.1769" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="2096" y="7628.0739">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1187.5509" x="2099.38" y="7645.7799">Assert peer_0_tx_commit.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_SAR_RESPONSE_BY_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="492.6353" x="2099.38" y="7663.4859">Assert peer_0_tx_commit.event_block_height &lt;= most_work_bitcoin_block_height</text><polygon fill="#E6E6FA" points="2446,7681.2949,2940,7681.2949,2950,7720.2949,2940,7759.2949,2446,7759.2949,2436,7720.2949,2446,7681.2949" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="490.1914" x="2448" y="7699.192">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="471.4455" x="2451.38" y="7716.898">signature: schnorr_sign(wt_privkey, peer_0_tx_commit_signed_by_boomlet_0)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.9123" x="2451.38" y="7734.604">content: peer_0_tx_commit_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2448" y="7752.31">}</text><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2693.4836" cy="7805.781" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3434.0063,7802.531,3444.0063,7806.531,3434.0063,7810.531,3438.0063,7806.531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3440.0063" y1="7806.531" y2="7806.531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="7791.869">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2728.4617" y="7783.016">WithdrawalWtNonInitiatorNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.9463" x="2731.8417" y="7800.722">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,7851.9431,2694.9836,7855.9431,2704.9836,7859.9431,2700.9836,7855.9431" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3445.5063" cy="7855.1931" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3441.0063" y1="7855.9431" y2="7855.9431"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="7841.2811">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2738.4617" y="7832.4281">WithdrawalNonInitiatorNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.1647" x="2741.8417" y="7850.1341">peer_i_tx_commit_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2693.4836" cy="7922.3111" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3434.0063,7919.0611,3444.0063,7923.0611,3434.0063,7927.0611,3438.0063,7923.0611" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3440.0063" y1="7923.0611" y2="7923.0611"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="7899.5461">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="475.1244" x="2728.4617" y="7881.8401">WithdrawalWtNonInitiatorNisoMessage4 [=WithdrawalWtNisoMessage2]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.3854" x="2731.8417" y="7899.5461">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.3955" x="2731.8417" y="7917.2521">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2010.0571,7986.1792,2000.0571,7990.1792,2010.0571,7994.1792,2006.0571,7990.1792" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2693.4836" cy="7989.4292" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2004.0571" x2="2688.9836" y1="7990.1792" y2="7990.1792"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2016.0571" y="7966.6642">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="475.1244" x="2043.5351" y="7948.9581">WithdrawalWtNisoMessage2 [=WithdrawalWtNonInitiatorNisoMessage4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.3854" x="2046.9151" y="7966.6642">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2046.9151" y="7984.3702">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1498,8003.1792,2499,8003.1792,2509,8051.1792,2499,8099.1792,1498,8099.1792,1488,8051.1792,1498,8003.1792" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="994.0584" x="1500" y="8021.0762">Niso receives {Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4], duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="800.2805" x="1503.38" y="8038.7822">from WT. It then verifies wt_pubkey's signature on peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt, each non-initiator peer i's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.0536" x="1503.38" y="8056.4882">boomlet_i_identity_pubkey's signature on peer_i_tx_commit_signed_by_boomlet_i, peer_i_tx_commit's magic to match "commit", tx_id to be the one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="906.1135" x="1503.38" y="8074.1942">expected and for the event_block_height to be fresh. It then forwards Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [1 &lt;= i &lt;= 4],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="881.3226" x="1503.38" y="8091.9003">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 and the latest block height it sees as niso_0_event_block_height to Boomlet.</text><polygon fill="#E6E6FA" points="1802,8109.7093,2194,8109.7093,2204,8121.7093,2194,8134.7093,1802,8134.7093,1792,8121.7093,1802,8109.7093" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="1804" y="8127.6063">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="1636,8145.4153,2361,8145.4153,2371,8157.4153,2361,8170.4153,1636,8170.4153,1626,8157.4153,1636,8145.4153" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="721.0978" x="1638" y="8163.3123">Assert schnorr_verify(wt_pubkey, peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1642,8181.1213,2355,8181.1213,2365,8193.1213,2355,8206.1213,1642,8206.1213,1632,8193.1213,1642,8181.1213" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.2546" x="1644" y="8199.0183">peer_i_tx_commit_signed_by_boomlet_i := peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.content [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1631,8216.8273,2365,8216.8273,2375,8228.8273,2365,8241.8273,1631,8241.8273,1621,8228.8273,1631,8216.8273" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="730.6398" x="1633" y="8234.7243">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_commit_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1751,8252.5333,2246,8252.5333,2256,8273.5333,2246,8295.5333,1751,8295.5333,1741,8273.5333,1751,8252.5333" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="488.2025" x="1753" y="8270.4303">peer_i_tx_commit := peer_i_tx_commit_signed_by_boomlet_i.content [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="1756.38" y="8288.1364">niso_0_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1826,8305.9454,2170,8305.9454,2180,8317.9454,2170,8330.9454,1826,8330.9454,1816,8317.9454,1826,8305.9454" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.9123" x="1828" y="8323.8424">Assert peer_i_tx_commit.magic == "commit" [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1844,8341.6514,2152,8341.6514,2162,8353.6514,2152,8366.6514,1844,8366.6514,1834,8353.6514,1844,8341.6514" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.1873" x="1846" y="8359.5484">Assert peer_i_tx_commit.tx_id == tx_id [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1261,8377.3574,2737,8377.3574,2747,8407.3574,2737,8438.3574,1261,8438.3574,1251,8407.3574,1261,8377.3574" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1263" y="8395.2544">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1465.2833" x="1266.38" y="8412.9604">Assert peer_i_tx_commit.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_AND_NON_INITIATOR_PEERS_TO_RECEIVING_TX_COMMITMENT_BY_ALL_PEERS) [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1388.5835" x="1266.38" y="8430.6664">Assert peer_i_tx_commit.event_block_height &lt;= (most_work_bitcoin_block_height - REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PEER_TX_COMMITMENT_AND_RECEIVING_ALL_TX_COMMITMENT_BY_PEERS) [0 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,8516.2995,1305.1306,8520.2995,1315.1306,8524.2995,1311.1306,8520.2995" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="8519.5495" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="8520.2995" y2="8520.2995"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="8487.9315">[45]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="8461.3725">WithdrawalNisoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.3854" x="1351.9886" y="8479.0785">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="1351.9886" y="8496.7845">niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="1351.9886" y="8514.4905">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="794,8533.2995,1813,8533.2995,1823,8625.2995,1813,8718.2995,794,8718.2995,784,8625.2995,794,8533.2995" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="761.7746" x="796" y="8551.1965">Boomlet receives {Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4], niso_0_event_block_height,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1009.1774" x="799.38" y="8568.9025">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0} from Niso. It first decrypts duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="900.8743" x="799.38" y="8586.6086">verifies sar_pubkey's signature on duress_placeholder_signed_by_sar and checks to see if the content matches of the duress_placeholder that it had</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="988.1176" x="799.38" y="8604.3146">sent to WT. It then verifies wt_pubkey's signature on peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt, each non-initiator peer i's boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="973.7394" x="799.38" y="8622.0206">signature on peer_i_tx_commit_signed_by_boomlet_i, peer_i_tx_commit's magic to match "commit", tx_id to be the one expected and for the event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="882.0114" x="799.38" y="8639.7266">to be fresh according to niso_0_event_block_height. After that Boomlet initializes counter with 0, reached_boomlets_collection with an empty set,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.6042" x="799.38" y="8657.4326">ping_seq_num with 0, reached_mystery_flag with 0, sets last_seen_block to niso_0_event_block_height. Boomlet then constructs Ping composed of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="873.4054" x="799.38" y="8675.1386">{"ping", tx_id, last_seen_block, ping_seq_num, reached_mystery_flag}, signs it with boomlet_0_identity_privkey, pads it with duress_placeholder,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="784.4855" x="799.38" y="8692.8447">signs peer_0_ping_signed_by_boomlet_0_padded with boomlet_0_identity_privkey, encrypts the result with wt_pubkey and sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="653.7704" x="799.38" y="8710.5507">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt to Niso.</text><polygon fill="#E6E6FA" points="683,8728.3597,1924,8728.3597,1934,8740.3597,1924,8753.3597,683,8753.3597,673,8740.3597,683,8728.3597" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1237.4187" x="685" y="8746.2567">duress_placeholder_signed_by_sar_encrypted_by_sar := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0)</text><polygon fill="#FFC0CB" points="978,8764.0657,1629,8764.0657,1639,8776.0657,1629,8789.0657,978,8789.0657,968,8776.0657,978,8764.0657" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="647.2054" x="980" y="8781.9627">Assert schnorr_verify(sar_pubkey, duress_placeholder_signed_by_sar_encrypted_by_sar.signature) == True</text><polygon fill="#FFC0CB" points="1168,8799.7717,1440,8799.7717,1450,8820.7717,1440,8842.7717,1168,8842.7717,1158,8820.7717,1168,8799.7717" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1170" y="8817.6687">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.6542" x="1173.38" y="8835.3747">check if duress_placeholder is the one sent.</text><polygon fill="#FFC0CB" points="941,8853.1837,1666,8853.1837,1676,8865.1837,1666,8878.1837,941,8878.1837,931,8865.1837,941,8853.1837" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="721.0978" x="943" y="8871.0808">Assert schnorr_verify(wt_pubkey, peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="947,8888.8898,1660,8888.8898,1670,8900.8898,1660,8913.8898,947,8913.8898,937,8900.8898,947,8888.8898" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.2546" x="949" y="8906.7868">peer_i_tx_commit_signed_by_boomlet_i := peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt.content [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="936,8924.5958,1670,8924.5958,1680,8936.5958,1670,8949.5958,936,8949.5958,926,8936.5958,936,8924.5958" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="730.6398" x="938" y="8942.4928">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_commit_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1058,8960.3018,1550,8960.3018,1560,8972.3018,1550,8985.3018,1058,8985.3018,1048,8972.3018,1058,8960.3018" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="488.2025" x="1060" y="8978.1988">peer_i_tx_commit := peer_i_tx_commit_signed_by_boomlet_i.content [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1131,8996.0078,1475,8996.0078,1485,9008.0078,1475,9021.0078,1131,9021.0078,1121,9008.0078,1131,8996.0078" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.9123" x="1133" y="9013.9048">Assert peer_i_tx_commit.magic == "commit" [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1150,9031.7138,1458,9031.7138,1468,9043.7138,1458,9056.7138,1150,9056.7138,1140,9043.7138,1150,9031.7138" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.1873" x="1152" y="9049.6108">Assert peer_i_tx_commit.tx_id == tx_id [0 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="584,9067.4198,2024,9067.4198,2034,9097.4198,2024,9128.4198,584,9128.4198,574,9097.4198,584,9067.4198" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="586" y="9085.3169">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1429.3253" x="589.38" y="9103.0229">Assert peer_i_tx_commit.event_block_height &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_AND_NON_INITIATOR_PEERS_TO_RECEIVING_TX_COMMITMENT_BY_ALL_PEERS) [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1352.6255" x="589.38" y="9120.7289">Assert peer_i_tx_commit.event_block_height &lt;= (niso_0_event_block_height - REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PEER_TX_COMMITMENT_AND_RECEIVING_ALL_TX_COMMITMENT_BY_PEERS) [0 &lt;= i &lt;= 4]</text><path d="M9,9147.5379 L160.3531,9147.5379 L160.3531,9157.2439 L150.3531,9167.2439 L9,9167.2439 L9,9147.5379" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="5727.738" style="stroke:#000000;stroke-width:1.5;" width="4087.3878" x="9" y="9147.5379"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.3531" x="24" y="9162.4349">Ping Pong Game</text><polygon fill="#E6E6FA" points="1159,9172.2439,1447,9172.2439,1457,9193.2439,1447,9215.2439,1159,9215.2439,1149,9193.2439,1159,9172.2439" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.6831" x="1161" y="9190.1409">counter := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280.9953" x="1164.38" y="9207.8469">reached_boomlets_collection: Collection.new()</text><polygon fill="#E6E6FA" points="1161,9225.6559,1445,9225.6559,1455,9317.6559,1445,9410.6559,1161,9410.6559,1151,9317.6559,1161,9225.6559" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.8151" x="1163" y="9243.553">ping_seq_num := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.4051" x="1166.38" y="9261.259">reached_mystery_flag := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.9492" x="1166.38" y="9278.965">last_seen_block := niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0261" x="1166.38" y="9296.671">_peer_0_ping := Ping{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.3711" x="1166.38" y="9314.377">magic: "ping",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="1166.38" y="9332.083">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.2122" x="1166.38" y="9349.789">last_seen_block: last_seen_block,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.7462" x="1166.38" y="9367.4951">ping_seq_num: ping_seq_num,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.4422" x="1166.38" y="9385.2011">reached_mystery_flag: reached_mystery_flag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1163" y="9402.9071">}</text><polygon fill="#E6E6FA" points="600,9420.7161,2006,9420.7161,2016,9539.7161,2006,9658.7161,600,9658.7161,590,9539.7161,600,9420.7161" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.7484" x="602" y="9438.6131">_peer_0_ping_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.3434" x="605.38" y="9456.3191">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.9131" x="605.38" y="9474.0251">content: _peer_0_ping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="602" y="9491.7312">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393.1724" x="605.38" y="9509.4372">_peer_0_ping_signed_by_boomlet_0_padded := PaddedMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.7422" x="605.38" y="9527.1432">content: _peer_0_ping_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.6442" x="605.38" y="9544.8492">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="602" y="9562.5552">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="561.4705" x="605.38" y="9580.2612">_peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="598.0656" x="605.38" y="9597.9673">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping_signed_by_boomlet_0_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323.6353" x="605.38" y="9615.6733">content: _peer_0_ping_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="602" y="9633.3793">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1399.113" x="605.38" y="9651.0853">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(ECDH(boomlet_0_identity_privkey, wt_pubkey), _peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="9704.5564" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,9701.3064,1997.0571,9705.3064,1987.0571,9709.3064,1991.0571,9705.3064" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="9705.3064" y2="9705.3064"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="9690.6443">[46]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="9681.7913">WithdrawalBoomletNisoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.6425" x="1341.9886" y="9699.4973">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="1539,9718.3064,2457,9718.3064,2467,9730.3064,2457,9743.3064,1539,9743.3064,1529,9730.3064,1539,9718.3064" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="914.2905" x="1541" y="9736.2034">Niso receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="1998.5571" cy="9789.6744" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2681.9836,9786.4244,2691.9836,9790.4244,2681.9836,9794.4244,2685.9836,9790.4244" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2003.0571" x2="2687.9836" y1="9790.4244" y2="9790.4244"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2006.0571" y="9775.7624">[47]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2033.5351" y="9766.9094">WithdrawalNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.6425" x="2036.9151" y="9784.6154">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,9835.8364,2694.9836,9839.8364,2704.9836,9843.8364,2700.9836,9839.8364" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3445.5063" cy="9839.0864" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3441.0063" y1="9839.8364" y2="9839.8364"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="9825.1744">[47]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="475.1244" x="2738.4617" y="9816.3214">WithdrawalNonInitiatorNisoWtMessage4 [=WithdrawalNisoWtMessage3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.7386" x="2741.8417" y="9834.0274">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><polygon fill="#E6E6FA" points="2558,9852.8364,2829,9852.8364,2839,9864.8364,2829,9877.8364,2558,9877.8364,2548,9864.8364,2558,9852.8364" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.9303" x="2560" y="9870.7334">reached_pings_collection := Collection.new()</text><path d="M19,9890.5424 L92.288,9890.5424 L92.288,9900.2485 L82.288,9910.2485 L19,9910.2485 L19,9890.5424" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="4758.0853" style="stroke:#000000;stroke-width:1.5;" width="4067.3878" x="19" y="9890.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="34" y="9905.4395">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="694.8539" x="107.288" y="9904.3014">[PING_PONG_LOOP until WT has Collection&lt;peer_i_id, peer_i_reached_ping_signed_by_boomlet_i&gt; for every peer_i_id in peer_ids]</text><polygon fill="#FFF0F5" points="2225,9915.2485,3162,9915.2485,3172,9963.2485,3162,10011.2485,2225,10011.2485,2215,9963.2485,2225,9915.2485" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="774.0595" x="2227" y="9933.1455">WT receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Niso (and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="879.1646" x="2230.38" y="9950.8515">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt from Peers). If this is the first ping received, WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="874.0032" x="2230.38" y="9968.5575">initializes reached_pings_collection with an empty set and goes into a loop that ends when reached_pings_collection[peer_i_id] has a valid value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="926.8223" x="2230.38" y="9986.2635">for every peer. WT decrypts peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i and verifies boomlet_i_identity_pubkey's signature. Wt then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="902.5254" x="2230.38" y="10003.9695">separates duress_placeholder, which is the padding, and peer_i_ping and sends duress_placeholder and boomlet_0_identity_pubkey to peer 0's SAR.</text><path d="M2471,10021.7785 L2471,10066.7785 L2915,10066.7785 L2915,10031.7785 L2905,10021.7785 L2471,10021.7785" fill="#E6E6FA" style="stroke:#181818;stroke-width:0.5;"/><path d="M2905,10021.7785 L2905,10031.7785 L2915,10031.7785 L2905,10021.7785" fill="#E6E6FA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416.9493" x="2477" y="10040.6756">if for peer_i_id in peer_ids reached_pings_collection[peer_i_id] exists:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.3001" x="2480.38" y="10058.3816">break PING_PONG_LOOP.</text><polygon fill="#E6E6FA" points="2011,10077.1906,3375,10077.1906,3385,10089.1906,3375,10102.1906,2011,10102.1906,2001,10089.1906,2011,10077.1906" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1360.6459" x="2013" y="10095.0876">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i := AES_decrypt(ECDH(wt_privkey, boomlet_i_identity_pubkey), peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt)</text><polygon fill="#FFC0CB" points="2288,10112.8966,3098,10112.8966,3108,10124.8966,3098,10137.8966,2288,10137.8966,2278,10124.8966,2288,10112.8966" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="806.4294" x="2290" y="10130.7936">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i.signature) == True</text><polygon fill="#E6E6FA" points="2333,10148.6026,3053,10148.6026,3063,10178.6026,3053,10209.6026,2333,10209.6026,2323,10178.6026,2333,10148.6026" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="713.2064" x="2335" y="10166.4996">peer_i_ping_signed_by_boomlet_i_padded := peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.8884" x="2338.38" y="10184.2056">duress_placeholder := peer_i_ping_signed_by_boomlet_i_padded.padding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="527.5665" x="2338.38" y="10201.9117">peer_i_ping_signed_by_boomlet_i := peer_i_ping_signed_by_boomlet_i_padded.content</text><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="2693.4836" cy="10273.0887" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3488.4042,10269.8387,3498.4042,10273.8387,3488.4042,10277.8387,3492.4042,10273.8387" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3494.4042" y1="10273.8387" y2="10273.8387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="10250.3237">[48]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.3021" x="2728.4617" y="10232.6177">WithdrawalWtSarsMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.1191" x="2731.8417" y="10250.3237">duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="2731.8417" y="10268.0297">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="2976,10286.8387,4022,10286.8387,4032,10351.8387,4022,10417.8387,2976,10417.8387,2966,10351.8387,2976,10286.8387" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="939.6273" x="2978" y="10304.7357">SAR receives {duress_placeholder, boomlet_0_identity_pubkey} from WT. It decrypts duress_placeholder using boomlet_0_identity_pubkey and sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="841.2563" x="2981.38" y="10322.4417">to get duress_placeholder_plaintext. It checks to see if it's a padding of False or a duress signal, if it was a duress signal and the pair of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="835.4585" x="2981.38" y="10340.1478">received boomlet_0_identity_pubkey and AES iv of duress_placeholder was not previously received, It calculates doxing_data_identifier by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="862.5503" x="2981.38" y="10357.8538">hashing duress_placeholder, uses it to find which doxing_data is associated with this user and then uses duress_placeholder which is equal to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="908.5961" x="2981.38" y="10375.5598">doxing_key to decrypt the associated static_doxing_data_encrypted_by_doxing_key and dynamic_doxing_data_encrypted_by_doxing_key. It then uses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="854.2303" x="2981.38" y="10393.2658">this doxing_data to enter SEARCH AND RESCUE. Regardless of if the duress_placeholder is a false signal or not SAR signs duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1039.5583" x="2981.38" y="10410.9718">with the doxing_key and encrypts it with boomlet_0_identity_pubkey. It then responds to WT with the duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0.</text><polygon fill="#E6E6FA" points="3100,10428.7808,3900,10428.7808,3910,10440.7808,3900,10453.7808,3100,10453.7808,3090,10440.7808,3100,10428.7808" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.1594" x="3102" y="10446.6778">duress_placeholder_plaintext := AES_Decrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder)</text><path d="M3106,10466.4868 L3172.918,10466.4868 L3172.918,10476.1929 L3162.918,10486.1929 L3106,10486.1929 L3106,10466.4868" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="161.9421" style="stroke:#000000;stroke-width:1.5;" width="888.7353" x="3106" y="10466.4868"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.918" x="3121" y="10481.3839">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="801.8173" x="3187.918" y="10480.2458">[SEARCH AND RESCUE [duress_placeholder_plaintext != padding(False) and (boomlet_identity_pubkey, duress_placeholder.iv) not previously saved]]</text><polygon fill="#FFC0CB" points="3281,10491.1929,3718,10491.1929,3728,10503.1929,3718,10516.1929,3281,10516.1929,3271,10503.1929,3281,10491.1929" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="433.0953" x="3283" y="10509.0899">Assert SHA256(duress_placeholder_plaintext) == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3126,10526.8989,3873,10526.8989,3883,10574.8989,3873,10622.8989,3126,10622.8989,3116,10574.8989,3126,10526.8989" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.9922" x="3128" y="10544.7959">doxing_key := duress_placeholder_plaintext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.0063" x="3131.38" y="10562.5019">static_doxing_data := AES_decrypt(private_key: doxing_key, content: static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="733.4082" x="3134.76" y="10580.2079">dynamic_doxing_data := AES_decrypt(private_key: doxing_key, content: dynamic_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.5255" x="3131.38" y="10597.9139">save(boomlet_0_identity_pubkey, duress_placeholder.iv) (nonce of encryption algorithm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.6962" x="3131.38" y="10615.62">Enter SEARCH_AND_RESCUE_MODE</text><polygon fill="#E6E6FA" points="2934,10640.429,4066,10640.429,4076,10688.429,4066,10736.429,2934,10736.429,2924,10688.429,2934,10640.429" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.1313" x="2936" y="10658.326">duress_placeholder_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.3853" x="2939.38" y="10676.032">signature: schnorr_sign(sar_privkey, duress_placeholder)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8742" x="2939.38" y="10693.738">content: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2936" y="10711.444">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1125.0078" x="2939.38" y="10729.15">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 := AES_encrypt(privkey: ECDH(sar_privkey, boomlet_0_identity_pubkey), content: duress_placeholder_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,10779.3711,2694.9836,10783.3711,2704.9836,10787.3711,2700.9836,10783.3711" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3499.9042" cy="10782.6211" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3495.4042" y1="10783.3711" y2="10783.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="10768.7091">[49]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.3021" x="2738.4617" y="10759.8561">WithdrawalSarsWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2741.8417" y="10777.5621">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2123,10796.3711,3263,10796.3711,3273,10888.3711,3263,10981.3711,2123,10981.3711,2113,10888.3711,2123,10796.3711" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1136.7206" x="2125" y="10814.2681">WT receives duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 from SAR and continue processing peer_0_ping_signed_by_boomlet_0(peer_i_ping_signed_by_boomlet_i).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="847.6263" x="2128.38" y="10831.9741">It verifies boomlet_i_identity_pubkey's signature on peer_i_ping_signed_by_boomlet_i, checks the magic to match "ping" and tx_id to be the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="810.1865" x="2128.38" y="10849.6801">one expected. If this is not the first ping It also checks that the ping_seq_num has been increased. Using ping's event_block_height, it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="805.7144" x="2128.38" y="10867.3861">checks that the ping is fresh and if it's the first ping received it checks that the reached_mystery_flag is not 1. If the mystery_flag is 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="811.3043" x="2128.38" y="10885.0922">WT assigns peer_i_ping_signed_by_boomlet_i to reached_pings_collection[peer_i_id]. WT constructs pong composed of {"pong", tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="878.1504" x="2128.38" y="10902.7982">most_work_bitcoin_block_height, Collection&lt;peer_j_ping_signed_by_boomlet_j&gt; [for each Peer i's pong include peer_j_ping_signed_by_boomlet_j</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.5734" x="2128.38" y="10920.5042">of all other peers (i != j)] }, if it isn't the first pong composed WT waits for at least 1 block to pass. WT signs the pong and encrypts it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="867.5164" x="2128.38" y="10938.2102">for Boomlet to get pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i. It then sends pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="956.9434" x="2128.38" y="10955.9162">alongside duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0 to Niso and pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.3501" x="2128.38" y="10973.6222">to other peers.</text><polygon fill="#E6E6FA" points="2497,10991.4312,2889,10991.4312,2899,11003.4312,2889,11016.4312,2497,11016.4312,2487,11003.4312,2497,10991.4312" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2499" y="11009.3283">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="2381,11027.1373,3005,11027.1373,3015,11039.1373,3005,11052.1373,2381,11052.1373,2371,11039.1373,2381,11027.1373" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="620.7896" x="2383" y="11045.0343">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_ping_signed_by_boomlet_i.signature) == True</text><polygon fill="#E6E6FA" points="2521,11062.8433,2866,11062.8433,2876,11074.8433,2866,11087.8433,2521,11087.8433,2511,11074.8433,2521,11062.8433" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.9263" x="2523" y="11080.7403">peer_i_ping := peer_i_ping_signed_by_boomlet_i.content</text><polygon fill="#FFC0CB" points="2584,11098.5493,2803,11098.5493,2813,11110.5493,2803,11123.5493,2584,11123.5493,2574,11110.5493,2584,11098.5493" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.4622" x="2586" y="11116.4463">Assert peer_i_ping.magic == "ping".</text><polygon fill="#FFC0CB" points="2593,11134.2553,2794,11134.2553,2804,11146.2553,2794,11159.2553,2593,11159.2553,2583,11146.2553,2593,11134.2553" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.8212" x="2595" y="11152.1523">Assert peer_i_ping.tx_id == tx_id.</text><polygon fill="#FFC0CB" points="2530,11169.9613,2857,11169.9613,2867,11190.9613,2857,11212.9613,2530,11212.9613,2520,11190.9613,2530,11169.9613" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.2952" x="2532" y="11187.8583">if not the first ping received from peer i:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319.7223" x="2535.38" y="11205.5644">check that peer_i_ping.ping_seq_num has increased.</text><polygon fill="#FFC0CB" points="2071,11223.3734,3316,11223.3734,3326,11253.3734,3316,11284.3734,2071,11284.3734,2061,11253.3734,2071,11223.3734" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="2073" y="11241.2704">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1234.3115" x="2076.38" y="11258.9764">Assert peer_i_ping.last_seen_block &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_TO_RECEIVING_ALL_PINGS_BY_WT_AND_HAVING_SAR_RESPONSE_BACK_TO_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429.1823" x="2076.38" y="11276.6824">Assert peer_i_ping.last_seen_block &lt;= most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="2551,11294.4914,2835,11294.4914,2845,11315.4914,2835,11337.4914,2551,11337.4914,2541,11315.4914,2551,11294.4914" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.7152" x="2553" y="11312.3884">if the first ping received from peer_i:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277.2253" x="2556.38" y="11330.0944">Assert peer_i_ping.reached_mystery_flag != 1.</text><polygon fill="#E6E6FA" points="2471,11347.9034,2915,11347.9034,2925,11368.9034,2915,11390.9034,2471,11390.9034,2461,11368.9034,2471,11347.9034" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250.8352" x="2473" y="11365.8005">if peer_i_ping.reached_mystery_flag == 1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437.1514" x="2476.38" y="11383.5065">reached_pings_collection[peer_i_id] := peer_i_ping_signed_by_boomlet_i</text><polygon fill="#FFC0CB" points="1833,11401.3155,3553,11401.3155,3563,11413.3155,3553,11426.3155,1833,11426.3155,1823,11413.3155,1833,11401.3155" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1716.0541" x="1835" y="11419.2125">if not the first pong Assert most_work_bitcoin_block_height &gt;= (pong.event_block_height + REQUIRED_MINIMUM_DISTANCE_IN_BLOCKS_BETWEEN_PING_AND_PONG)  [wait until a block has passed since the last sent pong (in case there's no immediate need to send due to ancillary)]</text><polygon fill="#E6E6FA" points="2241,11437.0215,3146,11437.0215,3156,11511.0215,3146,11586.0215,2241,11586.0215,2231,11511.0215,2241,11437.0215" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.7922" x="2243" y="11454.9185">pong_i := Pong{magic: "pong"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.2461" x="2246.38" y="11472.6245">tx_id: tx_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.8523" x="2246.38" y="11490.3305">event_block_height := most_work_bitcoin_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="894.2965" x="2246.38" y="11508.0366">prev_pings: Collection&lt;peer_j_ping_signed_by_boomlet_j&gt; [for each Peer i's pong include peer_j_ping_signed_by_boomlet_j of all other peers (i != j)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2243" y="11525.7426">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="550.8365" x="2246.38" y="11543.4486">pong_i_signed_by_wt := SignatureOnMessage{signature: schnorr_sign(wt_privkey, pong_i),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.7101" x="2246.38" y="11561.1546">content: pong_i}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.9686" x="2246.38" y="11578.8606">pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i := AES_encrypt(privkey: ECDH(wt_privkey, boomlet_i_identity_pubkey), pong_i_signed_by_wt)</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2010.0571,11646.7877,2000.0571,11650.7877,2010.0571,11654.7877,2006.0571,11650.7877" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2693.4836" cy="11650.0377" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2004.0571" x2="2688.9836" y1="11650.7877" y2="11650.7877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2016.0571" y="11627.2727">[50]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2043.5351" y="11609.5666">WithdrawalWtNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.0753" x="2046.9151" y="11627.2727">pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2046.9151" y="11644.9787">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2693.4836" cy="11717.1557" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3434.0063,11713.9057,3444.0063,11717.9057,3434.0063,11721.9057,3438.0063,11717.9057" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3440.0063" y1="11717.9057" y2="11717.9057"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="11694.3907">[50]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2728.4617" y="11676.6847">WithdrawalWtNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.9113" x="2731.8417" y="11694.3907">pong_i_signed_by_wt_encrypted_by_wt_for_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.9714" x="2731.8417" y="11712.0967">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i</text></g><polygon fill="#FFF0F5" points="1527,11730.9057,2469,11730.9057,2479,11751.9057,2469,11773.9057,1527,11773.9057,1517,11751.9057,1527,11730.9057" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="935.3896" x="1529" y="11748.8027">Niso receives {pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0, duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0} from WT and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.4504" x="1532.38" y="11766.5088">forwards them to Boomlet alongside the latest most_work_bitcoin_block_height as niso_0_event_block_height.</text><polygon fill="#E6E6FA" points="1802,11784.3178,2194,11784.3178,2204,11796.3178,2194,11809.3178,1802,11809.3178,1792,11796.3178,1802,11784.3178" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="1804" y="11802.2148">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#E6E6FA" points="1808,11820.0238,2189,11820.0238,2199,11832.0238,2189,11845.0238,1808,11845.0238,1798,11832.0238,1808,11820.0238" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="1810" y="11837.9208">niso_0_event_block_height := most_work_bitcoin_block_height</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,11923.5539,1305.1306,11927.5539,1315.1306,11931.5539,1311.1306,11927.5539" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="11926.8039" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="11927.5539" y2="11927.5539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="11895.1858">[51]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="11868.6268">WithdrawalNisoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.0753" x="1351.9886" y="11886.3328">pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="1351.9886" y="11904.0388">niso_0_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="1351.9886" y="11921.7449">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="777,11940.5539,1830,11940.5539,1840,12032.5539,1830,12125.5539,777,12125.5539,767,12032.5539,777,11940.5539" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1045.8372" x="779" y="11958.4509">Boomlet receives {pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0, niso_0_event_block_height, duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.3393" x="782.38" y="11976.1569">from Niso. It first decrypts duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0, verifies sar_pubkey's signature on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="861.9391" x="782.38" y="11993.8629">duress_placeholder_signed_by_sar and checks to see if the content matches of the duress_placeholder that it had sent to WT. It then decrypts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="938.6783" x="782.38" y="12011.5689">pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0 to get pong_0_signed_by_wt and verifies wt_pubkey's signature. Boomlet then checks the magic of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="821.0155" x="782.38" y="12029.2749">pong_0 to match "pong", tx_id to match the expected value, pong to be fresh according to niso_0_event_block_height. It then takes out</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="857.9871" x="782.38" y="12046.981">prev_ping_i_signed_by_boomlet_i from pong_0 for every other peer i, verifies boomlet_i_identity_pubkey's signature, checks that the magic is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="609.2974" x="782.38" y="12064.687">"ping", tx_id is the one expected, if it's not the first ping received the ping_seq_num has increased, if</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="853.8925" x="782.38" y="12082.393">reached_boomlets_collection[peer_i_id] was previously assigned a value reached_mystery_flag is not 0. At this moment Boomlet generates a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="979.2123" x="782.38" y="12100.099">pseudorandom number which if modulo DURESS_CHECK_INTERVAL_IN_BLOCKS is 0 Boomlet enters into a duress_check to update duress_placeholder_plaintext.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.9583" x="782.38" y="12117.805">Otherwise it will continue with the old value.</text><polygon fill="#E6E6FA" points="683,12135.614,1924,12135.614,1934,12147.614,1924,12160.614,683,12160.614,673,12147.614,683,12135.614" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1237.4187" x="685" y="12153.511">duress_placeholder_signed_by_sar_encrypted_by_sar := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0)</text><polygon fill="#FFC0CB" points="978,12171.32,1629,12171.32,1639,12183.32,1629,12196.32,978,12196.32,968,12183.32,978,12171.32" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="647.2054" x="980" y="12189.2171">Assert schnorr_verify(sar_pubkey, duress_placeholder_signed_by_sar_encrypted_by_sar.signature) == True</text><polygon fill="#FFC0CB" points="1168,12207.0261,1440,12207.0261,1450,12228.0261,1440,12250.0261,1168,12250.0261,1158,12228.0261,1168,12207.0261" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1170" y="12224.9231">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.6542" x="1173.38" y="12242.6291">check if duress_placeholder is the one sent.</text><polygon fill="#E6E6FA" points="821,12260.4381,1786,12260.4381,1796,12272.4381,1786,12285.4381,821,12285.4381,811,12272.4381,821,12260.4381" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961.0123" x="823" y="12278.3351">pong_0_signed_by_wt := AES_decrypt(privkey: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: pong_0_signed_by_wt_encrypted_by_wt_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1075,12296.1441,1531,12296.1441,1541,12308.1441,1531,12321.1441,1075,12321.1441,1065,12308.1441,1075,12296.1441" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="452.7774" x="1077" y="12314.0411">Assert schnorr_verify(wt_pubkey, pong_0_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1089,12331.8501,1517,12331.8501,1527,12352.8501,1517,12374.8501,1089,12374.8501,1079,12352.8501,1089,12331.8501" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.0383" x="1091" y="12349.7471">pong_0 := pong_0_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421.1094" x="1094.38" y="12367.4532">prev_ping_i_signed_by_boomlet_i := pong_0.prev_pings[i] [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1206,12385.2622,1401,12385.2622,1411,12397.2622,1401,12410.2622,1206,12410.2622,1196,12397.2622,1206,12385.2622" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.2822" x="1208" y="12403.1592">Assert pong_0.magic == "pong"</text><polygon fill="#FFC0CB" points="1217,12420.9682,1390,12420.9682,1400,12432.9682,1390,12445.9682,1217,12445.9682,1207,12432.9682,1217,12420.9682" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.1302" x="1219" y="12438.8652">Assert pong_0.tx_id == tx_id</text><polygon fill="#FFC0CB" points="767,12456.6742,1839,12456.6742,1849,12486.6742,1839,12517.6742,767,12517.6742,757,12486.6742,767,12456.6742" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="769" y="12474.5712">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1061.9061" x="772.38" y="12492.2772">Assert pong_0.event_block_height &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_CREATING_PONG_BY_WT_TO_REVIEWING_THE_PONG_IN_PEERS_BOOMLET)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390.9623" x="772.38" y="12509.9832">Assert pong_0.event_block_height &lt;= niso_0_event_block_height</text><polygon fill="#FFC0CB" points="955,12527.7922,1652,12527.7922,1662,12539.7922,1652,12552.7922,955,12552.7922,945,12539.7922,955,12527.7922" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.4857" x="957" y="12545.6892">Assert schnorr_verify(boomlet_i_identity_pubkey, prev_ping_i_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="1095,12563.4983,1512,12563.4983,1522,12575.4983,1512,12588.4983,1095,12588.4983,1085,12575.4983,1095,12563.4983" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413.8944" x="1097" y="12581.3953">prev_ping_i := prev_ping_i_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1159,12599.2043,1447,12599.2043,1457,12611.2043,1447,12624.2043,1159,12624.2043,1149,12611.2043,1159,12599.2043" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.6743" x="1161" y="12617.1013">Assert prev_ping_i.magic == "ping" [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1168,12634.9103,1439,12634.9103,1449,12646.9103,1439,12659.9103,1168,12659.9103,1158,12646.9103,1168,12634.9103" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.0332" x="1170" y="12652.8073">Assert prev_ping_i.tx_id == tx_id [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="979,12670.6163,1628,12670.6163,1638,12691.6163,1628,12713.6163,979,12713.6163,969,12691.6163,979,12670.6163" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="981" y="12688.5133">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="642.0966" x="984.38" y="12706.2193">if not the first ping received from peer_i Assert that peer_i_ping.ping_seq_num has increased. [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1153,12724.0283,1453,12724.0283,1463,12745.0283,1453,12767.0283,1153,12767.0283,1143,12745.0283,1153,12724.0283" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293.3063" x="1155" y="12741.9253">if reached_boomlets_collection[peer_i_id] != Null</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.0132" x="1158.38" y="12759.6314">Assert prev_ping_i.reached_mystery_flag != 0</text><path d="M29,12779.4404 L529.7675,12779.4404 L529.7675,12789.1464 L519.7675,12799.1464 L29,12799.1464 L29,12779.4404" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1063.3587" style="stroke:#000000;stroke-width:1.5;" width="2342.8445" x="29" y="12779.4404"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="455.7675" x="44" y="12794.3374">duress_check [ if PRNG()%#DURESS_CHECK_INTERVAL_IN_BLOCKS == 0]:</text><polygon fill="#E6E6FA" points="713,12804.1464,1893,12804.1464,1903,12852.1464,1893,12900.1464,713,12900.1464,703,12852.1464,713,12804.1464" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.2313" x="715" y="12822.0434">duress_check_space := DuressCheckSpace{space: rand([1..195;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2902" x="718.38" y="12839.7494">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3582" x="718.38" y="12857.4554">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="718.38" y="12875.1614">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.355" x="718.38" y="12892.8675">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="12946.3385" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,12943.0885,1997.0571,12947.0885,1987.0571,12951.0885,1991.0571,12947.0885" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="12947.0885" y2="12947.0885"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="12932.4265">[52]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="12923.5735">WithdrawalBoomletNisoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1341.9886" y="12941.2795">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1646,12960.0885,2351,12960.0885,2361,12972.0885,2351,12985.0885,1646,12985.0885,1636,12972.0885,1646,12960.0885" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="701.8445" x="1648" y="12977.9855">Niso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1374.7115,13028.2066,1364.7115,13032.2066,1374.7115,13036.2066,1370.7115,13032.2066" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="13031.4566" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1368.7115" x2="1994.0571" y1="13032.2066" y2="13032.2066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1380.7115" y="13017.5445">[53]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.5581" x="1408.1895" y="13008.6915">WithdrawalNisoStMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1411.5695" y="13026.3975">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="837,13045.2066,1888,13045.2066,1898,13075.2066,1888,13106.2066,837,13106.2066,827,13075.2066,837,13045.2066" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1044.1343" x="839" y="13063.1036">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Niso, decrypts it to get duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="870.8445" x="842.38" y="13080.8096">assign a country to each of the numbers in the duress_check_space corresponding to its alphabetical rank and shows this array to User for him</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.7271" x="842.38" y="13098.5156">to select 5 of them.</text><polygon fill="#E6E6FA" points="773,13116.3246,1953,13116.3246,1963,13137.3246,1953,13159.3246,773,13159.3246,763,13137.3246,773,13116.3246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.3156" x="775" y="13134.2216">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.6093" x="778.38" y="13151.9276">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="502.3089,13202.1487,492.3089,13206.1487,502.3089,13210.1487,498.3089,13206.1487" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1363.2115" cy="13205.3987" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="496.3089" x2="1358.7115" y1="13206.1487" y2="13206.1487"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="508.3089" y="13191.4867">[54]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142.8311" x="535.787" y="13182.6336">WithdrawalStOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6031" x="539.167" y="13200.3397">duress_check_space</text></g><polygon fill="#FFF0F5" points="49,13219.1487,932,13219.1487,942,13240.1487,932,13262.1487,49,13262.1487,39,13240.1487,49,13219.1487" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="876.473" x="51" y="13237.0457">User receives duress_check_space from ST. If he is not being coerced he will select 1 country in each column to replicate the duress_consent_set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.6331" x="54.38" y="13254.7517">and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="490.8089" cy="13308.2227" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1351.7115,13304.9727,1361.7115,13308.9727,1351.7115,13312.9727,1355.7115,13308.9727" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="495.3089" x2="1357.7115" y1="13308.9727" y2="13308.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="498.3089" y="13294.3107">[55]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.8981" x="525.787" y="13285.4577">WithdrawalStInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5771" x="529.167" y="13303.1637">duress_signal_index</text></g><polygon fill="#FFF0F5" points="851,13321.9727,1875,13321.9727,1885,13342.9727,1875,13364.9727,851,13364.9727,841,13342.9727,851,13321.9727" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1020.9034" x="853" y="13339.8697">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the nonce from previously received duress_check_space_with_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.7523" x="856.38" y="13357.5758">encrypts it for Boomlet and sends it to Iso.</text><polygon fill="#E6E6FA" points="773,13375.3848,1953,13375.3848,1963,13414.3848,1953,13453.3848,773,13453.3848,763,13414.3848,773,13375.3848" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2642" x="775" y="13393.2818">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3322" x="778.38" y="13410.9878">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="778.38" y="13428.6938">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.303" x="778.38" y="13446.3998">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1363.2115" cy="13499.8709" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,13496.6209,1997.0571,13500.6209,1987.0571,13504.6209,1991.0571,13500.6209" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1367.7115" x2="1993.0571" y1="13500.6209" y2="13500.6209"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1370.7115" y="13485.9589">[56]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181.5581" x="1398.1895" y="13477.1058">WithdrawalStNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1401.5695" y="13494.8119">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1646,13513.6209,2351,13513.6209,2361,13525.6209,2351,13538.6209,1646,13538.6209,1636,13525.6209,1646,13513.6209" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="701.8185" x="1648" y="13531.5179">Niso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,13581.7389,1305.1306,13585.7389,1315.1306,13589.7389,1311.1306,13585.7389" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="13584.9889" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="13585.7389" y2="13585.7389"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="13571.0769">[57]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="13562.2239">WithdrawalNisoBoomletMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1351.9886" y="13579.9299">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="900,13598.7389,1707,13598.7389,1717,13646.7389,1707,13694.7389,900,13694.7389,890,13646.7389,900,13598.7389" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="799.6564" x="902" y="13616.6359">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Niso. Boomlet will search for the indices in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407.7193" x="905.38" y="13634.3419">duress_check_space assigning the resulting value to duress_signal.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="410.6833" x="905.38" y="13652.048">If the duress_signal is composed of the same set of numbers as the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="736.6194" x="905.38" y="13669.754">duress_consent_set, duress_placeholder_plaintext will be assigned an empty padding otherwise it will be the doxing_key.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="484.3154" x="905.38" y="13687.46">duress_placeholder_plaintext will be encrypted to make up duress_placeholder.</text><polygon fill="#E6E6FA" points="715,13705.269,1892,13705.269,1902,13717.269,1892,13730.269,715,13730.269,705,13717.269,715,13705.269" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.2635" x="717" y="13723.166">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1029,13740.975,1577,13740.975,1587,13761.975,1577,13783.975,1029,13783.975,1019,13761.975,1029,13740.975" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1031" y="13758.872">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.0215" x="1034.38" y="13776.578">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="909,13794.387,1698,13794.387,1708,13815.387,1698,13837.387,909,13837.387,899,13815.387,909,13794.387" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.3503" x="911" y="13812.2841">duress_signal := duress_check_space[duress_signal_index_with_nonce.content]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="781.8984" x="914.38" y="13829.9901">duress_placeholder_plaintext := Evaluate(duress_signal, duress_consent_set, doxing_key) [either padding of False or doxing_key]</text><polygon fill="#FFF0F5" points="825,13854.7991,1782,13854.7991,1792,13928.7991,1782,14003.7991,825,14003.7991,815,13928.7991,825,13854.7991" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="950.5734" x="827" y="13872.6961">Regardless of executing duress procedure, Boomlet encrypts duress_placeholder_plaintext with sar_pubkey to get duress_placeholder. It then checks to see</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="762.1125" x="830.38" y="13890.4021">if the conditions for incrementing counter are met namely if block_heights of last_seen_block, niso_0_event_block_height and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.5182" x="830.38" y="13908.1081">prev_ping.last_seen_block are within a certain boundary. If for any of the peer_i_ids not appeared in reached_boomlets_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="921.4014" x="830.38" y="13925.8141">peer_i_prev_ping contain 1-valued reached_mystery_flag, Boomlet assigns peer_i_ping_signed_by_boomlet_i to reached_boomlets_collection[peer_i_id].</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="873.0413" x="830.38" y="13943.5202">If Boomlet's own counter has reached it's mystery it updates reached_mystery_flag value to 1. It then updates the last_seen_block by taking the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="894.0754" x="830.38" y="13961.2262">minimum of the current niso_0_event_block_height and the last_seen_block + 10. Boomlet then regenerates ping with incremented ping_seq_num,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="799.5134" x="830.38" y="13978.9322">signs it with peer_0_identity_pubkey, pads it with duress_placeholder, resigns it, encrypts it with wt_pubkey and sends the resulting</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="653.7704" x="830.38" y="13996.6382">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt to Niso.</text><polygon fill="#E6E6FA" points="904,14014.4472,1702,14014.4472,1712,14026.4472,1702,14039.4472,904,14039.4472,894,14026.4472,904,14014.4472" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.7034" x="906" y="14032.3442">duress_placeholder := AES_encrypt(privkey: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: duress_placeholder_plaintext)</text><polygon fill="#E6E6FA" points="416,14050.1532,2190,14050.1532,2200,14080.1532,2190,14111.1532,416,14111.1532,406,14080.1532,416,14050.1532" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="124.5141" x="418" y="14068.0502">Counter Increment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1764.1794" x="421.38" y="14085.7563">if last_seen_block != niso_0_event_block_height &amp;&amp; prev_ping_i.last_seen_block &gt;= (niso_0_event_block_height - TOLERANCE_IN_BLOCKS_FROM_CREATING_PING_BY_OTHER_PEERS_TO_REVIEWING_THE_PING_IN_PEER_BOOMLET) &amp;&amp; prev_ping_i.last_seen_block &lt;= niso_0_event_block_height :</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.6351" x="421.38" y="14103.4623">counter += 1</text><polygon fill="#E6E6FA" points="1020,14121.2713,1586,14121.2713,1596,14142.2713,1586,14164.2713,1020,14164.2713,1010,14142.2713,1020,14121.2713" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="559.4684" x="1022" y="14139.1683">if reached_boomlets_collection[peer_i_id] == Null and prev_ping_i.reached_mystery_flag==1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.0324" x="1025.38" y="14156.8743">reached_boomlets_collection[peer_i_id] := peer_i_ping_signed_by_boomlet_i</text><polygon fill="#E6E6FA" points="1221,14174.6833,1386,14174.6833,1396,14195.6833,1386,14217.6833,1221,14217.6833,1211,14195.6833,1221,14174.6833" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.9251" x="1223" y="14192.5803">if counter &gt;= mystery:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.4051" x="1226.38" y="14210.2863">reached_mystery_flag := 1</text><polygon fill="#E6E6FA" points="782,14228.0953,1825,14228.0953,1835,14258.0953,1825,14289.0953,782,14289.0953,772,14258.0953,782,14228.0953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="149.5131" x="784" y="14245.9924">last_seen_block update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.1552" x="787.38" y="14263.6984">if last_seen_block &lt; niso_0_event_block_height:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1036.1141" x="787.38" y="14281.4044">last_seen_block := min(niso_0_event_block_height, (last_seen_block + JUMP_IN_BLOCKS_IF_LAST_SEEN_BLOCK_LAGS_BEHIND_NISO_EVENT_BLOCK_HEIGHT_IN_BOOMLET))</text><polygon fill="#E6E6FA" points="600,14299.2134,2006,14299.2134,2016,14471.2134,2006,14643.2134,600,14643.2134,590,14471.2134,600,14299.2134" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0261" x="602" y="14317.1104">_peer_0_ping := Ping{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.3711" x="605.38" y="14334.8164">magic: "ping",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="605.38" y="14352.5224">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.7281" x="605.38" y="14370.2285">last_seen_block: last_seen_block</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.1302" x="605.38" y="14387.9345">ping_seq_num: (ping_seq_num += 1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.3822" x="605.38" y="14405.6405">reached_mystery_flag: reached_mystery_flag}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.7484" x="605.38" y="14423.3465">_peer_0_ping_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.3434" x="605.38" y="14441.0525">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.9131" x="605.38" y="14458.7585">content: _peer_0_ping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="602" y="14476.4646">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393.1724" x="605.38" y="14494.1706">_peer_0_ping_signed_by_boomlet_0_padded := PaddedMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.7422" x="605.38" y="14511.8766">content: _peer_0_ping_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.6442" x="605.38" y="14529.5826">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="602" y="14547.2886">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="561.4705" x="605.38" y="14564.9946">_peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="598.0656" x="605.38" y="14582.7007">signature: schnorr_sign(boomlet_0_identity_privkey, _peer_0_ping_signed_by_boomlet_0_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323.6353" x="605.38" y="14600.4067">content: _peer_0_ping_signed_by_boomlet_0_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="602" y="14618.1127">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1399.113" x="605.38" y="14635.8187">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt := AES_encrypt(ECDH(boomlet_0_identity_privkey, wt_pubkey), _peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="14696.2897" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,14693.0397,1997.0571,14697.0397,1987.0571,14701.0397,1991.0571,14697.0397" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="14697.0397" y2="14697.0397"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="14682.3777">[58]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="14673.5247">WithdrawalBoomletNisoMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.6425" x="1341.9886" y="14691.2307">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><polygon fill="#FFF0F5" points="1539,14710.0397,2457,14710.0397,2467,14722.0397,2457,14735.0397,1539,14735.0397,1529,14722.0397,1539,14710.0397" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="914.2905" x="1541" y="14727.9368">Niso receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="1998.5571" cy="14781.4078" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2681.9836,14778.1578,2691.9836,14782.1578,2681.9836,14786.1578,2685.9836,14782.1578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2003.0571" x2="2687.9836" y1="14782.1578" y2="14782.1578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2006.0571" y="14767.4958">[59]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2033.5351" y="14758.6428">WithdrawalNisoWtMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.6425" x="2036.9151" y="14776.3488">peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,14809.8638,2694.9836,14813.8638,2704.9836,14817.8638,2700.9836,14813.8638" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3445.5063" cy="14813.1138" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3441.0063" y1="14813.8638" y2="14813.8638"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="14808.0548">[59]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.7386" x="2738.4617" y="14808.0548">peer_i_ping_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2216,14826.8638,3171,14826.8638,3181,14847.8638,3171,14869.8638,2216,14869.8638,2206,14847.8638,2216,14826.8638" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="948.0385" x="2218" y="14844.7608">WT receives peer_0_ping_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt from Niso and jumps back to the beginning</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="581.0224" x="2221.38" y="14862.4668">of the PING_PONG_LOOP. if the loop breaks WT sends it's reached_pings_collection to all Peers.</text><path d="M22,14889.2758 L290.0671,14889.2758 L290.0671,14898.9819 L280.0671,14908.9819 L22,14908.9819 L22,14889.2758" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2003.3633" style="stroke:#000000;stroke-width:1.5;" width="3455.3813" x="22" y="14889.2758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.0671" x="37" y="14904.1729">Transaction Finalization and Relay</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2010.0571,14946.3939,2000.0571,14950.3939,2010.0571,14954.3939,2006.0571,14950.3939" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2693.4836" cy="14949.6439" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2004.0571" x2="2688.9836" y1="14950.3939" y2="14950.3939"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2016.0571" y="14935.7319">[60]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2043.5351" y="14926.8789">WithdrawalWtNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.0751" x="2046.9151" y="14944.5849">reached_pings_collection</text></g><g class="message" data-participant-1="WT" data-participant-2="Peers"><ellipse cx="2693.4836" cy="14999.0559" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3434.0063,14995.8059,3444.0063,14999.8059,3434.0063,15003.8059,3438.0063,14999.8059" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2697.9836" x2="3440.0063" y1="14999.8059" y2="14999.8059"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2700.9836" y="14985.1439">[60]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2728.4617" y="14976.2909">WithdrawalWtNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.0751" x="2731.8417" y="14993.9969">reached_pings_collection</text></g><polygon fill="#FFF0F5" points="1537,15012.8059,2459,15012.8059,2469,15033.8059,2459,15055.8059,1537,15055.8059,1527,15033.8059,1537,15012.8059" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="915.0572" x="1539" y="15030.7029">Niso receives reached_pings_collection from WT. Niso checks the validity of each peer's peer_i_reached_ping_signed_by_boomlet_i. Niso then hydrates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="482.7814" x="1542.38" y="15048.409">psbt and sends reached_pings_collection along with hydrated_psbt to Boomlet.</text><polygon fill="#FFC0CB" points="1640,15066.218,2356,15066.218,2366,15078.218,2356,15091.218,1640,15091.218,1630,15078.218,1640,15066.218" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="712.9202" x="1642" y="15084.115">check the presence and validity of each peer's peer_i_reached_ping_signed_by_boomlet_i in reached_pings_collection</text><polygon fill="#E6E6FA" points="1886,15101.924,2110,15101.924,2120,15113.924,2110,15126.924,1886,15126.924,1876,15113.924,1886,15101.924" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.4412" x="1888" y="15119.821">hydrated_psbt := hydrate_psbt(psbt)</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,15187.748,1305.1306,15191.748,1315.1306,15195.748,1311.1306,15191.748" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="15190.998" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="15191.748" y2="15191.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="15168.233">[61]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="15150.527">WithdrawalNisoBoomletMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.0751" x="1351.9886" y="15168.233">reached_pings_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.0231" x="1351.9886" y="15185.939">hydrated_psbt</text></g><polygon fill="#FFF0F5" points="863,15204.748,1745,15204.748,1755,15234.748,1745,15265.748,863,15265.748,853,15234.748,863,15204.748" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="719.1733" x="865" y="15222.6451">Boomlet receives {reached_pings_collection, hydrated_psbt} from Niso. Boomlet first checks the validity of each peer's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="871.3123" x="868.38" y="15240.3511">peer_i_reached_ping_signed_by_boomlet_i in reached_pings_collection. It then derives tx_id from hydrated_psbt and checks that it matches the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.4094" x="868.38" y="15258.0571">one committed to and if so, updates the saved psbt with the hydrated_psbt.</text><polygon fill="#FFC0CB" points="945,15275.8661,1661,15275.8661,1671,15287.8661,1661,15300.8661,945,15300.8661,935,15287.8661,945,15275.8661" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="712.9202" x="947" y="15293.7631">check the presence and validity of each peer's peer_i_reached_ping_signed_by_boomlet_i in reached_pings_collection</text><polygon fill="#FFC0CB" points="1168,15311.5721,1439,15311.5721,1449,15323.5721,1439,15336.5721,1168,15336.5721,1158,15323.5721,1168,15311.5721" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.0983" x="1170" y="15329.4691">Assert hydrated_psbt.derive_tx_id() == tx_id.</text><polygon fill="#E6E6FA" points="1234,15347.2781,1374,15347.2781,1384,15359.2781,1374,15372.2781,1234,15372.2781,1224,15359.2781,1234,15347.2781" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0972" x="1236" y="15365.1751">psbt := hydrated_psbt.</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="15418.6462" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,15415.3962,1997.0571,15419.3962,1987.0571,15423.3962,1991.0571,15419.3962" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="15419.3962" y2="15419.3962"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="15404.7342">[62]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="15395.8812">WithdrawalBoomletNisoMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.4332" x="1341.9886" y="15413.5872">magic: "withdrawal_ready_to_sign"</text></g><polygon fill="#FFF0F5" points="1628,15432.3962,2369,15432.3962,2379,15444.3962,2369,15457.3962,1628,15457.3962,1618,15444.3962,1628,15432.3962" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="737.4903" x="1630" y="15450.2932">Niso receives {magic: "withdrawal_ready_to_sign"} from Boomlet and proceeds to inform User to connect Boomlet to Iso.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="502.3089,15500.5142,492.3089,15504.5142,502.3089,15508.5142,498.3089,15504.5142" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="15503.7642" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="496.3089" x2="1994.0571" y1="15504.5142" y2="15504.5142"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="508.3089" y="15489.8522">[63]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="159.0681" x="535.787" y="15480.9992">WithdrawalNisoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422.5523" x="539.167" y="15498.7052">magic: "withdrawal_ready_to_sign_received_connect_boomlet_to_iso"</text></g><polygon fill="#FFF0F5" points="42,15517.5142,940,15517.5142,950,15538.5142,940,15560.5142,42,15560.5142,32,15538.5142,42,15517.5142" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.6562" x="44" y="15535.4112">User receives {magic: "withdrawal_ready_to_sign_received_connect_boomlet_to_iso"} from Niso and proceeds to connect Boomlet to Iso and input</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.8612" x="47.38" y="15553.1173">network, mnemonic and passphrase to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="490.8089" cy="15642.0003" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="966.1313,15638.7503,976.1313,15642.7503,966.1313,15646.7503,970.1313,15642.7503" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="495.3089" x2="972.1313" y1="15642.7503" y2="15642.7503"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="498.3089" y="15610.3823">[64]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.6581" x="525.787" y="15583.8233">WithdrawalIsoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.453" x="529.167" y="15601.5293">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.1691" x="529.167" y="15619.2353">mnemonic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.9921" x="529.167" y="15636.9413">passphrase</text></g><polygon fill="#FFF0F5" points="552,15655.7503,1404,15655.7503,1414,15676.7503,1404,15698.7503,552,15698.7503,542,15676.7503,552,15655.7503" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.8181" x="554" y="15673.6473">Iso receives {network, mnemonic, passphrase} from User and proceeds to inform Boomlet that they can start the musig protocol for tx_ins</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.8212" x="557.38" y="15691.3534">contained in the psbt.</text><rect fill="#FEFFDD" height="43" style="stroke:#181818;stroke-width:0.5;" width="372" x="954" y="15709.1624"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4481" x="971.5914" y="15727.0594">MUSIG2(psbt)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.2433" x="974.9715" y="15744.7654">Iso and Boomlet sign every tx_in contained in the psbt.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="977.6313" cy="15798.2364" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1292.1306,15794.9864,1302.1306,15798.9864,1292.1306,15802.9864,1296.1306,15798.9864" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="982.1313" x2="1298.1306" y1="15798.9864" y2="15798.9864"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="985.1313" y="15784.3244">[65]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214.1622" x="1012.6094" y="15775.4714">WithdrawalIsoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.1412" x="1015.9894" y="15793.1774">magic: "withdrawal_initialized_start_signing"</text></g><polygon fill="#FFF0F5" points="874,15811.9864,1733,15811.9864,1743,15832.9864,1733,15854.9864,874,15854.9864,864,15832.9864,874,15811.9864" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="809.9783" x="876" y="15829.8834">Boomlet receives {magic: "withdrawal_initialized_start_signing"} from Iso and proceeds to share with it the information necessary for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="852.2544" x="879.38" y="15847.5894">signing i.e. psbt, boomerang_descriptor, boomlet_0_boom_musig2_pubkey_share, alongside his own public nonce named pubnonce_boom.</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="989.1313,15950.9285,979.1313,15954.9285,989.1313,15958.9285,985.1313,15954.9285" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1303.6306" cy="15954.1785" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="983.1313" x2="1299.1306" y1="15954.9285" y2="15954.9285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="995.1313" y="15913.7075">[66]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214.1622" x="1022.6094" y="15878.2955">WithdrawalBoomletIsoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.91" x="1025.9894" y="15896.0015">psbt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.1141" x="1025.9894" y="15913.7075">boomerang_descriptor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.8192" x="1025.9894" y="15931.4135">boomlet_0_boom_musig2_pubkey_share</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.1811" x="1025.9894" y="15949.1195">pubnonce_boom</text></g><polygon fill="#FFF0F5" points="512,15967.9285,1443,15967.9285,1453,15988.9285,1443,16010.9285,512,16010.9285,502,15988.9285,512,15967.9285" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="924.1312" x="514" y="15985.8255">Iso receives {psbt, boomerang_descriptor, boomlet_0_boom_musig2_pubkey_share, pubnonce_boom} from Boomlet. Iso then generates it's own public</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.1924" x="517.38" y="16003.5316">nonce and sends this pubnonce_normal alongside his partialsignature (partialsig_normal) to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="977.6313" cy="16074.7086" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1292.1306,16071.4586,1302.1306,16075.4586,1292.1306,16079.4586,1296.1306,16075.4586" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="982.1313" x2="1298.1306" y1="16075.4586" y2="16075.4586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="985.1313" y="16051.9436">[67]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214.1622" x="1012.6094" y="16034.2376">WithdrawalIsoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.3711" x="1015.9894" y="16051.9436">pubnonce_normal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.7691" x="1015.9894" y="16069.6496">partialsig_normal</text></g><polygon fill="#FFF0F5" points="888,16088.4586,1718,16088.4586,1728,16109.4586,1718,16131.4586,888,16131.4586,878,16109.4586,888,16088.4586" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="823.1863" x="890" y="16106.3556">Boomlet receives {pubnonce_normal, partialsig_normal} from Iso, proceeds to produce it's own partial signature and shares it with Iso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.1093" x="893.38" y="16124.0616">Boomlet saves signed psbt on it's own memory.</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="989.1313,16174.2827,979.1313,16178.2827,989.1313,16182.2827,985.1313,16178.2827" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1303.6306" cy="16177.5327" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="983.1313" x2="1299.1306" y1="16178.2827" y2="16178.2827"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="995.1313" y="16163.6207">[68]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214.1622" x="1022.6094" y="16154.7677">WithdrawalBoomletIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.5791" x="1025.9894" y="16172.4737">partialsig_boom</text></g><polygon fill="#FFF0F5" points="593,16191.2827,1361,16191.2827,1371,16203.2827,1361,16216.2827,593,16216.2827,583,16203.2827,593,16191.2827" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="764.855" x="595" y="16209.1797">Iso receives partialsig_boom from Boomlet. Iso also keeps signed psbt but informs User that he can connect Boomlet to Niso.</text><rect fill="#FEFFDD" height="25" style="stroke:#181818;stroke-width:0.5;" width="372" x="954" y="16226.9887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.1081" x="1099.349" y="16244.8857">MUSIG2_END</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="502.3089,16295.1068,492.3089,16299.1068,502.3089,16303.1068,498.3089,16299.1068" style="stroke:#181818;stroke-width:1;"/><ellipse cx="977.6313" cy="16298.3568" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="496.3089" x2="973.1313" y1="16299.1068" y2="16299.1068"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="508.3089" y="16284.4447">[69]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="149.5911" x="535.787" y="16275.5917">WithdrawalIsoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.9644" x="539.167" y="16293.2977">magic: "withdrawal_psbt_signature_created_connect_boomlet_to_niso"</text></g><polygon fill="#FFF0F5" points="68,16312.1068,913,16312.1068,923,16324.1068,913,16337.1068,68,16337.1068,58,16324.1068,68,16312.1068" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="841.3603" x="70" y="16330.0038">User receives {magic: "withdrawal_psbt_signature_created_connect_boomlet_to_niso"} from Iso and proceeds to connect Boomlet to Niso.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="490.8089" cy="16383.4748" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,16380.2248,1997.0571,16384.2248,1987.0571,16388.2248,1991.0571,16384.2248" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="495.3089" x2="1993.0571" y1="16384.2248" y2="16384.2248"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="498.3089" y="16369.5628">[70]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.1351" x="525.787" y="16360.7098">WithdrawalNisoInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="508.8464" x="529.167" y="16378.4158">magic: "withdrawal_peer_is_informed_that_boomlet_should_be_connected_to_niso"</text></g><polygon fill="#FFF0F5" points="1560,16397.2248,2437,16397.2248,2447,16418.2248,2437,16440.2248,1560,16440.2248,1550,16418.2248,1560,16397.2248" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="870.0513" x="1562" y="16415.1218">Niso receives {magic: "withdrawal_peer_is_informed_that_boomlet_should_be_connected_to_niso"} from User and proceeds to ask Boomlet for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.1501" x="1565.38" y="16432.8278">the signed psbt.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1315.1306,16483.0489,1305.1306,16487.0489,1315.1306,16491.0489,1311.1306,16487.0489" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1998.5571" cy="16486.2989" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1309.1306" x2="1994.0571" y1="16487.0489" y2="16487.0489"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1321.1306" y="16472.3869">[71]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1348.6086" y="16463.5338">WithdrawalNisoBoomletMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="352.9633" x="1351.9886" y="16481.2399">magic: "withdrawal_signing_finished_export_signed_psbt"</text></g><polygon fill="#FFF0F5" points="869,16500.0489,1738,16500.0489,1748,16521.0489,1738,16543.0489,869,16543.0489,859,16521.0489,869,16500.0489" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="861.6404" x="871" y="16517.9459">Boomlet receives {magic: "withdrawal_signing_finished_export_signed_psbt"} from Niso and proceeds to respond to Niso with psbt_signed_0.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="561.0284" x="874.38" y="16535.6519">It also clears it's memory of other withdrawal-specific information and regenerates mystery.</text><polygon fill="#E6E6FA" points="1057,16553.4609,1551,16553.4609,1561,16574.4609,1551,16596.4609,1057,16596.4609,1047,16574.4609,1057,16553.4609" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9131" x="1059" y="16571.3579">mystery := mysterygen()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.6813" x="1062.38" y="16589.0639">withdrawal_clear() [reset memory back to pre-withdrawal except psbt_signed_0]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1303.6306" cy="16642.535" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1987.0571,16639.285,1997.0571,16643.285,1987.0571,16647.285,1991.0571,16643.285" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1308.1306" x2="1993.0571" y1="16643.285" y2="16643.285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1311.1306" y="16628.623">[72]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.6392" x="1338.6086" y="16619.7699">WithdrawalBoomletNisoMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.8271" x="1341.9886" y="16637.476">psbt_signed_0</text></g><polygon fill="#FFF0F5" points="1798,16656.285,2199,16656.285,2209,16668.285,2199,16681.285,1798,16681.285,1788,16668.285,1798,16656.285" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.4753" x="1800" y="16674.182">Niso receives psbt_signed_0 from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="1998.5571" cy="16727.653" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2681.9836,16724.403,2691.9836,16728.403,2681.9836,16732.403,2685.9836,16728.403" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2003.0571" x2="2687.9836" y1="16728.403" y2="16728.403"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2006.0571" y="16713.741">[73]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2033.5351" y="16704.888">WithdrawalNisoWtMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.8271" x="2036.9151" y="16722.594">psbt_signed_0</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="2704.9836,16773.815,2694.9836,16777.815,2704.9836,16781.815,2700.9836,16777.815" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3445.5063" cy="16777.065" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2698.9836" x2="3441.0063" y1="16777.815" y2="16777.815"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2710.9836" y="16763.153">[73]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2738.4617" y="16754.3">WithdrawalNisoWtMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.1692" x="2741.8417" y="16772.006">psbt_signed_i [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2239,16790.815,3147,16790.815,3157,16811.815,3147,16833.815,2239,16833.815,2229,16811.815,2239,16790.815" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="901.4725" x="2241" y="16808.7121">WT receives psbt_signed_0 from Niso and psbt_signed_i [1 &lt;= i &lt;= 4] from Peers. WT aggregates the signed_psbt's and relays the resulting signed_tx</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.3141" x="2244.38" y="16826.4181">to the network.</text><polygon fill="#E6E6FA" points="2522,16844.2271,2865,16844.2271,2875,16865.2271,2865,16887.2271,2522,16887.2271,2512,16865.2271,2522,16844.2271" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.9073" x="2524" y="16862.1241">signed_tx := aggregate_psbt(psbt_signed_i) [0 &lt;= i &lt;= 5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.7161" x="2527.38" y="16879.8301">relay_tx(signed_tx, network)</text><!--SRC=[xNrhSzj6ikXt_Gf4hhCcipHBJplMYLDNaPc8kxQaAyhnFMMxM109IOX9W4k0bdLi__VRtVC61cz8TXnzIMG2wEdfcUdfTqVl_M3XBjsv4td_MNd1n7lfHP5xwUtF_Cl0cNaNyLhinpFF6GP-xBjnk7HU-_7LTEbUkpDdn3zodllk9KBfuCDm5JkZs8szgBjs7dvqrbz5tj8P-LDltNa0W2VUhxELj-PE41ezU_32lxoA3sxSO0smYVs9lt23s1b68Nz47-YFVWt3-SoB-UCJFtXlF1wTEG_-y4Dum_Zvo9SGVrzwNh3c1LC7K3HUUdtcXCifOFNqgVFWr9joH4yyRndn9viR6-Pm-wVgqQRpu7-ysIoyTjRMt5KS1glvEJnO__dybpSR6-_Mrpv__hmMXB7dX1yyHe0UGTXpd1z_F0g1SduO_FYZypPmhXMjBqA46G7DuzN2SG7n-Cfp8gIpuyRq3vnDU05BYM_uaUC7LzxIZxqfVBnqtDaCte3LzBt8yJvEl0MZyFMLFxboPc44FpDmOU14Lwju6bu7VSHYVUol0p3dWxlqtNFO384xz-27gJ_1LGPau1-nTmcpcS7s0LpWbzsU0oiEurtS-C6biq3ozU3L6oTSU4kQepCD0nejlW9iOIiI-d8K-4syuBc0eZVpvW0Gtt6T3nwjoYGCOjSFS0GFg7d3nda8ZvSHZW3l0ZOn08KTH9FXE-TXv0Im6yORO_WkYCVdit3oVdpbuTx0aLUBgOkKmnLmBfPUT3MxSPRUnFC_mAy43ab2YCtPcT6HyMCQRA0_1gXBRm6WO3o0SNu3qo1AJiBv0iZF5Y-6Lpz_XdTWDtt-p4U4lnxWS6oj7YWu4ItyWrYDSh4CyJJZvquS2fIN-3LHWWOWv8O1VQpjiIa_naZ4yKPo5FoLmV0PC_3Ox_7I3I8u94Xlt9VqzQR-DQtY1RqSXC4ZN_8IMYr5ATgUDm0-WgtZhE1aFAA_a8l0zqHiWkvRYCa-FWA2Zdq2EGhdU42yHUISU_4rd7T7ZOo8chWiLu1-T1DChfPX4AuYM6zy2HPribek0VhifeTJY0JGwoiFluZ2YQ-sYWdJNNeE789Gh7VWF0mUEfChOBcJ6AYPEBW0za5_xN8PmlazqwZAcI_-QUKSQy1RJlPFzryEpWQdexK7peEfT-43qP-_EXsCHkE3my71lyV38tZwn_uB-6FywulZWt_hRvuTlnYSxXyT3DJJyM-dno_7P_zll7zoSdgC7_xwF_1qU3RSFpi-7PyC1gVZi-Fa2w_FQa0zEZvAG1uXwDF1mM3un_3ezyGBkJYrCYarylwB5zcZZz9VEoN7FpX- -N9uzd9mT5Q40Qmm_6jqSdmq6Z0ADnrZ_-XvCSbJtoCbwBrImn-S3lRF4Cu90KkI57yTiTaGEeVxbhdkmww5BqjEM8ru3FzXe6dSFuQ3ruJ4uO0zWm_PX7yzFdxvOd1MOq80_XZW6PGpnXcgSMp3_ElLonDjXE5lunVxexFnQ33Wly6_aK23mo4krd1qF1xyGGj13my7mzyFpmX06lRfuF- -6fuEdezVmWA_VFLo_7muEajCwTV1sMiSAxdnj8E1ozBEEQY2a413stjfH59xarQXxeW45SR0lK4Y8VBOjQN9QVUOg7hf1IYzmDLtClhr3EuelErT9mGslhps8nABl0LUlo2fNBlnvEfH6C1L0jShoglpSBgQUVsrjOSW8diBPtEDe8QFVY7X54H0OELAmiRVXi5Y5M_YXRQ8pkErAuKM5sVT3tJRWumSNG40-fLV-n5zmsG27AZFdawklCdxYDtbyp2AnzVXyltut8ydeH-Oej2L2p3WaeCBREw3T0VohCVVs61mpq6W0f84b-Ef5qsM_W8klXwY2pWH2l77iJzbxn8sUAi27BYxIKmYZDoPXbO8yWiGyeAzxkFy8xfA8xW3emkI3llEC2OnXyic17WM1fSaCE1FCrob614n9WJGkGZOpwObaB60BdlFdELYCfxCV5Ze_gLdIf2TRXesAYa0TnzekIma-o_FDBgIXXRrROJkfnSbVrfiCG1xf5YVBT6OVknqIMhAbehXetoii-RCftnrCyMJCyQHE_YVhlF3C-TeDPl9ux2rHj_XSU2BP3iH_15NLUNHoCLUnqqfZucZ8nx8q_C9uVQoeNvXsvfjOHGMapkOHDvCYcg72t1FBMLV8XIZg9bnda2fci8fS57q15KSnlRXDr3BbpUB68yOQN-mRXjZff35D-F5wlozn-HRTePyEXWuZxwLKkRcpPvHM_isjKG5MvSBpN23qX9qwETkAOXZbDl7Z7W0dEygt757-DidN1hKx62kU-mBucxqmPu3yuBXdJUhd_xRsTvw1q- -uDCav35V3sywFhyPdpDSW8ImDEE8ZjR-O2HUwYnWQdXIO8tsdC71yyEE-aAj8Rm4B_IiIzlj9N3MSEawyhnjEsk2BbbN47-EZ_G3Lss2LM-jYkIZio0cWfiQVhzsbt9VZyxKZRkZMCpepCPTHd4xyqGRL7AMy5kZEI9-FM04ycp3wdjup8GkphQnEjUadzEv0JAG1925OiPnm6t9nxDioyY-8ssxjN1Rvi-_AnS3iKf-s-TGrSxUNOF9uI8psSrSvb5yl8g5L4MmTAfmasHYwUXNS_7Oci0uLjOFMs-Eyf_71Irk0A6R2lul1Cbfdu4c5ky7CDjvX33XTRIAkPFtGNWzywQNqlX5O_UTDCh6RSimV6Rdbe9AZvNucJuCerY9ddFtqf_iEUlAM3IMLeuncMJSnM89k4p7E5aO2DP7cCl6VWI_UkC8RJCk-nivFqDgEaOoZZN8YF5wbQFqwUxH-w8BrMXiEcCh6FcNWNRizDFanyg0IBOYE3tyoD0EqgziUfvvZ4ZuPSFnKmuxHHuVMYzk3RHTwWMdVenJO8UGtKmZ-BSRhvRUSS0vuwUtRABqwvuJJG3wSaaVPh64r2MKkbLrKcNTeZfg9h-0VoEZa2Ghlb9RvLqwOjhz-aHm8TlDEYg-LClFj_4DMu6qEjjBtBHIjH8K-Ac6HB_L8YtAo_gDAMAvd043_y8dnqfwGpsCr2726Mkt2DSSnAtcCuw23CfnsTzeKe_eMT_ZDmXg4zfrCTKkV-4kqbmHvDDGZ4JPDL2R8li_tXQCRRepmqVnQLrmq_MUa8Wjkb6FCyCyTfR1_b1ZkOu9kxS1Gr0-PXODU84vVCZo8c7xt283F_fuNKSBRnB3yZef3YhMNyb9yFPg5fEp2eRGLdmIpcOUiyJZCaahGvfCsfvHiysHQwuBrAugR3efgTsEyb3XL7HBQ9BYwg23SjEnOTFBnw4lpr0NfPspvShB6nTOps-uymDqLD9fmpNLPQRCWSHfV9QMFybgI2gezbVQZxFFjqdHMblE7opmsKVn_ITD8bD7KJ1DeQN2lzEdSYz7UUUtRhbjNLqooDk6wJ4D0S52440MtXYtSWORgT_NiUNObCIhAsnNUGWgtjO8JmaczKn7dDdbtcmwFpzpVFpFpZiBZXf719mEvBz-BZsNNymnfBpmj8P1OglyhYtO27aptMjbdXN5j4zjJAjtovCYhf5jWu6xTOxNt6lD2hEveUJ2rrOpp6l338F1Cr7iBaa1DdtiF6ZXtLzp4xosgBQlp_wo6u146Po058FRmLyAqfdgMOuqpGAbbYGNXimeezsRX2xtHoc9cPdNqzUE0LQ4RrWZYBY03QYSaMadHYOBQAmc9EC2lk4rtTY5CZQxplDzBpcAwnTc3-IoE0lzaN9loA9gqc4vUA_P5utsKpaPWSA1K5vNnedp6qOuXF1GhMTIFiyw8-rwvXAGoqi-sSBsTLpHbj360UawoLdbYjcPU9LTs0AXkv2ivCKfDnAdK_xyqh3w91yZSkeWEJauAkTI6XHxbe51ha9X0MPtcdKADlMZDWEqkfKn_Bd8zUlqyuWxDdb9YyfC4LDygyNy4RHiBedXjjaihxgwepE2104CtIP9751ib9YqkVQQ6H0f_3Wf9xsEZy90HcOdhObvioclvbLHKFHuvwqTBUHP-lTtrdWSjLtkIyp6b05Pv6S1mhuTKLy8TtQjOsjNqDccSRnE6MfrcQaKLY0mRIHKgfpbKNWzhhV-MpLnJ1BdAAJuxaICgo1PLLscATLwUJJZ3XbGCjYmKc8a-GQZW2pwRrfo5C7cvH0a0KUE92q1IOWvQ0jnJ1DLsSt51LPbw9GCmYB3zan7BtjyZMBMjHinEx4m0QUvA4c1vnwB46UoCy85veN901YumQAjf4BNT6Sn4ohRIrga5k7qhSHdPKXCVeR4L4W2YyHaRkwA2Cczbdie2kIq5577wSb8cQXuYi90cc9rbli_3sa1vtQYqGH1BNEr2OtzQikKcAeTOXtKf3-Vk_yhOPL2Am4jy_jSwJO1qoxPbXCmgm15OHHuLQSSv7-sAJdt2lPSjnuXBSjj9-RS_TWf952lHMsYpSIChiMkBFPdEGhyN4PH-YQYtxjEOguDDiP6oOrHl3FQLYDxjwgtDg1-DxMtogYunVHJWlcJ6d4DstUWEjn647HJUQ-NRqlCYQuspSe2CrEqlmsvlcSNwdLjlq2k9tcR9P7cPPfA6JZmhaMIQYbjG4ZfTw0GsBM1TDJ85AWIHIm0Unmjt8d7yrLzIX5sbqlt1atRko9RMELbRX8scqztRS7igUWG2l7eCxEw6SPXnQ9yZ6s54FWxq0-gOz6AKc0BI6X7BsYa2R2pL7IKp0njKzBEe65fFQ0ChAhIVmMSSaJs32XLfFvASJ9_Hy4_S-DrQvEnTR4_-t3ybIN-l5bz-y9-zHtnJSlxRMonluYe3vUV9ORl89pF_HXpCVX3NU3OAxf8BJ8IN87FwTS3_764ltsY9povxCrclm-IqN_llkj-AHHmh1bikhV9Wa1sCjkNfWBLhUQrvIAcSbosVgeHKhRTSEPLVIDDY5mb-sthQUdqjwqMIL2KmDDu-gdOUvpu9T2Z0MJo7hiH2gIWa4p2LH23uYKYPaGz6_9sHa9NiXol2GZeNhG8WoaFGF8nctssk791-_4d80J3iNlFOdIkiC8JPVCmROadxP7U1yXS-NEMO8RgEEXH38TvNdPF8RV8J_3BYHInvi-KFfybiltil38NgemMaGck6sNo03EsUjMaG0l2F5K6DEOBJFg3XGMGeFRYLfY4td82gWhLO9hDnB9kogqcwajDmjbg7h1gJeiP5TqoDbiOe48_ZhnO1BxncWdfyx-zMIBZJoS7wOgOJJVrFjOuqVhdUiQSI9URB3qo7rXUr_UfJEhWTW4MdRVqFlYiK9DK-t9t1nteP9g9pZXpS-7j1oiBuy9CSXk1ojt46KCspOThuQXdOARkuksjqWbnMqrdNFCAhaVTAYbnszirRCSxRPAZlEstEL5CqordTEuIs1gUFZpIL4ZGeolKBfsoErXm09McnQhm0OaDB5b4nONE8Ta3vBvwYArCgKF6YM7b_2hd6NPfxjhJrc0n0-IkmXaG3_z6Y-P7FhrpZsFiOUATuyqNyOspSATq_sk5WjJhD5pu4PwFAJUjr1X6lY_PUDy3ernOFaxK4T72a9M-D26r9X62p7vSTrW4ifDdgk_HrdyRo3ZZ7avP9V-biUhXIegNBTdFqfYPA6V0rhzqtbmndwuk0LNKK6gTdlfcfVnH-spUpueaAPRNLeMuTkdiJG4wd5Zl2iyMG1_WYOVbwHWmUzQZgiuJNAEUJrcYyX1UEB-vCpY3c3uYtyj0mNPpbjmUxZ9xKrWdsTNI1qkPvFMpIr6rp3oXnzJoGznpaY6rJjq4mTJGjvyVc1gospEagJGrgk0wnetXKVZt2VqbiCs6RmE3GSfyYzcMEPsoM8ZHLo1i3ZP5DCyZBIw7qyBigsTojfF5MKmS9T_jr30uxPWXsRT0cygL0szreOgCLdgouFPkwMJ1hJibOr7otXsGK9QU4xRio1gdB08fBCbU65dkTAZoSPSy-zAAfbUCK8DnmrfJBiOj5TKI-rJaWIY6Ps6pvpUYA9PG6SIzJvEeoBPIXW6oviIiOcNabbjcqdKmp7cPbzZMnitGOcBQxRBgRbiPQqtHrC8XMbeRN8V6M6cX3tQPjCe8VN42IdB7ol25tLLB0DhU5Gb0WPO1jBqRr4i1sj93dknCpanVqL5vRCb5sfQvDRpvGYArPkGk8ptdnohGPPyamtI8_I7IvjBzKot8pgOWvwJqocGNdM5RK6IMqqn0Kcj7LOKNup4z9rOznGXIqohUFSJGBPkMvN9mZb3PM84y34PBF18ib_5jVoaiDTB4cpyNu7-E_m4_iX03XqFxkyLotACPkRF9QYRZsPXcE7LZbmy55nLTBrTkT8KpjAtPAlB4JN617IrO29m6YyBX4XbLvFB1VWTYwW63OzzsCghE-y-AXVyf9PR-nVO32zvJ8s5p3tyorgTbS6WD2DyLqvl0dPVxHDtCX3XDI9yqkiq2R7am6koV7Xmw-qVFdTF1wE3LeE-SUfSW-L7h45WtNllAFdMadND1kufl5zXSkAHuc9WroKOm4MMPc6ALYdiiJOjcoDrv4PDJDUZf4wCL488JPXfyu0V3ujFFPXdAr99f6y6B_xdrujVETicRFprMrraB5x7MZIUzZiwRN1H_U2OOGuUuGfTMe9EH_z-pcJ7z3ztayKK1RFekJJXJc1WTxc_jFkxaMbx88cOzyVdBedQKCd_PAO1iDdK4SmsG2hYsEEMFCNbHROUu-g0LE46NtISVl3oXBMDrEymuYRrU673gAJEx39TmnkO4UQ1n4HwtXRjl_FBu-O12TYeU8kE4rYXtgHyksxcn-FmIDg4CosSLrf5lzsY30PZeQCQE9ski-vLLcaCPoapYRZZHAjftKveodnxSAxmD4AYJmFT009q0MD7JgaX05XT7nG8sOJavlPVE55390DBmAzC0kAi9QqUYxVSZ5aVqfiByabNBXdt8ozcyDkhSbj8bf3T7A_QeAzIcEO9hA57VM4kPk-7u3oCjTZHpM1_TYUoYZZoZj2OAgHIJCud9VU9ZT4_ap_qPdF-v6mJeC9FJ56a5h1odh7e67AeK4jnBfHMDR5D8kDt2ECrBoEGSYve5P9IhezGe5Ol7C4XQr3u_GXM_DyFiczMDuI1lesfCamvKtOh8_bmbMxjWzQrsYFPgjPGPphpMotoXLtNP_gbULO_jqiPjevY8PWZPsRGOGdOswrbajisYBDbSCDlCLQrQYpuHMtMPdPrwTDrntZpBgFP27JtiEPivyzN9RqdVR7O5-BMfKbZRPYj9Y0nwVNj4sMYd64qzz7jDaLU9hjoYHx97SLsPoeZtCglz-IozjNGoRPcXUwct0CgTIAc2XFabQygljfdDt8A-9YoSHkaRKJiIircfx59EACQtMIP7Iq2jJEOQ5NAIGaAHD6wah9P5orhLvZRA1sKZr2vfof8XkvxFBLRbIIAM5iQhBKGAdYcSbmHMCetpAmZh3LkvTjEBMs5MhTTZQT3yCp4J9VxireYsthq50ISlhAvDwQTfOO-wCb3c_DguCB_emUHOYyvVHhcEpqhG2KFLgqM6RIQ5daBpSMOFIC5AHKUmy2B3OyGRh6DlIEQOnQzOFDJN4mppfC9aJPIx4GpBIeKiD5u8XeuxcOHBaOUNkM7xplv5B9P2d1f6bfd_lrx44hI4Nt430zc1U3X7zcwazqUWTsGQWCWYMA2p9FB-CmRDBGLcVXC1z9lnnSozb0_XomZ4nGZ3cptEP0jcaHNrVyAoprIaFo3qQHrHKlry4YFr38pjg5Pe-5CYEU1jmiRCni-EkIaSKJfxjII2p4G3PMWf6BT1nn-dP7HzUQxMe0rGsL3rAcorJWCWYKSDfRgLLa3i3_yY8_f0xxtLRrIXvtOLfCosGbz7HsgnYb9BQb8P0ZNJb4hClucsKnPaMOMdPkcQV9sdRhcGRrRTQQiOJOkQZgfJGXVx2TPM_jsT5oPl2Ia6DZc5O-T8CNgNc7xWNNSAMsiR0avo14F04G-JiWtydgioZRKBcZ9tuFzwtXENPsnPJucXzjBIJa94sqk8FnbpsRFF47q_-UGQ5mWR6Hujfs7I3mxNxTboUXOiMFXBaj2LigUo0DiZ6OgJfoeWStU9KmM8P9EtA5lgDaNGHBXGfUoe1YkWmePs7ZjQH-LBxBnCxRrgP4xjtYQbQYPDjRzYLVAbTfwm41edzcOpXsaSh7aQIgz8xDBvLDktIbpTTVd4vhfy0hVgUJtljEdKDIVrJZckCoRLciywEwn1N1M8GPJPKP7VjhCmXEiTvOAJO_ZFY-FZ4mTkRt-6KB7nRzgKXtST_rCVobwlLnMMbLzZO1JxnpIgaVHsIqU0Dcw7nwVVsXhIKBJjkdrMIm9KFwxzCTCZNP0gUG0885iDCHjHvlAc349qd2z3ge019zLrQB79-4IsY6iMSsu7zqQkrplM01ghOlYy_YcvbOsLjVJcgqK_U-wUdv-xzvgReiYiIGbwrYZDdafmq9BtM8493MFDMcCH5_1XTgO8a9cCcnk0u6Z_jB-MUKhz2wAWzLIKMXJlen_568k2tdNuu7tY6FUB8f_ghK_24fIP0UXRme1lwrZLx5ANRGseWM6DmCF2SJGpGHsC2ZFzoi5EvVXbVr41QBAWsivFfRFcjhxlh3azPOwv6RvcrfmjPOwqr3lDcijEcSFgXNULDLSgPKub-BMQDLS_POw2p9jcpRMMClSsQ2LhxZvbxZvbxZvbxZvbxZvbJhDzFIsTChVrdQRCPHa7EWLIQRUVaKrNDbuv2t1k8Xrv4fYCaGX50MpqQ1J3Le1iDs4l46LZaWta3MS9Ql7ds1J73x0wReHWNp7YmNzWNhO8AofuPeKhMz6pmi1StimmP52N-WGGgqk3ps-pBofj9fzkaa4VzXOhXLbeQs3LZGlLQR9Vw0KimqGeowTr_4d5iQ13gA17TD9qzcSMad_-uhmXSmg6Ift8P4H40TPgjffwJW40sZ0Ni0bch10ejzDsVBph_-o-Sxu86T-FWeV6_Z4cYYAKYtN44HrOfndi4wmSBQE25a1seXKZFcs6aDjCTFcD6uXaf12lxGIl9bpyvic_DejL-ahGOmOP0h1H7W0h1zLMZgJAkaIBKTMvf5kM03XjjRwr3Cpgvf7QDf0ITeCAAPSCY1RoG7osN_xBd7P6seTmdYoiM78yLagS3lEUYlyXxgUFbMBHYZlNJl3ae9EExsQnuWUdW_qpiZ1IA4Iojmh-Ec8vd2GA7kvRCZpt3_wDNrhIF3DGhfpUgTQcS5t6R5qiM5Xl9c2actb7rByeXW5RQdDFT_Bd6NYBpqJfZOaSci-pO0FW7i7NxOslAWMYqCw0dO0MQUnaX1SBzosv8Z49zZlUA6WEyQal7wKkHJ4BJoQyEpwS7JWF-6pfFKJvmF7dSszAVGC3pviocnVQI5ZLRZUO-BEPkxpfvhd96F-cu0BuwvECxi1RFXdSOQzeMvoKGYPJq93PEk_TgKIGAmwmYh6MAon3wogLtqpGpBW4zXkBEQXyN-OgKgLz3kbXOJDAdMbtetGIwxQSHLK1fAcYfRcpTpSixcpu4TtP1JdAjfbKMe_c6SQLasahaxlNKaB8wpDHgqp6Gs1772qzKXChjOJB0dwGbtfvn_cM6kmcQNTo3sxMI8TwNFj8VOD9JpNsQavgKskPtxUMsbGYh-djtQSssVAQv9nhxJPTTzr8zsBEJvfA9iiaZK4iIOR1rYr3cgr1_KovI291YG8nsFrMAnL942TstoDnLwQmOjmCwWfWmZF3LWM0A1d3qJjSbxAXzL9s8KOOdrRBI1xIqoG46NhIyfIdYrbjOLBH8XZvSSgwN8vkIytjeLgoyDYOFBlMHj_PZvabRnvYhqUvFLJ7QvSM8l9Mqn2xDG71-TtFVOqNyEbqDGkTvwz0ingD3mu7e5ODZyu6fzW7KqhYEEQ6X4_kFXa9fBVJm7t2co3dEva1hUDKbnbfZ9MkD_YETqc-pqFw7lEGaZfKkaPIlIMoTagepAwxpNAdqiFLw6hE6IGgy1PuMbXE4RkL4FfAYtpZlyiE1StAtM50D8iOtY_bFymkF5OjkOT1QpEbHrcbCEwDcP_8DlN7SF2Q35M70_PiUCHJUduzFdxvOc2Qe38H-palMQJTHBJylM3DGTkiaeEcuDE-AXXEPfuPOnmMxnW5Dsc1RGGhcMsssIZRhApj5cZ5SQbYkAtGjHiGAIbs_F3CELhDPlgkrSYJPRBSi3IJTjxWi2UdHxztkl_re4YA099llBllF_tjzP_UtQgHrFBuE-q_lRjTkl_qzdt_wM-g_pGsdsREqFl-qwNxJ-_kbEa_lVstwJ-zkrkY__Jszzf_kaBxwU5zz-dMkq_lFYxTVNhxk-q-lVkaXWFWoT-Y-xITvt-TxjCQBaPNspleFbssoRLgG9tVVVg-G_DzX-QMEZINR8yi68gP8kDzz2QhM6KWiRZaAJatbFazs-scdu3uIZDLP-T-AVUDwJfZfWtkFPlwQ4DWiPnad4270nFGM84MTubzE6Cd07O1mWPygPktQ6wf0YRPrZ2HEosi4gbWBXmEPqYDCIQmNs7QpZdWCdMNDoH9KjHfS2FOcBH-CEdINIo0nNfJre4ZqsZIqnCL1J9qCd6ypKV4NwTMDurQhnhHnVds6y6_-G0FWRhNWLm9j1znECoRnR52TifyCv7ThoGlYqqjwuj_88Afz3Kulq67dxXqC8ZP3_pvQYv8Fbc1KXV41SjiW_nFPtCZuUrSUighHOj0-rjkHPXhglgDMUYFH_MdRQL5HVxW5mwebquhizNbCw_WkwZIPxL_vZh7xhPXV05wS0yTyCqx50lAsKzoP_oGPqF_npyCEwOjPhMXOs3870F7PuS3ewgNuI4OAW-1SX0Ku9Rh6s0nlvn2_tpcR1PTgEKjmS-u9PYYq0jimC-UcG6d1Q2hnPncJ4FC6jQEexANLwIha3AmrPAav_vg-txxENjPzZ8AWW4NxEG4utJIpEvVhrwUQ7jk-DlunVxeR3p2q5Vw3VwD0T63mo6MbXkEZiU3FwZQ6Zqy70n_FpmZ07ot5LO-kyMwPEcoP1t3lO7xjrkjEDcN4ZMrxgkFtLSV-owgZs6kgxI3_5J3BVFaljPOejROxjFIjSHsxggMsEvJM_3rKrijiQzR1UmhbS_29VrpDLz4phdBuifGh3xtBlqWu68rLpCIfOg4qae5ggYOKKGvXjnk_J2dwXM6iu4iTC8ow5J9qhEb6qGkU-StFy3YMIvBOGSaJxsPUoDNy77v782TlEGTVQiyjiNfFwuOfvy_MiLJdKb1MRk6tjSYLAdW5p1Cid68FfcgIsPHyJSEa3J1gvlfKhG_NqJdkbiY4o-AhsSQ6_ySNi9lDUkp0wGzEtP-7JW7nwUdWuEpmVFCNYiY0G_pnZqOUyBQTpQSfMwCI4qXD-hUd1JSNVm7-dS7_wCy38_hHDV_bBTzg72EZa7DgFSi-3qJ-XURsPo5tfJOSSgWqsGvz83m9M7FOea8CtCrzA1q7bmkmj2rz7nMqPaRgdaMFBhhTGCCLKLXUrv6o1fZvHPxl_izMoAcpKIVqN9CfEnqxLcprdWqSzSBOiWTNoUwXNQyq8UqEh0msUdDE0w96Ek5d3EHX5G8y4jQiY4JiCVg4la1t9JCGOp_1B4vG7-ubXjFJbavSosKnURSnuVClRzPPhfZuKCUyu7bFe0N0DHwrMY0Jur7_9AG6NHYsQcZdF_aJVPYJ4ZgEVF0cuU1Fs5Gt2XQN2qfLJH9qXqL7J1CRoJuYU83DZNWH5e1dfGu2LqdsD1syGwDxPF2jgS1-wA21xBsZJAfiWI96sVY1bhTtVaAY8uVnY4SO-P_X1COHC8nx_e1CveJ7w5JjZHcq5DtoijNe-7lM-ps8Oirfxr0WeA6MDO73P8nW4gmVBoxDio_k8R9UojhMwigg5DMr7dC7QZhDU-kIcFmbHfQzcnq9LmRfCYGynUNZWcSi9rnNa2n2zQ6NBXz_RxN9tAn35OF9DRByTIB9aj_4OT6mK7yQqmBlSLLrZ4DsjEo436w2dqAy7m6UvOv-z2rCyMVcDyHuMZ7uh71OuUPB7OeEUocbE1ujSKarcOLnYoy2OgELCKprPHgnjWc- -xJK2GcAE-5BnmsdBWYfCNm803z9Tm0bt-MM9q5x2VON2f5hgD-uLzqhR4LZvzKFaHR1eavEiJ74YFMpNOqGVVIWDM1wHcd1VwUhYQUHbFsfPOwo686OQMKqmRvEU8l6P6BQF1u1DgGSDGao3bmskMDHi2VAk_qhGIrgk_InCUMNKP5czvxtiASoVagvXmaub83idxqphc1xO9a_gG2dZuU73rNz7WgDvHDn1WMIHY8vbYkrvX5krdl-w0j4QFYa3diEfE2WZfFDfIuO1CyyJSI6BQoo4DoU3HcYmXOuW9A5AEhS3K3YTmJoECB5agLof1lTVGyQSIDtYl5ZV5vqc_KljK8M4TTVPf1J7vTZY_WRevGPV4-BiAbx9U48xSe09GPBKz-vI7HibGKysEBlGiGDbWaWAZODlFS9RzV6DD2dOubr2gi7aKBR-9VO5gi9bZWqBgBdRjV2ZKl4Lkm9_rp0AFJ5QLPEI48CmpMHCKp5iW9mnweeu_KouxtSU8jOdEUgbNgapgwt5CXQKY0bUtO-iULZCzFjaiRdtVJQ6fcm2VR5ZCW_5ZOVI9t2B-15JXD4xMDiuVG6XTGzJVtyX9sdZ9ogCE1DQTfNyxScsHO1Nyj_iZZ_IdkcMb7UPMLr6UmO-N8oamcSJOQMEs-O-Olm0C-xKWWFJ4aSzly7_ZFOZMVhQr5xq71T9Vk70Iw_wpGriBflpz3fMVcNSHhiH_FF4Ss1d7KYZaZ_f7pt7Sl4Ke77s9U_IX6GdNNpiEFpZhnrX58XElE0m0yyR22xvexGMZyQaIVyy6D6woH037n5suGSt53bFmr7gapZe_HLcCynWZlF_mGtZ1-vYS8F_bzwNa1XS01YiPBQAfUef_owLFdmQatvOZohKjFDZSspE6e12b_jEay-1zlDWklGI7KZeKw4vy_VrupPOEUA03_uuz7OKoSxiSVJTu4HnTXHa3pUBMG4KbOZTTpU1K1d0rmqeZUmCAP0R1K7srr56Gscpda3SGw1Pnv8OLPYlqinBhP31pmsUXg5Kz1gYJ6lJxsrr7L_U0kVVTynZGi5kpBilUnlcOCN7dfK7mWtBs1izjpU0tZ6r6iDEgnIBS5Cc_avbEqA8QyLlTxdw4lHw7wtUm5ClXvCnPnWrMUd0yUhGfNnN44rPWZUeW56I8SWNmlG1wMdAy9qmzpgjBWoCoUoOkZKvK9FJM1XQ29d8uvEpCwCZwh7J3G7_je-6SsJOHyVWFJ84hgeSom0fVUvyyHCOBFd_c8yDS378wjrGC5Xx6R1x4QXRWM-vpTpGm0CrK09MW0TXypQKRROrD-Z9dVB3aA5RjWfc7633WdZ3Mta-mhigb_JQju8N8-4bsH8qKfvgm6yAG-OZNwH_GNSX7Tx8lct1GnsST7sFxA9v2Z42F2OzGqpe7ziJAmOcH4rCHbkS8CiPjWShKC0rxdWbNUvG62iviUJY4IGAcNJBAElWaJrNuu1A5Oxy1v63nq9g3c0RsyPVBW0jW7VOipZpDVSg_OECSQy9QJ_TFzbuEpmUbexO7pOEg1CESLbSlGtinh8Bb_Sd9wZ1yQxIDPryNZv0klpsf0BMn3QRwGYrChap8BFMQEFaf_xPGSFwihPne3ivuaKhZf60qxVvOQljNQcHL7h5eNeSQ4waHNwiEq7KkdmwvIiZAvyRI3aUwXMlSSt54prxeZwbKxIIH47glRbfYzY4HLfNgUZ7uzuycChfuC13Vl0g_V09lBn9EhHs40LmbShoYlKXaZ3xIkSiOMQNgkemVgEPfcd8DRMBHFgr8wzq6e0p7Muszm5SfkY7vhTJIhy0TuYGoS72EZWhkiX4QlyxHNl44ZkFgY2n8AoP-jmjSPO5jHGZJ9wnFIJSntMdFGz2CNbw9LT2N5BEhR2DrFBqh-jDXYOAXpsd_Tpoykk5Ub7h4-PzDrheLuYBeUQpKiPeOp9XFfkWP-Sh5aGatQmAmb_B89gPqfIa99h60YaIJZ684ADPrYmJJcYw4I1BrK9dIKsMXBIujc1k3Ys8Vi6RMrNMqMkxmToqLak2zf2JhqSxSKn4gPtIgQF2EPcqVt9Y5_pKegILowpbeDI-HczMbLlQ8g4grKPPIozL0QJg-eO4ATgQMgdlIqnfwgMeAPlYMBPT8jdrFZmBRtypE18_lsAzM_fzhykt8n4Alajx8grrgPwXzgOQlwtpG-oxF_BTq5jOWuDvOfctWROJDeBXfIZnaobP35WVaq4VSByeYxa_T1U3tpffVIdCMYnvmqoiP5Aik1sJXYYL8W-J4cmAQP5yrTB9RX1-52Yp_2QiZW9Z-2NxqnvjgFNVOtCdM6otICr1id_9VhLGxEfxj7xuik9gFLY5SpKSrUKcV7ZvKbaAKloyBijPlwQG4LgXO0hXStwzdkwu8phbVMZ6kq5hCpWDJzahemTL9bNP0wQatBdRJAgNJ4kehd51OvsMmupSQtPmMAbYfnKbqqtsgH1EM5ziQ4i5oygiotPViO1RzvZIP-LIIgUFkHgapYccLcMI0SyMpgDAxkXAbsiGilZ-P185U4OXlA7A7oWU1RnYJTMQATb-2TggMNHSdf9HBIiuNH5BD3rUEQrTbceH9QZIPcaKZKprRXsR8gbB-aU0ACpFxWEIb-AMEXB2div1XLAsu6_YihGPfCJLBQAoeTAQPSixPp4xxMe1HBHeLdQwsfN1nQgUki2qQP0udJ-2mjMsebKDHVQVVBFjycXU7zwVC72tpsKNolPowhevXCNhRstTdBxVxmnNxwRpzrDZsc8GvO2CAwy8nREOEDz6XhwUsIU7LbT4eEWhbDVShZQIkVd2xRnknggMvxsHmHSD8xCvMToo-9C9mQfeMjyfkrOFtp9hZNolGgz-vfOLgzMvwKQfDYjQQ8bZ-l3NjAGRWMIRyOuC9IDB04c-47vu45x_wQIryKOFONMtQMa0WJa39lE_Ydcg1K4PrPCDEIbzNbBM7a9SdQhpBdaHAFLSboyuv9PZ9IY8KroeTBqu3A6HbhOhqVheoiBoDGixkxg3rk9cM-CCCU5xn5k2mNSdcLudJe35vYzaMZ_LHE811Xa9hT0IjcYThl3xMcDWbX_EwQj-OAMLbYJhPaRMkabojEjt50kawjbhGR6Irf2x6fqPas9RkM7Abydre3bjOiGHua9mT7vH9AWsBFQhUFDO5bTEketqYsUX1LjpA6XNrZdNuUSSScBsbHSobYYc-rk3o2biqbCIGsc-LLrsrqHf0WWA7898a3MinQKKsBC90nqqaxOTuSocjoLNGGFH9vQqSFqCyDoK_CmPJtUEPzFfhLQhkKBaf222HRonRYyeiUBCyqf9obgBd2MpKnCmbHLVDeIejU7YM-90gcI4cFv18j-pMtxPqCv2w7O8bEWmWn1sqXHgKw4791KraZvS6so9uzqzFA7b-ZU8HTySYOA-oqQUuNyJw5F54SPLw42qm70-qnJ8A5D4drg-dEqKl8QE5GhEJTDn84LQ51L2aIMFj4RUJgyMMRe-NjhdpvAaNKSNeoMkt9eYdAtbH91cQvj_EGrZgntKB8bo2ePQusOQzVRPaIKxL3h8EQsMYh8bOfj1BGCh_FbKeJCEqIQJd1i0hGdwakgDCf1_cVRKgylO8zrwr7ICjosuavTpzs2WdKQr4BQ3FfeMin_ehzMOu2FvTHSBw9oFAkazDihkB6s2YvCOftHjlgN-zMzSq6rE-czbOPrRIOVdL23hRlG0suZK3Zfb9UBz_obnF1R1g11MQcG7yRqdpFBihhkdc1D4zIjYWpbosxICatyAv5scSf7K38vdUW1jXrW7H0XwM33c-8JKcthAzSUE7iYlnRbUcuITXiFjsr1Ood0ZSe-gBFZE1cX4N3ff4LmiplG2jer2UvlYgGNTcygJRGIFxd1UKBZfAPyzmlqm2ujFHV1bPLcRy2JZc2UWQKAh9-fH2MlwEudxdnwZU3QbtOhzM7uvkNy_DczUsB-DLtn3SjvRUnnVuY0hwzLFa1bHJ6N0XBu-xxBjpVK1Vkwi5UszzRx-so6MPRznstlwcEsrZwtP_VTzmkrt6xHARTrlVVPxiufMxhU-skxLHehrsKbtRVNxjAV-so2MTRtrzNxUhstvs_HIzjkuJvTNffsveFbsrotR2NTiL6sgpUPaulRRFUXXRugtGUrkqa4VJBVbntMColasTkxuaEmQerQvK-hjEgZLnBfwNTzmc_xnDUia-u7OMxRSnRhbMvrZ1KdLsAOsKc1ZsAbHzYU-_GMlbtgQ7lhdEb7BBRSsnDAXKrgk2QsGqq6xwr7sXnEz2A67q5mkRs1SsdUL5tKAU5sLTFb6mdIRAOE7MCHZjc4FGjKAHcUz1RMfvIPThBfk9jtIdnIdRWl4t2oN9imlOSMQE9HU239PKAuxkT3jN-xP8dNbh2zE8BQZ1k76lAiRZTeLhQNBgXduMbdj-8sb52FH1tF4sY8ejAAVnac-7D75XFccA0fDTWCF8oBssiZLkWnRIlssNBtRRomPgYgOKljBGsk0wDiT925UpoPvKH-k84bEIEbU4BswcMQBEzAn9jWjgPDbjwN9ATivcP8_huZ_L47vxCmZiD979PHkuoqbDhh79Qzg4nh7_O325jyTm_rUBVR7flJcwip3xHURC5HMRyp0GabN7KG7W96zFHOLK_ZFWnhHWSjlsmAayk1-S8JOpLZiCuiSGZmLqPY_QNmW0ZhRJvSm5Mv_WVy2CBCN0uD9nRZByzcf4xcwncCjICANnJDtRvK70dqKrovKPNE4FRcgqYJrmA5zY-WKMdQR0eKYrH8fyyD2lHRudkCe9ZttOouCtxpuf5vYdTbFx5zWEBgrCZOISBVpBMfsKmOmq8tnNJcy2Tb_j4NSA4E4r8dpHwkGAixpyQx9yU73hxHy-Tqy7euDMWxvnwbo3QKPyCM3TUCSe-TQITSq6xYcyNs5ouf7YOc978HZ0H09cOOfMgT2nlYcR8lMyH4qGrwEaJevNTWHDcsd7W1yEGqyzc6Sg2acdom3l-kVMEryvsoKi-FLRNMGiNiTPw9hsEpfjS57zu9XX3XxX2brQWav58txDP9_qFtUJnfRxAxzA4C-M6qU7-rkxZJgv1XGnTrXEVlongHochbfq2RmFB4SorAohWskAKFyRazBGTukg3Lk04NNQVVF3ovBECrUqmcoCsDc70MGVuot09PsnEa0SQ5-4XLRZxnY-FdmyecgRY8J9EQ8sIaFhXifqRYzikOUh9C6XMOHtvvems68293ZhbgC6JLN93oSdCYsuulIhgTLDAChSSt2QyqmteYokFzVQB8j6sgKW25jT5nVelOJb1l9SEtLVH-TAAA-FokTy8wooY8VVZWhez2gjALYaOzY6l1lFQg01RIbcGhXcjCAAkCPls1gw2iBPoSYrbCeNZgxRsUSFodlPuFKUUKOOIHLCAd9d4v0lnCGGdykV-34xzt0q2z7x9QOeuVrQwKbO80xvK2WdHzL4LM6nJDBZTkZBDAx3a78kQzLUKtwBKA1Lhhp18MXWzFq8LlpVZtfkLNU4WRwFeIfCcIzsAoFvS9McwOFMjXeRsIfsK6SwypCjyKRyeodPfcxLHdqCpTUniDgvfictMDCdcUDasgsh5JdJqTooMcceqt77UFCiebaADAknfaZcpr4bjoPXinkJzYhGeB0YpbPn-1fM-FL9ij5FhfHxwlQR8gunIRfyZcQAuR4jbn7kPHV1ybaTQEckrpD2zr5lOhFekf4z1mloACELNsqmRRa7x4lPAexACAAc8QQCU1OjbnqjycrLej4pFocIkKO0cUVaNITb6RcXPjAn5OswZEaysGksIfYmPiilbt6BHcoHYQI6xsaAau9b2TqbW9VCblu8Gth0BQJUzk1LcrNgvamPzAnCpgHC8lNiBOarUn5kRCa_JkXbr9P_C-RLnJNxHuxonm9k_Z7ATbvMW4uQgIucCg4oAEeKcuCmsXeA1YePNuKM6ruTt1CVsXiovYb-neAMl9mxcoOB9aYDt8mwMbGLPrBeG1nrtCWcN8lKjSyFsdVsBM2o5E3MCB3F_Vxs8PKS9t-06nfW3yN2ExDr8xmn0xyW8VH7Wlq27H-JzPmnQMWhC_2O2w3VZYvbxAH_2bn48YH567dkSjHRC8YiW_uIbVgaWV43eqpgYf3hP94Rg6HZRKQtGwgP4tFxRXCMOZPyT8bCuedJOQl7zcJa0oe1IC6w3NZTEoS3tybojGGESib7aLTXgdTOt4eyQgdGhJN3O7_v5HWI1tdMgtwW0pksgHPaDTRwEPjHYaQAMbACo16gc7vMOVnCTfop8icfEpSem-PfEtMeStwoIqrQjbnRr6rK6X2xs4onO_BixByoh4b8CR7AAdiwHOlIMAVt0k-uKTeSs19pa28Q08nucPHluFLTb6ciND2NLmF_rb2GkpzWIaX93xQMbdOI8jfSGVpBcicUV8NfoyiarBX0sClnJJiDy71oksxEbsonORE-N9A4h9JPb0RR79HJdDLL0vkvocWeGoIPlKIBJROgWYP2VIebB3LQWLlhIxcrIecRcKlihqchIqlQjaantBZvfx2Ss7QtcDDuf5tB6D5hp7cS74mYMZXX4cJt_-Aqu2qEuXl7-FZc6_xmuFZvnu9RrPmWLMzEcJMvu9_4_zQ7iPMjLVLNvDOOZiNzCengvPBUqbMchTdWi-Asj8Gr5swxRP-KOG4NZMXep4T95fWBrWG2oFmwpvMGkRyfmGyVoCgGY4d0YNOSMcun4P3EuPl7TTd1lv7gzOosAiR24pyk0ajFNM5bBGxbQzBEdnFdvAN6lkSc8p8-KzsQDZUofP08j9uxLQD0mrgmgbciT7sPdPG2PoGYv0GYEza_xQvcd51Js2swoJ9sAKelYVVIZ6ED3qFSD7xnF7ED-KRnHlVL9M6mo4-jyIyZjRHshcgtLihNs6XZM2FSh74TJv-jWL9X0LmvsAdKk-uiAG6MjiR9vQLlVTrwQdfJ6d01VCo_DbfH6EkITvgLb9wLXER-xoaihbPIcKkXQpKkhdvH60TrDyz9QIqfx6xIIbtQVb7QVb7QVb7QVb7QVb5OXAMthEqrAop84T0eaq6u_8r-jREHm5k3SL3MoxZF98X4U0jZe4IA6NG2PRS8s82gl93kS6muCrDZFiG-C7s3Xs0Z1lcB4W__0l6nHJrGVp0fNzafdbNAvb9bXjA0swWaWLZS3dzzcNnIcJ3xT92Cxx2rMERBGhi3A_HQgpcIhqEizXedmaa_h-9EABK4dJK4JuwIPxCyi9F_ynNb3fXCCNpgHwNw80gpLR3Nrd080j64kO1FCMDrCbapeT7oyuV_ildE-2CdUZuA7nlun9eg2aulbj14TMASPx1CifImZTHP0Tg8L8pvjXf3RHtIfZHk3PFGEBuy4hoRSxkR9lpPhE_fAl6F65mAmKHu0gwZKLXQYocj4wr3LkQIxT00uRRM-jHp7wgQGslQE4ZQ22acD38WMXa1yjb_-ovmEFjg7S9uih5XoF5Pbcmxpdeh98UwdZvLYqOexrqwXvA2JpkXcKTi7fuFzCx8cKdX2ifq8_ZfYMP8a01xkMt8ezm_-ZLzQ4YapKAwSGAdMfd1TncnTB5XORoPWf9jvHzI_A8O1MsfpJtUyvnbpYyz4wOs979hFis03u1x1r-szdYe5Xz3EW9s0rcTiteCN2_SZkI952FOxtYXe1F6f5Hqb4KKn2nacl3i-d1qu3_XiwJr4-S3nvtDlIgto0i-RCaiNMaPOaMitcFYpcRkywUQvn1Z_9eS__FL9HbpWBPyCkB0NW2rE3o7pAEZ5R9ttxbGYo1K7M85LonMMeMkLoY0cQ6Qi0FkDnG5KlYzprQVI_eNqiB0PooUHRalSgueTJTKhpKMzkr4X5zY6UoMwDy_ahPo-Mfd0lPQICLwVYLfVCbO16y1e2OcQ-AYbE1QS-xnanplESDHWDqbqgv60zBZsqVa6qungxD2SPABMCgnlBPceH2RHsxjF9h9b4iavrzfjkcQwaMukd9-cb4nFIPfwM5eAWwtRVJHBWlgPidz4IX25LB3RgrRoZo1ExBv7ugvCKSIu3nJZPw8nmrQ5SYW9mj5RDfUoaFLILXz669zMoqZNqHCJ11bwqgwKfsbPBLrIZI8O-P71kjIDhaZDbQ7wa_0ebpohrKRVsO-PdMuUOlD2kJrK2sUN5YBoLjCGsnG1mVaTp_s75_3fT3KBdUUlG6yQZGyE1w0q3O_E1gVOs57AsJZcXeHFBZmPqwFtbi1zmhlwvZkE0QtZLCiLQMgLxZJuZhVzlS_y-HupVv8QKhh6KBqbihODgCokkysobTB3rMZJpHaagkSMU5g0JH6xbH3wIaTyux_B3khCofPXG3Hx5zulvJ_CBjnLBPs6GMipYKRPd322ZHcNoFBqnt3mcinGXmFsR7Z4asX-FJv- -M9W6fWo4VivBpsZtTIl_BrWpVhQh9BrfU3JlYeOJkPw6MCS5kyO1JTfNsq4AvdVjTaelwkiPHPenN6fOfQjq8OQ42afTlpmp3bQpMRwhjN8asMGtB1qHtRUuB0dfqU_Txh_zQ18YW2IRxoxRwZybswe_FZlsb1v-xwXyZVLK1cxAJEtvdr3vLOQAc_VDrGsYV1TDLIkq4zvUDzE-UxRAM_VjrE-z9xyBTefstdvrscdhE5Yj6czWtRAPRisguxA-UsKxriEtxSSRgdbSCb-luAXcAahtaTliefLPX2B79wIWqAPqBDTP_e9YAyqStDsJfPomPZkBsQUu1wmgOzs01PjIGO6T1em4OoLDN6Ns6moTW9W5o1Om9UwYOhcbYhxaMtH4fdCmhAG2hV2uN26r1nY0liLfksS0ovJTtb3iYB5XGOtWer92mQJ7zt50bYiDsLTA38D7pqzRL0WGoSJnzjyHFnrQdMrgFMg4V-RRuCH_9iFy12eUnt8bK0R48V3F58SAsIdpByIsNr3yhBOrBAn-0SYt4bVW_CRTDg9ImV3ZFt0dw_cWkIJ5IXhGLomp3R8_tGsDn8UowMdF5Eq2BI_vLQ4kQPgnfZbyNZSVThUMQ6bVTMEzcRBnjkhRMUrOUOwkEws0te1Ud0F7V3DEnGBojbFScVya6S7_yS_35kaBQgqeN5_o8pxnsU70wCMbc7b7oehlpBo5-2MQzzdKRcSGlzyvcmMNQZbhRdFk3MNuiGBxBZFdfaXeGMWgqM5Pan3p1hMZgEobrVQgf0oiDMIfES-P_j- -pbxMVOoocW15-pa1DHqqipkNwzUdcXxRlZR-CN-w6mymk1K-Wt-ZI7BWyCX5cGRZex7Wp-eHXazF1mCVpyy8m1yjnNM2xl5QbxfObuTmqM1-xTRhQJNbnALgEvhTjtNxFekQdPX3ceDrygJ-xfTLUjsxTnLtQxTfpbrkxvknQslLAeAb-xFrNmHEUSkY_n2eVdSk_I3W0lDN8b8b0KIAYaLWwB2GH7b-74BzCES2bCOS0QIpWdBO5DbFC-MRX2vx9tV_00BLRaiSHoGFFLcxatv6FoTl9GPVKiyhXSddm-_uYdDf9Ii34FlQx6YL4GBs1vPAaJ7HzNliQYW6WT8-jpLpNGfsdSledFTaP295yMtCxsBVmuluRUQvTZ9x2KYqjem6zk3aIQixMJ3EUa6X1J2kJ7kvXJWlk4_qByx-9zk7JFuJtbRX4hFwEFMZ37FWjypeN-n6RXPe4k9NQLCBqqMGG-_NXBsB7A7C3FNG0y1vw7S8kXRItLd5OkvIPbdbAF3N3ULK5qHjgzbFAenLcunyxlVgIKYo4pq6It7HCfErvw1Qet-ClUw84ODWOVskT1NhkMBI8RfpJWEYGJhXJmnaTvJ2F1BMWOX4wt7wldu0Tnrp5cB_mInDa2Fj9PTJWvITQvjJdLyoDpgcsKcEHPUt34VJguvl02WrgjwuJyr7l5BugxNIMIdYNAwap_NYp71f-VC0syU1lw4GN6ZQ76rf1HBGKZfbH-cDmtyH7xvJGqa4LG09OLAmjJ9DBHTdqDZgwHmx6d0lYYdVTOUKUPDbd1muqnSAl6pvFa7Ao0rVXY7S52PBn3EM109XxZh1yo0JPo2pj7Ic45FtHelNus6ls-nMuMinvpY0WaAp65P53H8nW3Esjem_q8Q9k-Zh2sigeA2A8cJ7dCNvdhDEwdI67nzXfRz6Lq9vm8f5UH-nGLZGY5iNPmNqEc2DSCMZbU_x_M9I2pBqmEfyd8yzQB9qb_4eL6A3_yQq_9kSQLnJ8Fsj0m-Z5j2gpuydy5EPUusTAvCyIVc-KCu2Tuvp6ITGyavDwNCnQiF9d4rgn9cOKjGT5Ggdf-cj3B6DjboduQYIrzv3NpXAE4a5M4ZXkKUg2xX1hZeiyIQB60NmPPIwMKTzGl_ecj6CbGzC5i6OJaInAaIuzJD3pH1zzA0rU7e6IS3_fwk9fv6IVQbbcp78kzWVPIB1FaquYzPZOjeSEy_RKCuLXBa77ZfygR6hjvAqAZwZanyRDbHLBhelUSjJFpFLp7d4H6_-P6bemVC3MpN7VFP5F3gyU3ekTeyDZ5XM2Gb879ZkJPZ5ZDclRE3jiI4YaFciE5CkgahtoOeuczqwMzb4OMavMZC5WnmmyMIY4LNuMe6ShCdKCONBFGfbIlUwkXv4eKRlLVg5UFVf8MeFLehekff1WdvbJU-WFirGdN2-xW8bx9N3uxNuYLUPhGyUPC73CkIICmRBFOfGDXW_dHHcMpckKj-Mp1cXFeMIorLM3sA5jx4ly04KKqumA5rHpLtOXHgHS93loUzN02ZqnM5HpaX23CCRqIbC1R82GCQg8gFrCkEzt7YBM9pdk_gw5bFXRGWmLIs1kiVjsl2tKqZfndPdcoNxfUG2zHlO4jDprrjqkmXj5BxLCFClRo4VQNC2shhOxrasdKpzoOPUi1VYp_oM7UA0sPQIrvz8FKPx4SviZ9BIPoDraYxxvZX2V20JpiII4yCoLmR_mV-irZDPx0UCpU8NxryWOdQ4PwUpVxMnjPkVwSpWjlpNwl0sVh9sTpPstwwjxNh34z7Pmu-xwvrNWxFd2XSBK4KcVfHlFJX0WO0tRL_kHzSvnGhzyozFGV_rJbxsNL60_6ZCmW- -Cimm0Y3jN_zyPAzv1o6yMWHnlJouvr7ly9E77bB9CqVBzUUUnSkTYyS19EG-TvUdVtswAUr5o2qhc2xx3bUi7R00ixXsUZ_0m00]--></g></svg>