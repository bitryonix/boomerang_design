<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="9201px" preserveAspectRatio="none" style="width:4697px;height:9201px;background:#FFFFFF;" version="1.1" viewBox="0 0 4697 9201" width="4697px" zoomAndPan="magnify"><title>Non-Initiator Withdrawal Sequence Diagram (Without Stated)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="439.8721" x="2130.168" y="28.5352">Non-Initiator Withdrawal Sequence Diagram (Without Stated)</text><rect fill="#F0F8FF" height="9151.8848" style="stroke:#181818;stroke-width:0.5;" width="1563.8804" x="816" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.6196" x="1566.6304" y="56.0566">User Side</text><rect fill="#FFFFFF" height="9151.8848" style="stroke:#181818;stroke-width:0.5;" width="266.5957" x="3800.2334" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36.4673" x="3915.2976" y="56.0566">Peers</text><rect fill="none" height="1072.9063" style="stroke:#000000;stroke-width:1.5;" width="2496.9351" x="330" y="2343.0996"/><rect fill="none" height="1006.2852" style="stroke:#000000;stroke-width:1.5;" width="2563.0693" x="307" y="5062.3652"/><rect fill="#ADD8E6" height="145.1738" style="stroke:#000000;stroke-width:1.5;" width="926.2842" x="3684" y="8307.7051"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="834.1826" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="838" x2="838" y1="139.2871" y2="9115.8848"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="879.25" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="882.3652" x2="882.3652" y1="139.2871" y2="9115.8848"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="940.8374" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="944.1348" x2="944.1348" y1="139.2871" y2="9115.8848"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="1684.5659" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1688.3696" x2="1688.3696" y1="139.2871" y2="9115.8848"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="2349.8174" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2353.7544" x2="2353.7544" y1="139.2871" y2="9115.8848"/></g><g><title>WT</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="3074.9678" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3078.5532" x2="3078.5532" y1="139.2871" y2="9115.8848"/></g><g><title>Non_Initiator_Peers</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="3872.8242" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3876.2334" x2="3876.2334" y1="139.2871" y2="9115.8848"/></g><g><title>Initiator_Peer</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="4007.1221" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="4010.415" x2="4010.415" y1="139.2871" y2="9115.8848"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="8976.5977" width="8" x="4092.4233" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="4095.8291" x2="4095.8291" y1="139.2871" y2="9115.8848"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="820" y="136.334">User</text><ellipse cx="838.1826" cy="71.2988" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M838.1826,79.2988 L838.1826,106.2988 M825.1826,87.2988 L851.1826,87.2988 M838.1826,106.2988 L825.1826,121.2988 M838.1826,106.2988 L851.1826,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="820" y="9128.4199">User</text><ellipse cx="838.1826" cy="9139.873" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M838.1826,9147.873 L838.1826,9174.873 M825.1826,9155.873 L851.1826,9155.873 M838.1826,9174.873 L825.1826,9189.873 M838.1826,9174.873 L851.1826,9189.873" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="866.3652" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="873.3652" y="128.334">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="866.3652" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="873.3652" y="9135.4199">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="910.1348" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="917.1348" y="128.334">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="910.1348" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="917.1348" y="9135.4199">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="1673.3696" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="1680.3696" y="128.334">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="1673.3696" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="1680.3696" y="9135.4199">ST</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2331.7544" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2338.7544" y="128.334">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2331.7544" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2338.7544" y="9135.4199">Niso</text></g><g class="participant participant-head" data-participant="WT"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8291" x="3061.5532" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8291" x="3068.5532" y="128.334">WT</text></g><g class="participant participant-tail" data-participant="WT"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8291" x="3061.5532" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8291" x="3068.5532" y="9135.4199">WT</text></g><g class="participant participant-head" data-participant="Non_Initiator_Peers"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145.1816" x="3804.2334" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.1816" x="3811.2334" y="128.334">Non_Initiator_Peers</text></g><g class="participant participant-tail" data-participant="Non_Initiator_Peers"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145.1816" x="3804.2334" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.1816" x="3811.2334" y="9135.4199">Non_Initiator_Peers</text></g><g class="participant participant-head" data-participant="Initiator_Peer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.4141" x="3959.415" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.4141" x="3966.415" y="128.334">Initiator_Peer</text></g><g class="participant participant-tail" data-participant="Initiator_Peer"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.4141" x="3959.415" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.4141" x="3966.415" y="9135.4199">Initiator_Peer</text></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="4072.8291" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="4079.8291" y="128.334">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="4072.8291" y="9114.8848"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="4079.8291" y="9135.4199">SARs</text></g><path d="M819,179.2871 L819,326.2871 L4114,326.2871 L4114,189.2871 L4104,179.2871 L819,179.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M4104,179.2871 L4104,189.2871 L4114,189.2871 L4104,179.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88.8672" x="1862.4314" y="196.8555">PARAMETERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="212.166">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="629.5605" x="1878.8782" y="212.166">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="227.4766">2.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="771.0054" x="1878.8782" y="227.4766">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_WT_TX_APPROVAL_BY_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="242.7871">3.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="888.0371" x="1878.8782" y="242.7871">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_APPROVAL_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="258.0977">4.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1025.7114" x="1878.8782" y="258.0977">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="273.4082">5.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="901.6782" x="1878.8782" y="273.4082">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="288.7188">6.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="852.0396" x="1878.8782" y="288.7188">define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="304.0293">7.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="980.3765" x="1878.8782" y="304.0293">define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_INITIATOR_PEER_TX_COMMITMENT_BY_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3335" x="1862.4314" y="319.3398">8.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1182.708" x="1878.8782" y="319.3398">define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_COMMITMENT_BY_WT_HAVING_SAR_RESPONSE_BACK_TO_WT</text><g class="message" data-participant-1="Initiator_Peer" data-participant-2="WT"><polygon fill="#181818" points="3089.9678,380.0137,3079.9678,384.0137,3089.9678,388.0137,3085.9678,384.0137" style="stroke:#181818;stroke-width:1;"/><ellipse cx="4010.6221" cy="383.2637" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3083.9678" x2="4006.1221" y1="384.0137" y2="384.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3095.9678" y="363.9609">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="3126.7549" y="348.6504">WithdrawalNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.2456" x="3130.8682" y="363.9609">peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="631.9028" x="3130.8682" y="379.2715">psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text></g><path d="M2947,397.0137 L2947,437.0137 L3209,437.0137 L3209,407.0137 L3199,397.0137 L2947,397.0137" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3199,397.0137 L3199,407.0137 L3209,407.0137 L3199,397.0137" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.7188" x="2953" y="414.582">WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.7759" x="2953" y="429.8926">operations shown in initiator diagram.</text><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="3078.4678" cy="509.127" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3864.8242,505.877,3874.8242,509.877,3864.8242,513.877,3868.8242,509.877" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="3870.8242" y1="509.877" y2="509.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="482.1689">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3116.7549" y="459.2031">WithdrawalWtNonInitiatorNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="3120.8682" y="474.5137">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.3857" x="3120.8682" y="489.8242">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.8003" x="3120.8682" y="505.1348">psbt_encrypted_by_boomlet_0_for_boomlet_i [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2364.8174,581.1191,2354.8174,585.1191,2364.8174,589.1191,2360.8174,585.1191" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3078.4678" cy="584.3691" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2358.8174" x2="3073.9678" y1="585.1191" y2="585.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2370.8174" y="557.4111">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2401.6045" y="534.4453">WithdrawalWtNonInitiatorNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="2405.7178" y="549.7559">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.3857" x="2405.7178" y="565.0664">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.707" x="2405.7178" y="580.377">psbt_encrypted_by_boomlet_0_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="1838,598.1191,2869,598.1191,2879,663.1191,2869,728.1191,1838,728.1191,1828,663.1191,1838,598.1191" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="941.4272" x="1840" y="614.6875">Non-initiator Niso receives {wt_tx_approval_signed_by_wt, peer_0_tx_approval_signed_by_boomlet_0, psbt_encrypted_by_boomlet_0_for_boomlet_1}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.1489" x="1844.1133" y="629.998">from WT. Non-initiator Niso verifies wt_pubkey's signature on wt_tx_approval_signed_by_wt, finds out which peer is the initiator by looking at</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="820.022" x="1844.1133" y="645.3086">the initiator_id field of wt_tx_approval (We consider peer_0 as the initiator). It verifies that the boomlet_0_identity_pubkey derived</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1019.1733" x="1844.1133" y="660.6191">from wt_tx_approval exists in the set of peer_ids_collection, It then verifies boomlet_0_identity_pubkey's signature on peer_0_tx_approval_signed_by_boomlet_0.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="859.917" x="1844.1133" y="675.9297">Non-initiator Niso checks that the magic in peer_0_tx_approval and wt_tx_approval match "approved", the tx_id in both approvals is the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="872.2822" x="1844.1133" y="691.2402">same, peer_0_tx_approval is fresh according to wt_tx_approval and wt_tx_approval is fresh according to most_work_bitcoin_block_height.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="930.9536" x="1844.1133" y="706.5508">It then checks that most_work_bitcoin_block_height has passed milestone_block_0 from boomerang_descriptor and forwards the received message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.5854" x="1844.1133" y="721.8613">alongside niso_1_event_block_height to Non-initiator Boomlet.</text><polygon fill="#FFC0CB" points="2087,738.6035,2619,738.6035,2629,749.6035,2619,761.6035,2087,761.6035,2077,749.6035,2087,738.6035" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="528.8169" x="2089" y="755.1719">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True.</text><polygon fill="#E6E6FA" points="2074,771.9141,2633,771.9141,2643,782.9141,2633,794.9141,2074,794.9141,2064,782.9141,2074,771.9141" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="555.5977" x="2076" y="788.4824">regard wt_tx_approval_signed_by_wt.content.initiator_id as boomlet_0_identity_pubkey.</text><polygon fill="#FFC0CB" points="2071,805.2246,2635,805.2246,2645,816.2246,2635,828.2246,2071,828.2246,2061,816.2246,2071,805.2246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="560.3203" x="2073" y="821.793">Check that boomlet_0_identity_pubkey exists in boomerang_params.peer_ids_collection.</text><polygon fill="#FFC0CB" points="1994,838.5352,2712,838.5352,2722,849.5352,2712,861.5352,1994,861.5352,1984,849.5352,1994,838.5352" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="714.6572" x="1996" y="855.1035">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_approval_signed_by_boomlet_0.signature) == True.</text><polygon fill="#E6E6FA" points="2117,871.8457,2589,871.8457,2599,897.8457,2589,924.8457,2117,924.8457,2107,897.8457,2117,871.8457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.9756" x="2119" y="888.4141">peer_0_tx_approval := peer_0_tx_approval_signed_by_boomlet_0.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.3257" x="2123.1133" y="903.7246">wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="2123.1133" y="919.0352">niso_1_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="2196,935.7773,2510,935.7773,2520,946.7773,2510,958.7773,2196,958.7773,2186,946.7773,2196,935.7773" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.4893" x="2198" y="952.3457">Assert peer_0_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="2210,969.0879,2496,969.0879,2506,980.0879,2496,992.0879,2210,992.0879,2200,980.0879,2210,969.0879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.6611" x="2212" y="985.6563">Assert wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="2170,1002.3984,2535,1002.3984,2545,1013.3984,2535,1025.3984,2170,1025.3984,2160,1013.3984,2170,1002.3984" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="361.7148" x="2172" y="1018.9668">Assert peer_0_tx_approval.tx_id == wt_tx_approval.tx_id</text><polygon fill="#FFC0CB" points="1594,1035.709,3113,1035.709,3123,1061.709,3113,1088.709,1594,1088.709,1584,1061.709,1594,1035.709" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1596" y="1052.2773">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1506.9082" x="1600.1133" y="1067.5879">Assert wt_tx_approval.event_block_height &gt;= max(peer_0_tx_approval.event_block_height, (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_WT_TX_APPROVAL_BY_NON_INITIATOR_PEERS))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1364.9492" x="1600.1133" y="1082.8984">Assert wt_tx_approval.event_block_height &lt;= min((peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT), niso_1_event_block_height)</text><polygon fill="#FFC0CB" points="2011,1099.6406,2695,1099.6406,2705,1110.6406,2695,1122.6406,2011,1122.6406,2001,1110.6406,2011,1099.6406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.4497" x="2013" y="1116.209">Assert most_work_bitcoin_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><polygon fill="#E6E6FA" points="2202,1132.9512,2504,1132.9512,2514,1143.9512,2504,1155.9512,2202,1155.9512,2192,1143.9512,2202,1132.9512" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.7461" x="2204" y="1149.5195">initiator_peer_id := peer_0_tx_approval.peer_id</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="955.8374,1239.8145,945.8374,1243.8145,955.8374,1247.8145,951.8374,1243.8145" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="1243.0645" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="949.8374" x2="2348.8174" y1="1243.8145" y2="1243.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="961.8374" y="1208.4512">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="992.6245" y="1177.8301">WithdrawalNonInitiatorNisoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="996.7378" y="1193.1406">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.3857" x="996.7378" y="1208.4512">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.707" x="996.7378" y="1223.7617">psbt_encrypted_by_boomlet_0_for_boomlet_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="996.7378" y="1239.0723">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="405,1256.8145,1483,1256.8145,1493,1321.8145,1483,1386.8145,405,1386.8145,395,1321.8145,405,1256.8145" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="964.7866" x="407" y="1273.3828">Non-initiator Boomlet receives {wt_tx_approval_signed_by_wt, peer_0_tx_approval_signed_by_boomlet_0, psbt_encrypted_by_boomlet_0_for_boomlet_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="882.1274" x="411.1133" y="1288.6934">niso_1_event_block_height} from Non-initiator Niso. Non-initiator Boomlet verifies wt_pubkey's signature on wt_tx_approval_signed_by_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="850.0781" x="411.1133" y="1304.0039">finds out which peer is the initiator by looking at the initiator_id field of wt_tx_approval. It verifies that the boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1065.8286" x="411.1133" y="1319.3145">derived from wt_tx_approval exists in the set of peer_ids_collection. It then verifies boomlet_0_identity_pubkey's signature on peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="937.1362" x="411.1133" y="1334.625">and decrypts psbt_encrypted_by_boomlet_0_for_boomlet_1 using boomlet_1_identity_privkey and boomlet_0_identity. Non-initiator Boomlet checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="922.1177" x="411.1133" y="1349.9355">that the magic in peer_0_tx_approval and wt_tx_approval match "approved", the tx_id in both approvals is the same as the one derived from psbt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="967.0718" x="411.1133" y="1365.2461">peer_0_tx_approval is fresh according to wt_tx_approval, wt_tx_approval is fresh according to niso_1_event_block_height and niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="677.6694" x="411.1133" y="1380.5566">has passed (is larger than) milestone_block_0. Non-initiator Boomlet then sends psbt to non-initiator Niso.</text><polygon fill="#FFC0CB" points="680,1397.2988,1208,1397.2988,1218,1408.2988,1208,1420.2988,680,1420.2988,670,1408.2988,680,1397.2988" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="524.7036" x="682" y="1413.8672">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="665,1430.6094,1224,1430.6094,1234,1441.6094,1224,1453.6094,665,1453.6094,655,1441.6094,665,1430.6094" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="555.5977" x="667" y="1447.1777">regard wt_tx_approval_signed_by_wt.content.initiator_id as boomlet_0_identity_pubkey.</text><polygon fill="#FFC0CB" points="662,1463.9199,1226,1463.9199,1236,1474.9199,1226,1486.9199,662,1486.9199,652,1474.9199,662,1463.9199" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="560.3203" x="664" y="1480.4883">Check that boomlet_0_identity_pubkey exists in boomerang_params.peer_ids_collection.</text><polygon fill="#FFC0CB" points="587,1497.2305,1301,1497.2305,1311,1508.2305,1301,1520.2305,587,1520.2305,577,1508.2305,587,1497.2305" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="710.5439" x="589" y="1513.7988">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_approval_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="469,1530.541,1419,1530.541,1429,1556.541,1419,1583.541,469,1583.541,459,1556.541,469,1530.541" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.9756" x="471" y="1547.1094">peer_0_tx_approval := peer_0_tx_approval_signed_by_boomlet_0.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.3257" x="475.1133" y="1562.4199">wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="941.9858" x="475.1133" y="1577.7305">psbt := AES_decrypt(privkey: ECDH(boomlet_1_identity_privkey, boomlet_0_identity_pubkey), content: psbt_encrypted_by_boomlet_0_for_boomlet_1)</text><polygon fill="#FFC0CB" points="787,1594.4727,1101,1594.4727,1111,1605.4727,1101,1617.4727,787,1617.4727,777,1605.4727,787,1594.4727" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.4893" x="789" y="1611.041">Assert peer_0_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="801,1627.7832,1087,1627.7832,1097,1638.7832,1087,1650.7832,801,1650.7832,791,1638.7832,801,1627.7832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.6611" x="803" y="1644.3516">Assert wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="766,1661.0938,1121,1661.0938,1131,1680.0938,1121,1699.0938,766,1699.0938,756,1680.0938,766,1661.0938" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.769" x="768" y="1677.6621">Assert psbt.derive_tx_id() == peer_0_tx_approval.tx_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="317.9541" x="772.1133" y="1692.9727">peer_0_tx_approval.tx_id == wt_tx_approval.tx_id</text><polygon fill="#FFC0CB" points="362,1709.7148,1526,1709.7148,1536,1735.7148,1526,1762.7148,362,1762.7148,352,1735.7148,362,1709.7148" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="364" y="1726.2832">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1152.4043" x="368.1133" y="1741.5938">Assert peer_0_tx_approval.event_block_height &gt;= (wt_tx_approval.event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="751.7593" x="368.1133" y="1756.9043">Assert peer_0_tx_approval.event_block_height &lt;= min(niso_1_event_block_height, wt_tx_approval.event_block_height)</text><polygon fill="#FFC0CB" points="185,1773.6465,1704,1773.6465,1714,1799.6465,1704,1826.6465,185,1826.6465,175,1799.6465,185,1773.6465" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="187" y="1790.2148">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1506.9082" x="191.1133" y="1805.5254">Assert wt_tx_approval.event_block_height &gt;= max(peer_0_tx_approval.event_block_height, (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_WT_TX_APPROVAL_BY_NON_INITIATOR_PEERS))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1364.9492" x="191.1133" y="1820.8359">Assert wt_tx_approval.event_block_height &lt;= min((peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT), niso_1_event_block_height)</text><polygon fill="#FFC0CB" points="621,1837.5781,1268,1837.5781,1278,1848.5781,1268,1860.5781,621,1860.5781,611,1848.5781,621,1837.5781" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643.4492" x="623" y="1854.1465">Assert niso_1_event_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="944.3374" cy="1901.7598" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,1898.5098,2351.8174,1902.5098,2341.8174,1906.5098,2345.8174,1902.5098" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="948.8374" x2="2347.8174" y1="1902.5098" y2="1902.5098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="951.8374" y="1890.1123">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="982.6245" y="1882.457">WithdrawalNonInitiatorBoomletNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.8535" x="986.7378" y="1897.7676">psbt</text></g><polygon fill="#FFF0F5" points="1904,1915.5098,2803,1915.5098,2813,1934.5098,2803,1953.5098,1904,1953.5098,1894,1934.5098,1904,1915.5098" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="891.084" x="1906" y="1932.0781">Non-initiator Niso receives psbt from Non-initiator non-initiator Boomlet. Non-initiator Niso checks that psbt is satisfiable and derived tx_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="692.6118" x="1910.1133" y="1947.3887">matches that of peer_0_tx_approval. It then outputs psbt along with initiator's peer_i_id to non-initiator User.</text><polygon fill="#FFC0CB" points="2246,1964.1309,2459,1964.1309,2469,1975.1309,2459,1987.1309,2246,1987.1309,2236,1975.1309,2246,1964.1309" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.9297" x="2248" y="1980.6992">Assert hydrate_psbt(psbt) != Null</text><polygon fill="#FFC0CB" points="2177,1997.4414,2528,1997.4414,2538,2008.4414,2528,2020.4414,2177,2020.4414,2167,2008.4414,2177,1997.4414" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.769" x="2179" y="2014.0098">Assert psbt.derive_tx_id() == peer_0_tx_approval.tx_id</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="849.1826,2073.6836,839.1826,2077.6836,849.1826,2081.6836,845.1826,2077.6836" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="2076.9336" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="843.1826" x2="2348.8174" y1="2077.6836" y2="2077.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="855.1826" y="2057.6309">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240.938" x="885.9697" y="2042.3203">WithdrawalNonInitiatorNisoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.8535" x="890.083" y="2057.6309">psbt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4766" x="890.083" y="2072.9414">initiator_peer_id</text></g><polygon fill="#FFF0F5" points="379,2090.6836,1296,2090.6836,1306,2109.6836,1296,2128.6836,379,2128.6836,369,2109.6836,379,2090.6836" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="909.3525" x="381" y="2107.252">Non-initiator User receives {psbt, initiator_peer_id} from non-initiator Niso. Non-initiator User then informs non-initiator Niso of it's agreement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.0522" x="385.1133" y="2122.5625">with the tx.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="837.6826" cy="2170.1758" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,2166.9258,2351.8174,2170.9258,2341.8174,2174.9258,2345.8174,2170.9258" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="842.1826" x2="2347.8174" y1="2170.9258" y2="2170.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="845.1826" y="2158.5283">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229.2773" x="875.9697" y="2150.873">WithdrawalNonInitiatorNisoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.6401" x="880.083" y="2166.1836">magic: "withdrawal_non_initiator_peer_approved_the_withdrawal_psbt"</text></g><polygon fill="#FFF0F5" points="1897,2183.9258,2809,2183.9258,2819,2202.9258,2809,2221.9258,1897,2221.9258,1887,2202.9258,1897,2183.9258" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="903.9507" x="1899" y="2200.4941">Non-initiator Niso receives {magic: "withdrawal_non_initiator_peer_approved_the_withdrawal_psbt"} from non-initiator User. Non-initiator Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.8955" x="1903.1133" y="2215.8047">then informs non-initiator Boomlet to proceed.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="955.8374,2260.168,945.8374,2264.168,955.8374,2268.168,951.8374,2264.168" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="2263.418" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="949.8374" x2="2348.8174" y1="2264.168" y2="2264.168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="961.8374" y="2251.7705">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="992.6245" y="2244.1152">WithdrawalNonInitiatorNisoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.9346" x="996.7378" y="2259.4258">magic: "withdrawal_peer_agreement_with_psbt_received"</text></g><polygon fill="#FFF0F5" points="472,2277.168,1416,2277.168,1426,2303.168,1416,2330.168,472,2330.168,462,2303.168,472,2277.168" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="895.3242" x="474" y="2293.7363">Non-initiator Boomlet receives {magic: "withdrawal_peer_agreement_with_psbt_received"} from non-initiator Niso. Non-initiator Boomlet then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="932.5215" x="478.1133" y="2309.0469">derives tx_id from psbt, adds nonce to it and encrypts it with st_1_identity_pubkey. It then sends tx_id_with_nonce_encrypted_by_boomlet_1_for_st</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3545" x="478.1133" y="2324.3574">to non-initiator Niso.</text><path d="M330,2343.0996 L478.0415,2343.0996 L478.0415,2350.4102 L468.0415,2360.4102 L330,2360.4102 L330,2343.0996" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1072.9063" style="stroke:#000000;stroke-width:1.5;" width="2496.9351" x="330" y="2343.0996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="103.0415" x="345" y="2356.668">ST_check(tx_id)</text><polygon fill="#E6E6FA" points="423,2365.4102,1465,2365.4102,1475,2414.4102,1465,2464.4102,423,2464.4102,413,2414.4102,423,2365.4102" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.6187" x="425" y="2381.9785">tx_id := psbt.derive_tx_id()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.4927" x="429.1133" y="2397.2891">tx_id_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.3618" x="429.1133" y="2412.5996">content: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.9761" x="429.1133" y="2427.9102">nonce: rand() [u8; 32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="425" y="2443.2207">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1033.9063" x="429.1133" y="2458.5313">tx_id_with_nonce_encrypted_by_boomlet_1_for_st := AES_encrypt(private_key: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: tx_id_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="944.3374" cy="2506.1445" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,2502.8945,2351.8174,2506.8945,2341.8174,2510.8945,2345.8174,2506.8945" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="948.8374" x2="2347.8174" y1="2506.8945" y2="2506.8945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="951.8374" y="2494.4971">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="982.6245" y="2486.8418">WithdrawalNonInitiatorBoomletNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.4722" x="986.7378" y="2502.1523">tx_id_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1906,2519.8945,2800,2519.8945,2810,2530.8945,2800,2542.8945,1906,2542.8945,1896,2530.8945,1906,2519.8945" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.0493" x="1908" y="2536.4629">Non-initiator Niso receives tx_id_with_nonce_encrypted_by_boomlet_1_for_st from non-initiator Boomlet and forwards it to non-initiator ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1699.5659,2580.8262,1689.5659,2584.8262,1699.5659,2588.8262,1695.5659,2584.8262" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="2584.0762" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1693.5659" x2="2348.8174" y1="2584.8262" y2="2584.8262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1705.5659" y="2572.4287">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6592" x="1736.353" y="2564.7734">WithdrawalNonInitiatorNisoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.4722" x="1740.4663" y="2580.084">tx_id_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1257,2597.8262,2118,2597.8262,2128,2616.8262,2118,2635.8262,1257,2635.8262,1247,2616.8262,1257,2597.8262" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.5801" x="1259" y="2614.3945">Non-initiator ST receives tx_id_with_nonce_encrypted_by_boomlet_1_for_st from non-initiator Niso. Non-initiator ST decrypts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="853.3599" x="1263.1133" y="2629.7051">tx_id_with_nonce_encrypted_by_boomlet_1_for_st to get tx_id_with_nonce and outputs the content of it i.e. tx_id to non-initiator User.</text><polygon fill="#E6E6FA" points="1180,2646.4473,2196,2646.4473,2206,2665.4473,2196,2684.4473,1180,2684.4473,1170,2665.4473,1180,2646.4473" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.811" x="1182" y="2663.0156">tx_id := tx_id_with_nonce.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1008.2363" x="1186.1133" y="2678.3262">tx_id_with_nonce := AES_decrypt(privkey: ECDH(boomlet_1_identity_pubkey, st_1_identity_privkey), content: tx_id_with_nonce_encrypted_by_boomlet_1_for_st)</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="849.1826,2722.6895,839.1826,2726.6895,849.1826,2730.6895,845.1826,2726.6895" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1688.0659" cy="2725.9395" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="843.1826" x2="1683.5659" y1="2726.6895" y2="2726.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="855.1826" y="2714.292">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.7612" x="885.9697" y="2706.6367">WithdrawalNonInitiatorStOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.2749" x="890.083" y="2721.9473">tx_id</text></g><polygon fill="#FFF0F5" points="394,2739.6895,1281,2739.6895,1291,2758.6895,1281,2777.6895,394,2777.6895,384,2758.6895,394,2739.6895" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="879.5439" x="396" y="2756.2578">Non-initiator User receives tx_id from non-initiator ST. Non-initiator User checks to see tx_id matches the one he previously received from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="526.8555" x="400.1133" y="2771.5684">non-initiator Niso and agreed to. It then informs non-initiator ST of his agreement.</text><polygon fill="#FFC0CB" points="725,2788.3105,949,2788.3105,959,2799.3105,949,2811.3105,725,2811.3105,715,2799.3105,725,2788.3105" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.6001" x="727" y="2804.8789">Assert tx_id == psbt.derive_tx_id()</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="837.6826" cy="2852.4922" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1676.5659,2849.2422,1686.5659,2853.2422,1676.5659,2857.2422,1680.5659,2853.2422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="842.1826" x2="1682.5659" y1="2853.2422" y2="2853.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="845.1826" y="2840.8447">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="212.1006" x="875.9697" y="2833.1895">WithdrawalNonInitiatorStInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.4829" x="880.083" y="2848.5">magic: "withdrawal_non_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"</text></g><polygon fill="#FFF0F5" points="1203,2866.2422,2172,2866.2422,2182,2885.2422,2172,2904.2422,1203,2904.2422,1193,2885.2422,1203,2866.2422" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961.0479" x="1205" y="2882.8105">Non-initiator ST receives {magic: "withdrawal_non_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="893.623" x="1209.1133" y="2898.1211">from non-initiator User. It signs the tx_id_with_nonce, encrypts it with boomlet_1_identity_pubkey and sends the result to non-initiator Niso.</text><polygon fill="#E6E6FA" points="1079,2914.8633,2296,2914.8633,2306,2956.8633,2296,2998.8633,1079,2998.8633,1069,2956.8633,1079,2914.8633" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.8433" x="1081" y="2931.4316">tx_id_with_nonce_signed_by_st := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.5991" x="1085.1133" y="2946.7422">signature: schnorr_sign(st_1_identity_privkey, tx_id_with_nonce)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.9756" x="1085.1133" y="2962.0527">content: tx_id_with_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1081" y="2977.3633">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1209.7998" x="1085.1133" y="2992.6738">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 := AES_encrypt(private_key: ECDH(st_1_identity_privkey, boomlet_1_identity_pubkey), content: tx_id_with_nonce_signed_by_st)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1688.0659" cy="3040.2871" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,3037.0371,2351.8174,3041.0371,2341.8174,3045.0371,2345.8174,3041.0371" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1692.5659" x2="2347.8174" y1="3041.0371" y2="3041.0371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1695.5659" y="3028.6396">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6592" x="1726.353" y="3020.9844">WithdrawalNonInitiatorStNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.4189" x="1730.4663" y="3036.2949">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="1900,3054.0371,2806,3054.0371,2816,3073.0371,2806,3092.0371,1900,3092.0371,1890,3073.0371,1900,3054.0371" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.8218" x="1902" y="3070.6055">Non-initiator Niso receives tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 from non-initiator ST. Non-initiator Niso forwards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="888.8877" x="1906.1133" y="3085.916">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 along with the updated niso_1_event_block_height to non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2150,3102.6582,2555,3102.6582,2565,3113.6582,2555,3125.6582,2150,3125.6582,2140,3113.6582,2150,3102.6582" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="401.9653" x="2152" y="3119.2266">niso_1_event_block_height := most_work_bitcoin_block_height.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="955.8374,3178.9004,945.8374,3182.9004,955.8374,3186.9004,951.8374,3182.9004" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="3182.1504" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="949.8374" x2="2348.8174" y1="3182.9004" y2="3182.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="961.8374" y="3162.8477">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="992.6245" y="3147.5371">WithdrawalNonInitiatorNisoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.4189" x="996.7378" y="3162.8477">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="996.7378" y="3178.1582">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="469,3195.9004,1419,3195.9004,1429,3244.9004,1419,3294.9004,469,3294.9004,459,3244.9004,469,3195.9004" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="942.3667" x="471" y="3212.4688">Non-initiator Boomlet receives {tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1, niso_1_event_block_height} from non-initiator Niso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="860.958" x="475.1133" y="3227.7793">Non-initiator Boomlet decrypts tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 using boomlet_1_identity_privkey to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="838.2397" x="475.1133" y="3243.0898">tx_id_with_nonce_signed_by_st. It then verifies st_1_identity_pubkey's signature on tx_id_with_nonce_signed_by_st and checks if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="882.1528" x="475.1133" y="3258.4004">tx_id_with_nonce received matches with the one sent. Non-initiator Boomlet generates peer_1_tx_approval composed of {"approved", tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.8223" x="475.1133" y="3273.7109">niso_1_event_block_height}, signs it using boomlet_1_identity_privkey, encrypts it with wt_pubkey and sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="614.7134" x="475.1133" y="3289.0215">peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt to non-initiator Niso.</text><polygon fill="#E6E6FA" points="350,3305.7637,1538,3305.7637,1548,3316.7637,1538,3328.7637,350,3328.7637,340,3316.7637,350,3305.7637" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1184.1299" x="352" y="3322.332">tx_id_with_nonce_signed_by_st := AES_decrypt(privkey: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1)</text><polygon fill="#FFC0CB" points="642,3339.0742,1246,3339.0742,1256,3350.0742,1246,3362.0742,642,3362.0742,632,3350.0742,642,3339.0742" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="600.4438" x="644" y="3355.6426">Assert schnorr_verify(st_1_identity_pubkey, tx_id_with_nonce_signed_by_st.signature) == True</text><polygon fill="#FFC0CB" points="725,3372.3848,1163,3372.3848,1173,3391.3848,1163,3410.3848,725,3410.3848,715,3391.3848,725,3372.3848" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="727" y="3388.9531">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="430.4663" x="731.1133" y="3404.2637">Assert tx_id_with_nonce_signed_by_st.content == tx_id_with_nonce</text><polygon fill="#E6E6FA" points="290,3428.0059,1597,3428.0059,1607,3508.0059,1597,3589.0059,290,3589.0059,280,3508.0059,290,3428.0059" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.9536" x="292" y="3444.5742">_peer_1_tx_approval := TxApproval{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.4038" x="296.1133" y="3459.8848">magic: "approval",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="296.1133" y="3475.1953">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.7461" x="296.1133" y="3490.5059">event_block_height: niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="296.1133" y="3505.8164">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.7803" x="296.1133" y="3521.127">_peer_1_tx_approval_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="467.8159" x="296.1133" y="3536.4375">signature: schnorr_sign(boomlet_1_identity_privkey, _peer_1_tx_approval)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.5293" x="296.1133" y="3551.748">content: _peer_1_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="292" y="3567.0586">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1299.708" x="296.1133" y="3582.3691">_peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt := AES_encrypt(private_key: ECDH(boomlet_1_identity_privkey, wt_pubkey), content: _peer_1_tx_approval_signed_by_boomlet_1)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="944.3374" cy="3629.9824" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,3626.7324,2351.8174,3630.7324,2341.8174,3634.7324,2345.8174,3630.7324" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="948.8374" x2="2347.8174" y1="3630.7324" y2="3630.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="951.8374" y="3618.335">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="982.6245" y="3610.6797">WithdrawalNonInitiatorBoomletNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.2456" x="986.7378" y="3625.9902">peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="1866,3643.7324,2839,3643.7324,2849,3654.7324,2839,3666.7324,1866,3666.7324,1856,3654.7324,1866,3643.7324" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="969.6362" x="1868" y="3660.3008">Non-initiator Niso receives peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2353.3174" cy="3707.9141" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3066.9678,3704.6641,3076.9678,3708.6641,3066.9678,3712.6641,3070.9678,3708.6641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2357.8174" x2="3072.9678" y1="3708.6641" y2="3708.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2360.8174" y="3696.2666">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2391.6045" y="3688.6113">WithdrawalNonInitiatorNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.2456" x="2395.7178" y="3703.9219">peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="2623,3721.6641,3534,3721.6641,3544,3770.6641,3534,3820.6641,2623,3820.6641,2613,3770.6641,2623,3721.6641" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="895.1528" x="2625" y="3738.2324">WT receives peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Niso, decrypts it using wt_privkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="866.874" x="2629.1133" y="3753.543">verifies boomlet_1_identity_pubkey's signature on peer_1_tx_approval_signed_by_boomlet_1, checks that the magic matches "approved",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.2764" x="2629.1133" y="3768.8535">tx_id match the expected value and message to be fresh according to the most_work_bitcoin_block_height and event_block_height of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="899.3105" x="2629.1133" y="3784.1641">wt_tx_approval. It also receives peer_i_tx_approval_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt from non-initiator Peers and repeats</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="861.9546" x="2629.1133" y="3799.4746">the same validation process. WT then sends to each non-initiator peer a collection of all other peers' approvals except the initiator's and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="700.4766" x="2629.1133" y="3814.7852">in a separate message sends a collection of all peers' approvals along with wt_tx_approval to the initiator peer.</text><polygon fill="#E6E6FA" points="2446,3831.5273,3711,3831.5273,3721,3842.5273,3711,3854.5273,2446,3854.5273,2436,3842.5273,2446,3831.5273" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1261.0381" x="2448" y="3848.0957">peer_1_tx_approval_signed_by_boomlet_1 := AES_decrypt(privkey: ECDH(boomlet_1_identity_pubkey, wt_privkey), content: peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt)</text><polygon fill="#FFC0CB" points="2721,3864.8379,3435,3864.8379,3445,3875.8379,3435,3887.8379,2721,3887.8379,2711,3875.8379,2721,3864.8379" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="710.5439" x="2723" y="3881.4063">Assert schnorr_verify(boomlet_1_identity_pubkey, peer_1_tx_approval_signed_by_boomlet_1.signature) == True</text><polygon fill="#E6E6FA" points="2844,3898.1484,3311,3898.1484,3321,3909.1484,3311,3921.1484,2844,3921.1484,2834,3909.1484,2844,3898.1484" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.9756" x="2846" y="3914.7168">peer_1_tx_approval := peer_1_tx_approval_signed_by_boomlet_1.content</text><polygon fill="#FFC0CB" points="2923,3931.459,3233,3931.459,3243,3942.459,3233,3954.459,2923,3954.459,2913,3942.459,2923,3931.459" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.376" x="2925" y="3948.0273">Assert peer_1_tx_approval.magic == "approved"</text><polygon fill="#FFC0CB" points="2945,3964.7695,3211,3964.7695,3221,3975.7695,3211,3987.7695,2945,3987.7695,2935,3975.7695,2945,3964.7695" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262.374" x="2947" y="3981.3379">Assert peer_1_tx_approval.tx_id == tx_id</text><polygon fill="#FFC0CB" points="2242,3998.0801,3915,3998.0801,3925,4024.0801,3915,4051.0801,2242,4051.0801,2232,4024.0801,2242,3998.0801" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="2244" y="4014.6484">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1660.9404" x="2248.1133" y="4029.959">Assert peer_1_tx_approval.event_block_height &gt;= max((most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_APPROVAL_BY_WT), wt_tx_approval.event_block_height)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="531.4575" x="2248.1133" y="4045.2695">Assert peer_1_tx_approval.event_block_height &lt;= most_work_bitcoin_block_height.</text><g class="message" data-participant-1="Non_Initiator_Peers" data-participant-2="WT"><polygon fill="#181818" points="3089.9678,4089.6328,3079.9678,4093.6328,3089.9678,4097.6328,3085.9678,4093.6328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="3083.9678" x2="3875.8242" y1="4093.6328" y2="4093.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3095.9678" y="4081.2354">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3126.7549" y="4073.5801">WithdrawalNonInitiatorNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="553.4141" x="3130.8682" y="4088.8906">peer_i_tx_approval_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Initiator_Peer"><ellipse cx="3078.4678" cy="4152.8145" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3999.1221,4149.5645,4009.1221,4153.5645,3999.1221,4157.5645,4003.1221,4153.5645" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="4005.1221" y1="4153.5645" y2="4153.5645"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="4133.5117">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="3116.7549" y="4118.2012">WithdrawalWtNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.3018" x="3120.8682" y="4133.5117">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0=&lt;i=&lt;4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.564" x="3120.8682" y="4148.8223">wt_tx_approval_signed_by_wt</text></g><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="3078.4678" cy="4197.4355" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3864.8242,4194.1855,3874.8242,4198.1855,3864.8242,4202.1855,3868.8242,4198.1855" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="3870.8242" y1="4198.1855" y2="4198.1855"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="4185.7881">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3116.7549" y="4178.1328">WithdrawalWtNonInitiatorNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.7549" x="3120.8682" y="4193.4434">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2364.8174,4238.8066,2354.8174,4242.8066,2364.8174,4246.8066,2360.8174,4242.8066" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3078.4678" cy="4242.0566" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2358.8174" x2="3073.9678" y1="4242.8066" y2="4242.8066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2370.8174" y="4230.4092">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2401.6045" y="4222.7539">WithdrawalWtNonInitiatorNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.7549" x="2405.7178" y="4238.0645">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1838,4255.8066,2868,4255.8066,2878,4297.8066,2868,4339.8066,1838,4339.8066,1828,4297.8066,1838,4255.8066" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1022.563" x="1840" y="4272.375">Non-initiator Niso receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]} from WT. Non-initiator Niso updates niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="871.6221" x="1844.1133" y="4287.6855">with the latest most_work_bitcoin_block_height. For every non_initiator peer in peer_ids_collection, It verifies boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="942.9824" x="1844.1133" y="4302.9961">signature on peer_i_tx_approval_signed_by_boomlet_i, checks that the magic matches "approved", tx_id to be the expected value, peer_i_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="835.853" x="1844.1133" y="4318.3066">to be fresh according to niso_1_event_block_height and wt_tx_approval and checks that wt_tx_approval is still fresh. It forwards this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="741.3618" x="1844.1133" y="4333.6172">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; alongside niso_1_event_block_height to non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2152,4350.3594,2553,4350.3594,2563,4361.3594,2553,4373.3594,2152,4373.3594,2142,4361.3594,2152,4350.3594" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="2154" y="4366.9277">niso_1_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1957,4383.6699,2748,4383.6699,2758,4394.6699,2748,4406.6699,1957,4406.6699,1947,4394.6699,1957,4383.6699" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="787.7124" x="1959" y="4400.2383">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="2081,4416.9805,2626,4416.9805,2636,4427.9805,2626,4439.9805,2081,4439.9805,2071,4427.9805,2081,4416.9805" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.144" x="2083" y="4433.5488">peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="2177,4450.291,2529,4450.291,2539,4461.291,2529,4473.291,2177,4473.291,2167,4461.291,2177,4450.291" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.7085" x="2179" y="4466.8594">peer_i_tx_approval.magic == "approved" [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="2199,4483.6016,2507,4483.6016,2517,4494.6016,2507,4506.6016,2199,4506.6016,2189,4494.6016,2199,4483.6016" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.7065" x="2201" y="4500.1699">peer_i_tx_approval.tx_id == tx_id [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1423,4516.9121,3282,4516.9121,3292,4542.9121,3282,4569.9121,1423,4569.9121,1413,4542.9121,1423,4516.9121" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1425" y="4533.4805">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1847.7075" x="1429.1133" y="4548.791">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1727.2734" x="1433.2266" y="4564.1016">Assert  peer_i_tx_approval.event_block_height &lt;= min(niso_1_event_block_height, (wt_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)) [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1702,4580.8438,3005,4580.8438,3015,4599.8438,3005,4618.8438,1702,4618.8438,1692,4599.8438,1702,4580.8438" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1704" y="4597.4121">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1295.3726" x="1708.1133" y="4612.7227">Assert wt_tx_approval.event_block_height &gt;= (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_NON_INITIATOR_PEERS)</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="955.8374,4672.3965,945.8374,4676.3965,955.8374,4680.3965,951.8374,4676.3965" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="4675.6465" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="949.8374" x2="2348.8174" y1="4676.3965" y2="4676.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="961.8374" y="4656.3438">[27n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="1001.1621" y="4641.0332">WithdrawalNonInitiatorNisoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.6416" x="1005.2754" y="4656.3438">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt;[1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="1005.2754" y="4671.6543">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="418,4689.3965,1470,4689.3965,1480,4738.3965,1470,4788.3965,418,4788.3965,408,4738.3965,418,4689.3965" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="934.502" x="420" y="4705.9648">Non-initiator Boomlet receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4], niso_1_event_block_height} from non-initiator</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1040.1904" x="424.1133" y="4721.2754">Niso. After renewing niso_1_event_block_height, for every peer in peer_ids_collection except the initiator, non-initiator Boomlet verifies boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="942.9824" x="424.1133" y="4736.5859">signature on peer_i_tx_approval_signed_by_boomlet_i, checks that the magic matches "approved", tx_id to be the expected value, peer_i_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="978.5547" x="424.1133" y="4751.8965">to be fresh according to niso_1_event_block_height and wt_tx_approval and checks that wt_tx_approval is still fresh. It then generates duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.4531" x="424.1133" y="4767.207">which is an array of 5 integers between 1 and 198, adds a nonce to it and encrypts it using. Then non-initiator Boomlet sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="549.8467" x="424.1133" y="4782.5176">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st to non-initiator Niso.</text><polygon fill="#FFC0CB" points="548,4799.2598,1339,4799.2598,1349,4810.2598,1339,4822.2598,548,4822.2598,538,4810.2598,548,4799.2598" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="787.7124" x="550" y="4815.8281">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="670,4832.5703,1219,4832.5703,1229,4851.5703,1219,4870.5703,670,4870.5703,660,4851.5703,670,4832.5703" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.144" x="672" y="4849.1387">peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.4268" x="676.1133" y="4864.4492">update niso_1_event_block_height with received value.</text><polygon fill="#FFC0CB" points="746,4881.1914,1142,4881.1914,1152,4892.1914,1142,4904.1914,746,4904.1914,736,4892.1914,746,4881.1914" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392.4692" x="748" y="4897.7598">Assert peer_i_tx_approval.magic == "approved" [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="768,4914.502,1120,4914.502,1130,4925.502,1120,4937.502,768,4937.502,758,4925.502,768,4914.502" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.4673" x="770" y="4931.0703">Assert peer_i_tx_approval.tx_id == tx_id [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="15,4947.8125,1874,4947.8125,1884,4973.8125,1874,5000.8125,15,5000.8125,5,4973.8125,15,4947.8125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="17" y="4964.3809">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1847.7075" x="21.1133" y="4979.6914">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1731.3867" x="25.2266" y="4995.002">Assert  peer_i_tx_approval.event_block_height &lt;= min(niso_1_event_block_height, (wt_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS))  [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="293,5011.7441,1596,5011.7441,1606,5030.7441,1596,5049.7441,293,5049.7441,283,5030.7441,293,5011.7441" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="295" y="5028.3125">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1295.3726" x="299.1133" y="5043.623">Assert wt_tx_approval.event_block_height &gt;= (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_NON_INITIATOR_PEERS)</text><path d="M307,5062.3652 L442.0986,5062.3652 L442.0986,5069.6758 L432.0986,5079.6758 L307,5079.6758 L307,5062.3652" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1006.2852" style="stroke:#000000;stroke-width:1.5;" width="2563.0693" x="307" y="5062.3652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.0986" x="322" y="5075.9336">duress_check</text><polygon fill="#E6E6FA" points="327,5084.6758,1560,5084.6758,1570,5126.6758,1560,5168.6758,327,5168.6758,317,5126.6758,327,5084.6758" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9736" x="329" y="5101.2441">duress_check_space := DuressCheckSpace{space: rand([1..198;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.3994" x="333.1133" y="5116.5547">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1553" x="333.1133" y="5131.8652">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="333.1133" y="5147.1758">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.7197" x="333.1133" y="5162.4863">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st := AES_encrypt(private_key: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="944.3374" cy="5210.0996" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,5206.8496,2351.8174,5210.8496,2341.8174,5214.8496,2345.8174,5210.8496" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="948.8374" x2="2347.8174" y1="5210.8496" y2="5210.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="951.8374" y="5198.4521">[28n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="991.1621" y="5190.7969">WithdrawalNonInitiatorBoomletNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="995.2754" y="5206.1074">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1856,5223.8496,2850,5223.8496,2860,5234.8496,2850,5246.8496,1856,5246.8496,1846,5234.8496,1856,5223.8496" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="990.0693" x="1858" y="5240.418">Non-initiator Niso receives duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st from  non-initiator Boomlet and forwards it to non-initiator ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1699.5659,5284.7813,1689.5659,5288.7813,1699.5659,5292.7813,1695.5659,5288.7813" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="5288.0313" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1693.5659" x2="2348.8174" y1="5288.7813" y2="5288.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="1705.5659" y="5276.3838">[29n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6592" x="1744.8906" y="5268.7285">WithdrawalNonInitiatorNisoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1749.0039" y="5284.0391">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1211,5301.7813,2164,5301.7813,2174,5327.7813,2164,5354.7813,1211,5354.7813,1201,5327.7813,1211,5301.7813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="840.3281" x="1213" y="5318.3496">Non-initiator ST receives duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st from non-initiator Niso, decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="941.4082" x="1217.1133" y="5333.6602">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st, assign a country to each of the numbers in the duress_check_space corresponding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="590.9795" x="1217.1133" y="5348.9707">to its alphabetical rank and shows this array to non-initiator User for him to select 5 of them.</text><polygon fill="#E6E6FA" points="1071,5365.7129,2304,5365.7129,2314,5384.7129,2304,5403.7129,1071,5403.7129,1061,5384.7129,1071,5365.7129" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.834" x="1073" y="5382.2813">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_1_identity_pubkey, st_1_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.6245" x="1077.1133" y="5397.5918">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="849.1826,5441.9551,839.1826,5445.9551,849.1826,5449.9551,845.1826,5445.9551" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1688.0659" cy="5445.2051" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="843.1826" x2="1683.5659" y1="5445.9551" y2="5445.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="855.1826" y="5433.5576">[30n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="223.7612" x="894.5073" y="5425.9023">WithdrawalNonInitiatorStOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.1816" x="898.6206" y="5441.2129">duress_check_space</text></g><polygon fill="#FFF0F5" points="396,5458.9551,1279,5458.9551,1289,5477.9551,1279,5496.9551,396,5496.9551,386,5477.9551,396,5458.9551" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="875.2974" x="398" y="5475.5234">Non-initiator User receives duress_check_space from non-initiator ST. If he is not being coerced he will select 1 country in each column to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.2749" x="402.1133" y="5490.834">replicate the duress_consent_set and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="837.6826" cy="5538.4473" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1676.5659,5535.1973,1686.5659,5539.1973,1676.5659,5543.1973,1680.5659,5539.1973" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="842.1826" x2="1682.5659" y1="5539.1973" y2="5539.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="845.1826" y="5526.7998">[31n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="212.1006" x="884.5073" y="5519.1445">WithdrawalNonInitiatorStInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7847" x="888.6206" y="5534.4551">duress_signal_index</text></g><polygon fill="#FFF0F5" points="1231,5552.1973,2144,5552.1973,2154,5571.1973,2144,5590.1973,1231,5590.1973,1221,5571.1973,1231,5552.1973" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="905.3853" x="1233" y="5568.7656">Non-initiator ST receives duress_signal_index from non-initiator User. Non-initiator ST then creates duress_signal_index_with_nonce using the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="778.5146" x="1237.1133" y="5584.0762">nonce from previously received duress_check_space_with_nonce, encrypts it for non-initiator Boomlet and sends it to Niso.</text><polygon fill="#E6E6FA" points="1071,5600.8184,2306,5600.8184,2316,5634.8184,2306,5669.8184,1071,5669.8184,1061,5634.8184,1071,5600.8184" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.0024" x="1073" y="5617.3867">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.7583" x="1077.1133" y="5632.6973">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="1077.1133" y="5648.0078">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1226.9258" x="1077.1133" y="5663.3184">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1 := AES_encrypt(private_key: ECDH(boomlet_1_identity_pubkey, st_1_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1688.0659" cy="5710.9316" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,5707.6816,2351.8174,5711.6816,2341.8174,5715.6816,2345.8174,5711.6816" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1692.5659" x2="2347.8174" y1="5711.6816" y2="5711.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="1695.5659" y="5699.2842">[32n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6592" x="1734.8906" y="5691.6289">WithdrawalNonInitiatorStNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1739.0039" y="5706.9395">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="1928,5724.6816,2777,5724.6816,2787,5743.6816,2777,5762.6816,1928,5762.6816,1918,5743.6816,1928,5724.6816" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="841.5786" x="1930" y="5741.25">Non-initiator Niso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1 from non-initiator ST and forwards it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.8672" x="1934.1133" y="5756.5605">non-initiator Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="955.8374,5800.9238,945.8374,5804.9238,955.8374,5808.9238,951.8374,5804.9238" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="5804.1738" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="949.8374" x2="2348.8174" y1="5804.9238" y2="5804.9238"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="961.8374" y="5792.5264">[33n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="1001.1621" y="5784.8711">WithdrawalNonInitiatorNisoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1005.2754" y="5800.1816">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="486,5817.9238,1401,5817.9238,1411,5866.9238,1401,5916.9238,486,5916.9238,476,5866.9238,486,5817.9238" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="907.5625" x="488" y="5834.4922">Non-initiator Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1 from non-initiator Niso. Non-initiator Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="857.4541" x="492.1133" y="5849.8027">will search for the indices in duress_check_space assigning the resulting value to duress_signal. If the duress_signal is composed of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="865.5474" x="492.1133" y="5865.1133">same set of numbers as the duress_consent_set, duress_placeholder_plaintext will be assigned an empty padding otherwise it will be the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="888.5386" x="492.1133" y="5880.4238">doxing_key. duress_placeholder_plaintext will be encrypted to make up duress_placeholder. Non-initiator Boomlet then generates approvals</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="896.9175" x="492.1133" y="5895.7344">composed of peer_i_tx_approval_signed_by_peer_i [0 &lt;= i &lt;= 4] and wt_tx_approval, signs it with boomlet_1_identity_privkey and sends it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.3936" x="492.1133" y="5911.0449">non-initiator Niso.</text><polygon fill="#E6E6FA" points="329,5927.7871,1560,5927.7871,1570,5938.7871,1560,5950.7871,329,5950.7871,319,5938.7871,329,5927.7871" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1227.04" x="331" y="5944.3555">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1)</text><polygon fill="#FFC0CB" points="657,5961.0977,1232,5961.0977,1242,5980.0977,1232,5999.0977,657,5999.0977,647,5980.0977,657,5961.0977" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="659" y="5977.666">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="567.3472" x="663.1133" y="5992.9766">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="495,6009.7188,1393,6009.7188,1403,6035.7188,1393,6062.7188,495,6062.7188,485,6035.7188,495,6009.7188" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="501.7441" x="497" y="6026.2871">duress_signal := duress_check_space[duress_signal_index_with_nonce.content]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="817.083" x="501.1133" y="6041.5977">duress_placeholder_plaintext := Evaluate(duress_signal, duress_consent_set, doxing_key) [either padding of False or doxing_key]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.3159" x="501.1133" y="6056.9082">duress_placeholder := AES_encrypt(privkey: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: duress_placeholder_plaintext)</text><polygon fill="#E6E6FA" points="573,6080.6504,1314,6080.6504,1324,6122.6504,1314,6164.6504,573,6164.6504,563,6122.6504,573,6080.6504" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.7583" x="575" y="6097.2188">approvals: Collection&lt;tx_approval_signed&gt; := [peer_i_tx_approval_signed_by_peer_i[0 &lt;= i &lt;= 4], wt_tx_approval]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="363.3652" x="583.2266" y="6112.5293">approvals_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.4009" x="579.1133" y="6127.8398">signature: schnorr_sign(boomlet_1_identity_privkey, approvals)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.1143" x="579.1133" y="6143.1504">content: approvals</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="575" y="6158.4609">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="944.3374" cy="6206.0742" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,6202.8242,2351.8174,6206.8242,2341.8174,6210.8242,2345.8174,6206.8242" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="948.8374" x2="2347.8174" y1="6206.8242" y2="6206.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="951.8374" y="6194.4268">[34n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="991.1621" y="6186.7715">WithdrawalNonInitiatorBoomletNisoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.4707" x="995.2754" y="6202.082">approvals_signed_by_boomlet_1</text></g><polygon fill="#FFF0F5" points="2002,6219.8242,2703,6219.8242,2713,6230.8242,2703,6242.8242,2002,6242.8242,1992,6230.8242,2002,6219.8242" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.8613" x="2004" y="6236.3926">Non-initiator Niso receives approvals_signed_by_boomlet_1 from non-initiator Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Initiator_Peer" data-participant-2="WT"><polygon fill="#181818" points="3089.9678,6280.7559,3079.9678,6284.7559,3089.9678,6288.7559,3085.9678,6284.7559" style="stroke:#181818;stroke-width:1;"/><ellipse cx="4010.6221" cy="6284.0059" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3083.9678" x2="4006.1221" y1="6284.7559" y2="6284.7559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3095.9678" y="6272.3584">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.4556" x="3126.7549" y="6264.7031">WithdrawalNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.25" x="3130.8682" y="6280.0137">peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2353.3174" cy="6328.627" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3066.9678,6325.377,3076.9678,6329.377,3066.9678,6333.377,3070.9678,6329.377" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2357.8174" x2="3072.9678" y1="6329.377" y2="6329.377"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="2360.8174" y="6316.9795">[35n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2400.1421" y="6309.3242">WithdrawalNonInitiatorNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.4707" x="2404.2554" y="6324.6348">approvals_signed_by_boomlet_1</text></g><polygon fill="#FFF0F5" points="2579,6342.377,3578,6342.377,3588,6368.377,3578,6395.377,2579,6395.377,2569,6368.377,2579,6342.377" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="990.9961" x="2581" y="6358.9453">WT receives approvals_signed_by_boomlet_1 from non-initiator Niso. WT verifies boomlet_1_identity_pubkey's signature on approvals_signed_by_boomlet_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.7905" x="2585.1133" y="6374.2559">and checks the content to match peer_i_tx_approval_signed_by_peer_i [0 &lt;= i &lt;= 4] and wt_tx_approval. At the same time it receives</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="473.5542" x="2585.1133" y="6389.5664">approvals_received_by_peer_i [2 &lt;= i &lt;= 4] and repeats the same process.</text><polygon fill="#FFC0CB" points="2752,6406.3086,3404,6406.3086,3414,6417.3086,3404,6429.3086,2752,6429.3086,2742,6417.3086,2752,6406.3086" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="648.6289" x="2754" y="6422.877">Assert schnorr_verify(boomlet_1_identity_pubkey, approvals_signed_by_boomlet_1.signature) == True</text><polygon fill="#FFC0CB" points="2696,6439.6191,3460,6439.6191,3470,6450.6191,3460,6462.6191,2696,6462.6191,2686,6450.6191,2696,6439.6191" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="760.6333" x="2698" y="6456.1875">Assert approvals_signed_by_boomlet_1.content == [peer_i_tx_approval_signed_by_peer_i[0 &lt;= i &lt;= 4], wt_tx_approval]</text><g class="message" data-participant-1="Non_Initiator_Peers" data-participant-2="WT"><polygon fill="#181818" points="3089.9678,6500.5508,3079.9678,6504.5508,3089.9678,6508.5508,3085.9678,6504.5508" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3876.3242" cy="6503.8008" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3083.9678" x2="3871.8242" y1="6504.5508" y2="6504.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3247" x="3095.9678" y="6492.1533">[35n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3135.2925" y="6484.498">WithdrawalNonInitiatorNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.564" x="3139.4058" y="6499.8086">approvals_signed_by_boomlet_i [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="3078.4678" cy="6548.4219" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3864.8242,6545.1719,3874.8242,6549.1719,3864.8242,6553.1719,3868.8242,6549.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="3870.8242" y1="6549.1719" y2="6549.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="6536.7744">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3116.7549" y="6529.1191">WithdrawalWtNonInitiatorNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.7461" x="3120.8682" y="6544.4297">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2364.8174,6589.793,2354.8174,6593.793,2364.8174,6597.793,2360.8174,6593.793" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3078.4678" cy="6593.043" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2358.8174" x2="3073.9678" y1="6593.793" y2="6593.793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2370.8174" y="6581.3955">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2401.6045" y="6573.7402">WithdrawalWtNonInitiatorNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.7461" x="2405.7178" y="6589.0508">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text></g><polygon fill="#FFF0F5" points="1883,6606.793,2824,6606.793,2834,6648.793,2824,6690.793,1883,6690.793,1873,6648.793,1883,6606.793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="933.0991" x="1885" y="6623.3613">Non-initiator Niso receives peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt from WT. Non-initiator Niso updates niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="838.519" x="1889.1133" y="6638.6719">with the most_work_bitcoin_block_height, verifies wt_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="924.1235" x="1889.1133" y="6653.9824">boomlet_0_identity_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0, magic to match "commit", tx_id to be the expected value and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="702.1904" x="1889.1133" y="6669.293">event_block_height to be fresh according to most_work_bitcoin_block_height. Non-initiator Niso then forwards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="752.4448" x="1889.1133" y="6684.6035">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt alongside niso_1_event_block_height to Non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2152,6701.3457,2553,6701.3457,2563,6712.3457,2553,6724.3457,2152,6724.3457,2142,6712.3457,2152,6701.3457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.8521" x="2154" y="6717.9141">niso_1_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="2007,6734.6563,2699,6734.6563,2709,6745.6563,2699,6757.6563,2007,6757.6563,1997,6745.6563,2007,6734.6563" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.8857" x="2009" y="6751.2246">Assert schnorr_verify(wt_pubkey, peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="2009,6767.9668,2697,6767.9668,2707,6778.9668,2697,6790.9668,2009,6790.9668,1999,6778.9668,2009,6767.9668" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.6899" x="2011" y="6784.5352">peer_0_tx_commit_signed_by_boomlet_0 := peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.content</text><polygon fill="#FFC0CB" points="2000,6801.2773,2707,6801.2773,2717,6812.2773,2707,6824.2773,2000,6824.2773,1990,6812.2773,2000,6801.2773" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.5679" x="2002" y="6817.8457">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_commit_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2126,6834.5879,2580,6834.5879,2590,6845.5879,2580,6857.5879,2126,6857.5879,2116,6845.5879,2126,6834.5879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="450.0234" x="2128" y="6851.1563">peer_0_tx_commit := peer_0_tx_commit_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2207,6867.8984,2498,6867.8984,2508,6878.8984,2498,6890.8984,2207,6890.8984,2197,6878.8984,2207,6867.8984" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.936" x="2209" y="6884.4668">Assert peer_0_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="2224,6901.209,2483,6901.209,2493,6912.209,2483,6924.209,2224,6924.209,2214,6912.209,2224,6901.209" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.3979" x="2226" y="6917.7773">Assert peer_0_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="1625,6934.5195,3081,6934.5195,3091,6960.5195,3081,6987.5195,1625,6987.5195,1615,6960.5195,1625,6934.5195" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="1627" y="6951.0879">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1444.5615" x="1631.1133" y="6966.3984">Assert peer_0_tx_commit.event_block_height &gt;= (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_INITIATOR_PEER_TX_COMMITMENT_BY_NON_INITIATOR_PEERS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="483.3677" x="1631.1133" y="6981.709">Assert peer_0_tx_commit.event_block_height &lt;= niso_1_event_block_height</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="955.8374,7041.3828,945.8374,7045.3828,955.8374,7049.3828,951.8374,7045.3828" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2353.3174" cy="7044.6328" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="949.8374" x2="2348.8174" y1="7045.3828" y2="7045.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="961.8374" y="7025.3301">[39]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="992.6245" y="7010.0195">WithdrawalNonInitiatorNisoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.7461" x="996.7378" y="7025.3301">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0889" x="996.7378" y="7040.6406">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="489,7058.3828,1400,7058.3828,1410,7107.3828,1400,7157.3828,489,7157.3828,479,7107.3828,489,7058.3828" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="889.6938" x="491" y="7074.9512">Non-initiator Boomlet receives {peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt, niso_1_event_block_height} from non-initiator Niso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.6821" x="495.1133" y="7090.2617">Non-initiator Boomlet verifies wt_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt, boomlet_0_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.9868" x="495.1133" y="7105.5723">signature on peer_0_tx_commit_signed_by_boomlet_0, magic to match "commit", tx_id to be the expected value and event_block_height to be</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.4912" x="495.1133" y="7120.8828">fresh according to niso_1_event_block_height. Non-initiator Boomlet then generates peer_1_tx_commit composed of {"commit", tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="817.4639" x="495.1133" y="7136.1934">event_block_height}, signs it with boomlet_1_identity_privkey, pads it with duress_placeholder, signs it again and encrypts it with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="881.0166" x="495.1133" y="7151.5039">wt_pubkey. It then sends peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt to Niso.</text><polygon fill="#FFC0CB" points="598,7168.2461,1290,7168.2461,1300,7179.2461,1290,7191.2461,598,7191.2461,588,7179.2461,598,7168.2461" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.8857" x="600" y="7184.8145">Assert schnorr_verify(wt_pubkey, peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="600,7201.5566,1288,7201.5566,1298,7212.5566,1288,7224.5566,600,7224.5566,590,7212.5566,600,7201.5566" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.6899" x="602" y="7218.125">peer_0_tx_commit_signed_by_boomlet_0 := peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.content</text><polygon fill="#FFC0CB" points="591,7234.8672,1298,7234.8672,1308,7245.8672,1298,7257.8672,591,7257.8672,581,7245.8672,591,7234.8672" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.5679" x="593" y="7251.4355">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_commit_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="717,7268.1777,1171,7268.1777,1181,7279.1777,1171,7291.1777,717,7291.1777,707,7279.1777,717,7268.1777" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="450.0234" x="719" y="7284.7461">peer_0_tx_commit := peer_0_tx_commit_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="798,7301.4883,1089,7301.4883,1099,7312.4883,1089,7324.4883,798,7324.4883,788,7312.4883,798,7301.4883" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.936" x="800" y="7318.0566">Assert peer_0_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="815,7334.7988,1074,7334.7988,1084,7345.7988,1074,7357.7988,815,7357.7988,805,7345.7988,815,7334.7988" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.3979" x="817" y="7351.3672">Assert peer_0_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="216,7368.1094,1672,7368.1094,1682,7394.1094,1672,7421.1094,216,7421.1094,206,7394.1094,216,7368.1094" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="218" y="7384.6777">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1444.5615" x="222.1133" y="7399.9883">Assert peer_0_tx_commit.event_block_height &gt;= (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_INITIATOR_PEER_TX_COMMITMENT_BY_NON_INITIATOR_PEERS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="483.3677" x="222.1133" y="7415.2988">Assert peer_0_tx_commit.event_block_height &lt;= niso_1_event_block_height</text><polygon fill="#E6E6FA" points="185,7432.041,1703,7432.041,1713,7566.041,1703,7700.041,185,7700.041,175,7566.041,185,7432.041" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5474" x="187" y="7448.6094">_peer_1_tx_commit := TxCommit{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.4277" x="191.1133" y="7463.9199">magic: "commit",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8896" x="191.1133" y="7479.2305">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.7461" x="191.1133" y="7494.541">event_block_height: niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="187" y="7509.8516">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.8042" x="191.1133" y="7525.1621">_peer_1_tx_commit_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460.8398" x="191.1133" y="7540.4727">signature: schnorr_sign(boomlet_1_identity_privkey, _peer_1_tx_commit)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5532" x="191.1133" y="7555.7832">content: _peer_1_tx_commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="187" y="7571.0938">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="772.8335" x="191.1133" y="7586.4043">_peer_1_tx_commit_signed_by_boomlet_1_padded := PaddedMessage{content: _peer_1_tx_commit_signed_by_boomlet_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0254" x="191.1133" y="7601.7148">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="187" y="7617.0254">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.7847" x="191.1133" y="7632.3359">_peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.9336" x="191.1133" y="7647.6465">signature: schnorr_sign(boomlet_1_identity_privkey, _peer_1_tx_commit_signed_by_boomlet_1_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.5337" x="191.1133" y="7662.957">content: _peer_1_tx_commit_signed_by_boomlet_1_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="187" y="7678.2676">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1510.6025" x="191.1133" y="7693.5781">_peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt := AES_encrypt(privkey: ECDH(boomlet_1_identity_privkey, wt_pubkey), content: _peer_1_tx_commit_signed_by_boomlet_1_padded)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="944.3374" cy="7741.1914" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2341.8174,7737.9414,2351.8174,7741.9414,2341.8174,7745.9414,2345.8174,7741.9414" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="948.8374" x2="2347.8174" y1="7741.9414" y2="7741.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="951.8374" y="7729.5439">[40]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="306.4775" x="982.6245" y="7721.8887">WithdrawalNonInitiatorBoomletNisoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.25" x="986.7378" y="7737.1992">peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="1771,7754.9414,2934,7754.9414,2944,7765.9414,2934,7777.9414,1771,7777.9414,1761,7765.9414,1771,7754.9414" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1159.6406" x="1773" y="7771.5098">Non-initiator Niso receives peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Non_Initiator_Peers" data-participant-2="WT"><polygon fill="#181818" points="3089.9678,7815.873,3079.9678,7819.873,3089.9678,7823.873,3085.9678,7819.873" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3876.3242" cy="7819.123" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3083.9678" x2="3871.8242" y1="7819.873" y2="7819.873"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3095.9678" y="7807.4756">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3126.7549" y="7799.8203">WithdrawalNonInitiatorNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="738.9561" x="3130.8682" y="7815.1309">peer_i_tx_commit_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2353.3174" cy="7863.7441" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3066.9678,7860.4941,3076.9678,7864.4941,3066.9678,7868.4941,3070.9678,7864.4941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2357.8174" x2="3072.9678" y1="7864.4941" y2="7864.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2360.8174" y="7852.0967">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2391.6045" y="7844.4414">WithdrawalNonInitiatorNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.25" x="2395.7178" y="7859.752">peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="2589,7877.4941,3568,7877.4941,3578,7903.4941,3568,7930.4941,2589,7930.4941,2579,7903.4941,2589,7877.4941" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="971.1914" x="2591" y="7894.0625">WT receives peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Niso, decrypts it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830.7939" x="2595.1133" y="7909.373">with wt_privkey, verifies boomlet_1_identity_pubkey's signature. It then derives duress_placeholder by separating the padding from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="832.0635" x="2595.1133" y="7924.6836">peer_1_tx_commit_signed_by_boomlet_1_padded and sends it to SAR. It also saves peer_1_tx_commit_signed_by_boomlet for later.</text><polygon fill="#E6E6FA" points="2256,7941.4258,3901,7941.4258,3911,7952.4258,3901,7964.4258,2256,7964.4258,2246,7952.4258,2256,7941.4258" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1641.0469" x="2258" y="7957.9941">peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1 := AES_decrypt(privkey: ECDH(boomlet_1_identity_pubkey, wt_privkey), content: peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt)</text><polygon fill="#FFC0CB" points="2626,7974.7363,3530,7974.7363,3540,7985.7363,3530,7997.7363,2626,7997.7363,2616,7985.7363,2626,7974.7363" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="900.5483" x="2628" y="7991.3047">Assert schnorr_verify(boomlet_1_identity_pubkey, peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1.signature) == True</text><polygon fill="#E6E6FA" points="2652,8008.0469,3504,8008.0469,3514,8034.0469,3504,8061.0469,2652,8061.0469,2642,8034.0469,2652,8008.0469" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="843.9844" x="2654" y="8024.6152">peer_1_tx_commit_signed_by_boomlet_1_padded := peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="513.646" x="2658.1133" y="8039.9258">duress_placeholder := peer_1_tx_commit_signed_by_boomlet_1_padded.padding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="647.0039" x="2658.1133" y="8055.2363">peer_1_tx_commit_signed_by_boomlet_1 := peer_1_tx_commit_signed_by_boomlet_1_padded.content</text><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="3078.4678" cy="8118.1602" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="4084.4233,8114.9102,4094.4233,8118.9102,4084.4233,8122.9102,4088.4233,8118.9102" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="4090.4233" y1="8118.9102" y2="8118.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="8098.8574">[42]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="474.3286" x="3116.7549" y="8083.5469">WithdrawalNonInitiatorWtSarsMessage1[=WithdrawalWtSarsMessage1]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="3120.8682" y="8098.8574">duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="3120.8682" y="8114.168">boomlet_1_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3643,8131.9102,4549,8131.9102,4559,8196.9102,4549,8261.9102,3643,8261.9102,3633,8196.9102,3643,8131.9102" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.2378" x="3645" y="8148.4785">SAR receives {duress_placeholder, boomlet_1_identity_pubkey} from WT. It decrypts duress_placeholder using boomlet_1_identity_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="834.9897" x="3649.1133" y="8163.7891">sar_privkey to get duress_placeholder_plaintext. It checks to see if it's a padding of False or a duress signal, if it was a duress signal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="824.8652" x="3649.1133" y="8179.0996">and the pair of the received boomlet_1_identity_pubkey and AES iv of duress_placeholder was not previously received, It calculates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="826.0332" x="3649.1133" y="8194.4102">doxing_data_identifier by hashing duress_placeholder, uses it to find which doxing_data is associated with this user and then uses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.4639" x="3649.1133" y="8209.7207">duress_placeholder which is equal to doxing_key to decrypt the associated static_doxing_data_encrypted_by_doxing_key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="819.9648" x="3649.1133" y="8225.0313">dynamic_doxing_data_encrypted_by_doxing_key. It then uses this doxing_data to enter SEARCH AND RESCUE. Regardless of if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="717.9263" x="3649.1133" y="8240.3418">duress_placeholder is a false signal or not SAR signs duress_placeholder with the doxing_key and encrypts it with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="820.5742" x="3649.1133" y="8255.6523">boomlet_1_identity_pubkey. It then responds to WT with the duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1.</text><polygon fill="#E6E6FA" points="3678,8272.3945,4512,8272.3945,4522,8283.3945,4512,8295.3945,3678,8295.3945,3668,8283.3945,3678,8272.3945" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830.8765" x="3680" y="8288.9629">duress_placeholder_plaintext := AES_Decrypt(privkey: ECDH(sar_privkey, boomlet_1_identity_pubkey), content: duress_placeholder)</text><path d="M3684,8307.7051 L3751.1851,8307.7051 L3751.1851,8315.0156 L3741.1851,8325.0156 L3684,8325.0156 L3684,8307.7051" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="145.1738" style="stroke:#000000;stroke-width:1.5;" width="926.2842" x="3684" y="8307.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.1851" x="3699" y="8321.2734">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="839.0991" x="3766.1851" y="8320.3398">[SEARCH AND RESCUE [duress_placeholder_plaintext != padding(False) and (boomlet_identity_pubkey, duress_placeholder.iv) not previously saved]]</text><polygon fill="#FFC0CB" points="3865,8330.0156,4326,8330.0156,4336,8341.0156,4326,8353.0156,3865,8353.0156,3855,8341.0156,3865,8330.0156" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.2661" x="3867" y="8346.584">Assert SHA256(duress_placeholder_plaintext) == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3704,8363.3262,4487,8363.3262,4497,8405.3262,4487,8447.3262,3704,8447.3262,3694,8405.3262,3704,8363.3262" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.4048" x="3706" y="8379.8945">doxing_key := duress_placeholder_plaintext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.9932" x="3710.1133" y="8395.2051">static_doxing_data := AES_decrypt(private_key: doxing_key, content: static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="767.6475" x="3714.2266" y="8410.5156">dynamic_doxing_data := AES_decrypt(private_key: doxing_key, content: dynamic_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="558.4668" x="3710.1133" y="8425.8262">save(boomlet_1_identity_pubkey, duress_placeholder.iv) (nonce of encryption algorithm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.6416" x="3710.1133" y="8441.1367">Enter SEARCH_AND_RESCUE_MODE</text><polygon fill="#E6E6FA" points="3506,8464.8789,4686,8464.8789,4696,8506.8789,4686,8548.8789,3506,8548.8789,3496,8506.8789,3506,8464.8789" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.6191" x="3508" y="8481.4473">duress_placeholder_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.6299" x="3512.1133" y="8496.7578">signature: schnorr_sign(sar_privkey, duress_placeholder)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.1152" x="3512.1133" y="8512.0684">content: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="3508" y="8527.3789">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1172.0947" x="3512.1133" y="8542.6895">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1 := AES_encrypt(privkey: ECDH(sar_privkey, boomlet_1_identity_pubkey), content: duress_placeholder_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="3089.9678,8587.0527,3079.9678,8591.0527,3089.9678,8595.0527,3085.9678,8591.0527" style="stroke:#181818;stroke-width:1;"/><ellipse cx="4095.9233" cy="8590.3027" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3083.9678" x2="4091.4233" y1="8591.0527" y2="8591.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3095.9678" y="8578.6553">[43]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="267.4395" x="3126.7549" y="8571">WithdrawalNonInitiatorSarsWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="3130.8682" y="8586.3105">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="2575,8604.0527,3582,8604.0527,3592,8646.0527,3582,8688.0527,2575,8688.0527,2565,8646.0527,2575,8604.0527" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="999.5464" x="2577" y="8620.6211">WT receives duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1 from SAR and continue processing peer_1_tx_commit_signed_by_boomlet_1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="958.7437" x="2581.1133" y="8635.9316">It verifies boomlet_1_identity_pubkey's signature on peer_1_tx_commit_signed_by_boomlet_1, checks the magic to match "commit", tx_id to be the one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="917.5474" x="2581.1133" y="8651.2422">expected and for the event_block_height to be fresh. WT then signs peer_1_tx_commit_signed_by_boomlet_1 with wt_privkey. WT then sends the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="751.5498" x="2581.1133" y="8666.5527">collection of peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt [0 &lt;= i &lt;= 4] to Each Niso alongside it's respective</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.4819" x="2581.1133" y="8681.8633">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i.</text><polygon fill="#FFC0CB" points="2725,8698.6055,3432,8698.6055,3442,8709.6055,3432,8721.6055,2725,8721.6055,2715,8709.6055,2725,8698.6055" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.5679" x="2727" y="8715.1738">Assert schnorr_verify(boomlet_1_identity_pubkey, peer_1_tx_commit_signed_by_boomlet_1.signature) == True</text><polygon fill="#E6E6FA" points="2851,8731.916,3305,8731.916,3315,8742.916,3305,8754.916,2851,8754.916,2841,8742.916,2851,8731.916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="450.0234" x="2853" y="8748.4844">peer_1_tx_commit := peer_1_tx_commit_signed_by_boomlet_1.content</text><polygon fill="#FFC0CB" points="2932,8765.2266,3223,8765.2266,3233,8776.2266,3223,8788.2266,2932,8788.2266,2922,8776.2266,2932,8765.2266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.936" x="2934" y="8781.7949">Assert peer_1_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="2949,8798.5371,3208,8798.5371,3218,8809.5371,3208,8821.5371,2949,8821.5371,2939,8809.5371,2949,8798.5371" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.3979" x="2951" y="8815.1055">Assert peer_1_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="2230,8831.8477,3926,8831.8477,3936,8857.8477,3926,8884.8477,2230,8884.8477,2220,8857.8477,2230,8831.8477" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.2397" x="2232" y="8848.416">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1683.8936" x="2236.1133" y="8863.7266">Assert peer_1_tx_commit.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_COMMITMENT_BY_WT_HAVING_SAR_RESPONSE_BACK_TO_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520.3682" x="2236.1133" y="8879.0371">Assert peer_1_tx_commit.event_block_height &lt;= most_work_bitcoin_block_height</text><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="3078.4678" cy="8941.9609" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3864.8242,8938.7109,3874.8242,8942.7109,3864.8242,8946.7109,3868.8242,8942.7109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="3870.8242" y1="8942.7109" y2="8942.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="8922.6582">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="3116.7549" y="8907.3477">WithdrawalWtNonInitiatorNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.1152" x="3120.8682" y="8922.6582">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="517.9243" x="3120.8682" y="8937.9688">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2364.8174,8998.6426,2354.8174,9002.6426,2364.8174,9006.6426,2360.8174,9002.6426" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3078.4678" cy="9001.8926" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2358.8174" x2="3073.9678" y1="9002.6426" y2="9002.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2370.8174" y="8982.5898">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.9819" x="2401.6045" y="8967.2793">WithdrawalWtNonInitiatorNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.1152" x="2405.7178" y="8982.5898">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="2405.7178" y="8997.9004">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1</text></g><g class="message" data-participant-1="WT" data-participant-2="Initiator_Peer"><ellipse cx="3078.4678" cy="9061.8242" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3999.1221,9058.5742,4009.1221,9062.5742,3999.1221,9066.5742,4003.1221,9062.5742" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3082.9678" x2="4005.1221" y1="9062.5742" y2="9062.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3085.9678" y="9042.5215">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="477.4136" x="3116.7549" y="9027.2109">WithdrawalWtNisoMessage2[=WithdrawalWtNonInitiatorNisoMessage4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.1152" x="3120.8682" y="9042.5215">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.8311" x="3120.8682" y="9057.832">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><path d="M819,9075.5742 L819,9100.5742 L4114,9100.5742 L4114,9085.5742 L4104,9075.5742 L819,9075.5742" fill="#00FFFF" style="stroke:#181818;stroke-width:0.5;"/><path d="M4104,9075.5742 L4104,9085.5742 L4114,9085.5742 L4104,9075.5742" fill="#00FFFF" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="597.3208" x="2163.3484" y="9093.1426">From this this point on, non-initiator follows the same steps as initiator. (Withdrawal Diagram)</text><!--SRC=[xLrjSziualwkNu5DFemrewWisSucsNZg5CUpySx4JbcQyMqbAHOjqJOh4gKLgTYkJFxxTGCW2P0021AKaxkRggtPM8A0HWFeVj3eb_XJ6AtyjRyWSV2VJH1DWxT17FlNmMWUNaTa7bmbdIHCvW4vNKPFJg8m2VrakIONON8pM_kt_foC-G_9wz2_nfvsyClb9Y7Zn4-2MRTpkRmZZtwFWpKPXxFW4NaCdK-3L_DDqF6ds1lzxl5luVLDSdJlHnsWA0cduSgF4d8IB_bNz0VYLw-MoyKyIFZNxyBea_JrU48U_n4keONqyMcOzVZFTH14dI2Q4I1HQdGn8Slr3AXw_fmyFWzcR0xlWc0T0_qNDs4YamBSyJBkUBGTxs2mkolFHsebD5AHCHwTv_qCoUD_1_FvyfPqVY1HS3iFeo0cVaAco_bc4SLaC7psqzxkuU3WMOyC3vxYluVFdlR8thDz_FV-OBz73WP3_FV1_h3J-VFFFpkTQ9a4PFavOAlGeqDsNbx-_6vqFdfxF3a-7vFEurbm1OEHoTbln-UZqwDZx-JKU_NRsT6lO- -NyxEttkI_lT6xT-TdVun-yrxz6xuzcPoC9cVdthlZutDlSbPi0EojtUd513iwFpuwFldZvFIVz6-vnUdPQM7eSUrHodt8eoh6Q6DoocxrunP-VJPv0tGg-d3dydSvRjE5FZfx-_PaylRuTABUfVdmnU-Alsqyvwfkh7QRt0cmxis8DeUp2pyUlpix7HzxhqP7ls9li1q95IvuqZiTVvCieytYaeeKyWXE-llTtO-FEY1JnacmWWyxHH7rv6UGXoy8WRQvt4SnUf5mRJ4W7oAoWiRUhfVSUVvgjLv-zkTU34eac7cNzzubazNmFUYAzVqgANvy1SFT9hIV-38HMe5qcmVJ95n6ByXHzk-NXLQbljA_mf_9-rtoyf24-9_zZwB4mrdz-EF5vCSVFqJBLR3siUUOn3VBsuY4-BzKtysORkldR1fqK4S0QnIYlyYhYmGQPMsGSoBVRXCDppWxhDYgO9oU9UJzKEI8k2K6gYsHpnL8_yudD-ZSv0lCTRt_6VP_i0O04Ty0-GXbygMbRTR1D0W_WphzOY2uPqbkpvxOhpYrg_Lo0Nknho8CPX5UXK0OqBNQN7uAxd-03GfZ-ibc3RCqShX7G1xD04406Bkz2QStT08aZ4bo4mYx-_AUp9TBW8BN22U08kbhBvn1Fy5yHfPNXT40wmK0Fw8uH8Z2k4FyGlVTFZb9yeaaDp06DiXP0h-E06NUynaIw0mMOvRnfZ1eS1V6IOm75Bk90G42ONJmS1OBygA7uqAJA1zSEsQHgtOhtKSI5QislGccduIfBlphS8e4bxibFeZcmWGNVW9hzOZz7SmUzMWdq09M0ZgvN2Ot96qSfyi9bCJ-8b1jKcnojGvY-DLq2d0I5pfP5aTL4AB-tM8P9zxjSlt9kmoJwJAClClvSlh9kmaGL5EUf8mN6M7-6Rc1VRFounZMVH7EWnXaKi1RxB9jW6m78HrTUxCWdgx35V8RgOOZTUklPumF_2X3BqmC8Jd-V1bTuoOb4IoFD_02a0Y9F3vCJ5v9VhtebmKANZL0Zeo0s7L2uYaqMAyzkidkTxA3sZCTpNwssxhay91CrfkWhvTSCDWwk8Of6hk4WvZ0jFhIoVKDcru_jIDSDxPi-cEQdyDyPUXbCkuhJcDTFch7jHN3jLciE3Wl3cq7uymlwppimsBLy8VwpGbzL1oVAkwMfz5dKWbOaqkQoaMIPzAe2mKbJBGT5Xd5FzTs23Za5nHFS0-EcQX1BgefLJ3rPs2gVxUZeAVSk4TszAlpPBkNs6wtrhG0r2t2QCTkNkIdDc_rtPv-3tUhzaN51eVLAeaPbKRebxM7-TZduf9BBVMfJsLQ3ek77TeN0cEkAqgNf08ovis-BK0sIXgHKxbzpGYWqsRV2aFtZ1Fwoh136QJrDTDmHDo8MHk0Rbl4NHjB0pqfd7R1qlsjOscAqm3CpGAwv76D3Rs9aOlPtm8zC75aWazjgqLoTJk0WrPw3tf008_eFRqyWVIIbmsPqLCB12jqtxE3zdeTXxFKVmk42VXz1pgV- -jhsFR0mQXR1lGwrjCT5WTuVd36bAJooLKAgUs0SgCyV0XONfpVjf6v7J-t0SwhMFtDuJdTaT1yT3psk9JQuHBc1Ja-UlrcHo-2UlhL0j341tbXB_Ew5clM0F9hUgg9-dNqmEJwJAfvL1RkqBNNtWUKqivyLp1HORmjs85bmA0xrG3yIQkGkZQH7FzhXNMl-WxHRSp7lsvTt_6jItCkzInskdDbzwIzJZgmxWr1l2VnjiM711GURgPzAhuLbu58QVMhCklItW3dn7uInbUXVpaFE7nbg2qJOHGBfbWz1TUx9KnFaG_S6LOR3dsPqPBS0fFocm50QwR0iVCIEC8N_4hpoyqzy3m9F1nZ1__J9Nyx9AUR-RpIS5DFVkSRO3-_A2E9LRVaCyg5RDNn_qjtT95MxZvYt0gqJNv3PN2wr2k_B4QLbqNQ7LsoC0Azl8WLly753XDOCVzw7GIB57tWUhBRW7143ZgqHvlpWT-VH2c3g2f-GHxTPcqzeCGhp2nLqnuCx0bDaGsF71_CMg10oNQwcLL3i_Sf7UUpcyIIm8ZJ89W9R7xgQB4PQbZEffWkCvqVdPcNFaOyQiMkqcXawpqjtS4oiq7C9Pbm2_LdCyhrQO1S3jdTa8FM6F-cUpoMOJ2xsMIIZjtnQDUCQDgV6leEAFIDsSka-a9ulLvkLcGyyQY8tg7zTgik56nYU8TG23OSgq0TDkKR0JVCANxs1Hjcy9t-WjcZyCiN1FGaTlP-y-mVP6_u4RxvgkgvOjxypi4RqJi7Id2xUuTg7SGhHv6MBidFozyTDVUm_cJTf55DnYfEHZfXwLqnL5WYnXD1i3pB1SjuKYLJnf81k3bxqC7Hp1neqI9hL483HiWCTlKtDZ3r6YLEyQ0XyrCiXBeolOHJZKh2Vj3dXxSQ0ebC4izySKpnegyw-FKk_TmM4gkEfEdmcVdLpJVSyyvuOWMenea0fqftvFhGIT06fVEW-c6AcPSWybCJQ0w9cQKJ_c-r3Zw7oqqylyyVyEaWJ9OM3pnk4AhrS0laMaKD2P1JL-Gc591Olym46UjcLWQ5RiXMORYRmpRpiHyd3f3DnyidR9EKCLuOKnY51cFFP__6gnU_UdZ8DoFAgoSuldmRWdFNA1KkX1L7CrsS6zQ5KzGhen7j8QLRYQCHwZqIR-OsTcULN14FScv4P0fydDexpo8k_R-WnqxwwOlCmeeVxSHgNLxIrINm8Kej7TWGIPC53lmjlwnK8e_OREoiXJmamWGOCXoamguAWOnBPWE7oRUCH6fmtKgwqk4oXEAupeAj0K_1PZN3q0spjrHawIqbd1871vSSR0rTtzttNBcrzGTq1-9wbK_XAb1NScDCQSh0dGk_AjzdEGwiMXR58xJgTbDyVpRBPfJ_7AI4LwadPKcMvbw57BjaPmK1J8oGGiF1wo12p_A0M-u6qkFJTBbOBV79503A5-czEBz9QfUpnrKWwBWg3YiqOlOaAcZ0zCLbKF6UDZ3XrDjQpxPrT6YpXxVOHGsPTtQt_ijfhBmecBUzvLkfpVkCUQ3q3dHOlXzX24dL0dgA7GxBDhaRyR- -YFWtRVAebvquqO9Itl0lp0u85EnuTlktFY8pxJ35e18oK_65WpElbVFcP23A185uA2pf4kv2hgyyUsr97yTNeZRMevvTwKAm90s5jvABIakI8W2hHUPTAAw95vFjimfdrikHHwRUSAFoJVj1uOSsiF93gwItfudUI1M_gALJkSKTlh1nSBSAfeYTeViDisIbWGYmr9U1okkA3cBsVgKczhBO0zXGycYXACcVbpPrM37pKBrIeM6bMA0pqhOELe7FRO2fBniC4yveJ1rxYedZFkuVqVw_984FZ9DxfVwIFiaTb72Q_dnEbl1JzdNyW-0_5znDWrN1XV87HXPzEeI-uW1Vhs5Zfsl1nbSDKkfUk1iLN8VuqicKztL7A7LXib9EZSoD-G6HV8fQEARTugIilCC66k-mIc8g44ybLpF7iEgHE9lCyoltfVA1gjr7PcGisMM5drUxBGqiNMvsAcJCauUDak_QE2BLdklBQaE24Eywt1VYNJCL39ou91rLJeSdJTMog_3LHkmE3nGHkyE3D69Nde0YThTWBnCZhAtenl3gmvVXuSlzZnNX31brPFYqZU3fOLDw1pfMFbMnyYdkXaO1qEqGwEQTuJhyLsDqChCJnkPxMMOfcMFRf39yz1Ve7NfQtnFfbO67KKJQIDyI80mLW52yuMMOi98fTJ1XzZ09MAyC27kA4RbVWneRcZto5I6y8gLbd_yu2G7Zq74eJXH2PyEuuNwrZAvzM7inQHXk6cemIoKV59Z5zYId62PKOfZgaLEpZSjmAa3Zrg6CRghwiaOxeINQgSGMBJaNRobrJxShSmpPaFB1aX7LZk0Mpkm_FN3geEAyjnZyknNVyhg9YxeI0lbxYa0Y4OByFN9yyTfl9jbB6t2xhrwkMANkqnS-Uj7Nhz5LGbrSek0MjQxXm5nbsCI0HfG6YPx67lWNQcc0MgW9ANzOcm5RufZvVdhnogU-3ppu5hr-8kAlr_uzMdWEO4MIu1hlSfT1SXj0FmDAmE3vC-xPwXjzMwafiaycI85wHREdj39PjJpZMWbyV5XOemtRQnNP86_PpSEmp-Yj8tkrfRkuJso3vXoGaNstjlYeVXpRNn3f_pf4Qcct_6-2ISp5NvIfLP97eHP0yhocdz8mwZ5-zeL-mrtrtm_wVT04_pZusFrQASALyG3YkwzQBsb20xwwgeojHWaO2HDUWPz5Zi_0-uviSBENkV2V8imseWc6pwD6uGJ35bbNpqNOcMrL3y2vWvZ3K83lOWGPzDbl4oNh- -m1SiaylzWrB4k7eZY_W77XizKoeaYNGU0mmKV2rOqFY3AS0hw1e_s9ULNTB6-vQOqXK6My0hrLt8GBvYIFbmY0gOoYXSddk58u5HyHgyM1RTo2mofqrQk8z1fxpLxgqcEojnlL3OBGd12tY0Z5N3GEl2TN6EeGOdn20jSFt47JPR2U0a25ps_nZiFNVv3jKDYAT8Uo9D-uHM0Aws0rXvsM1D8sNKReX-Z5NDw44OsVOQT7b2zxWwXct8B8DteVc7iXiEVEMMA8dTa6WOwv2y5q7OYtFx4hyHmmtn7krya-Oh6CYeWJumQKVIYlT97ZWZibOtrLw405_PL1XofMsi4CpP2kCG4j21ODPJdGs1j6ZO82XgxJRmLVD6EyKggeeCM7IFVOah5lpzMaUD0c8vkQ3DjcfoaichvaKWdjhq4Uu_bd1hvPE0qeP50e0WOuKW74WelmB-OS1aibpO1g246YiqzHOOX-uaAotpHXMufRUFQmiaBefP-jva3MpN8EFCP_ep7iBc4Jkqp9XM5yq3gBLN9FLlwC8XtgUdKRnW7p7sVDEIMpvHqqyMXyjzKmsRhGRCB-9mmuKVpI6A2UM_zoJoqg5ND66MrCx4ivDxp2E2dus6lZo8GaSwBSLqOkzYqlhGPjK1_LrRpaDJfEpLC6cKVjitaVLg53vgHUXxbgnFc-WXpEh8-2-5DlTkZz68yvBC-Er6TFVJwpGmJAEWYPfsDw-Ax8Bx2_OM9hePs619L-RdLxAAVRPJKcg96cQXMo0oiLT2WVqvznAkyjJh5qY8jUPHy9jGjcWsu_720RIWe24CNKrpouSM_VrM92DR5nUcwOnSov-gxkmdlddifvRU-WGGMIePmj3jJ08aoKzKVmKC5djKkJgEcE9CAZHixxmreBMEMLNtkv6EY1Bkfxr9l7uWbTiwUzF8y3LVi9JuthggBxP9JaJkT9kA0O9UE7nDii8bteVbZiFlLbp_fClTVRSe8siit2zraUrzoR4DBbBaejpu2g65hBHy9GmsRlcKgeF6l3vNJFMif8ZgyrYAlZNzgG6lVmg3h3jUW_QdRuwrbaxgvDFGtnQP3eMjzzZpjXP2Bm4MjRwOEHnhEedIlLRXXLhhQA9Q6NAp6jGFqLRxdQohVn1nKoHjVcG8K8DnGUqGyWvpgs9KGHtT9MwHKz2QxJjvsgxUoAVGaE7VpirUv17xbJqvjLxBJbv_UjLZlirfm8Q6czys2c1vyx6YMVDXDOM_TiRA1tMitYiHNDQ5ABIeV5hMf6hLgaMQJi7HGjZOvvC1gNMN8c3vboJJw3h_R6nHxQWlA6PKkCq9L_xOUHEYSd2z1Iv-8ipaWP9AgzF5ja174ltT2s8ZPN6NW0NTnYiON6wjY62IuQkR8uWOrIjkr4hvSRLWFu_wwQxJE-v3jbSdT4__r5IFQI2SGsKhqKCwVe1TRMyhom8NLPNZWlwb3AHIiI_8x-AwLLtxyoUmK28FPie3BO8qarAVe6R3LGq-qPMMxYBAu6QM7ozNFnj9E7fvet6P3UttLyKtWgvvFP0f_QojApZILidhvdVz26zNDFJXkWdMAedsBZV0BxgWhWEAq63njx3xgBxDCLFT2UARknfjPC8PDHpLUN7BMdwVaLGlxoFaruatgUf2_9QKhbEdApwDSm7ftdAOPYtuwrr5y64m1OviTfh9QsaZXd2njc2nbr6b7PDDME5P9nfKt8oQvsTAWnG3yz0vRRlsxtHVVa_M7wg0C79ZR9p8jaxA_ZD0lB-qFnwKVyHkVm8JnHbFQ7v7SAT9H597mgMAfKbWLjvq9oa1CXLQo2H7r-qZm5AVLfMnTpmfgSJkYmSeBvCAsvetIUyNbt9FN4eSt9hHyNlqeVhvdm3DUfurtcAcoU2qWX4dx67ocOWSEX1xZ20vacCfdwy-c69aiHlEjcVkBpeK1RK1b_uyStE4FLcctY89NNM8wM1yCAVT70s3XUJaEQwPa_ii676_GCvrEFM3_gRPV5rmR_sR1aQBbl4lsBxGVADc6aE06rDFN4QKc2KkY4xuhPVUGlx7wIgqTAE9sGE6cCzuWms7jyF3e_UaD6fw_9-V7uwFVZFZcdfJpdk0UmpaJcQAcOElAEND5TnRSBzGPFw65YXZWLmzA7pC8KLMOwxVRAPyZZK6A6GONUooT6IF8A9qpsuuCF94U-lbvav1vqMfStLB-lbUfNEDkM-U7BOtKxonKQ8D0Ey0ejlwLb9E-D5FxjC9KBErGeTEa2v57IHUMgS4eDFtUBfnT1qEnZcM-oIX-_6GqFdkwOlUZGpr5vuCshac-etAbHpG6KigKJQ7GhpJiNriR-55DpbEeCrn-qXY3eCdNoEJ119ytgxZ2NKn02l7FCwU3FhvThE68BslEn84Gys7qUsttUsxFNnyLCoJPdI3gW3Sf5Y6TBSMnKyI85gv36dxMEv32RFjeu_p8vWhrZhqEvN7q_HJmbf-Tpd7IT6wWhVodQGXL3tUg0JM6qoRpJ40dOu5NwJAXAbrOZVwx1_YYw-rc_vs4EVRG3fyzwtCh2tlgC_Yv2HbcgTgsGVU4ENifAo_I-d1hMoXmZlIhBVej0yp76yR7oHPc730MhgCbnfC-1-uOC-mzviNIxFTfUiUecQRLvKRBuVPlfMStlI4w9MQiUXAnIiygTN4oyDoFQ7AGDwhPtPwVZO-_LwEXNx4rHbNfG-SPKvPwLoVBzDZmrzHclB8_lpuNpwtum2vx6aj5rNsLqtM_a5VhzpNnGPwx5XBNwVBL3sLAYOyV7xuuVkvsE76_UunZnwDwFO9r_GJLFhwxqFoiuAmd19AUoUVaAviJI2t0tzHWuIMC0ipPzifEpYBmE_Ukrl-Xs_Wi4ycgpc7SwyQSmedMzGVNzPmDK1vnjepacIfW7Lqa7bC8yeAyn6N-9qEkO_p3jdWsvtC259y4BVxTpkRmZZsZ0-HYKp2Fo63gV1dX_w_ZJB9wUtUgG1HsW22uNuSg7UP_Gfw7qmYTzbJz8uzSeZwMlCSpwZt09BQIF-MCJ_kIVwo28QDmIa2WrmisuHcJy_3bvV1xCs1oe20BwBsx2H2P5-UX3EnZixihpAOIsP8rKP31GoviCoUD_1xZa82l__FDFzIRgm7bvDpeVlJsUW6GddSUpu2e4TDLYkVdwdHQJ_-3VbHb_Qe_IIb9oqiAmhIItSkVoTpbkquNUgiSCQK32m-0imi8gyQHtH2Kws1MLQFrmkO7iA6l8mLSH5KVxmNhZUQlytYJ5TnPQbVgICigBZzCT4NU_83_-U37vySSFqNA5hfZGSqpJxD127xbod35brE-q0IO75PdjxPcfO9UU4Vf7-e7qIDy49NwRAJb6edun4Dop9BTdJsnUWLOJlbJjLcqa61zcOgnppPzIM4hPk51JvlAUp9VBJsZUyPEqlavUUnUBCOV1dFeT5nAdxbpGY4kqCwmvTz8C4Tdlktt95fHbYjNwd7A_Wrd6cyAWmLqO9ra6BPwVGfUoNwxbs23EohJI2dzukchgfBYXgbjLjbfkon9pvwObYB6JosLo8yHwXx6OhqErIR69ma5TaIEtd1UtGSWNC_wn14e28ofkvpUmRrP-ZFxjYt0Un0cMRsOjTjasGBQ3G4QpV11Fr-4A-IrvIqdFfsaT9dncRJTSpDQPt70q5LOjSrpQcZuT6hla9go-T79zmwRNJutchcJBfZ-c-JdCLuRUzEA-uZJsjn4XPZoSTLciE3YIKxfnCC6Ff728e0-BLJD62BKGUrYUXYhfSEKY5UBYctIXe2GpWnQwPvzlCJy_fYXMqBErDCMDhgdTRgrfyOJ3TlEgaLdOujxUDGILTQlsHSK6XzKgYHcLHkYNjOVvsEVYaaijzQbFPLh7CO3m6y7YxKSWFYnohYXSpH33gNNgDKUSZKYr0TIsnTcr4VI7A0FHBWYwltK4dJh1PPvzzXkwikIx7yqKvEfs08UgzFRpWB2TcjNvbGdVgALbGsRqr0B12jFtx02zkPI6CNE6WDfteFEvlxuEy57TZxfb66yCVEKXeZ3ZrYfJD8RYLJ5fMmVZnVbj6u-t62LQ4vBRnub-8r1ETsHjh_-Y5zAkoGl9MkPrQmMiMgDqJKyriRwE7fXSdqarZyh27Rhssbk0KjgPRmWj1E5M5QYeXjrFMWNIjOciBZDINGbtkqK-_hfhVPkxbkPSwbdiTDDoZ0eTf2BNCNWJXRRY2g3EMLrbmgMzOOqmFmdZgz2_d0SSj3AibWckjEmP_LKAgNTBI9xYdIKj5y195Gh0Y_NbkIC9SsHKfAslkbBVtCymbuY7O-pWVxheddwwcSyhZJJrfBPmAQugb80DMQc4RAtn_qktSBUA2LyOT2xr-jKs9pVjZYvK684ENiIAtz0W3XeATBqEWaMADD8eYUGEZaDM1Q7gBE3tj1B2W0X93MwpjfvKgfZD9rN47Wpd2KrnyeyS7y9QeE2hRRq5EZHxTzBnExihB9atSZ3hkrfYXXf6iucbIyeoCrE8bZujF6h5Nj9evAzrSyfJbdx8OtcPh19kbxGWeQaS8TtFiJ5EY3irOzVsLNbOPHlLHO_LuHfFMDBi7Tflj-gYm2Q6TmE5w4fJWjIgUf5d3z4Kkk0n3JNdlTKYMaLQkiHL8m_hJz5DyjHaPxrC2egIM4tgO0tSc5Ala8qxGrG20aR8Z6xrDp4FdIqTAcHvYcp4TCnKKvAm7_Jpo8mAG5EeOPETx-AOucLTTSWRXUjNLf6fnwzkfsuTgNo7kG4XGTwNgqKfVYZ7EhDVvx2MsIWnO5bHsYZD_A00IhWjg5x3XS_rXbhL8wUk2Arebgh2Vfa9CbxDx0CAwT-fMOgg6G3pyR88MoBB_nt651IXWTVpsR_ngiGl3HvoouZPwWc9Bz-6uDo1IONoO9rPp5Hc2DSMkz9c9ymZtlFGALRbni9Eh98Xug4LNEgJ1Z6HQXrTqi4bK25AA1s844bpBPSLcusJjH25H1Z2YoOriWQEKsuPOTJWjPKafSE96QvTHXHi0xZtMKBpcTcJANhGnDVEDx4zLnvj_N7RWRYM4-rceCs5NvLlftarLECmYWVYs2BCroo7XOeUUOgCajpC_VmuEibE248Kh7gaknAhKknc3qDoabtnBJU_3MgNKqYHMyLXXVRBdYi5RITb4ZAyTLaansrGAQnINpPx58jTL8v3ZJ3rgsQil02OjxtbEwRDsubv8A6sIh5XCGb4HV9KyUbpSZVYVtqHiMxQfAKSggIOcjIqVxUMxpCTL9T8DUDBEPMgmtbpCl9KfUaqqTLrjVVijILpsag_wR0A3R9iDab2ETW6o-npJRRBe79AIQRAX8II7oAdr1ucUdkQs8bKoOiQEPLHtF5AaxK_3GFGLh2fhlkZo_uF4A7aMPBdhPHNAgoOULKsLSLAiHXWiPmO3zsXFcKmJ3YZqMjPSR5Y4X9UcLxkbVej-eNK9Fvypkgpqg_Z7mG_jk1k6gmAhem_n6bYDImJa6OA3RArOEEh1YbrBzn-2YuyVEbaokrIVrOfegra-6n-JBUGoDD4JDECAoK7hUgHQcPTCVaYrUwZpTmh5gulRXbOMez2xzeu1DMUwyjgKu4GOpeKytIeyXiyQQg7NQMjDYnsUA08Yoqc535a51beKuMOgCLuvSENuU5BbXl4uBdOIZ3oi2cH0ntNdhe64xT3afj7XElmNriiL4XpjoQLePY_GE_Gq_gUI6y1F3WXqaRDbk1TQ5k1gP8fTH2UkIXJJp4YzofG8pspdxiY75QajEn97oTOR9xdY3j9n33KC6wuNoqZLQFlkh2XTjFqBFU80e7OdkGKaOHAH58zScfmSHbE1K_SEfInIbLVrjWbjCGkbKYX9PVTBIMwwNPbZj5qiPmFbeoeTg-sS17_wO4JxHJdlSL0sgruRDTDyzELCCVVfUBHRWzK-yt4UMdNRVUHoXMWr7sfmZSg-bWrkagepqaKtAAgDPoIgmoG6228qgRGqnZo_e8g3Q1AeTGaJpP8-_3YbK_T4lBi-tv4_FNQlqSZpG71BD_NU3kx39BR0FePK086pvznPrBVw4vAhObzCa4Ar2kQlNoLoQhbeDPA3E73OXbj15ohS0PvowuRXdr6hnhP8olTnNrY6t_c08VikxK5HVL3mlx2HV_NSL5Bk-L_4pPYNlMYJAsIF0gr09BdDVsKHYIFyRClz1lk7Vz-qE-39lZ7mSVkrqeHhdJ1LzGHAEWbZJV-LrULiLN7V2DXpe-s-uvpTxECkJ2Tmie7zzyVjiYlUdwwphogUgtDFRSSXkfXEILCpunlT9ieMTzdhuMyIXMxPMKvH1Gd5T0ihn_4Iw9HF8WlUgiR7x1ZE0Ka0uVu4tDtkc69fX5kKgof312WzuURSC7yq_6w082KKRGmEVvMYY5jbHZdG067LUYgLr4emAFkDIyKLpFeG7Cit28G51FGED6UN65eGSXAbrq6k6scos0z1Vm9dz_Y5OOl-Y3Rbh3_wBQ4s-DcGVVO1wnRjPh3zae2QMyk8_GAz68kMSA8HgdmYfEJVjqm0P5Ph4IN5m9FxfnbWzYPRGJbcB_iJzU1UACJkn9tF7FfuAwLx2CM4gW8wp1kDTcDyKeNObsgy5dbgLz1VsNidegLTj11CwIh2tuB8aH3MRUP2_xGTSwjO8Pct5RA3nLS-13fdaeS3O87RNAlgS6lRHwQueZfuoCLmFuQn6rQEWa63QS1XG4AESz0H2fgMDGE_iMyix20epW3gW04WSth7e8-49soXLotQUQo58lmD5fbUTyp5woZ4xjCoQN5eKYmM2NtUOLFz7sw3UE0EMkpvcdnHg4qfDKmsRgmkbMVCAP3LIZE5D6Ts-voLoag_t966Ir4xCj2sP6oQL5mQDS6Q0dPraG9hmm4x5jUEGrolpvIgtb5QtISckVECO_QP_C-h49yp2Ey3dFLAF9z1JcSMReIDLAXpcCyvh0yErAVFVNv5CeglWz2vcgeAA-Rj_keBzcihn3OmlRGLDMaHHIeYQLg5R83AzKkA1_Jdt4gxorEiNI8YsvT7mcrwcM3Rj_tFXjAyhWNnTHNvwG4LFqQv-I6JipigkzMBhnBxXsurTKOoXdIj1McTlLLpoiARgYfbLzHQtZb3MkjLPNRU-sLOQ06kgZlicuUYsSk5OfHfeyjMJdADbHmduoItAix2HSKWsJya7YRXN8BtG-BtQVEubcVgNjuMrx6HhPPE1VBuvfx4-AZt4MbQUEhgc-rV0uCrLZsdgaSA1rSFFUifOZaNLf9KXsVpeOqk8SLrHckHPzDivDTpo87TMtgUsAXznefc_NTz-nBxYg2SPHHX7elY2htLiMIqDkH67fVVyLRhXRoRNmmXTp7jJbG8QCDXJFq0yXPUsq9KSI7j5KwH4-2w_Hjfsexks9Vvgh3LZteOrzgUf3kLbSURlhwlTLwVDsQ4m6DhFVTSxGbFcqcfhRkJjX0sxIQwM8h-j2a39LUWblLXrfbIBCgsNi5MjeAIzNHvMmNCkMQcF-lzZR17ffmyePb0uhGbN_jXv4wzoIBU5BddBIfxQw_25japN0lFT2s-ZLdoNy03TnYiO36IjY62Ivwk3Avleqgjkr4huqRPhF__wwGxREYv3jbSdT4__r5I8YI2SGsqg4Kiule1TRMSg6m8NMPK3Wlwb3AHIiI_8x-AwLLtxyowmC286RjLzdPaQIQ57q3jXgewVQCB3Tn5bU3j33v-lbgsibLKyqRrxU0ftBsbIrmfwrCDjjOk2OfRjnjcNjofBrsOg5-Oer3yFUbojHDNYJs7dJ7s2VoUQ3zKVOPJQsKGewVciybEIvF4yqhnFZbVPeA9dK9IPzuqzJ1TIHZqU5WF3hFa-_4lXrhgICB1jDRPevfh7Ysab9c2njc2xbc6b7PD0cD5LPnfKt8EAxsGAWnG3yz0vRRlsxtcIymVwA1OnAR9EL5ClRNSPgkvFsX-90ZVgFpln0U74gxGdBu13hAWX4-5InGAek1jdCXlSQ9a2PLGQ8-DsUUVfEwcAsB-L1DFY1qM3bzUfZMXr7wilYyEv8wnj3cvDQFYr-bRyrCP8Rhr0ykyz4rpmLa3ma_uuyKpC3XqDzQuVfBKu5C_VbqGzED2CvkCp_n-L2W8wXal_7Z6voXQiqsSP1AQIoJoYDBXRveb6aSBwSXpMtCdypWmmswPFEfHwmVzRRBWbM3_snOSh3SLOZ-nVO3PPimKfo0CffwuhGayIXqmdV5x3xo5tO_oPKY9PnEI9mqXbH463azFXwT7xqXezFNvFnuVFJxSP-SqnAJSzm3M3iXytjKJ1rvHwxehkBRXRfX9_GmCGERYc7fisHXYYhpctPxvJFaeHunGvb2x-KJ8oGuXHCckzN11v9VNLylCdA7Dgq76YhTrqgbAvnjoppevR6wdUKA3Gjult-55jtICfBtHWh_TfZAXHqg5Bfq0VAGuw9ALVY8Xf-xnTEBq6VsiSmtMP6Ftuo61qztp4vjw7QeFF3cLSatLEvZgEO0IjdI2JHwUUQT2sjZVugfcKbrXkiFMaCGT9aw-HoO09DcTNUO1oW80Tuv9aZmvzVBDHon1UtvM10Y7km-Z-q-x-tPw-DYbc2RCoGTq0Pb4SIpfJWsga2DWhL7urvQHtAOJHfjd7-P70p3GDvMtqKHHSavwnodMkUswSfLYh5GiL3VDs1E66qo5pBK_pROb3xwgTACrSWYQx0cYZvvrgzpc3KUhRhf8nstdh2NEwFFYf1NbIfRAnHVk6-NShCoRIydIBKok4XlnB9p8T1yZB5oh2HFvkL28IhgRnpfS-2-8SF-GruYtMwAjjUfkgbARTw7B7xVPf9IywkGKthIgkSTgmIbSYSN4-_DY3O7QOCQxTtPwVZOUpKw-XLxKzH87bI-65MvMBNXMQbF5MLvQ7ykd5hturXm0fQCgVkkNfpVttm7rJCiPcpL9smToXOG7HC-VdTSsErqvAZj7iT-H_T-1Alx2ofoUYMb_rd1QKW8fl-KZSLNC2SMcS-znUCaMD5GkwnDd-paB2AlG_zwxI-wdVy2aRlQBEQTphkv7oM_l_qDzNsCkcpG7-uE3_hxEsC_8V_QH6JuZ0psN-mzVp4y8FzyE_bfT-_5tYx1HjtE3WW54YytQq31ip1Erk7b1ddSxVpB_-oJyqs4Jl4loDagYFxr-jVq0q35dyFrCiBoSPr__V4sR_1q_yah4FpZO8si-UDjvtLmvMCziUDekcHlaBzFVddohFER7rrlO7LV0FJk7B60ynVavFn_0000]--></g></svg>