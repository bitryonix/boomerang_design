<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="10361px" preserveAspectRatio="none" style="width:4497px;height:10361px;background:#FFFFFF;" version="1.1" viewBox="0 0 4497 10361" width="4497px" zoomAndPan="magnify"><title>Non-Initiator Withdrawal Sequence Diagram (Without States)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="429.7984" x="2035.2947" y="29.9659">Non-Initiator Withdrawal Sequence Diagram (Without States)</text><rect fill="#F0F8FF" height="10309.3665" style="stroke:#181818;stroke-width:0.5;" width="1506.319" x="775" y="46.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="60.2941" x="1498.0125" y="59.9649">User Side</text><rect fill="#FFFFFF" height="10309.3665" style="stroke:#181818;stroke-width:0.5;" width="264.8752" x="3626.6645" y="46.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.893" x="3741.1556" y="59.9649">Peers</text><rect fill="none" height="1223.5948" style="stroke:#000000;stroke-width:1.5;" width="2388.8716" x="318" y="2598.6194"/><rect fill="none" height="1116.4768" style="stroke:#000000;stroke-width:1.5;" width="2455.5945" x="294" y="5712.4595"/><rect fill="#ADD8E6" height="161.9421" style="stroke:#000000;stroke-width:1.5;" width="888.7353" x="3526" y="9343.2439"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="793.3089" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="797" x2="797" y1="146.8419" y2="10273.3665"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="838.5789" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="841.6179" x2="841.6179" y1="146.8419" y2="10273.3665"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="900.3857" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="903.5398" x2="903.5398" y1="146.8419" y2="10273.3665"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="1616.2594" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1619.5244" x2="1619.5244" y1="146.8419" y2="10273.3665"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="2251.605" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2254.8911" x2="2254.8911" y1="146.8419" y2="10273.3665"/></g><g><title>WT</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="2946.5315" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2950.1296" x2="2950.1296" y1="146.8419" y2="10273.3665"/></g><g><title>Non_Initiator_Peers</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="3698.5543" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3701.6645" x2="3701.6645" y1="146.8419" y2="10273.3665"/></g><g><title>Initiator_Peer</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="3831.9918" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3835.444" x2="3835.444" y1="146.8419" y2="10273.3665"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="10126.5247" width="8" x="3916.5626" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3920.5397" x2="3920.5397" y1="146.8419" y2="10273.3665"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="779" y="142.7399">User</text><ellipse cx="797.3089" cy="76.2739" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M797.3089,84.2739 L797.3089,111.2739 M784.3089,92.2739 L810.3089,92.2739 M797.3089,111.2739 L784.3089,126.2739 M797.3089,111.2739 L810.3089,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="779" y="10287.3325">User</text><ellipse cx="797.3089" cy="10299.9344" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M797.3089,10307.9344 L797.3089,10334.9344 M784.3089,10315.9344 L810.3089,10315.9344 M797.3089,10334.9344 L784.3089,10349.9344 M797.3089,10334.9344 L810.3089,10349.9344" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="825.6179" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="832.6179" y="134.7399">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="825.6179" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="832.6179" y="10294.3325">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="869.5398" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="876.5398" y="134.7399">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="869.5398" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="876.5398" y="10294.3325">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1605.5244" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1612.5244" y="134.7399">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1605.5244" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1612.5244" y="10294.3325">ST</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="2233.8911" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="2240.8911" y="134.7399">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="2233.8911" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="2240.8911" y="10294.3325">Niso</text></g><g class="participant participant-head" data-participant="WT"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8039" x="2933.1296" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8039" x="2940.1296" y="134.7399">WT</text></g><g class="participant participant-tail" data-participant="WT"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8039" x="2933.1296" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8039" x="2940.1296" y="10294.3325">WT</text></g><g class="participant participant-head" data-participant="Non_Initiator_Peers"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143.7795" x="3630.6645" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.7795" x="3637.6645" y="134.7399">Non_Initiator_Peers</text></g><g class="participant participant-tail" data-participant="Non_Initiator_Peers"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143.7795" x="3630.6645" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.7795" x="3637.6645" y="10294.3325">Non_Initiator_Peers</text></g><g class="participant participant-head" data-participant="Initiator_Peer"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.0957" x="3784.444" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.0957" x="3791.444" y="134.7399">Initiator_Peer</text></g><g class="participant participant-tail" data-participant="Initiator_Peer"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.0957" x="3784.444" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.0957" x="3791.444" y="10294.3325">Initiator_Peer</text></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3897.5397" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3904.5397" y="134.7399">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3897.5397" y="10272.3665"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3904.5397" y="10294.3325">SARs</text></g><path d="M779,186.8419 L779,337.8419 L3938,337.8419 L3938,196.8419 L3928,186.8419 L779,186.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3928,186.8419 L3928,196.8419 L3938,196.8419 L3928,186.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="84.7731" x="1762.3764" y="205.7389">PARAMETERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="223.4449">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.2575" x="1776.7804" y="223.4449">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="241.1509">2.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="761.6576" x="1776.7804" y="241.1509">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_WT_TX_APPROVAL_BY_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="258.8569">3.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="878.3067" x="1776.7804" y="258.8569">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_APPROVAL_BY_WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="276.5629">4.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1014.0139" x="1776.7804" y="276.5629">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="294.2689">5.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.2278" x="1776.7804" y="294.2689">#define TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="311.975">6.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="972.6219" x="1776.7804" y="311.975">#define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_INITIATOR_PEER_TX_COMMITMENT_BY_NON_INITIATOR_PEERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1762.3764" y="329.681">7.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1169.4288" x="1776.7804" y="329.681">#define TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_COMMITMENT_BY_WT_HAVING_SAR_RESPONSE_BACK_TO_WT</text><g class="message" data-participant-1="Initiator_Peer" data-participant-2="WT"><polygon fill="#181818" points="2961.5315,398.608,2951.5315,402.608,2961.5315,406.608,2957.5315,402.608" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3835.4918" cy="401.858" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2955.5315" x2="3830.9918" y1="402.608" y2="402.608"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2967.5315" y="379.093">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2995.0096" y="361.387">WithdrawalNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.6523" x="2998.3896" y="379.093">peer_0_tx_approval_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="588.4457" x="2998.3896" y="396.799">psbt_encrypted_collection: Collection&lt;psbt_encrypted_by_boomlet_0_for_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text></g><path d="M2822,415.608 L2822,460.608 L3077,460.608 L3077,425.608 L3067,415.608 L2822,415.608" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3067,415.608 L3067,425.608 L3077,425.608 L3067,415.608" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.098" x="2828" y="434.505">WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.2602" x="2828" y="452.2111">operations shown in initiator diagram.</text><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="2950.0315" cy="542.0941" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3690.5543,538.8441,3700.5543,542.8441,3690.5543,546.8441,3694.5543,542.8441" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3696.5543" y1="542.8441" y2="542.8441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="510.4761">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2985.0096" y="483.9171">WithdrawalWtNonInitiatorNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="2988.3896" y="501.6231">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.4632" x="2988.3896" y="519.3291">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.9973" x="2988.3896" y="537.0351">psbt_encrypted_by_boomlet_0_for_boomlet_i [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2266.605,623.6682,2256.605,627.6682,2266.605,631.6682,2262.605,627.6682" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2950.0315" cy="626.9182" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2260.605" x2="2945.5315" y1="627.6682" y2="627.6682"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2272.605" y="595.3002">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2300.0831" y="568.7411">WithdrawalWtNonInitiatorNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="2303.4631" y="586.4472">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.4632" x="2303.4631" y="604.1532">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.6552" x="2303.4631" y="621.8592">psbt_encrypted_by_boomlet_0_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="1762,640.6682,2748,640.6682,2758,714.6682,2748,789.6682,1762,789.6682,1752,714.6682,1762,640.6682" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="902.5384" x="1764" y="658.5652">Non-initiator Niso receives {wt_tx_approval_signed_by_wt, peer_0_tx_approval_signed_by_boomlet_0, psbt_encrypted_by_boomlet_0_for_boomlet_1}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="859.1576" x="1767.38" y="676.2712">from WT. Non-initiator Niso verifies wt_pubkey's signature on wt_tx_approval_signed_by_wt, finds out which peer is the initiator by looking at</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="786.7734" x="1767.38" y="693.9772">the initiator_id field of wt_tx_approval (We consider peer_0 as the initiator). It verifies that the boomlet_0_identity_pubkey derived</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="975.2732" x="1767.38" y="711.6833">from wt_tx_approval exists in the set of peer_ids_collection, It then verifies boomlet_0_identity_pubkey's signature on peer_0_tx_approval_signed_by_boomlet_0.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="822.9004" x="1767.38" y="729.3893">Non-initiator Niso checks that the magic in peer_0_tx_approval and wt_tx_approval match "approved", the tx_id in both approvals is the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="834.6522" x="1767.38" y="747.0953">same, peer_0_tx_approval is fresh according to wt_tx_approval and wt_tx_approval is fresh according to most_work_bitcoin_block_height.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.6647" x="1767.38" y="764.8013">It then checks that most_work_bitcoin_block_height has passed milestone_block_0 from boomerang_descriptor and forwards the received message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380.5364" x="1767.38" y="782.5073">alongside niso_1_event_block_height to Non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2059,800.3163,2451,800.3163,2461,812.3163,2451,825.3163,2059,825.3163,2049,812.3163,2059,800.3163" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2061" y="818.2133">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="2002,836.0223,2508,836.0223,2518,848.0223,2508,861.0223,2002,861.0223,1992,848.0223,2002,836.0223" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.9574" x="2004" y="853.9194">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True.</text><polygon fill="#E6E6FA" points="1986,871.7284,2524,871.7284,2534,883.7284,2524,896.7284,1986,896.7284,1976,883.7284,1986,871.7284" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="534.0924" x="1988" y="889.6254">regard wt_tx_approval_signed_by_wt.content.initiator_id as boomlet_0_identity_pubkey.</text><polygon fill="#FFC0CB" points="1984,907.4344,2525,907.4344,2535,919.4344,2525,932.4344,1984,932.4344,1974,919.4344,1984,907.4344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="537.9533" x="1986" y="925.3314">Check that boomlet_0_identity_pubkey exists in boomerang_params.peer_ids_collection.</text><polygon fill="#FFC0CB" points="1913,943.1404,2597,943.1404,2607,955.1404,2597,968.1404,1913,968.1404,1903,955.1404,1913,943.1404" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.2516" x="1915" y="961.0374">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_approval_signed_by_boomlet_0.signature) == True.</text><polygon fill="#E6E6FA" points="2031,978.8464,2480,978.8464,2490,1008.8464,2480,1039.8464,2031,1039.8464,2021,1008.8464,2031,978.8464" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.6363" x="2033" y="996.7434">peer_0_tx_approval := peer_0_tx_approval_signed_by_boomlet_0.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.4302" x="2036.38" y="1014.4494">wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="2036.38" y="1032.1555">niso_1_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="2106,1049.9645,2404,1049.9645,2414,1061.9645,2404,1074.9645,2106,1074.9645,2096,1061.9645,2106,1049.9645" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.3463" x="2108" y="1067.8615">Assert peer_0_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="2119,1085.6705,2391,1085.6705,2401,1097.6705,2391,1110.6705,2119,1110.6705,2109,1097.6705,2119,1085.6705" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.0212" x="2121" y="1103.5675">Assert wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="2084,1121.3765,2425,1121.3765,2435,1133.3765,2425,1146.3765,2084,1146.3765,2074,1133.3765,2084,1121.3765" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337.4283" x="2086" y="1139.2735">Assert peer_0_tx_approval.tx_id == wt_tx_approval.tx_id</text><polygon fill="#FFC0CB" points="1508,1157.0825,3002,1157.0825,3012,1187.0825,3002,1218.0825,1508,1218.0825,1498,1187.0825,1508,1157.0825" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1510" y="1174.9795">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1483.6912" x="1513.38" y="1192.6855">Assert wt_tx_approval.event_block_height &gt;= max(peer_0_tx_approval.event_block_height, (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_WT_TX_APPROVAL_BY_NON_INITIATOR_PEERS))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1343.7593" x="1513.38" y="1210.3916">Assert wt_tx_approval.event_block_height &lt;= min((peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT), most_work_bitcoin_block_height)</text><polygon fill="#FFC0CB" points="1928,1228.2006,2582,1228.2006,2592,1240.2006,2582,1253.2006,1928,1253.2006,1918,1240.2006,1928,1228.2006" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.6373" x="1930" y="1246.0976">Assert most_work_bitcoin_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><polygon fill="#E6E6FA" points="2111,1263.9066,2398,1263.9066,2408,1275.9066,2398,1288.9066,2111,1288.9066,2101,1275.9066,2111,1263.9066" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.3613" x="2113" y="1281.8036">initiator_peer_id := peer_0_tx_approval.peer_id</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="915.3857,1385.1427,905.3857,1389.1427,915.3857,1393.1427,911.3857,1389.1427" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="1388.3927" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="909.3857" x2="2250.605" y1="1389.1427" y2="1389.1427"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="921.3857" y="1347.9216">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="948.8637" y="1312.5096">WithdrawalNonInitiatorNisoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="952.2438" y="1330.2156">wt_tx_approval_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.4632" x="952.2438" y="1347.9216">peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.6552" x="952.2438" y="1365.6277">psbt_encrypted_by_boomlet_0_for_boomlet_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="952.2438" y="1383.3337">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="388,1402.1427,1419,1402.1427,1429,1476.1427,1419,1551.1427,388,1551.1427,378,1476.1427,388,1402.1427" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="925.4703" x="390" y="1420.0397">Non-initiator Boomlet receives {wt_tx_approval_signed_by_wt, peer_0_tx_approval_signed_by_boomlet_0, psbt_encrypted_by_boomlet_0_for_boomlet_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.0133" x="393.38" y="1437.7457">niso_1_event_block_height} from Non-initiator Niso. Non-initiator Boomlet verifies wt_pubkey's signature on wt_tx_approval_signed_by_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="812.7214" x="393.38" y="1455.4517">finds out which peer is the initiator by looking at the initiator_id field of wt_tx_approval. It verifies that the boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1021.1501" x="393.38" y="1473.1577">derived from wt_tx_approval exists in the set of peer_ids_collection. It then verifies boomlet_0_identity_pubkey's signature on peer_0_tx_approval_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.6774" x="393.38" y="1490.8638">and decrypts psbt_encrypted_by_boomlet_0_for_boomlet_1 using boomlet_1_identity_privkey and boomlet_0_identity. Non-initiator Boomlet checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="886.1586" x="393.38" y="1508.5698">that the magic in peer_0_tx_approval and wt_tx_approval match "approved", the tx_id in both approvals is the same as the one derived from psbt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="924.0405" x="393.38" y="1526.2758">peer_0_tx_approval is fresh according to wt_tx_approval, wt_tx_approval is fresh according to niso_1_event_block_height and niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="645.9184" x="393.38" y="1543.9818">has passed (is larger than) milestone_block_0. Non-initiator Boomlet then sends psbt to non-initiator Niso.</text><polygon fill="#FFC0CB" points="652,1561.7908,1155,1561.7908,1165,1573.7908,1155,1586.7908,652,1586.7908,642,1573.7908,652,1561.7908" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.4734" x="654" y="1579.6878">Assert schnorr_verify(wt_pubkey, wt_tx_approval_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="635,1597.4968,1173,1597.4968,1183,1609.4968,1173,1622.4968,635,1622.4968,625,1609.4968,635,1597.4968" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="534.0924" x="637" y="1615.3938">regard wt_tx_approval_signed_by_wt.content.initiator_id as boomlet_0_identity_pubkey.</text><polygon fill="#FFC0CB" points="633,1633.2028,1174,1633.2028,1184,1645.2028,1174,1658.2028,633,1658.2028,623,1645.2028,633,1633.2028" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="537.9533" x="635" y="1651.0999">Check that boomlet_0_identity_pubkey exists in boomerang_params.peer_ids_collection.</text><polygon fill="#FFC0CB" points="564,1668.9089,1244,1668.9089,1254,1680.9089,1244,1693.9089,564,1693.9089,554,1680.9089,564,1668.9089" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.7676" x="566" y="1686.8059">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_approval_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="450,1704.6149,1357,1704.6149,1367,1734.6149,1357,1765.6149,450,1765.6149,440,1734.6149,450,1704.6149" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.6363" x="452" y="1722.5119">peer_0_tx_approval := peer_0_tx_approval_signed_by_boomlet_0.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.4302" x="455.38" y="1740.2179">wt_tx_approval := wt_tx_approval_signed_by_wt.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="900.0295" x="455.38" y="1757.9239">psbt := AES_decrypt(privkey: ECDH(boomlet_1_identity_privkey, boomlet_0_identity_pubkey), content: psbt_encrypted_by_boomlet_0_for_boomlet_1)</text><polygon fill="#FFC0CB" points="755,1775.7329,1053,1775.7329,1063,1787.7329,1053,1800.7329,755,1800.7329,745,1787.7329,755,1775.7329" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.3463" x="757" y="1793.6299">Assert peer_0_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="768,1811.4389,1040,1811.4389,1050,1823.4389,1040,1836.4389,768,1836.4389,758,1823.4389,768,1811.4389" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.0212" x="770" y="1829.336">Assert wt_tx_approval.magic == "approved".</text><polygon fill="#FFC0CB" points="738,1847.145,1069,1847.145,1079,1868.145,1069,1890.145,738,1890.145,728,1868.145,738,1847.145" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324.1033" x="740" y="1865.042">Assert psbt.derive_tx_id() == peer_0_tx_approval.tx_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.8932" x="743.38" y="1882.748">peer_0_tx_approval.tx_id == wt_tx_approval.tx_id</text><polygon fill="#FFC0CB" points="346,1900.557,1461,1900.557,1471,1930.557,1461,1961.557,346,1961.557,336,1930.557,346,1900.557" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="348" y="1918.454">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1104.507" x="351.38" y="1936.16">Assert peer_0_tx_approval.event_block_height &gt;= (wt_tx_approval.event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="714.8444" x="351.38" y="1953.866">Assert peer_0_tx_approval.event_block_height &lt;= min(niso_1_event_block_height, wt_tx_approval.event_block_height)</text><polygon fill="#FFC0CB" points="175,1971.675,1633,1971.675,1643,2001.675,1633,2032.675,175,2032.675,165,2001.675,175,1971.675" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="177" y="1989.5721">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1447.7334" x="180.38" y="2007.2781">Assert wt_tx_approval.event_block_height &gt;= max(peer_0_tx_approval.event_block_height, (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_WT_TX_APPROVAL_BY_NON_INITIATOR_PEERS))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1307.8014" x="180.38" y="2024.9841">Assert wt_tx_approval.event_block_height &lt;= min((peer_0_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_INITIATOR_PEER_TO_TX_APPROVAL_BY_WT), niso_1_event_block_height)</text><polygon fill="#FFC0CB" points="595,2042.7931,1213,2042.7931,1223,2054.7931,1213,2067.7931,595,2067.7931,585,2054.7931,595,2042.7931" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="614.6793" x="597" y="2060.6901">Assert niso_1_event_block_height &gt;= boomerang_params.boomerang_descriptor.milestone_block_0 .</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="903.8857" cy="2114.1611" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,2110.9111,2253.605,2114.9111,2243.605,2118.9111,2247.605,2114.9111" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.3857" x2="2249.605" y1="2114.9111" y2="2114.9111"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="911.3857" y="2100.2491">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="938.8637" y="2091.3961">WithdrawalNonInitiatorBoomletNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.91" x="942.2438" y="2109.1021">psbt</text></g><polygon fill="#FFF0F5" points="1829,2127.9111,2682,2127.9111,2692,2148.9111,2682,2170.9111,1829,2170.9111,1819,2148.9111,1829,2127.9111" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.7284" x="1831" y="2145.8082">Non-initiator Niso receives psbt from Non-initiator non-initiator Boomlet. Non-initiator Niso checks that psbt is satisfiable and derived tx_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="662.4673" x="1834.38" y="2163.5142">matches that of peer_0_tx_approval. It then outputs psbt along with initiator's peer_i_id to non-initiator User.</text><polygon fill="#FFC0CB" points="2154,2181.3232,2356,2181.3232,2366,2193.3232,2356,2206.3232,2154,2206.3232,2144,2193.3232,2154,2181.3232" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.5882" x="2156" y="2199.2202">Assert hydrate_psbt(psbt) != Null</text><polygon fill="#FFC0CB" points="2091,2217.0292,2419,2217.0292,2429,2229.0292,2419,2242.0292,2091,2242.0292,2081,2229.0292,2091,2217.0292" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324.1033" x="2093" y="2234.9262">Assert psbt.derive_tx_id() == peer_0_tx_approval.tx_id</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="808.3089,2302.8533,798.3089,2306.8533,808.3089,2310.8533,804.3089,2306.8533" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="2306.1033" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="802.3089" x2="2250.605" y1="2306.8533" y2="2306.8533"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="814.3089" y="2283.3382">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240.8381" x="841.787" y="2265.6322">WithdrawalNonInitiatorNisoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.91" x="845.167" y="2283.3382">psbt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9301" x="845.167" y="2301.0443">initiator_peer_id</text></g><polygon fill="#FFF0F5" points="359,2319.8533,1235,2319.8533,1245,2340.8533,1235,2362.8533,359,2362.8533,349,2340.8533,359,2319.8533" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="868.7775" x="361" y="2337.7503">Non-initiator User receives {psbt, initiator_peer_id} from non-initiator Niso. Non-initiator User then informs non-initiator Niso of it's agreement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.1721" x="364.38" y="2355.4563">with the tx.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="796.8089" cy="2408.9273" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,2405.6773,2253.605,2409.6773,2243.605,2413.6773,2247.605,2409.6773" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="801.3089" x2="2249.605" y1="2409.6773" y2="2409.6773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="804.3089" y="2395.0153">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229.9051" x="831.787" y="2386.1623">WithdrawalNonInitiatorNisoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435.9423" x="835.167" y="2403.8683">magic: "withdrawal_non_initiator_peer_approved_the_withdrawal_psbt"</text></g><polygon fill="#FFF0F5" points="1816,2422.6773,2694,2422.6773,2704,2443.6773,2694,2465.6773,1816,2465.6773,1806,2443.6773,1816,2422.6773" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="871.1564" x="1818" y="2440.5743">Non-initiator Niso receives {magic: "withdrawal_non_initiator_peer_approved_the_withdrawal_psbt"} from non-initiator User. Non-initiator Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.4813" x="1821.38" y="2458.2804">then informs non-initiator Boomlet to proceed.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="915.3857,2508.5014,905.3857,2512.5014,915.3857,2516.5014,911.3857,2512.5014" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="2511.7514" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="909.3857" x2="2250.605" y1="2512.5014" y2="2512.5014"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="921.3857" y="2497.8394">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="948.8637" y="2488.9864">WithdrawalNonInitiatorNisoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5202" x="952.2438" y="2506.6924">magic: "withdrawal_peer_agreement_with_psbt_received"</text></g><polygon fill="#FFF0F5" points="453,2525.5014,1354,2525.5014,1364,2555.5014,1354,2586.5014,453,2586.5014,443,2555.5014,453,2525.5014" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="865.8784" x="455" y="2543.3984">Non-initiator Boomlet receives {magic: "withdrawal_peer_agreement_with_psbt_received"} from non-initiator Niso. Non-initiator Boomlet then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.4614" x="458.38" y="2561.1044">derives tx_id from psbt, adds nonce to it and encrypts it with st_1_identity_pubkey. It then sends tx_id_with_nonce_encrypted_by_boomlet_1_for_st</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.2561" x="458.38" y="2578.8104">to non-initiator Niso.</text><path d="M318,2598.6194 L460.1881,2598.6194 L460.1881,2608.3255 L450.1881,2618.3255 L318,2618.3255 L318,2598.6194" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1223.5948" style="stroke:#000000;stroke-width:1.5;" width="2388.8716" x="318" y="2598.6194"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="97.1881" x="333" y="2613.5165">ST_check(tx_id)</text><polygon fill="#E6E6FA" points="407,2623.3255,1399,2623.3255,1409,2680.3255,1399,2737.3255,407,2737.3255,397,2680.3255,407,2623.3255" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.0142" x="409" y="2641.2225">tx_id := psbt.derive_tx_id()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.3782" x="412.38" y="2658.9285">tx_id_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.9301" x="412.38" y="2676.6345">content: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0002" x="412.38" y="2694.3405">nonce: rand() [u8; 32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="409" y="2712.0465">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="985.5306" x="412.38" y="2729.7526">tx_id_with_nonce_encrypted_by_boomlet_1_for_st := AES_encrypt(private_key: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: tx_id_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="903.8857" cy="2783.2236" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,2779.9736,2253.605,2783.9736,2243.605,2787.9736,2247.605,2783.9736" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.3857" x2="2249.605" y1="2783.9736" y2="2783.9736"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="911.3857" y="2769.3116">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="938.8637" y="2760.4586">WithdrawalNonInitiatorBoomletNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.2372" x="942.2438" y="2778.1646">tx_id_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1829,2796.9736,2681,2796.9736,2691,2808.9736,2681,2821.9736,1829,2821.9736,1819,2808.9736,1829,2796.9736" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.3024" x="1831" y="2814.8706">Non-initiator Niso receives tx_id_with_nonce_encrypted_by_boomlet_1_for_st from non-initiator Boomlet and forwards it to non-initiator ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1631.2594,2865.0916,1621.2594,2869.0916,1631.2594,2873.0916,1627.2594,2869.0916" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="2868.3416" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1625.2594" x2="2250.605" y1="2869.0916" y2="2869.0916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1637.2594" y="2854.4296">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="263.3282" x="1664.7374" y="2845.5766">WithdrawalNonInitiatorNisoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.2372" x="1668.1174" y="2863.2826">tx_id_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1210,2882.0916,2028,2882.0916,2038,2903.0916,2028,2925.0916,1210,2925.0916,1200,2903.0916,1210,2882.0916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="756.4056" x="1212" y="2899.9886">Non-initiator ST receives tx_id_with_nonce_encrypted_by_boomlet_1_for_st from non-initiator Niso. Non-initiator ST decrypts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="811.3174" x="1215.38" y="2917.6947">tx_id_with_nonce_encrypted_by_boomlet_1_for_st to get tx_id_with_nonce and outputs the content of it i.e. tx_id to non-initiator User.</text><polygon fill="#E6E6FA" points="1136,2935.5037,2103,2935.5037,2113,2956.5037,2103,2978.5037,1136,2978.5037,1126,2956.5037,1136,2935.5037" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.7852" x="1138" y="2953.4007">tx_id := tx_id_with_nonce.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="960.4016" x="1141.38" y="2971.1067">tx_id_with_nonce := AES_decrypt(privkey: ECDH(boomlet_1_identity_pubkey, st_1_identity_privkey), content: tx_id_with_nonce_encrypted_by_boomlet_1_for_st)</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="808.3089,3021.3277,798.3089,3025.3277,808.3089,3029.3277,804.3089,3025.3277" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1619.7594" cy="3024.5777" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="802.3089" x2="1615.2594" y1="3025.3277" y2="3025.3277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="814.3089" y="3010.6657">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224.6011" x="841.787" y="3001.8127">WithdrawalNonInitiatorStOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.691" x="845.167" y="3019.5187">tx_id</text></g><polygon fill="#FFF0F5" points="374,3038.3277,1218,3038.3277,1228,3059.3277,1218,3081.3277,374,3081.3277,364,3059.3277,374,3038.3277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="837.3176" x="376" y="3056.2247">Non-initiator User receives tx_id from non-initiator ST. Non-initiator User checks to see tx_id matches the one he previously received from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.8275" x="379.38" y="3073.9308">non-initiator Niso and agreed to. It then informs non-initiator ST of his agreement.</text><polygon fill="#FFC0CB" points="694,3091.7398,900,3091.7398,910,3103.7398,900,3116.7398,694,3116.7398,684,3103.7398,694,3091.7398" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.5012" x="696" y="3109.6368">Assert tx_id == psbt.derive_tx_id()</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="796.8089" cy="3163.1078" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1608.2594,3159.8578,1618.2594,3163.8578,1608.2594,3167.8578,1612.2594,3163.8578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="801.3089" x2="1614.2594" y1="3163.8578" y2="3163.8578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="804.3089" y="3149.1958">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213.6681" x="831.787" y="3140.3428">WithdrawalNonInitiatorStInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="768.0924" x="835.167" y="3158.0488">magic: "withdrawal_non_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"</text></g><polygon fill="#FFF0F5" points="1151,3176.8578,2088,3176.8578,2098,3197.8578,2088,3219.8578,1151,3219.8578,1141,3197.8578,1151,3176.8578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="930.2415" x="1153" y="3194.7548">Non-initiator ST receives {magic: "withdrawal_non_initiator_peer_approved_that_txid_received_is_the_same_as_the_one_derived_from_withdrawal_psbt"}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="851.4744" x="1156.38" y="3212.4608">from non-initiator User. It signs the tx_id_with_nonce, encrypts it with boomlet_1_identity_pubkey and sends the result to non-initiator Niso.</text><polygon fill="#E6E6FA" points="1040,3230.2699,2200,3230.2699,2210,3278.2699,2200,3326.2699,1040,3326.2699,1030,3278.2699,1040,3230.2699" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.0824" x="1042" y="3248.1669">tx_id_with_nonce_signed_by_st := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.4013" x="1045.38" y="3265.8729">signature: schnorr_sign(st_1_identity_privkey, tx_id_with_nonce)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.7942" x="1045.38" y="3283.5789">content: tx_id_with_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1042" y="3301.2849">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1153.127" x="1045.38" y="3318.9909">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 := AES_encrypt(private_key: ECDH(st_1_identity_privkey, boomlet_1_identity_pubkey), content: tx_id_with_nonce_signed_by_st)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1619.7594" cy="3372.462" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,3369.212,2253.605,3373.212,2243.605,3377.212,2247.605,3373.212" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1624.2594" x2="2249.605" y1="3373.212" y2="3373.212"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1627.2594" y="3358.55">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="263.3282" x="1654.7374" y="3349.6969">WithdrawalNonInitiatorStNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386.0353" x="1658.1174" y="3367.403">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="1824,3386.212,2686,3386.212,2696,3407.212,2686,3429.212,1824,3429.212,1814,3407.212,1824,3386.212" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="855.4916" x="1826" y="3404.109">Non-initiator Niso receives tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 from non-initiator ST. Non-initiator Niso forwards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="851.0323" x="1829.38" y="3421.815">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 along with the updated niso_1_event_block_height to non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2059,3439.624,2451,3439.624,2461,3451.624,2451,3464.624,2059,3464.624,2049,3451.624,2059,3439.624" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2061" y="3457.521">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#E6E6FA" points="2063,3475.33,2447,3475.33,2457,3487.33,2447,3500.33,2063,3500.33,2053,3487.33,2063,3475.33" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380.7963" x="2065" y="3493.227">niso_1_event_block_height := most_work_bitcoin_block_height.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="915.3857,3561.1541,905.3857,3565.1541,915.3857,3569.1541,911.3857,3565.1541" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="3564.4041" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="909.3857" x2="2250.605" y1="3565.1541" y2="3565.1541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="921.3857" y="3541.6391">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="948.8637" y="3523.933">WithdrawalNonInitiatorNisoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386.0353" x="952.2438" y="3541.6391">tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="952.2438" y="3559.3451">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="450,3578.1541,1358,3578.1541,1368,3635.1541,1358,3692.1541,450,3692.1541,440,3635.1541,450,3578.1541" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="901.1734" x="452" y="3596.0511">Non-initiator Boomlet receives {tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1, niso_1_event_block_height} from non-initiator Niso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="824.4086" x="455.38" y="3613.7571">Non-initiator Boomlet decrypts tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1 using boomlet_1_identity_privkey to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="799.8644" x="455.38" y="3631.4631">tx_id_with_nonce_signed_by_st. It then verifies st_1_identity_pubkey's signature on tx_id_with_nonce_signed_by_st and checks if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="849.3295" x="455.38" y="3649.1691">tx_id_with_nonce received matches with the one sent. Non-initiator Boomlet generates peer_1_tx_approval composed of {"approved", tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="659.0094" x="455.38" y="3666.8752">niso_1_event_block_height}, signs it using boomlet_1_identity_privkey, encrypts it with wt_pubkey and sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="587.2884" x="455.38" y="3684.5812">peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt to non-initiator Niso.</text><polygon fill="#E6E6FA" points="338,3702.3902,1469,3702.3902,1479,3714.3902,1469,3727.3902,338,3727.3902,328,3714.3902,338,3702.3902" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1127.9976" x="340" y="3720.2872">tx_id_with_nonce_signed_by_st := AES_decrypt(privkey: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: tx_id_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_1)</text><polygon fill="#FFC0CB" points="617,3738.0962,1189,3738.0962,1199,3750.0962,1189,3763.0962,617,3763.0962,607,3750.0962,617,3738.0962" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="568.8025" x="619" y="3755.9932">Assert schnorr_verify(st_1_identity_pubkey, tx_id_with_nonce_signed_by_st.signature) == True</text><polygon fill="#FFC0CB" points="697,3773.8022,1109,3773.8022,1119,3794.8022,1109,3816.8022,697,3816.8022,687,3794.8022,697,3773.8022" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="699" y="3791.6992">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="405.4183" x="702.38" y="3809.4052">Assert tx_id_with_nonce_signed_by_st.content == tx_id_with_nonce</text><polygon fill="#E6E6FA" points="279,3834.2142,1529,3834.2142,1539,3926.2142,1529,4019.2142,279,4019.2142,269,3926.2142,279,3834.2142" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.3972" x="281" y="3852.1113">_peer_1_tx_approval := TxApproval{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.7611" x="284.38" y="3869.8173">magic: "approval",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="284.38" y="3887.5233">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.0782" x="284.38" y="3905.2293">event_block_height: niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="284.38" y="3922.9353">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.4804" x="284.38" y="3940.6413">_peer_1_tx_approval_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="448.5914" x="284.38" y="3958.3474">signature: schnorr_sign(boomlet_1_identity_privkey, _peer_1_tx_approval)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.6451" x="284.38" y="3976.0534">content: _peer_1_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="281" y="3993.7594">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1242.8397" x="284.38" y="4011.4654">_peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt := AES_encrypt(private_key: ECDH(boomlet_1_identity_privkey, wt_pubkey), content: _peer_1_tx_approval_signed_by_boomlet_1)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="903.8857" cy="4064.9364" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,4061.6864,2253.605,4065.6864,2243.605,4069.6864,2247.605,4065.6864" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.3857" x2="2249.605" y1="4065.6864" y2="4065.6864"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="911.3857" y="4051.0244">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="938.8637" y="4042.1714">WithdrawalNonInitiatorBoomletNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.6523" x="942.2438" y="4059.8774">peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="1789,4078.6864,2722,4078.6864,2732,4090.6864,2722,4103.6864,1789,4103.6864,1779,4090.6864,1789,4078.6864" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="929.1625" x="1791" y="4096.5835">Non-initiator Niso receives peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2255.105" cy="4150.0545" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2938.5315,4146.8045,2948.5315,4150.8045,2938.5315,4154.8045,2942.5315,4150.8045" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2259.605" x2="2944.5315" y1="4150.8045" y2="4150.8045"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2262.605" y="4136.1425">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2290.0831" y="4127.2895">WithdrawalNonInitiatorNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.6523" x="2293.4631" y="4144.9955">peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="2512,4163.8045,3387,4163.8045,3397,4220.8045,3387,4277.8045,2512,4277.8045,2502,4220.8045,2512,4163.8045" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="856.5444" x="2514" y="4181.7015">WT receives peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Niso, decrypts it using wt_privkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="834.5353" x="2517.38" y="4199.4075">verifies boomlet_1_identity_pubkey's signature on peer_1_tx_approval_signed_by_boomlet_1, checks that the magic matches "approved",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="810.6932" x="2517.38" y="4217.1135">tx_id match the expected value and message to be fresh according to the most_work_bitcoin_block_height and event_block_height of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="864.4095" x="2517.38" y="4234.8196">wt_tx_approval. It also receives peer_i_tx_approval_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt from non-initiator Peers and repeats</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="826.9042" x="2517.38" y="4252.5256">the same validation process. WT then sends to each non-initiator peer a collection of all other peers' approvals except the initiator's and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.9595" x="2517.38" y="4270.2316">in a separate message sends a collection of all peers' approvals along with wt_tx_approval to the initiator peer.</text><polygon fill="#E6E6FA" points="2754,4288.0406,3146,4288.0406,3156,4300.0406,3146,4313.0406,2754,4313.0406,2744,4300.0406,2754,4288.0406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2756" y="4305.9376">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#E6E6FA" points="2345,4323.7466,3555,4323.7466,3565,4335.7466,3555,4348.7466,2345,4348.7466,2335,4335.7466,2345,4323.7466" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1206.1666" x="2347" y="4341.6436">peer_1_tx_approval_signed_by_boomlet_1 := AES_decrypt(privkey: ECDH(boomlet_1_identity_pubkey, wt_privkey), content: peer_1_tx_approval_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt)</text><polygon fill="#FFC0CB" points="2610,4359.4526,3290,4359.4526,3300,4371.4526,3290,4384.4526,2610,4384.4526,2600,4371.4526,2610,4359.4526" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.7676" x="2612" y="4377.3496">Assert schnorr_verify(boomlet_1_identity_pubkey, peer_1_tx_approval_signed_by_boomlet_1.signature) == True</text><polygon fill="#E6E6FA" points="2727,4395.1586,3172,4395.1586,3182,4407.1586,3172,4420.1586,2727,4420.1586,2717,4407.1586,2727,4395.1586" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.6363" x="2729" y="4413.0557">peer_1_tx_approval := peer_1_tx_approval_signed_by_boomlet_1.content</text><polygon fill="#FFC0CB" points="2803,4430.8647,3097,4430.8647,3107,4442.8647,3097,4455.8647,2803,4455.8647,2793,4442.8647,2803,4430.8647" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.8622" x="2805" y="4448.7617">Assert peer_1_tx_approval.magic == "approved"</text><polygon fill="#FFC0CB" points="2827,4466.5707,3073,4466.5707,3083,4478.5707,3073,4491.5707,2827,4491.5707,2817,4478.5707,2827,4466.5707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.1512" x="2829" y="4484.4677">Assert peer_1_tx_approval.tx_id == tx_id</text><polygon fill="#FFC0CB" points="2144,4502.2767,3755,4502.2767,3765,4532.2767,3755,4563.2767,2144,4563.2767,2134,4532.2767,2144,4502.2767" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="2146" y="4520.1737">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1600.3401" x="2149.38" y="4537.8797">Assert peer_1_tx_approval.event_block_height &gt;= max((most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_APPROVAL_BY_WT), wt_tx_approval.event_block_height)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="503.4253" x="2149.38" y="4555.5857">Assert peer_1_tx_approval.event_block_height &lt;= most_work_bitcoin_block_height.</text><g class="message" data-participant-1="Non_Initiator_Peers" data-participant-2="WT"><polygon fill="#181818" points="2961.5315,4605.8068,2951.5315,4609.8068,2961.5315,4613.8068,2957.5315,4609.8068" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2955.5315" x2="3701.5543" y1="4609.8068" y2="4609.8068"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2967.5315" y="4595.1448">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2995.0096" y="4586.2918">WithdrawalNonInitiatorNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.8303" x="2998.3896" y="4603.9978">peer_i_tx_approval_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Initiator_Peer"><ellipse cx="2950.0315" cy="4676.1748" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3823.9918,4672.9248,3833.9918,4676.9248,3823.9918,4680.9248,3827.9918,4676.9248" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3829.9918" y1="4676.9248" y2="4676.9248"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="4653.4098">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2985.0096" y="4635.7038">WithdrawalWtNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.3823" x="2988.3896" y="4653.4098">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [0=&lt;i=&lt;4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.5821" x="2988.3896" y="4671.1158">wt_tx_approval_signed_by_wt</text></g><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="2950.0315" cy="4725.5869" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3690.5543,4722.3369,3700.5543,4726.3369,3690.5543,4730.3369,3694.5543,4726.3369" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3696.5543" y1="4726.3369" y2="4726.3369"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="4711.6748">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2985.0096" y="4702.8218">WithdrawalWtNonInitiatorNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="395.9023" x="2988.3896" y="4720.5279">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2266.605,4771.7489,2256.605,4775.7489,2266.605,4779.7489,2262.605,4775.7489" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2950.0315" cy="4774.9989" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2260.605" x2="2945.5315" y1="4775.7489" y2="4775.7489"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2272.605" y="4761.0869">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2300.0831" y="4752.2339">WithdrawalWtNonInitiatorNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="395.9023" x="2303.4631" y="4769.9399">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1771,4788.7489,2739,4788.7489,2749,4836.7489,2739,4884.7489,1771,4884.7489,1761,4836.7489,1771,4788.7489" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="960.6617" x="1773" y="4806.6459">Non-initiator Niso receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]} from WT. Non-initiator Niso updates niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="836.3683" x="1776.38" y="4824.3519">with the latest most_work_bitcoin_block_height. For every non_initiator peer in peer_ids_collection, It verifies boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="905.6194" x="1776.38" y="4842.0579">signature on peer_i_tx_approval_signed_by_boomlet_i, checks that the magic matches "approved", tx_id to be the expected value, peer_i_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="799.2143" x="1776.38" y="4859.764">to be fresh according to niso_1_event_block_height and wt_tx_approval and checks that wt_tx_approval is still fresh. It forwards this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="704.5483" x="1776.38" y="4877.47">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; alongside niso_1_event_block_height to non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2059,4895.279,2451,4895.279,2461,4907.279,2451,4920.279,2059,4920.279,2049,4907.279,2059,4895.279" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2061" y="4913.176">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#E6E6FA" points="2064,4930.985,2445,4930.985,2455,4942.985,2445,4955.985,2064,4955.985,2054,4942.985,2064,4930.985" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="2066" y="4948.882">niso_1_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1884,4966.691,2625,4966.691,2635,4978.691,2625,4991.691,1884,4991.691,1874,4978.691,1884,4966.691" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="737.9457" x="1886" y="4984.588">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="2002,5002.397,2508,5002.397,2518,5014.397,2508,5027.397,2002,5027.397,1992,5014.397,2002,5002.397" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.8144" x="2004" y="5020.294">peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="2094,5038.103,2416,5038.103,2426,5050.103,2416,5063.103,2094,5063.103,2084,5050.103,2094,5038.103" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.6693" x="2096" y="5056.0001">peer_i_tx_approval.magic == "approved" [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="2118,5073.8091,2391,5073.8091,2401,5085.8091,2391,5098.8091,2118,5098.8091,2108,5085.8091,2118,5073.8091" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.9582" x="2120" y="5091.7061">peer_i_tx_approval.tx_id == tx_id [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1347,5109.5151,3163,5109.5151,3173,5139.5151,3163,5170.5151,1347,5170.5151,1337,5139.5151,1347,5109.5151" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1349" y="5127.4121">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1805.3895" x="1352.38" y="5145.1181">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1685.4515" x="1355.76" y="5162.8241">Assert  peer_i_tx_approval.event_block_height &lt;= min(most_work_bitcoin_block_height, (wt_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)) [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="1585,5180.6331,2924,5180.6331,2934,5201.6331,2924,5223.6331,1585,5223.6331,1575,5201.6331,1585,5180.6331" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1587" y="5198.5301">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1332.2933" x="1590.38" y="5216.2362">Assert wt_tx_approval.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="915.3857,5284.1632,905.3857,5288.1632,915.3857,5292.1632,911.3857,5288.1632" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="5287.4132" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="909.3857" x2="2250.605" y1="5288.1632" y2="5288.1632"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="921.3857" y="5264.6482">[27n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="957.4047" y="5246.9422">WithdrawalNonInitiatorNisoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392.5223" x="960.7848" y="5264.6482">Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt;[1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="960.7848" y="5282.3542">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="400,5301.1632,1407,5301.1632,1417,5358.1632,1407,5415.1632,400,5415.1632,390,5358.1632,400,5301.1632" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="876.8506" x="402" y="5319.0602">Non-initiator Boomlet receives {Collection&lt;peer_i_tx_approval_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4], niso_1_event_block_height} from non-initiator</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="996.5414" x="405.38" y="5336.7662">Niso. After renewing niso_1_event_block_height, for every peer in peer_ids_collection except the initiator, non-initiator Boomlet verifies boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="905.6194" x="405.38" y="5354.4723">signature on peer_i_tx_approval_signed_by_boomlet_i, checks that the magic matches "approved", tx_id to be the expected value, peer_i_tx_approval</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="937.7811" x="405.38" y="5372.1783">to be fresh according to niso_1_event_block_height and wt_tx_approval and checks that wt_tx_approval is still fresh. It then generates duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="760.2922" x="405.38" y="5389.8843">which is an array of 5 integers between 1 and 195, adds a nonce to it and encrypts it using. Then non-initiator Boomlet sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="525.7854" x="405.38" y="5407.5903">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st to non-initiator Niso.</text><polygon fill="#FFC0CB" points="533,5425.3993,1274,5425.3993,1284,5437.3993,1274,5450.3993,533,5450.3993,523,5437.3993,533,5425.3993" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="737.9457" x="535" y="5443.2963">Assert schnorr_verify(boomlet_i_identity_pubkey, peer_i_tx_approval_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4]</text><polygon fill="#E6E6FA" points="649,5461.1053,1159,5461.1053,1169,5482.1053,1159,5504.1053,649,5504.1053,639,5482.1053,649,5461.1053" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.8144" x="651" y="5479.0023">peer_i_tx_approval := peer_i_tx_approval_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.6573" x="654.38" y="5496.7084">update niso_1_event_block_height with received value.</text><polygon fill="#FFC0CB" points="722,5514.5174,1086,5514.5174,1096,5526.5174,1086,5539.5174,722,5539.5174,712,5526.5174,722,5514.5174" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360.2043" x="724" y="5532.4144">Assert peer_i_tx_approval.magic == "approved" [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="746,5550.2234,1061,5550.2234,1071,5562.2234,1061,5575.2234,746,5575.2234,736,5562.2234,746,5550.2234" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.4933" x="748" y="5568.1204">Assert peer_i_tx_approval.tx_id == tx_id [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="15,5585.9294,1795,5585.9294,1805,5615.9294,1795,5646.9294,15,5646.9294,5,5615.9294,15,5585.9294" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="17" y="5603.8264">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1769.4315" x="20.38" y="5621.5324">Assert peer_i_tx_approval.event_block_height &gt;= max(wt_tx_approval.event_block_height, (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_NON_INITIATOR_PEERS_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)) [1 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1652.8735" x="23.76" y="5639.2384">Assert  peer_i_tx_approval.event_block_height &lt;= min(niso_1_event_block_height, (wt_tx_approval.event_block_height + TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS))  [1 &lt;= i &lt;= 4]</text><polygon fill="#FFC0CB" points="252,5657.0474,1555,5657.0474,1565,5678.0474,1555,5700.0474,252,5700.0474,242,5678.0474,252,5657.0474" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="254" y="5674.9445">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1296.3353" x="257.38" y="5692.6505">Assert wt_tx_approval.event_block_height &gt;= (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_APPROVAL_BY_WT_TO_RECEIVING_NON_INITIATOR_TX_APPROVAL_BY_OTHER_NON_INITIATOR_PEERS)</text><path d="M294,5712.4595 L425.2681,5712.4595 L425.2681,5722.1655 L415.2681,5732.1655 L294,5732.1655 L294,5712.4595" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1116.4768" style="stroke:#000000;stroke-width:1.5;" width="2455.5945" x="294" y="5712.4595"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="86.2681" x="309" y="5727.3565">duress_check</text><polygon fill="#E6E6FA" points="314,5737.1655,1494,5737.1655,1504,5785.1655,1494,5833.1655,314,5833.1655,304,5785.1655,314,5737.1655" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.2313" x="316" y="5755.0625">duress_check_space := DuressCheckSpace{space: rand([1..195;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2902" x="319.38" y="5772.7685">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3582" x="319.38" y="5790.4745">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="319.38" y="5808.1806">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.355" x="319.38" y="5825.8866">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st := AES_encrypt(private_key: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="903.8857" cy="5879.3576" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,5876.1076,2253.605,5880.1076,2243.605,5884.1076,2247.605,5880.1076" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.3857" x2="2249.605" y1="5880.1076" y2="5880.1076"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="911.3857" y="5865.4456">[28n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="947.4047" y="5856.5926">WithdrawalNonInitiatorBoomletNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="950.7848" y="5874.2986">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1780,5893.1076,2729,5893.1076,2739,5905.1076,2729,5918.1076,1780,5918.1076,1770,5905.1076,1780,5893.1076" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="945.5945" x="1782" y="5911.0046">Non-initiator Niso receives duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st from  non-initiator Boomlet and forwards it to non-initiator ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1631.2594,5961.2257,1621.2594,5965.2257,1631.2594,5969.2257,1627.2594,5965.2257" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="5964.4757" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1625.2594" x2="2250.605" y1="5965.2257" y2="5965.2257"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="1637.2594" y="5950.5636">[29n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="263.3282" x="1673.2784" y="5941.7106">WithdrawalNonInitiatorNisoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1676.6584" y="5959.4167">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st</text></g><polygon fill="#FFF0F5" points="1161,5978.2257,2077,5978.2257,2087,6008.2257,2077,6039.2257,1161,6039.2257,1151,6008.2257,1161,5978.2257" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="801.9834" x="1163" y="5996.1227">Non-initiator ST receives duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st from non-initiator Niso, decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="906.2043" x="1166.38" y="6013.8287">duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st, assign a country to each of the numbers in the duress_check_space corresponding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="563.8883" x="1166.38" y="6031.5347">to its alphabetical rank and shows this array to non-initiator User for him to select 5 of them.</text><polygon fill="#E6E6FA" points="1029,6049.3437,2209,6049.3437,2219,6070.3437,2209,6092.3437,1029,6092.3437,1019,6070.3437,1029,6049.3437" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.3156" x="1031" y="6067.2407">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_1_identity_pubkey, st_1_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_1_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.6093" x="1034.38" y="6084.9467">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="808.3089,6135.1678,798.3089,6139.1678,808.3089,6143.1678,804.3089,6139.1678" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1619.7594" cy="6138.4178" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="802.3089" x2="1615.2594" y1="6139.1678" y2="6139.1678"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="814.3089" y="6124.5058">[30n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224.6011" x="850.328" y="6115.6528">WithdrawalNonInitiatorStOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6031" x="853.708" y="6133.3588">duress_check_space</text></g><polygon fill="#FFF0F5" points="376,6152.1678,1218,6152.1678,1228,6173.1678,1218,6195.1678,376,6195.1678,366,6173.1678,376,6152.1678" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="834.7693" x="378" y="6170.0648">Non-initiator User receives duress_check_space from non-initiator ST. If he is not being coerced he will select 1 country in each column to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.1993" x="381.38" y="6187.7708">replicate the duress_consent_set and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="796.8089" cy="6241.2418" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1608.2594,6237.9918,1618.2594,6241.9918,1608.2594,6245.9918,1612.2594,6241.9918" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="801.3089" x2="1614.2594" y1="6241.9918" y2="6241.9918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="804.3089" y="6227.3298">[31n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213.6681" x="840.328" y="6218.4768">WithdrawalNonInitiatorStInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5771" x="843.708" y="6236.1828">duress_signal_index</text></g><polygon fill="#FFF0F5" points="1185,6254.9918,2055,6254.9918,2065,6275.9918,2055,6297.9918,1185,6297.9918,1175,6275.9918,1185,6254.9918" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="863.0964" x="1187" y="6272.8888">Non-initiator ST receives duress_signal_index from non-initiator User. Non-initiator ST then creates duress_signal_index_with_nonce using the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="747.1103" x="1190.38" y="6290.5949">nonce from previously received duress_check_space_with_nonce, encrypts it for non-initiator Boomlet and sends it to Niso.</text><polygon fill="#E6E6FA" points="1029,6308.4039,2209,6308.4039,2219,6347.4039,2209,6386.4039,1029,6386.4039,1019,6347.4039,1029,6308.4039" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2642" x="1031" y="6326.3009">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3322" x="1034.38" y="6344.0069">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="1034.38" y="6361.7129">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.303" x="1034.38" y="6379.4189">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1 := AES_encrypt(private_key: ECDH(boomlet_1_identity_pubkey, st_1_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1619.7594" cy="6432.89" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,6429.64,2253.605,6433.64,2243.605,6437.64,2247.605,6433.64" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1624.2594" x2="2249.605" y1="6433.64" y2="6433.64"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="1627.2594" y="6418.978">[32n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="263.3282" x="1663.2784" y="6410.1249">WithdrawalNonInitiatorStNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1666.6584" y="6427.831">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="1849,6446.64,2660,6446.64,2670,6467.64,2660,6489.64,1849,6489.64,1839,6467.64,1849,6446.64" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="804.1025" x="1851" y="6464.537">Non-initiator Niso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1 from non-initiator ST and forwards it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.7061" x="1854.38" y="6482.243">non-initiator Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="915.3857,6532.464,905.3857,6536.464,915.3857,6540.464,911.3857,6536.464" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="6535.714" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="909.3857" x2="2250.605" y1="6536.464" y2="6536.464"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="921.3857" y="6521.802">[33n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="957.4047" y="6512.949">WithdrawalNonInitiatorNisoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="960.7848" y="6530.655">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="466,6549.464,1342,6549.464,1352,6606.464,1342,6663.464,466,6663.464,456,6606.464,466,6549.464" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="869.1285" x="468" y="6567.361">Non-initiator Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1 from non-initiator Niso. Non-initiator Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="821.9252" x="471.38" y="6585.0671">will search for the indices in duress_check_space assigning the resulting value to duress_signal. If the duress_signal is composed of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="833.5603" x="471.38" y="6602.7731">same set of numbers as the duress_consent_set, duress_placeholder_plaintext will be assigned an empty padding otherwise it will be the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="856.2582" x="471.38" y="6620.4791">doxing_key. duress_placeholder_plaintext will be encrypted to make up duress_placeholder. Non-initiator Boomlet then generates approvals</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.9095" x="471.38" y="6638.1851">composed of peer_i_tx_approval_signed_by_peer_i [0 &lt;= i &lt;= 4] and wt_tx_approval, signs it with boomlet_1_identity_privkey and sends it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3181" x="471.38" y="6655.8911">non-initiator Niso.</text><polygon fill="#E6E6FA" points="315,6673.7001,1492,6673.7001,1502,6685.7001,1492,6698.7001,315,6698.7001,305,6685.7001,315,6673.7001" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.2635" x="317" y="6691.5971">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_1)</text><polygon fill="#FFC0CB" points="630,6709.4062,1178,6709.4062,1188,6730.4062,1178,6752.4062,630,6752.4062,620,6730.4062,630,6709.4062" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="632" y="6727.3032">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.0215" x="635.38" y="6745.0092">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="474,6762.8182,1333,6762.8182,1343,6792.8182,1333,6823.8182,474,6823.8182,464,6792.8182,474,6762.8182" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.3503" x="476" y="6780.7152">duress_signal := duress_check_space[duress_signal_index_with_nonce.content]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="781.8984" x="479.38" y="6798.4212">duress_placeholder_plaintext := Evaluate(duress_signal, duress_consent_set, doxing_key) [either padding of False or doxing_key]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="851.7994" x="479.38" y="6816.1272">duress_placeholder := AES_encrypt(privkey: ECDH(boomlet_1_identity_privkey, st_1_identity_pubkey), content: duress_placeholder_plaintext)</text><polygon fill="#E6E6FA" points="559,6840.9362,1248,6840.9362,1258,6888.9362,1248,6936.9362,559,6936.9362,549,6888.9362,559,6840.9362" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="678.8606" x="561" y="6858.8332">approvals: Collection&lt;tx_approval_signed&gt; := [peer_i_tx_approval_signed_by_peer_i[0 &lt;= i &lt;= 4], wt_tx_approval]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5854" x="567.76" y="6876.5393">approvals_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384.6964" x="564.38" y="6894.2453">signature: schnorr_sign(boomlet_1_identity_privkey, approvals)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.7501" x="564.38" y="6911.9513">content: approvals</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="561" y="6929.6573">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="903.8857" cy="6983.1283" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,6979.8783,2253.605,6983.8783,2243.605,6987.8783,2247.605,6983.8783" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.3857" x2="2249.605" y1="6983.8783" y2="6983.8783"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="911.3857" y="6969.2163">[34n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="947.4047" y="6960.3633">WithdrawalNonInitiatorBoomletNisoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.3402" x="950.7848" y="6978.0693">approvals_signed_by_boomlet_1</text></g><polygon fill="#FFF0F5" points="1919,6996.8783,2591,6996.8783,2601,7008.8783,2591,7021.8783,1919,7021.8783,1909,7008.8783,1919,6996.8783" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="668.8505" x="1921" y="7014.7754">Non-initiator Niso receives approvals_signed_by_boomlet_1 from non-initiator Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Initiator_Peer" data-participant-2="WT"><polygon fill="#181818" points="2961.5315,7064.9964,2951.5315,7068.9964,2961.5315,7072.9964,2957.5315,7068.9964" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3835.4918" cy="7068.2464" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2955.5315" x2="3830.9918" y1="7068.9964" y2="7068.9964"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2967.5315" y="7054.3344">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="186.9661" x="2995.0096" y="7045.4814">WithdrawalNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.0685" x="2998.3896" y="7063.1874">peer_0_tx_commit_signed_by_boomlet_0_padded_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text></g><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2255.105" cy="7117.6584" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2938.5315,7114.4084,2948.5315,7118.4084,2938.5315,7122.4084,2942.5315,7118.4084" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2259.605" x2="2944.5315" y1="7118.4084" y2="7118.4084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="2262.605" y="7103.7464">[35n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2298.6241" y="7094.8934">WithdrawalNonInitiatorNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.3402" x="2302.0041" y="7112.5994">approvals_signed_by_boomlet_1</text></g><polygon fill="#FFF0F5" points="2471,7131.4084,3429,7131.4084,3439,7161.4084,3429,7192.4084,2471,7192.4084,2461,7161.4084,2471,7131.4084" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="951.5354" x="2473" y="7149.3054">WT receives approvals_signed_by_boomlet_1 from non-initiator Niso. WT verifies boomlet_1_identity_pubkey's signature on approvals_signed_by_boomlet_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="797.1087" x="2476.38" y="7167.0115">and checks the content to match peer_i_tx_approval_signed_by_peer_i [0 &lt;= i &lt;= 4] and wt_tx_approval. At the same time it receives</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="444.3403" x="2476.38" y="7184.7175">approvals_received_by_peer_i [2 &lt;= i &lt;= 4] and repeats the same process.</text><polygon fill="#FFC0CB" points="2639,7202.5265,3261,7202.5265,3271,7214.5265,3261,7227.5265,2639,7227.5265,2629,7214.5265,2639,7202.5265" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="618.6445" x="2641" y="7220.4235">Assert schnorr_verify(boomlet_1_identity_pubkey, approvals_signed_by_boomlet_1.signature) == True</text><polygon fill="#FFC0CB" points="2592,7238.2325,3308,7238.2325,3318,7250.2325,3308,7263.2325,2592,7263.2325,2582,7250.2325,2592,7238.2325" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="712.2056" x="2594" y="7256.1295">Assert approvals_signed_by_boomlet_1.content == [peer_i_tx_approval_signed_by_peer_i[0 &lt;= i &lt;= 4], wt_tx_approval]</text><g class="message" data-participant-1="Non_Initiator_Peers" data-participant-2="WT"><polygon fill="#181818" points="2961.5315,7306.3505,2951.5315,7310.3505,2961.5315,7314.3505,2957.5315,7310.3505" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3702.0543" cy="7309.6005" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2955.5315" x2="3697.5543" y1="7310.3505" y2="7310.3505"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.019" x="2967.5315" y="7295.6885">[35n]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="3003.5506" y="7286.8355">WithdrawalNonInitiatorNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.6822" x="3006.9306" y="7304.5415">approvals_signed_by_boomlet_i [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="2950.0315" cy="7359.0126" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3690.5543,7355.7626,3700.5543,7359.7626,3690.5543,7363.7626,3694.5543,7359.7626" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3696.5543" y1="7359.7626" y2="7359.7626"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="7345.1006">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2985.0096" y="7336.2476">WithdrawalWtNonInitiatorNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.9463" x="2988.3896" y="7353.9536">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2266.605,7405.1746,2256.605,7409.1746,2266.605,7413.1746,2262.605,7409.1746" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2950.0315" cy="7408.4246" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2260.605" x2="2945.5315" y1="7409.1746" y2="7409.1746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2272.605" y="7394.5126">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2300.0831" y="7385.6596">WithdrawalWtNonInitiatorNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.9463" x="2303.4631" y="7403.3656">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text></g><polygon fill="#FFF0F5" points="1806,7422.1746,2704,7422.1746,2714,7470.1746,2704,7518.1746,1806,7518.1746,1796,7470.1746,1806,7422.1746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="890.8256" x="1808" y="7440.0716">Non-initiator Niso receives peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt from WT. Non-initiator Niso updates niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="803.7644" x="1811.38" y="7457.7776">with the most_work_bitcoin_block_height, verifies wt_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="886.3016" x="1811.38" y="7475.4837">boomlet_0_identity_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0, magic to match "commit", tx_id to be the expected value and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="672.9194" x="1811.38" y="7493.1897">event_block_height to be fresh according to most_work_bitcoin_block_height. Non-initiator Niso then forwards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="719.8624" x="1811.38" y="7510.8957">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt alongside niso_1_event_block_height to Non-initiator Boomlet.</text><polygon fill="#E6E6FA" points="2059,7528.7047,2451,7528.7047,2461,7540.7047,2451,7553.7047,2059,7553.7047,2049,7540.7047,2059,7528.7047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2061" y="7546.6017">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#E6E6FA" points="2064,7564.4107,2445,7564.4107,2455,7576.4107,2445,7589.4107,2064,7589.4107,2054,7576.4107,2064,7564.4107" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3123" x="2066" y="7582.3077">niso_1_event_block_height := most_work_bitcoin_block_height</text><polygon fill="#FFC0CB" points="1925,7600.1167,2584,7600.1167,2594,7612.1167,2584,7625.1167,1925,7625.1167,1915,7612.1167,1925,7600.1167" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="655.8376" x="1927" y="7618.0137">Assert schnorr_verify(wt_pubkey, peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="1927,7635.8227,2583,7635.8227,2593,7647.8227,2583,7660.8227,1927,7660.8227,1917,7647.8227,1927,7635.8227" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="652.1584" x="1929" y="7653.7198">peer_0_tx_commit_signed_by_boomlet_0 := peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.content</text><polygon fill="#FFC0CB" points="1918,7671.5288,2591,7671.5288,2601,7683.5288,2591,7696.5288,1918,7696.5288,1908,7683.5288,1918,7671.5288" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.4617" x="1920" y="7689.4258">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_commit_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2040,7707.2348,2471,7707.2348,2481,7719.2348,2471,7732.2348,2040,7732.2348,2030,7719.2348,2040,7707.2348" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.0244" x="2042" y="7725.1318">peer_0_tx_commit := peer_0_tx_commit_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2117,7742.9408,2392,7742.9408,2402,7754.9408,2392,7767.9408,2117,7767.9408,2107,7754.9408,2117,7742.9408" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.5703" x="2119" y="7760.8378">Assert peer_0_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="2136,7778.6468,2374,7778.6468,2384,7790.6468,2374,7803.6468,2136,7803.6468,2126,7790.6468,2136,7778.6468" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8452" x="2138" y="7796.5438">Assert peer_0_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="1533,7814.3528,2977,7814.3528,2987,7844.3528,2977,7875.3528,1533,7875.3528,1523,7844.3528,1533,7814.3528" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="1535" y="7832.2498">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1433.7062" x="1538.38" y="7849.9559">Assert peer_0_tx_commit.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_INITIATOR_PEER_TX_COMMITMENT_BY_NON_INITIATOR_PEERS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="492.6353" x="1538.38" y="7867.6619">Assert peer_0_tx_commit.event_block_height &lt;= most_work_bitcoin_block_height</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="915.3857,7935.5889,905.3857,7939.5889,915.3857,7943.5889,911.3857,7939.5889" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2255.105" cy="7938.8389" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="909.3857" x2="2250.605" y1="7939.5889" y2="7939.5889"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="921.3857" y="7916.0739">[39]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="948.8637" y="7898.3679">WithdrawalNonInitiatorNisoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.9463" x="952.2438" y="7916.0739">peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8371" x="952.2438" y="7933.7799">niso_1_event_block_height</text></g><polygon fill="#FFF0F5" points="467,7952.5889,1339,7952.5889,1349,8009.5889,1339,8066.5889,467,8066.5889,457,8009.5889,467,7952.5889" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="851.0845" x="469" y="7970.4859">Non-initiator Boomlet receives {peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt, niso_1_event_block_height} from non-initiator Niso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="861.9916" x="472.38" y="7988.192">Non-initiator Boomlet verifies wt_pubkey's signature on peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt, boomlet_0_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="862.1473" x="472.38" y="8005.898">signature on peer_0_tx_commit_signed_by_boomlet_0, magic to match "commit", tx_id to be the expected value and event_block_height to be</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="814.1387" x="472.38" y="8023.604">fresh according to niso_1_event_block_height. Non-initiator Boomlet then generates peer_1_tx_commit composed of {"commit", tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="782.9905" x="472.38" y="8041.31">event_block_height}, signs it with boomlet_1_identity_privkey, pads it with duress_placeholder, signs it again and encrypts it with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.8195" x="472.38" y="8059.016">wt_pubkey. It then sends peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt to Niso.</text><polygon fill="#FFC0CB" points="574,8076.825,1233,8076.825,1243,8088.825,1233,8101.825,574,8101.825,564,8088.825,574,8076.825" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="655.8376" x="576" y="8094.722">Assert schnorr_verify(wt_pubkey, peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.signature) == True</text><polygon fill="#E6E6FA" points="576,8112.531,1232,8112.531,1242,8124.531,1232,8137.531,576,8137.531,566,8124.531,576,8112.531" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="652.1584" x="578" y="8130.4281">peer_0_tx_commit_signed_by_boomlet_0 := peer_0_tx_commit_signed_by_boomlet_0_signed_by_wt.content</text><polygon fill="#FFC0CB" points="567,8148.2371,1240,8148.2371,1250,8160.2371,1240,8173.2371,567,8173.2371,557,8160.2371,567,8148.2371" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.4617" x="569" y="8166.1341">Assert schnorr_verify(boomlet_0_identity_pubkey, peer_0_tx_commit_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="688,8183.9431,1119,8183.9431,1129,8195.9431,1119,8208.9431,688,8208.9431,678,8195.9431,688,8183.9431" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.0244" x="690" y="8201.8401">peer_0_tx_commit := peer_0_tx_commit_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="766,8219.6491,1041,8219.6491,1051,8231.6491,1041,8244.6491,766,8244.6491,756,8231.6491,766,8219.6491" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.5703" x="768" y="8237.5461">Assert peer_0_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="784,8255.3551,1022,8255.3551,1032,8267.3551,1022,8280.3551,784,8280.3551,774,8267.3551,784,8255.3551" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8452" x="786" y="8273.2521">Assert peer_0_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="200,8291.0611,1608,8291.0611,1618,8321.0611,1608,8352.0611,200,8352.0611,190,8321.0611,200,8291.0611" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="202" y="8308.9581">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1397.7484" x="205.38" y="8326.6642">Assert peer_0_tx_commit.event_block_height &gt;= (niso_1_event_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_INITIATOR_PEER_TO_RECEIVING_INITIATOR_PEER_TX_COMMITMENT_BY_NON_INITIATOR_PEERS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="456.6773" x="205.38" y="8344.3702">Assert peer_0_tx_commit.event_block_height &lt;= niso_1_event_block_height</text><polygon fill="#E6E6FA" points="178,8362.1792,1630,8362.1792,1640,8516.1792,1630,8671.1792,178,8671.1792,168,8516.1792,178,8362.1792" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.7472" x="180" y="8380.0762">_peer_1_tx_commit := TxCommit{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.4551" x="183.38" y="8397.7822">magic: "commit",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7301" x="183.38" y="8415.4882">tx_id: tx_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.0782" x="183.38" y="8433.1942">event_block_height: niso_1_event_block_height</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="180" y="8450.9003">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.1743" x="183.38" y="8468.6063">_peer_1_tx_commit_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.2855" x="183.38" y="8486.3123">signature: schnorr_sign(boomlet_1_identity_privkey, _peer_1_tx_commit)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.3392" x="183.38" y="8504.0183">content: _peer_1_tx_commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="180" y="8521.7243">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="740.7666" x="183.38" y="8539.4303">_peer_1_tx_commit_signed_by_boomlet_1_padded := PaddedMessage{content: _peer_1_tx_commit_signed_by_boomlet_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.6442" x="183.38" y="8557.1364">padding: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="180" y="8574.8424">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="597.8965" x="183.38" y="8592.5484">_peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="634.4916" x="183.38" y="8610.2544">signature: schnorr_sign(boomlet_1_identity_privkey, _peer_1_tx_commit_signed_by_boomlet_1_padded),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360.0614" x="183.38" y="8627.9604">content: _peer_1_tx_commit_signed_by_boomlet_1_padded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="180" y="8645.6664">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1445.2372" x="183.38" y="8663.3725">_peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt := AES_encrypt(privkey: ECDH(boomlet_1_identity_privkey, wt_pubkey), content: _peer_1_tx_commit_signed_by_boomlet_1_padded)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="903.8857" cy="8716.8435" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2243.605,8713.5935,2253.605,8717.5935,2243.605,8721.5935,2247.605,8717.5935" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="908.3857" x2="2249.605" y1="8717.5935" y2="8717.5935"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="911.3857" y="8702.9315">[40]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="305.4092" x="938.8637" y="8694.0785">WithdrawalNonInitiatorBoomletNisoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.0685" x="942.2438" y="8711.7845">peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="1697,8730.5935,2812,8730.5935,2822,8742.5935,2812,8755.5935,1697,8755.5935,1687,8742.5935,1697,8730.5935" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1111.5785" x="1699" y="8748.4905">Non-initiator Niso receives peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Non_Initiator_Peers" data-participant-2="WT"><polygon fill="#181818" points="2961.5315,8798.7115,2951.5315,8802.7115,2961.5315,8806.7115,2957.5315,8802.7115" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3702.0543" cy="8801.9615" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2955.5315" x2="3697.5543" y1="8802.7115" y2="8802.7115"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2967.5315" y="8788.0495">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2995.0096" y="8779.1965">WithdrawalNonInitiatorNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.1647" x="2998.3896" y="8796.9025">peer_i_tx_commit_signed_by_boomlet_i_padded_signed_by_boomlet_i_encrypted_by_boomlet_i_for_wt [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2255.105" cy="8851.3736" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2938.5315,8848.1236,2948.5315,8852.1236,2938.5315,8856.1236,2942.5315,8852.1236" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2259.605" x2="2944.5315" y1="8852.1236" y2="8852.1236"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2262.605" y="8837.4616">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2290.0831" y="8828.6086">WithdrawalNonInitiatorNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.0685" x="2293.4631" y="8846.3146">peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt</text></g><polygon fill="#FFF0F5" points="2481,8865.1236,3418,8865.1236,3428,8895.1236,3418,8926.1236,2481,8926.1236,2471,8895.1236,2481,8865.1236" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="930.1635" x="2483" y="8883.0206">WT receives peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt from non-initiator Niso, decrypts it</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="801.9832" x="2486.38" y="8900.7266">with wt_privkey, verifies boomlet_1_identity_pubkey's signature. It then derives duress_placeholder by separating the padding from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.1725" x="2486.38" y="8918.4326">peer_1_tx_commit_signed_by_boomlet_1_padded and sends it to SAR. It also saves peer_1_tx_commit_signed_by_boomlet for later.</text><polygon fill="#E6E6FA" points="2163,8936.2416,3737,8936.2416,3747,8948.2416,3737,8961.2416,2163,8961.2416,2153,8948.2416,2163,8936.2416" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1570.999" x="2165" y="8954.1386">peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1 := AES_decrypt(privkey: ECDH(boomlet_1_identity_pubkey, wt_privkey), content: peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1_encrypted_by_boomlet_1_for_wt)</text><polygon fill="#FFC0CB" points="2518,8971.9476,3381,8971.9476,3391,8983.9476,3381,8996.9476,2518,8996.9476,2508,8983.9476,2518,8971.9476" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="859.1836" x="2520" y="8989.8447">Assert schnorr_verify(boomlet_1_identity_pubkey, peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1.signature) == True</text><polygon fill="#E6E6FA" points="2543,9007.6537,3356,9007.6537,3366,9037.6537,3356,9068.6537,2543,9068.6537,2533,9037.6537,2543,9007.6537" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="806.4684" x="2545" y="9025.5507">peer_1_tx_commit_signed_by_boomlet_1_padded := peer_1_tx_commit_signed_by_boomlet_1_padded_signed_by_boomlet_1.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="491.4785" x="2548.38" y="9043.2567">duress_placeholder := peer_1_tx_commit_signed_by_boomlet_1_padded.padding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616.7464" x="2548.38" y="9060.9627">peer_1_tx_commit_signed_by_boomlet_1 := peer_1_tx_commit_signed_by_boomlet_1_padded.content</text><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="2950.0315" cy="9132.1398" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3908.5626,9128.8898,3918.5626,9132.8898,3908.5626,9136.8898,3912.5626,9132.8898" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3914.5626" y1="9132.8898" y2="9132.8898"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="9109.3747">[42]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="468.4163" x="2985.0096" y="9091.6687">WithdrawalNonInitiatorWtSarsMessage1[=WithdrawalWtSarsMessage1]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.1191" x="2988.3896" y="9109.3747">duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="2988.3896" y="9127.0808">boomlet_1_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3483,9145.8898,4357,9145.8898,4367,9219.8898,4357,9294.8898,3483,9294.8898,3473,9219.8898,3483,9145.8898" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="867.3603" x="3485" y="9163.7868">SAR receives {duress_placeholder, boomlet_1_identity_pubkey} from WT. It decrypts duress_placeholder using boomlet_1_identity_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.8351" x="3488.38" y="9181.4928">sar_privkey to get duress_placeholder_plaintext. It checks to see if it's a padding of False or a duress signal, if it was a duress signal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.5345" x="3488.38" y="9199.1988">and the pair of the received boomlet_1_identity_pubkey and AES iv of duress_placeholder was not previously received, It calculates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="792.1161" x="3488.38" y="9216.9048">doxing_data_identifier by hashing duress_placeholder, uses it to find which doxing_data is associated with this user and then uses</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="759.6292" x="3488.38" y="9234.6108">duress_placeholder which is equal to doxing_key to decrypt the associated static_doxing_data_encrypted_by_doxing_key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="788.2035" x="3488.38" y="9252.3169">dynamic_doxing_data_encrypted_by_doxing_key. It then uses this doxing_data to enter SEARCH AND RESCUE. Regardless of if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.6623" x="3488.38" y="9270.0229">duress_placeholder is a false signal or not SAR signs duress_placeholder with the doxing_key and encrypts it with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="790.5564" x="3488.38" y="9287.7289">boomlet_1_identity_pubkey. It then responds to WT with the duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1.</text><polygon fill="#E6E6FA" points="3520,9305.5379,4320,9305.5379,4330,9317.5379,4320,9330.5379,3520,9330.5379,3510,9317.5379,3520,9305.5379" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="796.1594" x="3522" y="9323.4349">duress_placeholder_plaintext := AES_Decrypt(privkey: ECDH(sar_privkey, boomlet_1_identity_pubkey), content: duress_placeholder)</text><path d="M3526,9343.2439 L3592.918,9343.2439 L3592.918,9352.9499 L3582.918,9362.9499 L3526,9362.9499 L3526,9343.2439" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="161.9421" style="stroke:#000000;stroke-width:1.5;" width="888.7353" x="3526" y="9343.2439"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.918" x="3541" y="9358.1409">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="801.8173" x="3607.918" y="9357.0028">[SEARCH AND RESCUE [duress_placeholder_plaintext != padding(False) and (boomlet_identity_pubkey, duress_placeholder.iv) not previously saved]]</text><polygon fill="#FFC0CB" points="3702,9367.9499,4139,9367.9499,4149,9379.9499,4139,9392.9499,3702,9392.9499,3692,9379.9499,3702,9367.9499" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="433.0953" x="3704" y="9385.8469">Assert SHA256(duress_placeholder_plaintext) == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3546,9403.6559,4293,9403.6559,4303,9451.6559,4293,9499.6559,3546,9499.6559,3536,9451.6559,3546,9403.6559" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.9922" x="3548" y="9421.553">doxing_key := duress_placeholder_plaintext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.0063" x="3551.38" y="9439.259">static_doxing_data := AES_decrypt(private_key: doxing_key, content: static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="733.4082" x="3554.76" y="9456.965">dynamic_doxing_data := AES_decrypt(private_key: doxing_key, content: dynamic_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.5255" x="3551.38" y="9474.671">save(boomlet_1_identity_pubkey, duress_placeholder.iv) (nonce of encryption algorithm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.6962" x="3551.38" y="9492.377">Enter SEARCH_AND_RESCUE_MODE</text><polygon fill="#E6E6FA" points="3354,9517.186,4486,9517.186,4496,9565.186,4486,9613.186,3354,9613.186,3344,9565.186,3354,9517.186" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.1313" x="3356" y="9535.083">duress_placeholder_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.3853" x="3359.38" y="9552.789">signature: schnorr_sign(sar_privkey, duress_placeholder)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8742" x="3359.38" y="9570.4951">content: duress_placeholder</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="3356" y="9588.2011">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1125.0078" x="3359.38" y="9605.9071">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1 := AES_encrypt(privkey: ECDH(sar_privkey, boomlet_1_identity_pubkey), content: duress_placeholder_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="2961.5315,9656.1281,2951.5315,9660.1281,2961.5315,9664.1281,2957.5315,9660.1281" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3920.0626" cy="9659.3781" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2955.5315" x2="3915.5626" y1="9660.1281" y2="9660.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2967.5315" y="9645.4661">[43]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="267.0722" x="2995.0096" y="9636.6131">WithdrawalNonInitiatorSarsWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2998.3896" y="9654.3191">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1</text></g><polygon fill="#FFF0F5" points="2465,9673.1281,3434,9673.1281,3444,9721.1281,3434,9769.1281,2465,9769.1281,2455,9721.1281,2465,9673.1281" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961.7795" x="2467" y="9691.0251">WT receives duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1 from SAR and continue processing peer_1_tx_commit_signed_by_boomlet_1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="918.7755" x="2470.38" y="9708.7312">It verifies boomlet_1_identity_pubkey's signature on peer_1_tx_commit_signed_by_boomlet_1, checks the magic to match "commit", tx_id to be the one</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="879.9058" x="2470.38" y="9726.4372">expected and for the event_block_height to be fresh. WT then signs peer_1_tx_commit_signed_by_boomlet_1 with wt_privkey. WT then sends the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="706.7194" x="2470.38" y="9744.1432">collection of peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt [0 &lt;= i &lt;= 4] to Each Niso alongside it's respective</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416.4554" x="2470.38" y="9761.8492">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i.</text><polygon fill="#E6E6FA" points="2754,9779.6582,3146,9779.6582,3156,9791.6582,3146,9804.6582,2754,9804.6582,2744,9791.6582,2754,9779.6582" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5444" x="2756" y="9797.5552">most_work_bitcoin_block_height := rpc_client.get_block_height()</text><polygon fill="#FFC0CB" points="2613,9815.3642,3286,9815.3642,3296,9827.3642,3286,9840.3642,2613,9840.3642,2603,9827.3642,2613,9815.3642" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.4617" x="2615" y="9833.2612">Assert schnorr_verify(boomlet_1_identity_pubkey, peer_1_tx_commit_signed_by_boomlet_1.signature) == True</text><polygon fill="#E6E6FA" points="2735,9851.0703,3166,9851.0703,3176,9863.0703,3166,9876.0703,2735,9876.0703,2725,9863.0703,2735,9851.0703" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.0244" x="2737" y="9868.9673">peer_1_tx_commit := peer_1_tx_commit_signed_by_boomlet_1.content</text><polygon fill="#FFC0CB" points="2812,9886.7763,3087,9886.7763,3097,9898.7763,3087,9911.7763,2812,9911.7763,2802,9898.7763,2812,9886.7763" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.5703" x="2814" y="9904.6733">Assert peer_1_tx_commit.magic == "commit"</text><polygon fill="#FFC0CB" points="2831,9922.4823,3069,9922.4823,3079,9934.4823,3069,9947.4823,2831,9947.4823,2821,9934.4823,2831,9922.4823" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8452" x="2833" y="9940.3793">Assert peer_1_tx_commit.tx_id == tx_id</text><polygon fill="#FFC0CB" points="2129,9958.1883,3770,9958.1883,3780,9988.1883,3770,10019.1883,2129,10019.1883,2119,9988.1883,2129,9958.1883" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.8981" x="2131" y="9976.0853">Freshness check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1630.5132" x="2134.38" y="9993.7913">Assert peer_1_tx_commit.event_block_height &gt;= (most_work_bitcoin_block_height - TOLERANCE_IN_BLOCKS_FROM_TX_COMMITMENT_BY_NON_INITIATOR_PEER_TO_RECEIVING_NON_INITIATOR_PEERS_TX_COMMITMENT_BY_WT_HAVING_SAR_RESPONSE_BACK_TO_WT)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="492.6353" x="2134.38" y="10011.4973">Assert peer_1_tx_commit.event_block_height &lt;= most_work_bitcoin_block_height</text><g class="message" data-participant-1="WT" data-participant-2="Non_Initiator_Peers"><ellipse cx="2950.0315" cy="10082.6744" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3690.5543,10079.4244,3700.5543,10083.4244,3690.5543,10087.4244,3694.5543,10083.4244" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3696.5543" y1="10083.4244" y2="10083.4244"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="10059.9094">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2985.0096" y="10042.2034">WithdrawalWtNonInitiatorNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.3854" x="2988.3896" y="10059.9094">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.3955" x="2988.3896" y="10077.6154">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_i [2 &lt;= i &lt;= 4]</text></g><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2266.605,10146.5424,2256.605,10150.5424,2266.605,10154.5424,2262.605,10150.5424" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2950.0315" cy="10149.7924" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2260.605" x2="2945.5315" y1="10150.5424" y2="10150.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2272.605" y="10127.0274">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.7362" x="2300.0831" y="10109.3214">WithdrawalWtNonInitiatorNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.3854" x="2303.4631" y="10127.0274">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2303.4631" y="10144.7334">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_1</text></g><g class="message" data-participant-1="WT" data-participant-2="Initiator_Peer"><ellipse cx="2950.0315" cy="10216.9105" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3823.9918,10213.6605,3833.9918,10217.6605,3823.9918,10221.6605,3827.9918,10217.6605" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2954.5315" x2="3829.9918" y1="10217.6605" y2="10217.6605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2957.5315" y="10194.1455">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="471.7444" x="2985.0096" y="10176.4395">WithdrawalWtNisoMessage2[=WithdrawalWtNonInitiatorNisoMessage4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.3854" x="2988.3896" y="10194.1455">Collection&lt;peer_i_tx_commit_signed_by_boomlet_i_signed_by_wt&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.0534" x="2988.3896" y="10211.8515">duress_placeholder_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><path d="M779,10230.6605 L779,10257.6605 L3938,10257.6605 L3938,10240.6605 L3928,10230.6605 L779,10230.6605" fill="#00FFFF" style="stroke:#181818;stroke-width:0.5;"/><path d="M3928,10230.6605 L3928,10240.6605 L3938,10240.6605 L3928,10230.6605" fill="#00FFFF" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="572.4945" x="2068.0455" y="10249.5575">From this this point on, non-initiator follows the same steps as initiator. (Withdrawal Diagram)</text><!--SRC=[xLtjSzisql-klmANVAZLAXfBjjCa5tSUnN4klZPEnbBhvoR9S6Y9jZcHI9MaOdlI_E_FBW2I00c0u8kSt3qtSzEB9GXOB83T7nRx4d_oWxKRkIiIUtzkl63klV7YsBto9al_AY1BxpBf9NwozCXf63mw2Vp4TvCm8kT-Shs8t1jtIQRyX-IbxrvXJpluPRX9o3Hn4o_kzox2M_BWzzYBoDHVU0_8G-XyxhrORhoUEyVUw7SFV_ElhfEZEpVe0KM9F_VNRf2GapZaNz4VY5-z2CFLqalur-_yu9FqzNH67lxXXz12-lZKpthyH-HvGSyB5WH8b1gTpqWOBO2gfq_9mpDlmURmplEY6EW_l_OJcHJWZfDnnw7jU0UZtLrvFb8heP6AZEdaBEzdJ1x-orikmnlI-u44titI3xoOk0cPXylDAeZ9QFpafxtTmz71am4P7pp6Vu-VF1wGlIVx-E_zqVw078p6-E-3_N6lzzTVV_LwGPXu9FpiiLKOq25xpoz-UJSvcxmvdXsVJKdl8Ncuy2vXE39x-zlnsUJqwDWvENLU_FRswDUfy-hixHjdzh_EvDsxixT_J7vpNlmBlZsPdKncRy-STyV7PyxiRR41CBX1j-SpxEhi-EZuv8-Jqt_Gl-KMfszF2uDF6unJxaKULp5ADnDKTgmVkV3hjxFNGAcYZovulTsHZzw-UNCoUtDyEbDldvoEudV5ttP6HCDD87S2N7mzeStXOC6Ff-_UdawFdHUJer-nDzWbX9vyF8Qzdhj9mc2pkg3ddJo0O_X-T_VZWnuS-6dYhU73Nb5-FFe5XDKpGg1jBfHHnfqdN9IFo8U0hA6ni-iajuwxNaVXPtVfn23XlOLpSUTSC44AtuCWZ-xMIV7ZInZk9g7zn1U9q0f4pzAR9tuOF2D7sR-V5rgL-ah_ydyXxtV9yqFYut_sFuhY26Vruu_dinz__124QozoiUUOnDVXJK1y_5-gZ1PCyGnpDerwAC21DGgvNEJLUGADiZR8EP5lDuc6PvmTLcnLC4xF4l9-B794t18ZrPR8vmgaV-UJ6_MkymNcYjZz3FlVYq2xnzT0FkACV6bfcyYRU_vdq7LV30GFBCaTs1Fx5QTs6OKhs8j35M4m2__I1yA0hlNcufDtzmDiK1ZJJJOHpDB8uG41URG0zGv8wURQdr_J2H0_9icr9-pkYpko34F0QLUewu4YwMl7Nq0_td91mil2Q034FC06GUmZVc3S8MwX-_wGd2JvH99h60CRv2o1NmS00U_u30bq1ekno7XJ6DIxzUCanWEAtSG0pu0mEhY_Y0LvCS1neKcG3wuTiyXLkvKU8ecALPjVU_DFmbHNxfK_HuBBtH8NH7DXWYitWRLwmFxs5Wy6j1De0Ii1dLo4oJL96yVfSW8biRloL9iKcrn6NWo_ciy1w-529s5nL0KXwj-jmZXnRiBeatFX9_FG3voBPJZ_v5nxY7WfJrB6Yumm_unSmxvPkt4CwxxobruCCidZBNRPDa2sWv0Ehfo55yyZVutyHghXIDsuqOBnWHzbw8M98IJ7NOR15MvI4i3oE2F70ucGoEF3nEILvDX_g1Se84ig9lNia4JhkJDV-Z3UyCgJnzpfb_l6EmRqEm56H0c9vz0WYXowWUzsCY4mC1txORQJ- -JmaCoYZMUUHEHT0VkCNS8XJt0AabHm3GTgg9tQ4Uu9jYNq8Y0_u_cgqrjaF5ISz65DFch7jHNnjLciE9ImDom7uymlwrFimsBLy8VwZGzzLEpYAkwMfp5a4WzOaqknoaMIPzAe2mKbJ6mU5Xd5FzTs21Zd5Oe-k037J8mX5zMKAfZw2p3LlTrHq5DkF20x5GlmQBlNrtw_rjm0DQxyOCTkSkIdBc_q_K75NgsKg1MSXdKh2HoLtXcMTPHP0EI2ayilzVbFfLiEliSzsXV2RwwHIbUn0lxcpRuj33VA795JkOdD2DFJPjyAgG-C4_hA44eP2WurqsY9wn4PDu3sjhY-Dc87UbBGtWQn3xUEs2aQ1CYuyEYInpKsz2P6BcP_2_J0n949BZMl5idLxG0EZUbjwnwl2NX7IAze8BtaPKDc3DG2mUeECR2xGEYn2CvI_oqG9jmITg3pfHjTmRO73WRzyhL1ntgwms8Fpm_Ec99KFhbA8RKTU6wKX_S1q8lpspP6j-FdDc1w5Qk_EL2dEnAQJuwd3fTIErp2F2F7HozVx-X5q42_Me2S-23Fx6LUtsBD6e1_JKyryR-E7fZSa4arXyh27Rhssfk1KjgPRmqcAept1Zl431Xqfng5F-eKLzScaby2jC9wK7sHw3VcO-VtBxtE-U_LAxzwQRba8oVqB6vrvyhkINkzT63TIuLuJ-9jYyyLA3pQFI1GyQsu30HAssALyPZs1ZWdTXC_llJTYwN7uIj3RPa8erWmnUefkDujONgAVE3EiDvmwCjCe-G6c9JV301QCmMEdPV04JxYLnfYhk-0vuddu1Wx-9y- -TiXETqibvKcd7hoEzy0-_b56KcikYM_fLp8LXt_ltH75sdb7YJ6hK3Rv3TK1gTBlVBBOb1vMQJTqINp0z3BgrZn6rniFu4LSwyYprkbw0FNazq6X2DoqACzsfmF_FuaI1b4LV4pyk0cQ-i09KvXPgcQTc1WHsYAR7ZGybck0mgKRAURMJKqUmNJSJwxIOG4Hfnxta9Wy-EM5fknXkLiYkaoq_dHcJdfayU3JkmgZKQstjFI7Imp6yHSaWctK7Une5oVUyXbdzqDEMYDyM-wnsCP1hERJIRfs1sFTis8flsfeU-8Gj-OlN-gBuHNKRXPa-dCeI9wX_RRhxfGi8dX7K8Xs72i0dNOb6y4t32d-DaNR9Z1T_eBPe_2BvyHq9FOsVlDax-JlV57-EQhgkUAUVCx1sz4xnmemUtk7Qfr4AySHLhw93ylFxVKtEFwasqdZMeoLd4oqWbBhvU-mX8ndGc2vKakMAQpAfaobGp0pTc3Fevcva2B3bcZ4XemGcQmgx-nWQbNA76A1msPds8Xr9Nf9PngLE8FlI4_lDKGI6IIUEQBOueNVTN1htVfvxQGM7KaJOVFpAz-lk6UzgOpAq0rJGGuLReZruTEWZOedGVL3rFC78B8JqsWEIHcbaxultNaVVR3JRoyozq4w21CbXOFF6uGglLm2-HQHGq9a5ENvDeNaDYmp0GPwsPM1eLko5PXl9l3DlEndoOj89kBbq_O9YbZ73-cC0eDnexB_erNBtxrS91lHfHNJt1y-JO4vmvOAbm8AuvckZWth0kdQ5168zf3IhSIHoFKHoNUB6tipYgv8Xxat8Z85FWqjNU-3RZq_u9-GUcdpp8BAtwq4wjrUKbNby27ABLqO4CaJHOuyBVyibA9F6ApiRCMyf084s38U9GAkoe4CYsP3LfClcCaKeFhLjAL3fSXb9RhBDWQy1HirWjOveNP9olu3dooXBvRkD7aG6xSzar_h-rARFrnlWLnWyfdTXLWB3bYfZHbmB4DlohVVZd6h5eMnGEtwkPKVDisottKBHm0-PUfBsX9JkT-aHmNPUSGmL6CPq73mIilGDzuZri5HzB3rZnShKDyZWNmyqLwYyvlgThb773r2lgpYiCARPizjmhQDNtD6LMyrOrC6FYcrfDm7VtSx54lRgFYp3kxN_zLDbPUGipRtl8TrkRjnpnGUhywBD-zC0YcQW4TnGw7PPlTJlXVNqHidJPvCCXEd6YTAM_uPsRd1Wga7BlzMn_jcNQOOb09zQdume6VqybvQsLyoWI1U2WiwHBkMMrVaFQwaZujNw2wM8zwDgjpmKer5jvXpYkjL8eGiWwPTwwuWfxFjiygdDaWHnwPUiEDoZVj1uMFsyZAnwsIte4c_YHL_AAMJkKMToR3njxjsfiZBeVkDynAbePIm59VU2gFBZg86NPJytrPx05iA7dBK9JaBakRsg-OkQzUAT-mKYoE6ccBlBNdSljYwYS7m_WB6XN8dddYU8ZxHtnR28dd0kFaNgalfajovoUSfhjSaX1-ohwEVn1yyxpRkRSkk6V-mCYYpvBGL-pXopXix7GjsFYgGKhT2_UkWbiINpgPyg7k27LxjohqRA_s6Xb9ywCdUK9r801AaxBoQHjfVDegYQd0KfLSpTpPgaVYR3BFhzoNodEhTX-PQRHaJHP-NkriDR9q5Eek0gEJmFw-ZVjKxRa-hpPH2B70utqX5ZXJxi292z9J9QDur5JXjnNhscZcyO4Ycdbya4OponDGn3KNh7nYzBaLtHXwVlZSFto-_x4Y22EZZemVTn5OFcvAxqZ7oiSgLZx6tT0eEBmR0jlvbBGT_ginSfjPDsFpZI-pmIonRL8PMliAUeUUeZiYlOtmu8z06mLTWfg-0cgATySCRLOofGxQp9vJ0KMMeUP0CIBtnb2ZJdCSWIAyMQIq7AaG9pwW9peEHQ12MB4VDzolbf77_pbMRj8m5DVNuA5A7YlmaAsKIF6HhyH7rIEdngOsmwd0KhiEPUHKrPSral8jaLGbRkaot7LBoOpwVPbjo8kK6PRSu9xQvfaER1pzVxhdV4h5oMynH7fxSSyDfov1dfzJo1E8cEVdeENZtNupLLBQaDjzm6iBZkg-uk7x7Nt8crmcr1Cey6vGpHi2J2upC6I0FqhRoa1ZslmlJ6e0awWrB7yZN01RufYvo3hnsgKk8Zn66PsZ0k96aNk7nge3M974kyBBuuMNt7ZGpuWIC7fwm1s0NQCBCBMg3iaCAL2lQFOgM2QhbWDX9_6XzujrjD6DdS8Tv2sxwXZs6RtcP0_GT1SFYMriOGkuPD-jBMYg7-xN9Mxg8apjkuTC1ed_VQAbZdQB7MBQHgHYKx34uY54oLebVnJA0UJFI_efZJcVucTVw3Syhk7zQ3W4VV3tWu_zhvM2N1ay8JvagxMJ9exYQrl5iTMG2YDXmhFsaw3bk_P-IpQqCzEruJ_5cLs4NeoV1erYByOTigwUFtLhjbMzQESURos60fGN8zIWxvYR88dkiXVLaBcoiSjObZj6SNu1wS9dwp2WU9S1OJ_1Ly_rjGkuqfy3oe6Z_OcvYLs7DzoYnt2eChY3tYsk_HMBAC2h181LHj7AvA1TAPoARvVLui0soAF5AlJLguZq6dlD7WZJOxAt6zID6D6Sa7RX8ugvQBoTJounBiJ7O8u4BY6uW-QX5yq1fiBdDtZJuUi_odOeR4MwGrbITDmYC8N8MozXfoMUj4t301qhdPZB6p-WmKRiz8ZoPMyKr0po4Fb6RmLBnmVstBQM669djX6pK-uJCOyyyGueTYMU0-OCmnrLsKSiy5CHdcFSWB9JwAKkp5xm3sMihugpgA2_Ca9JnKexcA4Picq0HGU2HKDP3ZJsna6Z28fns-btWY-QCLufLLJGuaEWU-F9sBVNrh1uq2KZcneEksQdAOQSFg1I2Ur688_n_3CptyAVUnGoA1G10nof06AHMFWNytQ3fP9cG3M48D7PfwWmHCTt8VzocjqknIqyrLfP8GpIpzPB8EiwN0AFyTze4hjDsCGkKd9X61UqpcgTt96rkw18X_gItVYnnnpYMNDEoIAyXIOE3OQt6YPR5vhWsVs4qJcANngZ-NCROEvwHgLYpYYZfObzAQVhLvWeXQ01RT2Ta95FbFlACC-XvQNLe0tgexgQbxn6nwbvVYNpg4CsxyCgTCYyxkimLuqutrUGmvdrKH1_wiqElH_ZCOVbsP7w7AZFPtQ8G5bxFdFTJ0_V9Na5-nic5WdjD2Iez7EdsqCvtJuh-q6DD5Mha1rOgSP6-PZ-WbDvRt6AfKDST6RxIAXrC1jq-_4DsL1IL8CefhxcaQ1x-sqj9bGJ6wVN3hEOELVVTrzuzTnJ-Spj7JGe2ZEMK-k16bZvYR8a31ug-AnsjHWrtO54UD0e6c5SQm6hmWngBnS3FT15_H01yrWy-stsm9SdlQ1gF-5vXDkgw26P9BaNVUAlA4R9-27nDWlV5xeV5xjFdVEpFbDt_Avyhuriit2vbiSrzoR4gBKNfPPdG5KyhkCZOIWhjFT49LIUTE7fkcSjPIH_snh4rN5hRKXD-tYlEiDrwBPQvTvKdUQyDlKqPgb1Ld1zzmFkYf69m0UiRQKdHXgWe_RfL3jZL7duAfQ4Ngx470prL_pVg03Ejt535L9tr-PkXNemr8BH3o0ddRObH16mqrKr73q9RQTlErNRsHNx4bn6-BcktOC-6Acc4wtOwJPS8hTQux9VSpQLuKQvjdtQqlJvk9bOtBeNPGFjrcdoawteNvFoLJf7RbN_QfKlJUnbxmnfQThC8-suz98JeCYKQz90VBKtOGxGufGtBDjxXAxSAzSFr6bIMVIPEZrgSKRA25Zj5TqYaKhxQXfTgsHpuOTxqCeTrhzeh9XjcD16DrVMYx1HpxQTw3Lqmm8DPYNTr0llUzFFpRIVd2WdtocpsoFwxoz2ZfnC87QH8QUOS4OliBQM7eSDgKkEmtbHXr8kMf7WT_HVAQtw_fL9Fn00iSS9rRC0abIJec_0LWCr_O6HvIREucgG3YPVFuLHD-cBgdcJ0UdztPOl5u_bD3nRu5DNoOssiOJDinxjZxgmiUx9EH6qK_JrKsoSB65VLVeTfzNW-MJlNdUHVPQdUzepPMVPr6Og982g-RQJe_QqOe92o5_SfNc2Kl-MzBqwpN9THsuMlIUcaxCyCrFish6MUkLWTWDZMg4ErD9MiW9jOSDi8LrG8ogRvX6oGZ9jQHFIvAlTAMeCC4pFWENshzjzqGbwVvm-7S61YKqoypoPkb6SffXvVoW-C8dVwDnAX8UGqlwGl5k1ZhA8X4y5IvNAig3jNCXySY9as5MGg4_hccTkfPvpKJ6LhicrXGuhv_ptqp98IXSTbtT7KdyVsfpSk77ng_I9d0bFFqhT-pA7PFDSG0eH_pF-IC4C70xzp1L-pZHBoznTpZSq4upWmxTm4vSF1Tg2olXhDxx66QhMR1DxgRp62i4yy5ReYmRXnd4uzsdoRVwK1nzkqF-SJprW_QYtNHRBw_svOJdaSWye-XVR3vHjmaXn0cffxeZJaWIbq0dV5Okxm5tP_IHNZvHmEY5nqXXL4c1W-VHuSdRqcanENvApu-dHxyT3SaQhgovn3s3fZyoTKp5rv1svfBkARnVgSvxGmyGCSIg6fS-bXIcgp7JQxPNFa4Uxn0o32hsNJuoG6nTEcEmj21z8xe93lSZ8_VIqZdMeVbygrQzmjYrJzfV7wlV2DHeWq0xm0Ys_fMKaxuqK_kqmbGixL2ZqwGBa4Tb5vQfmVVK_zukd5q7GucEPRx9AdxwUZ0yUxvXzzT2RKddWpQkIRwZSTLBD0PIofHDeT5xDEnVMnluKKtEKwWpN7xI68EWpTVBPCq4dpUhkCCTM40AySymVuIwlmWYEs8hsV2m84GTsdyDsd_FcxSlZOe9fcpCa7T065Jp4iwKuDggeb89LIECrMqToc4qVNPn_cHp1th7NeroklfyYdf9p3xQST9qRQ5l-KhI5AeOwxm6R_62J-S0X4h31g_IPK9KBhaRQOOFzKNGgj7xFmz83Q0TEd_MubOMzzHczQeH4l5JjMY7xmXsybCoNwNqvewwLEKPwLPQz8u7cOumMP1MbCZyS2bPHa-D8dxts6zA_nxIzsxoojhkNsbxUwkQsjNchilXzbrbjxysDf656MxcJyvdpUaARWnn3hVdkxUdqs7anEVeLUrEK81-rz2x97VhtzxlmDDNdxR8K3ByK94Fx8r_mb9RCkVigS-v-8w_Mxs_cepfpBURvrQVv7Sis61qxFdvt_DZjzUHu-G57dqTtRW3h_0e11BqKq_-iuQma17F3oeRhIvWJIu_0tUnZu2IDOSpQ3CbEpYBoqdUl8dVLx_qF2EJrPhNizU9FVa2Bk8DI_NC3L7kSRPCb9dfOUfT93vJ2qgFlF1b_YT3hbFymxPuD6MxWAfMWTQJVkmXloGCQC3y59VE0F8JEvnxU37lkFCi7mEwBo88UK0JN5d_jmhnFwADJUfMKligVkl5hbCVIrnWc_eSVGWlfO_wCXJ_vH-Hv0Osx0XAbHhWP8yJSJv-IXsVUWis1YY2W__pQJsHIbCz9j8FHxguydq9eJjP8HGQ3oxp9c3pybuTB3hBohx_-Kc-Y7foNTvEpoPlZ6KXsqdj87YwyIn-Gcss-eRBoA2KaQj9jCOqH_bsPwwh1E9raT2UT3Dn9ggukUBtTaRVg9jECYFi1GOJ5RE8nx8aQRhGhQhZwiNWZsJ_MaEQl8kIEzeELt_DM-NL92Xujj2hr9MN95z-aUo8eVaP-_F5yzkEF7u9mZHwOq7DCS_ZGiYYvvbemJJ7iTO7qHXNP-ksPgM2NdX7wj_cHz3RV1C9zcocr37FzOY1uO4dkm9xOl1Qm9ZQgsflQI32-nyHOSPo_eB2ijN6X0i_57Lc6uIUqwhX9MeqehuACPR5zRqdTZGkvMNVEQJWdcXSYpfqq_KJs-_vGCW5boMYrhgRStM2HyQOmg7VhnqcMdeidlz2L8P0hNpO8uZAjjC8DdgwQEk-kh-fMbH2Ncx34zBnfCMZiv29CheL0SZyMau6eDYasKVYbAzBmbbFlDeWdOpO_bfr9O4J5rVaQzitQZT6jVUKllJZ1GjginIxR1iXs4CXeZVVYUUIlaT-IavJqQffMhSBNrN-VM3HR_tJ3iLUOiyoJYEXhfB5BRhiQIbB1DHoeeNPgDEacsn9w4P2VyNpLwHKl7YfE-d0RuMV6Wr-NnOf3AVcv6mSJN5CA1nJwi5WrOz1H1u6DvMceSYPNBb8XeBz95mfACljdeNls-HOh3M26PGKzswrEqUY2sk_NcXjFccmtkHhPaItkxFr1nLwjbAWLd8PrAmaSbTuPbdMKMG3aWfFBB_NvJwLRhsLquZS2tziFRxnVV5vHJ9pXabFhx74jqJpYuGQ0tXRDryRf7u8CghV1wSEju_JKmovp6xJVq5L5ucc_PN9rEu03Odh7kiVB0RMiyuiPFe1BouRC6AW5WjNDOM1tRJ3N134c_n3k1ZlG-TADhZnyiNU3VlcoO8ogvV6dCEFEIcmq1kLL0MzRX-N5-MqRcNSOWbeJdDi7eNuZU4vtPEsGWgABqwx9nSbQvlLhHSDQutLDJpLHluuUcDoGIJM7oi8TklRQ-u1Isfdl2Xr4-5PLsgZ6teywHTErYQokbr9TGtYxrKhgtBgsKTZaF-_2fUMIZPpGixZLJQjboEae5Raj8qDHQ2kk0EgqsrM6OjeR5Zjp4p- -zDsBfST1AyDgcU1AwxVHNwMGUhU4v2dU2Md50qugDOCoZyICZX_YrDsGUKagCkzNNQclxnQOgCJ1CNRmFttqVJ_TB9ULvffwKbku55VLUi26hDf3jjRu_wLRUBkY3ryOT2xr-jKshJZjZYwK7u0ENiMAtz084HfdT1LvtYf56ca8Hd8Bno4hv51r5l1xMinXH8IC2JTPMqSgyipcaofY1uPpXAOu-GSjdziweE2hRSa8EZHxtTBnExihXCpLsLiCsrfYnXf6iucbIygIIrE8bZvWFEZ4Nj9evAzrq-9Jbdx80uMPh19kbxIoegck8jtFiJ48YNjCOzVsXOLOSHxLHO-L4flEMDxl7Tfll-gYm2Q6TmE5w4hpZTGgt96d9j7Kwk014pNdlTKwO4LQ-gIjHXxNds8xoLEJdVNID2YgUZKfvJLgnvHwjNZQCqGb8624pEXMVnFpkDpIeKAMfyX6p2XDDINnXzum3_ke03I5CZpP-IwEALxMLOUyKIw0oa8uzVZLxzKjXPNli7P0I93tvO9NYX_AWTJirpciPJPAZ8PML6TAqqeeW19k2whNSE5plQ5MzSYfIqABigMgS5XcWenNC_k0GlhtQbRJQWR0NBmimfR8KfZxCGL5QE1rNFPll2hnIuE3t39Yjdf2uikt8JXtarAXF5Xd5f2L6SArzRgqgG_pSFeyBeiLwh6m4wjaY7Xe1Q_wf470fLf7btHm2LI84ae78aJIsbRyYit6oLg8GY8CuKMJCb-ZbbFk667KuBML9AN3YKcwsumes0PmxxESx0kplrJm7vExk_KjRwyj_xV-SDw2k8up16U0i0s_AjzbysAnnc4KZy-nHNooMSOB1K_ot1ubcPnxAdBaavq-X3zO54fttLRb1iuUdUJimE8xSNxJr2wdaDktYiCApPezXGgQL4g1P7X7iyZgsw2GMgKkRlRW5hTHPorAgAbVJ6FbvSAyxItVI6tUPSm32QLdYWsBsIigihwApwgpsmd_wuk8ezCc7IL_9SMSggRzkxL4fUcWkWom6L_AEM1RdBTM1gIg_A8cklfjRKbxNScShlA6jbY51kb1csJF76s3PVP9ChjbK3aN9bDbGYRC3q6hd2GcUWUQw8zKoOiQEPLHtAbBKsuW3MJG5lYfBekaAri04A7ajP8dt9HNog-OULKQMCLAiH1ZiTeQ3pwY_cemZB-WyNTPxRLYzfIGbKMNUwK-aMuXfugxNBBojVJh-0V1HywxdNlhWfla3t6Q4Gxh6wGfJhriBTZuga5AtGitgu9x45ywcV9xpAcYJ6fIfUAsalIqkG3OGg8O4p5DKyMKtCggHwgPBiRaGLMxZowJnbWux7GN_z19u7pVnesfzboVLniXXFZRiPXWH9MOuL5J3TzMZcj3XiS7Yf3XOYOKGogKaJR7YObQZEK-VEuVFcT9JGp-bfq4Qe-R4ZdISUrnsq3hRaXgvyVHTlYl7LQ8fEbiayemrLVGE_GKtH7f1OE7L0JQYE8ISFHjYr9LCgKETZJNgHeeHkI-46eCQVRELuGAYvIM_V_Zn0SinDFcdIHYYAuVDzolbb6ymV_RYfBQ3Jcmt7yAT6Ch9LAquolHJlN8gPcepN0gwDEkGna7LVLbZOjyIrnKYKAw31tTKkgVVbzc6qtHovbXoGtk_rnL-TV2VVwdUyu-L9py5iEDjnT3t73g4iZvMIeJtkwjRR-P_YZjmks-jxL5H7KVtV2vZRwxJIuJwfeJU3Uesmsn6fSP0Z9W7gLvPA2nIVuN6pN0HeLodpmj8-t3YTSkzTx8Ao2u0N6ZoBr3UzC1mKphLtWTlF2I6m_w6L42HayFkC-jQ_IwfORH8PaX1UeLpHxnocJLykFh9DJoVW6EDb2mKuo3l6Nt6yC-etURxBsOxk8XiGtJQu6HxBkrHKhr8-Uw14jTH7nzzpZ98F6_JuZKqMwnWqdR2FfhYf1O288eMQlaZq8vWFnvIJ-buTjJ_EmB_OQ74hmV3OUW3_v-yB7_jLAGA-CL51KT2jf94xhmjQtYs6eKWv6mrg_G-otdtiuWruRf55pUUx33k4D-rNDgRishgkVdt1MjnL03B6o5wQpnqN4J9D5Tzlp9wuMnkrQMS4LnKW7JyafEl3WTHONuHBc-TW51-dF0Ct28Fp7_hMkMc1j19qMSocWAUekuzbVCcHyl3G1B6KKhavTqfHZIrkjf7LNHOXNwwbKKIY6fUyrBzjMCqD0SYtRX6ee9Q3oEJoun3iDdHUGkFDmsyz2Bve12uVCRlCZmHHzbsnBs7zsMS8VShEWU-u0LnDPBs5w99-tDC40tHoVcaiKFQ4WFh_qv6zQDgH2PnOgbEJxmvBQrR10ximqtdN9NXNdaYVSwiIjnnpCV5UuhoZvYyPEA61ZZLfFzCYzryUYbMgjLOGqLz5S6EgfOQGSTD4EsZLVeG8HeAEitYrSOjvrp9vYX6RULyaC55pu4kXUQbcR1WowvrzJirpKFJK7NzCsJ2c0t0d6R5h62GVsvHs60Giup496A6XRYX7ynTpCifIdEW2e0GM3p2fIW3qGlSo7zS9hcBSKYFETOMTuFpAK3wSGkKd9fcIxYhTR9NLvh5PsvRlpOOzxdh7bQHbCeqcarJBOkh8BO9mo0KPNiCuM_vnQytFUBoh-SKKOx4VkoKAQbR60KFFIrqMn2QZfHmYkZ9eUMLqw3tA-Fr6fUqHeTf-Q9XioZ3jcy3wiG7tDnhyDSDOfyNq4EPvQkf8zKClKOZpaipuxKvq1zFeK2b-yzd_bEAWeTv-q-wejdwsirTh0zDFLDQLqBQcAfMeNim4hb9Ch7z1USodkBKomTug8tsKT2RNlPeDiF9iY6aa88H37rjNK61wf-ZNDgXqxCxAhl9o-yJkuTj2jrCfRJoMahSktgwyzNr41HKok_fTPm1XpNMgigF_xQAyD03NHHtmVVF1PFyogK1KsVNBB2e5seu26P9BcRUkAlA0R9-27nDejx5xeV5xjFlT-pFbD_zwwScurii_1fbiSrzoO4VBKNbQQDhwfMrl4vC1J8sNkYyjjiuLcwPor59AVMIfBgk98sfA5zd5ITuJfq5QroAQfEs5sRUXhrqo2_jRxxWNtnOqLqaJ8iKkyBKULLgrWIUZiIynJKN_5_em8ktyRrKqX2NPkx5VBVKCj4Fu2SFjcM44N8IrVLNFGaj9s-xLHjPrViorm1sge7VJXFJSVLtNkj0jrn5SP-pTbK1koqjLW-RYOCj-wws42dTPeWP2jQrwHobHw9MzMwMfLB4rtPUo1QMYHBDUlb924ovPfK2L_jBOy3D1Jb3Sjc6g4hzyhr0tKwK1REfKu3MfoHCd9KUzssI3RIlXf4ruhONBZW7dHnX_KR6gjZ6oQqqSYLzGvibB9j9tgztB30W5arDtLz-zwqSZFj9oUJoNVAxFQ8_lkBa4Sc4uXTP94f9cNH2wojfP1XG-eIo71UrA6KYrOa-1tzLqghldzbiWm4GEnDGMNDHv9gKlGDs6gWfZymijp4MLmDqi7awwVvwIR5JpLlshuuF9QJrco1Erqb0Dh6mZN93DJUOhedfn7GJipNJwnnVe5zgIHvatUFlNlTCVRvZ-vfVvGzKrDRg90QgUQZJ8xBqzp_2Z5-SPTcq4aTJzA7v3IRSnt9M7Hhc4xEyfn5iMl7MkekWva2Z0btEb0yMycNiuKDiuL4EeseR9fXnmghjALDI0AlzdEeCS0mFGEMsxzkzvd7CNy8WcCIcoJbUJ9repZDnVB-K7mk4h_HUNa8pngbNI6vbG8TPS48dmeMA9N5GDkva3laHCWkgo1Hdz8qprfA7TcYOXfPawS97LREQE-d9NkK7ZCkxuwaxZUqERbnu-9NwOis4vb-b7hRPPx0vhc0x27-P_oHWXau77frAnoCQPwJkRkSRsWk5S6bRk4cBXyAT0ILxDTkV8qpLAtP9lPIAOsLQtaKgz0NZMYDut3kqtJJ_64EFjoWupUVUi3wKM-xB33M-tF3Sghb3adqBxOVADk4aU84bD7S4QSbYKUX4xuh5dU1kxBxIQuKAU5qGkAaCN0Zm2ZjwV7axEWrcPo-96V7qwFVZuVaZ5RzNE8Um78McNUbOkh8Et99TnNVBjJPEw67YHdOL0nB7pyBKrIPtxJRAvyX3oY96SeKUY-V624lB9mmsNaFFf2yzuPwaP6xpMdzt53flbGgNU5iMwQcBu_LxuLhD2pW_Vu5MdHBoqZU6odyss4g5tQeKEZJ1SZ3cuigLU69wd_k5qylGf_5npBVP4K-VJqP7ppUCRlEeNEZyi2RLoNVKBadeve3A6LB9z3eIvftBgoD_IccPYRL6Qu_Q0r1q6VgvBDd0aoQrTrXVgOW17Zdc8p1NLw54Hon5UtvM10Y3km-X-q-vytRbyV5vCesPqWwe0qgLOXdIt5iLE4W1MkFnecrZkGmcpIwEFyoEHZiWRojleiYYf8JyhMSQftRPbkkKeo5YeLws05p_62JEQgX_hV1flJHJvL3hKRoNOCrKVJyitwTmsJxQDLD7-cuzOIzt1azOuHqj5JPMg7umdsxbDAMQNivhwoLmKLw8vPT687cOup8OrMICbyQ2b5HV-D8dxts6zA_n-IrsxoUjhk3sbxKwcPujNbvilXzbxbTxyqLf65ULxcJyvdpUaARWnn3NVdkxUdqs7anEVeLUrCKn1wrz10XdNY6wXDUMOg3NmhoeFr1BpWnIsRQ_RPUgD_VV4VLComckjNdkHtBjXKT4pv-TrpOxVNagFC1HvL7Tsu0g_iA8GAzxDB_hE4q90Ipfifcw4kO4yiimBtTuyHRqr31hCsGxEGi8YzzzofoL_tU_u38NMzMorxltT8Daj_V_8P88aOjEHgETyS7m_sTgPkGVsu2Cdv2HllFzfu-6n-GaxFfZE3t_TuEo0CIXvi8eFN2ZvF8lzWWU_kzVxgVNNAs2T2V_nd1ltPcR_g0hjCF0Mv_zgCmm5A1lN_-yOOr8g_3PBeE4zhuyVwZ5w00fbw4BFhZJU-bT-bY4RdZO1woLyxVPwyUFUdzvWPN6rZbPm3kUqSiS1w-c_uV]--></g></svg>