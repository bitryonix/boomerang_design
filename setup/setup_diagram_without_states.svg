<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="17619px" preserveAspectRatio="none" style="width:4277px;height:17619px;background:#FFFFFF;" version="1.1" viewBox="0 0 4277 17619" width="4277px" zoomAndPan="magnify"><title>Setup Sequence Diagram (Without States)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="297.7734" x="1990.8691" y="28.5352">Setup Sequence Diagram (Without States)</text><rect fill="#F0F8FF" height="17569.8613" style="stroke:#181818;stroke-width:0.5;" width="2200.6099" x="385.0186" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.6196" x="1454.0137" y="56.0566">User Side</text><rect fill="none" height="1195.459" style="stroke:#000000;stroke-width:1.5;" width="4009.562" x="34" y="410.6348"/><rect fill="none" height="3090.0977" style="stroke:#000000;stroke-width:1.5;" width="2154.0391" x="53" y="1620.0938"/><rect fill="none" height="4096.9355" style="stroke:#000000;stroke-width:1.5;" width="3781.24" x="37" y="4724.1914"/><rect fill="none" height="1259.3223" style="stroke:#000000;stroke-width:1.5;" width="2773.7153" x="58" y="6413.4141"/><rect fill="none" height="506.832" style="stroke:#000000;stroke-width:1.5;" width="2775.24" x="1033" y="7857.8418"/><rect fill="none" height="2466.0918" style="stroke:#000000;stroke-width:1.5;" width="3767.24" x="51" y="8835.127"/><rect fill="none" height="647.3164" style="stroke:#000000;stroke-width:1.5;" width="2821.24" x="987" y="10304.623"/><rect fill="none" height="2396.1602" style="stroke:#000000;stroke-width:1.5;" width="4235.5117" x="35" y="11315.2188"/><rect fill="none" height="632.0059" style="stroke:#000000;stroke-width:1.5;" width="2823.24" x="985" y="12852.5781"/><rect fill="none" height="3791.4824" style="stroke:#000000;stroke-width:1.5;" width="3802.24" x="16" y="13725.3789"/><rect fill="none" height="632.0059" style="stroke:#000000;stroke-width:1.5;" width="2837.24" x="971" y="16721.9922"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="403.2012" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="407.0186" x2="407.0186" y1="139.2871" y2="17533.8613"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="1035.4346" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1038.5498" x2="1038.5498" y1="139.2871" y2="17533.8613"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="1506.3169" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1509.6143" x2="1509.6143" y1="139.2871" y2="17533.8613"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="1566.2158" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1570.0195" x2="1570.0195" y1="139.2871" y2="17533.8613"/></g><g><title>Boomletwo</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="1635.8081" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1639.4121" x2="1639.4121" y1="139.2871" y2="17533.8613"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="2463.6899" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2467.627" x2="2467.627" y1="139.2871" y2="17533.8613"/></g><g><title>Phone</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="2549.8711" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2553.1138" x2="2553.1138" y1="139.2871" y2="17533.8613"/></g><g><title>WT</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="3148.7803" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3152.3657" x2="3152.3657" y1="139.2871" y2="17533.8613"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="3641.7715" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3645.1772" x2="3645.1772" y1="139.2871" y2="17533.8613"/></g><g><title>Peers</title><rect fill="#000000" fill-opacity="0.00000" height="17394.5742" width="8" x="3773.1384" y="139.2871"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3777.0369" x2="3777.0369" y1="139.2871" y2="17533.8613"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="389.0186" y="136.334">User</text><ellipse cx="407.2012" cy="71.2988" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M407.2012,79.2988 L407.2012,106.2988 M394.2012,87.2988 L420.2012,87.2988 M407.2012,106.2988 L394.2012,121.2988 M407.2012,106.2988 L420.2012,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.3652" x="389.0186" y="17546.3965">User</text><ellipse cx="407.2012" cy="17557.8496" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M407.2012,17565.8496 L407.2012,17592.8496 M394.2012,17573.8496 L420.2012,17573.8496 M407.2012,17592.8496 L394.2012,17607.8496 M407.2012,17592.8496 L420.2012,17607.8496" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="1022.5498" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="1029.5498" y="128.334">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.7695" x="1022.5498" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.7695" x="1029.5498" y="17553.3965">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="1475.6143" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="1482.6143" y="128.334">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.4053" x="1475.6143" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.4053" x="1482.6143" y="17553.3965">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="1555.0195" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="1562.0195" y="128.334">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="30.3926" x="1555.0195" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="16.3926" x="1562.0195" y="17553.3965">ST</text></g><g class="participant participant-head" data-participant="Boomletwo"><rect fill="#D3D3D3" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.792" x="1595.4121" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.792" x="1602.4121" y="128.334">Boomletwo</text></g><g class="participant participant-tail" data-participant="Boomletwo"><rect fill="#D3D3D3" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.792" x="1595.4121" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.792" x="1602.4121" y="17553.3965">Boomletwo</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2445.627" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2452.627" y="128.334">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44.126" x="2445.627" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.126" x="2452.627" y="17553.3965">Niso</text></g><g class="participant participant-head" data-participant="Phone"><rect fill="#5F9EA0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55.5146" x="2526.1138" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.5146" x="2533.1138" y="128.334">Phone</text></g><g class="participant participant-tail" data-participant="Phone"><rect fill="#5F9EA0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55.5146" x="2526.1138" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.5146" x="2533.1138" y="17553.3965">Phone</text></g><g class="participant participant-head" data-participant="WT"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8291" x="3135.3657" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8291" x="3142.3657" y="128.334">WT</text></g><g class="participant participant-tail" data-participant="WT"><rect fill="#FF0000" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8291" x="3135.3657" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8291" x="3142.3657" y="17553.3965">WT</text></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="3622.1772" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="3629.1772" y="128.334">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47.1885" x="3622.1772" y="17532.8613"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.1885" x="3629.1772" y="17553.3965">SARs</text></g><g class="participant participant-head" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="3756.0369" y="136.334">Peers</text><ellipse cx="3777.1384" cy="71.2988" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3777.1384,79.2988 L3777.1384,106.2988 M3764.1384,87.2988 L3790.1384,87.2988 M3777.1384,106.2988 L3764.1384,121.2988 M3777.1384,106.2988 L3790.1384,121.2988" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="3756.0369" y="17546.3965">Peers</text><ellipse cx="3777.1384" cy="17557.8496" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3777.1384,17565.8496 L3777.1384,17592.8496 M3764.1384,17573.8496 L3790.1384,17573.8496 M3777.1384,17592.8496 L3764.1384,17607.8496 M3777.1384,17592.8496 L3790.1384,17607.8496" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><path d="M5,154.2871 L5,332.2871 L809,332.2871 L809,164.2871 L799,154.2871 L5,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M799,154.2871 L799,164.2871 L809,164.2871 L799,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.4497" x="11" y="171.8555">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="41.4497" y="171.8555">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="187.166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="363.9238" x="15.1133" y="187.166">milestone_block_collection: Collection&lt;milestone_block&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="202.4766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="775.1758" x="15.1133" y="202.4766">wt_ids_collection: Collection&lt;wt_id&gt; [Identity of all agreed upon WT candidates, first is the one first attempted to activate]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="217.7871">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="485.5195" x="15.1133" y="217.7871">sar_ids_collection: Collection&lt;sar_id&gt; [Identity of all privately selected SARs]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="233.0977">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51.0923" x="15.1133" y="233.0977">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="248.4082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="88.6577" x="15.1133" y="248.4082">entropy_bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="263.7188">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="71.2334" x="15.1133" y="263.7188">passphrase</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="279.0293">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="118.4219" x="15.1133" y="279.0293">static_doxing_data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="294.3398">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="110.6904" x="15.1133" y="294.3398">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="309.6504">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="84.6523" x="15.1133" y="309.6504">rpc_client_url</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="11" y="324.9609">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="95.6846" x="15.1133" y="324.9609">rpc_client_auth</text><path d="M3026,154.2871 L3026,286.2871 L3278,286.2871 L3278,164.2871 L3268,154.2871 L3026,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3268,154.2871 L3268,164.2871 L3278,164.2871 L3268,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.7188" x="3032" y="171.8555">WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3052.7188" y="171.8555">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3032" y="187.166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="223.5073" x="3036.1133" y="187.166">state: SetupReadyToRegisterService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3032" y="202.4766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="66.9995" x="3036.1133" y="202.4766">wt_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3032" y="217.7871">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="45.7729" x="3036.1133" y="217.7871">wt_id: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3032" y="233.0977">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="99.5186" x="3052.5664" y="233.0977">wt_tor_address,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3032" y="248.4082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="67.4438" x="3052.5664" y="248.4082">wt_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="3032" y="263.7188">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3032" y="279.0293">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="206.0894" x="3036.1133" y="279.0293">most_work_bitcoin_block_height</text><path d="M3519,154.2871 L3519,286.2871 L3771,286.2871 L3771,164.2871 L3761,154.2871 L3519,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3761,154.2871 L3761,164.2871 L3771,164.2871 L3761,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.9683" x="3525" y="171.8555">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3550.9683" y="171.8555">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="187.166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="223.5073" x="3529.1133" y="187.166">state: SetupReadyToRegisterService</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="202.4766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="71.2461" x="3529.1133" y="202.4766">sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="217.7871">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="50.0195" x="3529.1133" y="217.7871">sar_id: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="233.0977">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="103.7651" x="3545.5664" y="233.0977">sar_tor_address,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="248.4082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="71.6904" x="3545.5664" y="248.4082">sar_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="263.7188">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="4.2275" x="3529.1133" y="263.7188">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="3525" y="279.0293">&#160;</text><path d="M2472,154.2871 L2472,209.2871 L2634,209.2871 L2634,164.2871 L2624,154.2871 L2472,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2624,154.2871 L2624,164.2871 L2634,164.2871 L2624,154.2871" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40.9678" x="2478" y="171.8555">Phone</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="2518.9678" y="171.8555">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.9727" x="2482.1133" y="187.166">state: SetupReady</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="2478" y="202.4766">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="137.249" x="2482.1133" y="202.4766">dynamic_doxing_data</text><path d="M388,342.7031 L388,397.7031 L3663,397.7031 L3663,352.7031 L3653,342.7031 L388,342.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3653,342.7031 L3653,352.7031 L3663,352.7031 L3653,342.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88.8672" x="1727.9626" y="360.2715">PARAMETERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="578.1953" x="1732.0759" y="375.582">#define MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS milestone_block_1-milestone_block_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328.6372" x="1732.0759" y="390.8926">#define MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS</text><path d="M34,410.6348 L163.3984,410.6348 L163.3984,417.9453 L153.3984,427.9453 L34,427.9453 L34,410.6348" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1195.459" style="stroke:#000000;stroke-width:1.5;" width="4009.562" x="34" y="410.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="84.3984" x="49" y="424.2031">SAR sign-up</text><g class="message" data-participant-1="User" data-participant-2="Phone"><ellipse cx="406.7012" cy="494.4375" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2541.8711,491.1875,2551.8711,495.1875,2541.8711,499.1875,2545.8711,495.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="2547.8711" y1="495.1875" y2="495.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="467.4795">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.2749" x="444.9883" y="444.5137">SetupPhoneInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6904" x="449.1016" y="459.8242">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.4268" x="449.1016" y="475.1348">sar_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.4219" x="449.1016" y="490.4453">static_doxing_data</text></g><polygon fill="#FFF0F5" points="2085,508.1875,3022,508.1875,3032,534.1875,3022,561.1875,2085,561.1875,2075,534.1875,2085,508.1875" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="790.3594" x="2087" y="524.7559">Phone receives {doxing_password, sar_ids_collection, static_doxing_data} from User and saves doxing_key (SHA256 digest of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="925.4692" x="2091.1133" y="540.0664">doxing_password) to encrypt static_doxing_data and dynamic_doxing_data (e.g. location). It then sends doxing_data_identifier (SHA_256 digest of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.5732" x="2091.1133" y="555.377">doxing_key) to SAR to initialize setup.</text><polygon fill="#E6E6FA" points="2404,572.1191,2703,572.1191,2713,591.1191,2703,610.1191,2404,610.1191,2394,591.1191,2404,572.1191" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.5586" x="2406" y="588.6875">doxing_key := sha256(doxing_password)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.313" x="2410.1133" y="603.998">doxing_data_identifier := sha256(doxing_key)</text><g class="message" data-participant-1="Phone" data-participant-2="SARs"><ellipse cx="2553.3711" cy="651.6113" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3633.7715,648.3613,3643.7715,652.3613,3633.7715,656.3613,3637.7715,652.3613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2557.8711" x2="3639.7715" y1="652.3613" y2="652.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2560.8711" y="639.9639">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165.9404" x="2591.6582" y="632.3086">SetupPhoneSarMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4448" x="2595.7715" y="647.6191">doxing_data_identifier</text></g><polygon fill="#FFF0F5" points="3275,665.3613,4015,665.3613,4025,676.3613,4015,688.3613,3275,688.3613,3265,676.3613,3275,665.3613" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="736.4741" x="3277" y="681.9297">SAR receives doxing_data_identifier from Phone and responds with a newly generated sar_service_fee_payment_info.</text><polygon fill="#E6E6FA" points="3453,698.6719,3837,698.6719,3847,740.6719,3837,782.6719,3453,782.6719,3443,740.6719,3453,698.6719" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.873" x="3455" y="715.2402">sar_service_fee_payment_info := SarServiceFeePaymentInfo{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.4209" x="3459.1133" y="730.5508">service_fee_invoice: service_fee_invoice,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.4902" x="3459.1133" y="745.8613">payment_deadline: payment_deadline,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.3574" x="3459.1133" y="761.1719">sar_id: sar_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.3408" x="3455" y="776.4824">}.</text><g class="message" data-participant-1="SARs" data-participant-2="Phone"><polygon fill="#181818" points="2564.8711,820.8457,2554.8711,824.8457,2564.8711,828.8457,2560.8711,824.8457" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3645.2715" cy="824.0957" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2558.8711" x2="3640.7715" y1="824.8457" y2="824.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2570.8711" y="812.4482">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165.9404" x="2601.6582" y="804.793">SetupSarPhoneMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.021" x="2605.7715" y="820.1035">sar_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="2301,837.8457,2805,837.8457,2815,848.8457,2805,860.8457,2301,860.8457,2291,848.8457,2301,837.8457" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="500.4365" x="2303" y="854.4141">Phone receives sar_service_fee_payment_info from SAR and forwards it to User.</text><polygon fill="#FFC0CB" points="2324,871.1563,2782,871.1563,2792,882.1563,2782,894.1563,2324,894.1563,2314,882.1563,2324,871.1563" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="454.4604" x="2326" y="887.7246">Assert sar_service_fee_payment_info.sar_id == sar_ids_collection.sar_id</text><g class="message" data-participant-1="Phone" data-participant-2="User"><polygon fill="#181818" points="418.2012,932.0879,408.2012,936.0879,418.2012,940.0879,414.2012,936.0879" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2553.3711" cy="935.3379" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="2548.8711" y1="936.0879" y2="936.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="923.6904">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.9355" x="454.9883" y="916.0352">SetupPhoneOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.021" x="459.1016" y="931.3457">sar_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="54,949.0879,759,949.0879,769,968.0879,759,987.0879,54,987.0879,44,968.0879,54,949.0879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="610.0415" x="56" y="965.6563">User receives sar_service_fee_payment_info from Phone, verifies and pays the invoice generating</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.4805" x="60.1133" y="980.9668">sar_service_fee_payment_receipts as a result. He then inputs sar_service_fee_payment_receipts back to phone.</text><polygon fill="#E6E6FA" points="178,997.709,634,997.709,644,1008.709,634,1020.709,178,1020.709,168,1008.709,178,997.709" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="452.626" x="180" y="1014.2773">sar_service_fee_payment_receipts := pay(sar_service_fee_payment_info)</text><g class="message" data-participant-1="User" data-participant-2="Phone"><ellipse cx="406.7012" cy="1061.8906" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2541.8711,1058.6406,2551.8711,1062.6406,2541.8711,1066.6406,2545.8711,1062.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="2547.8711" y1="1062.6406" y2="1062.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="1050.2432">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.2749" x="444.9883" y="1042.5879">SetupPhoneInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.3228" x="449.1016" y="1057.8984">sar_service_fee_payment_receipts</text></g><polygon fill="#FFF0F5" points="2042,1075.6406,3065,1075.6406,3075,1094.6406,3065,1113.6406,2042,1113.6406,2032,1094.6406,2042,1075.6406" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1015.5234" x="2044" y="1092.209">Phone receives sar_service_fee_payment_receipts from User and forwards it to SAR alongside encrypted static_doxing_data, encrypted dynamic_doxing_data and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.5581" x="2048.1133" y="1107.5195">doxing_data_identifier.</text><polygon fill="#E6E6FA" points="2163,1124.2617,2942,1124.2617,2952,1158.2617,2942,1193.2617,2163,1193.2617,2153,1158.2617,2163,1124.2617" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="729.8789" x="2165" y="1140.8301">static_doxing_data_encrypted_by_doxing_key := AES_encrypt(private_key: doxing_key, content: static_doxing_data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="767.5332" x="2169.1133" y="1156.1406">dynamic_doxing_data_encrypted_by_doxing_key := AES_encrypt(private_key: doxing_key, content: dynamic_doxing_data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="524.8052" x="2169.1133" y="1171.4512">note that static data is sent once and dynamic data is updated and sent in intervals</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="692.5801" x="2169.1133" y="1186.7617">Phone then hashes doxing_key and sends this alongside every sent message as an unauthenticated identifier.</text><g class="message" data-participant-1="Phone" data-participant-2="SARs"><ellipse cx="2553.3711" cy="1280.3066" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3633.7715,1277.0566,3643.7715,1281.0566,3633.7715,1285.0566,3637.7715,1281.0566" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2557.8711" x2="3639.7715" y1="1281.0566" y2="1281.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2560.8711" y="1245.6934">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165.9404" x="2591.6582" y="1215.0723">SetupPhoneSarMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.3228" x="2595.7715" y="1230.3828">sar_service_fee_payment_receipts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.6504" x="2595.7715" y="1245.6934">static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4448" x="2595.7715" y="1261.0039">doxing_data_identifier</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.4297" x="2595.7715" y="1276.3145">dynamic_doxing_data_encrypted_by_doxing_key [sent_at_intervals]</text></g><polygon fill="#FFF0F5" points="3266,1294.0566,4023,1294.0566,4033,1328.0566,4023,1363.0566,3266,1363.0566,3256,1328.0566,3266,1294.0566" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="749.4487" x="3268" y="1310.625">SAR receives {sar_service_fee_payment_receipts, static_doxing_data_encrypted_by_doxing_key, doxing_data_identifier,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.9336" x="3272.1133" y="1325.9355">dynamic_doxing_data_encrypted_by_doxing_key} from Phone, verifies sar_service_fee_payment_receipts,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.3447" x="3272.1133" y="1341.2461">stores encrypted_doxing_data associating it with doxing_data_identifier and responds to Phone</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="668.8271" x="3272.1133" y="1356.5566">informing it they're in sync. Phone will continue generating and sending encrypted_dynamic_doxing_data.</text><polygon fill="#FFC0CB" points="3434,1373.2988,3855,1373.2988,3865,1384.2988,3855,1396.2988,3434,1396.2988,3424,1384.2988,3434,1373.2988" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.8662" x="3436" y="1389.8672">Assert verify_payment(sar_service_fee_payment_receipts) == True</text><polygon fill="#FFC0CB" points="3399,1406.6094,3891,1406.6094,3901,1417.6094,3891,1429.6094,3399,1429.6094,3389,1417.6094,3399,1406.6094" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="488.0776" x="3401" y="1423.1777">Check that doxing_data_identifier is the same as the one previously received.</text><g class="message" data-participant-1="SARs" data-participant-2="Phone"><polygon fill="#181818" points="2564.8711,1467.541,2554.8711,1471.541,2564.8711,1475.541,2560.8711,1471.541" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2558.8711" x2="3644.7715" y1="1471.541" y2="1471.541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2570.8711" y="1459.1436">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165.9404" x="2601.6582" y="1451.4883">SetupSarPhoneMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357.9951" x="2605.7715" y="1466.7988">magic: "setup_sar_setup_done_and_in_sync_with_phone"</text></g><polygon fill="#FFF0F5" points="2204,1484.541,2902,1484.541,2912,1503.541,2902,1522.541,2204,1522.541,2194,1503.541,2204,1484.541" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.7456" x="2206" y="1501.1094">Phone receives {magic: "setup_sar_setup_done_and_in_sync_with_phone"} from SAR and informs User that it's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.9116" x="2210.1133" y="1516.4199">now in-sync with SAR.</text><g class="message" data-participant-1="Phone" data-participant-2="User"><polygon fill="#181818" points="418.2012,1560.7832,408.2012,1564.7832,418.2012,1568.7832,414.2012,1564.7832" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2553.3711" cy="1564.0332" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="2548.8711" y1="1564.7832" y2="1564.7832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="1552.3857">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.9355" x="454.9883" y="1544.7305">SetupPhoneOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.5771" x="459.1016" y="1560.041">magic: "setup_sar_registered_and_connected_to_phone"</text></g><polygon fill="#FFF0F5" points="56,1577.7832,758,1577.7832,768,1588.7832,758,1600.7832,56,1600.7832,46,1588.7832,56,1577.7832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="698.0073" x="58" y="1594.3516">User receives {magic: "setup_sar_registered_and_connected_to_phone"} from Phone and proceeds to setup Iso.</text><path d="M53,1620.0938 L187.2671,1620.0938 L187.2671,1627.4043 L177.2671,1637.4043 L53,1637.4043 L53,1620.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3090.0977" style="stroke:#000000;stroke-width:1.5;" width="2154.0391" x="53" y="1620.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.2671" x="68" y="1633.6621">duress_setup</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="406.7012" cy="1734.5176" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1027.4346,1731.2676,1037.4346,1735.2676,1027.4346,1739.2676,1031.4346,1735.2676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1033.4346" y1="1735.2676" y2="1735.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="1692.249">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101.2705" x="444.9883" y="1653.9727">SetupIsoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.0923" x="449.1016" y="1669.2832">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.6577" x="449.1016" y="1684.5938">entropy_bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.2334" x="449.1016" y="1699.9043">passphrase</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6904" x="449.1016" y="1715.2148">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.4268" x="449.1016" y="1730.5254">sar_ids_collection</text></g><polygon fill="#FFF0F5" points="704,1748.2676,1374,1748.2676,1384,1790.2676,1374,1832.2676,704,1832.2676,694,1790.2676,704,1748.2676" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.7358" x="706" y="1764.8359">Iso receives {network, entropy_bytes, passphrase, doxing_password, sar_ids_collection} from  User,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="604.1001" x="710.1133" y="1780.1465">creates mnemonic and master_xpriv_0 from the input. Then derives purpose_root_xpriv_0 from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="657.9663" x="710.1133" y="1795.457">master_xpriv_0 via the path m/cb86' which is m/52102h in decimal, where purpose (cb86') is the first 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.5913" x="710.1133" y="1810.7676">bytes of sha256("boomerang"), hardened. Iso also creates normal_pubkey_0, that is generated directly</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3315" x="710.1133" y="1826.0781">from purpose_root_xpub_0.</text><polygon fill="#E6E6FA" points="907,1842.8203,1171,1842.8203,1181,1853.8203,1171,1865.8203,907,1865.8203,897,1853.8203,907,1842.8203" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.5586" x="909" y="1859.3887">doxing_key := sha256(doxing_password)</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1038.9346" cy="1952.9336" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1498.3169,1949.6836,1508.3169,1953.6836,1498.3169,1957.6836,1502.3169,1953.6836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1504.3169" y1="1953.6836" y2="1953.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="1918.3203">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1077.2217" y="1887.6992">SetupIsoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.7314" x="1081.335" y="1903.0098">normal_pubkey_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.2046" x="1081.335" y="1918.3203">doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.4268" x="1081.335" y="1933.6309">sar_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.0923" x="1081.335" y="1948.9414">network</text></g><polygon fill="#FFF0F5" points="1149,1966.6836,1871,1966.6836,1881,2008.6836,1871,2050.6836,1149,2050.6836,1139,2008.6836,1149,1966.6836" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.5918" x="1151" y="1983.252">Boomlet receives {normal_pubkey_0, doxing_key, sar_ids_collection, network} from Iso during installation.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.4668" x="1155.1133" y="1998.5625">Then independently generates boomlet_0_identity_privkey which it uses to encrypt, decrypt and sign</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="710.125" x="1155.1133" y="2013.873">messages. It also creates boomlet_0_boom_musig2_privkey_share and boomlet_0_boom_musig2_pubkey_share,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="700.0195" x="1155.1133" y="2029.1836">that will together with normal_pubkey_0, generate the MuSig2 aggregated public key, named boom_pubkey_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="560.6377" x="1155.1133" y="2044.4941">that is used in boomerang_descriptor. It then responds with boomlet_0_identity_pubkey.</text><polygon fill="#E6E6FA" points="1176,2061.2363,1843,2061.2363,1853,2149.2363,1843,2237.2363,1176,2237.2363,1166,2149.2363,1176,2061.2363" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.5303" x="1178" y="2077.8047">boomlet_0_identity_privkey := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="394.6465" x="1182.1133" y="2093.1152">boomlet_0_boom_musig2_privkey_share := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="551.7637" x="1182.1133" y="2108.4258">boomlet_0_boom_musig2_pubkey_share := derive_pubkey(boomlet_0_identity_privkey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="468.6475" x="1182.1133" y="2123.7363">boomlet_0_identity_pubkey := derive_pubkey(boomlet_0_identity_privkey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="655.6938" x="1182.1133" y="2139.0469">boom_pubkey_0 := derive_musig2_pubkey(boomlet_0_boom_musig2_pubkey_share, normal_pubkey_0)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.4717" x="1182.1133" y="2154.3574">peer_0_tor_secret_key := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.9658" x="1182.1133" y="2169.668">peer_0_id := PeerId{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.769" x="1182.1133" y="2184.9785">boom_pubkey: boom_pubkey_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.0825" x="1182.1133" y="2200.2891">normal_pubkey: normal_pubkey_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.4312" x="1182.1133" y="2215.5996">boomlet_identity_pubkey: boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1178" y="2230.9102">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,2275.2734,1040.4346,2279.2734,1050.4346,2283.2734,1046.4346,2279.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1509.3169" y1="2279.2734" y2="2279.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="2266.876">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1087.2217" y="2259.2207">SetupBoomletIsoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1091.335" y="2274.5313">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="796,2292.2734,1280,2292.2734,1290,2303.2734,1280,2315.2734,796,2315.2734,786,2303.2734,796,2292.2734" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.9683" x="798" y="2308.8418">Iso receives boomlet_0_identity_pubkey from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Iso" data-participant-2="ST"><ellipse cx="1038.9346" cy="2356.4551" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1558.2158,2353.2051,1568.2158,2357.2051,1558.2158,2361.2051,1562.2158,2357.2051" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1564.2158" y1="2357.2051" y2="2357.2051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="2344.8076">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136.6523" x="1077.2217" y="2337.1523">SetupIsoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1081.335" y="2352.4629">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="1268,2370.2051,1871,2370.2051,1881,2381.2051,1871,2393.2051,1268,2393.2051,1258,2381.2051,1268,2370.2051" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="599.3584" x="1270" y="2386.7734">ST receives boomlet_0_identity_pubkey from Boomlet and responds with st_0_identity_pubkey.</text><polygon fill="#E6E6FA" points="1372,2403.5156,1767,2403.5156,1777,2422.5156,1767,2441.5156,1372,2441.5156,1362,2422.5156,1372,2403.5156" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.8672" x="1374" y="2420.084">st_0_identity_privkey := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.3213" x="1378.1133" y="2435.3945">st_0_identity_pubkey := derive_pubkey(st_0_identity_privkey)</text><g class="message" data-participant-1="ST" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,2479.7578,1040.4346,2483.7578,1050.4346,2487.7578,1046.4346,2483.7578" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="2483.0078" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1565.2158" y1="2483.7578" y2="2483.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="2471.3604">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136.6523" x="1087.2217" y="2463.7051">SetupStIsoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1091.335" y="2479.0156">st_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="812,2496.7578,1265,2496.7578,1275,2507.7578,1265,2519.7578,812,2519.7578,802,2507.7578,812,2496.7578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="449.2744" x="814" y="2513.3262">Iso receives st_0_identity_pubkey from SAR and forwards it to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1038.9346" cy="2560.9395" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1498.3169,2557.6895,1508.3169,2561.6895,1498.3169,2565.6895,1502.3169,2561.6895" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1504.3169" y1="2561.6895" y2="2561.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="2549.292">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1077.2217" y="2541.6367">SetupIsoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.7993" x="1081.335" y="2556.9473">st_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="1105,2574.6895,1913,2574.6895,1923,2593.6895,1913,2612.6895,1105,2612.6895,1095,2593.6895,1105,2574.6895" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="677.3901" x="1107" y="2591.2578">Boomlet receives st_0_identity_pubkey from Iso. It then generates an array of 5 random integers between 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="800.7949" x="1111.1133" y="2606.5684">and 198 named duress_check_space and encrypts it for st. This will be used to record the duress_consent_set input from user.</text><polygon fill="#E6E6FA" points="893,2623.3105,2126,2623.3105,2136,2665.3105,2126,2707.3105,893,2707.3105,883,2665.3105,893,2623.3105" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9736" x="895" y="2639.8789">duress_check_space := DuressCheckSpace{space: rand([1..198;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.3994" x="899.1133" y="2655.1895">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1553" x="899.1133" y="2670.5">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="899.1133" y="2685.8105">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.7197" x="899.1133" y="2701.1211">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,2745.4844,1040.4346,2749.4844,1050.4346,2753.4844,1046.4346,2749.4844" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1509.8169" cy="2748.7344" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1505.3169" y1="2749.4844" y2="2749.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="2737.0869">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1087.2217" y="2729.4316">SetupBoomletIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1091.335" y="2744.7422">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="677,2762.4844,1399,2762.4844,1409,2773.4844,1399,2785.4844,677,2785.4844,667,2773.4844,677,2762.4844" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="718.8848" x="679" y="2779.0527">Iso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Iso" data-participant-2="ST"><ellipse cx="1038.9346" cy="2826.666" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1558.2158,2823.416,1568.2158,2827.416,1558.2158,2831.416,1562.2158,2827.416" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1564.2158" y1="2827.416" y2="2827.416"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="2815.0186">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136.6523" x="1077.2217" y="2807.3633">SetupIsoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1081.335" y="2822.6738">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1218,2840.416,1920,2840.416,1930,2874.416,1920,2909.416,1218,2909.416,1208,2874.416,1218,2840.416" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.1182" x="1220" y="2856.9844">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Iso. Decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.2124" x="1224.1133" y="2872.2949">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st, assign a country to each of the numbers in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.6167" x="1224.1133" y="2887.6055">the duress_check_space corresponding to its alphabetical rank and shows this array to User for him to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251.4814" x="1224.1133" y="2902.916">select 5 of them as duress_consent_set.</text><polygon fill="#E6E6FA" points="953,2919.6582,2186,2919.6582,2196,2938.6582,2186,2957.6582,953,2957.6582,943,2938.6582,953,2919.6582" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.834" x="955" y="2936.2266">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.6245" x="959.1133" y="2951.5371">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="418.2012,2995.9004,408.2012,2999.9004,418.2012,3003.9004,414.2012,2999.9004" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="2999.1504" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1565.2158" y1="2999.9004" y2="2999.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="2987.5029">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.6631" x="454.9883" y="2979.8477">SetupStOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.1816" x="459.1016" y="2995.1582">duress_check_space</text></g><polygon fill="#FFF0F5" points="73,3012.9004,741,3012.9004,751,3038.9004,741,3065.9004,73,3065.9004,63,3038.9004,73,3012.9004" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="623.8413" x="75" y="3029.4688">User receives duress_check_space from ST. He then selects 5 countries via the ST's joystick. ST will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="656.043" x="79.1133" y="3044.7793">record the index in the duress_signal_index User is to memorize the name of 5 countries that they have</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.4268" x="79.1133" y="3060.0898">selected in this stage.</text><polygon fill="#E6E6FA" points="213,3076.832,601,3076.832,611,3087.832,601,3099.832,213,3099.832,203,3087.832,213,3076.832" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384.1475" x="215" y="3093.4004">duress_signal_index := DuressSignalIndex{indices: [index;5]}</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="406.7012" cy="3141.0137" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1558.2158,3137.7637,1568.2158,3141.7637,1558.2158,3145.7637,1562.2158,3141.7637" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1564.2158" y1="3141.7637" y2="3141.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="3129.3662">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.0024" x="444.9883" y="3121.7109">SetupStInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7847" x="449.1016" y="3137.0215">duress_signal_index</text></g><polygon fill="#FFF0F5" points="1224,3154.7637,1915,3154.7637,1925,3173.7637,1915,3192.7637,1224,3192.7637,1214,3173.7637,1224,3154.7637" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.3945" x="1226" y="3171.332">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="683.5918" x="1230.1133" y="3186.6426">nonce from previously received duress_check_space_with_nonce, encrypts it for Boomlet and sends it to Iso.</text><polygon fill="#E6E6FA" points="952,3203.3848,2187,3203.3848,2197,3245.3848,2187,3287.3848,952,3287.3848,942,3245.3848,952,3203.3848" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.5449" x="954" y="3219.9531">ST drops redundant data.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.0024" x="958.1133" y="3235.2637">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.7583" x="958.1133" y="3250.5742">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.521" x="958.1133" y="3265.8848">nonce: duress_check_space_with_nonce.nonce}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1226.9258" x="958.1133" y="3281.1953">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,3325.5586,1040.4346,3329.5586,1050.4346,3333.5586,1046.4346,3329.5586" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="3328.8086" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1565.2158" y1="3329.5586" y2="3329.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="3317.1611">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136.6523" x="1087.2217" y="3309.5059">SetupStIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1091.335" y="3324.8164">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="677,3342.5586,1400,3342.5586,1410,3353.5586,1400,3365.5586,677,3365.5586,667,3353.5586,677,3342.5586" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="719.4878" x="679" y="3359.127">Iso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1038.9346" cy="3406.7402" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1498.3169,3403.4902,1508.3169,3407.4902,1498.3169,3411.4902,1502.3169,3407.4902" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1504.3169" y1="3407.4902" y2="3407.4902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="3395.0928">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1077.2217" y="3387.4375">SetupIsoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1081.335" y="3402.748">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1079,3420.4902,1939,3420.4902,1949,3469.4902,1939,3519.4902,1079,3519.4902,1069,3469.4902,1079,3420.4902" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="694.4971" x="1081" y="3437.0586">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Iso and decrypts it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.7778" x="1085.1133" y="3452.3691">get duress_signal_index_with_nonce. After checking the nonce to be the same as the one sent, It will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="627.0786" x="1085.1133" y="3467.6797">search for the newly received indices in duress_check_space store those numbers corresponding to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="634.6958" x="1085.1133" y="3482.9902">aforementioned indices as duress_consent_set, and drops redundant data. It then generates another</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.6563" x="1085.1133" y="3498.3008">duress_check_space, and repeat the same process and sends a fresh duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.4316" x="1085.1133" y="3513.6113">to Iso.</text><polygon fill="#E6E6FA" points="894,3530.3535,2125,3530.3535,2135,3541.3535,2125,3553.3535,894,3553.3535,884,3541.3535,894,3530.3535" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1227.04" x="896" y="3546.9219">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1224,3563.6641,1795,3563.6641,1805,3574.6641,1795,3586.6641,1224,3586.6641,1214,3574.6641,1224,3563.6641" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="567.3472" x="1226" y="3580.2324">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="1301,3596.9746,1718,3596.9746,1728,3615.9746,1718,3634.9746,1301,3634.9746,1291,3615.9746,1301,3596.9746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407.8306" x="1303" y="3613.543">duress_signal_index := duress_signal_index_with_nonce.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409.4048" x="1307.1133" y="3628.8535">duress_consent_set := duress_check_space[duress_signal_index]</text><polygon fill="#E6E6FA" points="893,3645.5957,2126,3645.5957,2136,3687.5957,2126,3729.5957,893,3729.5957,883,3687.5957,893,3645.5957" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9736" x="895" y="3662.1641">duress_check_space := DuressCheckSpace{space: rand([1..198;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.3994" x="899.1133" y="3677.4746">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1553" x="899.1133" y="3692.7852">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="899.1133" y="3708.0957">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.7197" x="899.1133" y="3723.4063">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,3767.7695,1040.4346,3771.7695,1050.4346,3775.7695,1046.4346,3771.7695" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1509.3169" y1="3771.7695" y2="3771.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="3759.3721">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1087.2217" y="3751.7168">SetupBoomletIsoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1091.335" y="3767.0273">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="677,3784.7695,1399,3784.7695,1409,3795.7695,1399,3807.7695,677,3807.7695,667,3795.7695,677,3784.7695" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="718.8848" x="679" y="3801.3379">Iso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Iso" data-participant-2="ST"><ellipse cx="1038.9346" cy="3848.9512" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1558.2158,3845.7012,1568.2158,3849.7012,1558.2158,3853.7012,1562.2158,3849.7012" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1564.2158" y1="3849.7012" y2="3849.7012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="3837.3037">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136.6523" x="1077.2217" y="3829.6484">SetupIsoStMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3789" x="1081.335" y="3844.959">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1218,3862.7012,1920,3862.7012,1930,3896.7012,1920,3931.7012,1218,3931.7012,1208,3896.7012,1218,3862.7012" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="658.563" x="1220" y="3879.2695">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Iso, decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.2124" x="1224.1133" y="3894.5801">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st, assign a country to each of the numbers in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.6167" x="1224.1133" y="3909.8906">the duress_check_space corresponding to its alphabetical rank and shows this array to User for him to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.0313" x="1224.1133" y="3925.2012">select 5 of them as confirmation of duress_consent_set.</text><polygon fill="#E6E6FA" points="953,3941.9434,2186,3941.9434,2196,3960.9434,2186,3979.9434,953,3979.9434,943,3960.9434,953,3941.9434" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1225.834" x="955" y="3958.5117">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.6245" x="959.1133" y="3973.8223">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="418.2012,4018.1855,408.2012,4022.1855,418.2012,4026.1855,414.2012,4022.1855" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="4021.4355" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1565.2158" y1="4022.1855" y2="4022.1855"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="4009.7881">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.6631" x="454.9883" y="4002.1328">SetupStOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.1816" x="459.1016" y="4017.4434">duress_check_space</text></g><polygon fill="#FFF0F5" points="91,4035.1855,721,4035.1855,731,4054.1855,721,4073.1855,91,4073.1855,81,4054.1855,91,4035.1855" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="622.7749" x="93" y="4051.7539">User receives duress_check_space from ST. He will select 1 country in each column to replicate the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.6729" x="97.1133" y="4067.0645">duress_consent_set and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="406.7012" cy="4114.6777" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1558.2158,4111.4277,1568.2158,4115.4277,1558.2158,4119.4277,1562.2158,4115.4277" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1564.2158" y1="4115.4277" y2="4115.4277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="4103.0303">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.0024" x="444.9883" y="4095.375">SetupStInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7847" x="449.1016" y="4110.6855">duress_signal_index</text></g><polygon fill="#FFF0F5" points="1221,4128.4277,1917,4128.4277,1927,4147.4277,1917,4166.4277,1221,4166.4277,1211,4147.4277,1221,4128.4277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.5303" x="1223" y="4144.9961">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="641.4561" x="1227.1133" y="4160.3066">from previously received duress_check_space_with_nonce, encrypts it for Boomlet and sends it to Iso.</text><polygon fill="#E6E6FA" points="952,4177.0488,2187,4177.0488,2197,4211.0488,2187,4246.0488,952,4246.0488,942,4211.0488,952,4177.0488" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.0024" x="954" y="4193.6172">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.7583" x="958.1133" y="4208.9277">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3169" x="958.1133" y="4224.2383">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1226.9258" x="958.1133" y="4239.5488">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,4283.9121,1040.4346,4287.9121,1050.4346,4291.9121,1046.4346,4287.9121" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="4287.1621" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1565.2158" y1="4287.9121" y2="4287.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="4275.5146">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136.6523" x="1087.2217" y="4267.8594">SetupStIsoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1091.335" y="4283.1699">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="750,4300.9121,1328,4300.9121,1338,4319.9121,1328,4338.9121,750,4338.9121,740,4319.9121,750,4300.9121" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="570.5972" x="752" y="4317.4805">Iso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.7773" x="756.1133" y="4332.791">forwards it to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1038.9346" cy="4380.4043" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1498.3169,4377.1543,1508.3169,4381.1543,1498.3169,4385.1543,1502.3169,4381.1543" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1504.3169" y1="4381.1543" y2="4381.1543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="4368.7568">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1077.2217" y="4361.1016">SetupIsoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.9819" x="1081.335" y="4376.4121">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1154,4394.1543,1864,4394.1543,1874,4436.1543,1864,4478.1543,1154,4478.1543,1144,4436.1543,1154,4394.1543" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.3584" x="1156" y="4410.7227">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Iso. Boomlet will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.0127" x="1160.1133" y="4426.0332">search for the indices in duress_check_space. If the resulting 5 numbers constitute the same set as the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="668.5605" x="1160.1133" y="4441.3438">duress_consent_set, Boomlet knows that the user has "memorized" the consent set. If not, there would be</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1626" x="1160.1133" y="4456.6543">a retry from</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1239.3892" y="4456.6543">SetupBoomletIsoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364.8442" x="1417.8599" y="4456.6543">. If that also fails, the duress setup process will start from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1156" y="4471.9648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1160.1133" y="4471.9648">SetupBoomletIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520.2158" x="1342.6973" y="4471.9648">onwards (after key exchange). If all is good, Boomlet will drop the redundant data.</text><polygon fill="#E6E6FA" points="894,4488.707,2125,4488.707,2135,4499.707,2125,4511.707,894,4511.707,884,4499.707,894,4488.707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1227.04" x="896" y="4505.2754">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1224,4522.0176,1795,4522.0176,1805,4533.0176,1795,4545.0176,1224,4545.0176,1214,4533.0176,1224,4522.0176" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="567.3472" x="1226" y="4538.5859">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="1304,4555.3281,1715,4555.3281,1725,4566.3281,1715,4578.3281,1304,4578.3281,1294,4566.3281,1304,4555.3281" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="407.8306" x="1306" y="4571.8965">duress_signal_index := duress_signal_index_with_nonce.content</text><polygon fill="#FFC0CB" points="1302,4588.6387,1716,4588.6387,1726,4599.6387,1716,4611.6387,1302,4611.6387,1292,4599.6387,1302,4588.6387" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="410.8203" x="1304" y="4605.207">Assert duress_check_space[duress_signal_index] == consent_set</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,4649.5703,1040.4346,4653.5703,1050.4346,4657.5703,1046.4346,4653.5703" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1509.8169" cy="4652.8203" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1505.3169" y1="4653.5703" y2="4653.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="4641.1729">[27]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1087.2217" y="4633.5176">SetupBoomletIsoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.3076" x="1091.335" y="4648.8281">magic: "setup_duress_finished"</text></g><polygon fill="#FFF0F5" points="712,4666.5703,1366,4666.5703,1376,4685.5703,1366,4704.5703,712,4704.5703,702,4685.5703,712,4666.5703" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.0835" x="714" y="4683.1387">Iso receives {magic: "setup_duress_finished"} from Boomlet and knowing Boomlet can be disconnected</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0571" x="718.1133" y="4698.4492">returns mnemonic to User.</text><path d="M37,4724.1914 L256.0464,4724.1914 L256.0464,4731.502 L246.0464,4741.502 L37,4741.502 L37,4724.1914" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="4096.9355" style="stroke:#000000;stroke-width:1.5;" width="3781.24" x="37" y="4724.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174.0464" x="52" y="4737.7598">boomerang_params setup</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="418.2012,4774.123,408.2012,4778.123,418.2012,4782.123,414.2012,4778.123" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1038.9346" cy="4777.373" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1034.4346" y1="4778.123" y2="4778.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="4765.7256">[28]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112.9312" x="454.9883" y="4758.0703">SetupIsoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.0537" x="459.1016" y="4773.3809">mnemonic</text></g><polygon fill="#FFF0F5" points="57,4791.123,756,4791.123,766,4810.123,756,4829.123,57,4829.123,47,4810.123,57,4791.123" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="691.0503" x="59" y="4807.6914">User receives mnemonic from Iso, saves it in a safe place and proceeds to shutdown Iso and connect Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.9282" x="63.1133" y="4823.002">to Niso to continue setup.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="406.7012" cy="4901.2363" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,4897.9863,2465.6899,4901.9863,2455.6899,4905.9863,2459.6899,4901.9863" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="2461.6899" y1="4901.9863" y2="4901.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="4874.2783">[29]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.1792" x="444.9883" y="4851.3125">SetupNisoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.0923" x="449.1016" y="4866.623">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.6523" x="449.1016" y="4881.9336">rpc_client_url</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.6846" x="449.1016" y="4897.2441">rpc_client_auth</text></g><polygon fill="#FFF0F5" points="2124,4914.9863,2809,4914.9863,2819,4940.9863,2809,4967.9863,2124,4967.9863,2114,4940.9863,2124,4914.9863" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.7563" x="2126" y="4931.5547">Niso receives {network, rpc_client_url, rpc_client_auth} from User during the installation. rpc_client_url</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.3848" x="2130.1133" y="4946.8652">and rpc_client_auth provides a direct view into the provided network. As Niso communicates through TOR,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.3979" x="2130.1133" y="4962.1758">Niso asks for peer_0_tor_secret_key from Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,5006.5391,1511.3169,5010.5391,1521.3169,5014.5391,1517.3169,5010.5391" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="5009.7891" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="5010.5391" y2="5010.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="4998.1416">[30]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="4990.4863">SetupNisoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.0342" x="1562.2173" y="5005.7969">magic: "setup_initialized"</text></g><polygon fill="#FFF0F5" points="1204,5023.5391,1816,5023.5391,1826,5049.5391,1816,5076.5391,1204,5076.5391,1194,5049.5391,1204,5023.5391" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="604.4873" x="1206" y="5040.1074">Boomlet receives {magic: "setup_initialized"} from Niso. It then derives peer_0_tor_address from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="555.8008" x="1210.1133" y="5055.418">peer_0_tor_secret_key, signs it and responds with peer_0_id, peer_0_tor_secret_key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.6768" x="1210.1133" y="5070.7285">peer_0_tor_address_signed_by_boomlet_0.</text><polygon fill="#E6E6FA" points="1271,5087.4707,1748,5087.4707,1758,5129.4707,1748,5171.4707,1271,5171.4707,1261,5129.4707,1271,5087.4707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413.3213" x="1273" y="5104.0391">peer_0_tor_address := derive_tor_address(peer_0_tor_secret_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="425.458" x="1277.1133" y="5119.3496">peer_0_tor_address_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="465.6069" x="1277.1133" y="5134.6602">signature: schnorr_sign(boomlet_0_identity_privkey, peer_0_tor_address),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.207" x="1277.1133" y="5149.9707">content: peer_0_tor_address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1273" y="5165.2813">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="5243.5156" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,5240.2656,2465.6899,5244.2656,2455.6899,5248.2656,2459.6899,5244.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="5244.2656" y2="5244.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="5216.5576">[31]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="5193.5918">SetupBoomletNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.147" x="1552.2173" y="5208.9023">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.9595" x="1552.2173" y="5224.2129">peer_0_tor_secret_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.5635" x="1552.2173" y="5239.5234">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2100,5257.2656,2835,5257.2656,2845,5299.2656,2835,5341.2656,2100,5341.2656,2090,5299.2656,2100,5257.2656" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="686.3276" x="2102" y="5273.834">Niso receives {peer_0_id, peer_0_tor_secret_key, peer_0_tor_address_signed_by_boomlet_0} from Boomlet. It</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="723.0679" x="2106.1133" y="5289.1445">verifies the signature on peer_0_tor_address_signed_by_boomlet_0 using boomlet_0_identity_pubkey that it got in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="658.3091" x="2106.1133" y="5304.4551">peer_0_id. Niso then runs a tor circuit using peer_0_tor_secret_key and generates peer_0_tor_address in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="628.5322" x="2106.1133" y="5319.7656">doing so. It checks the generated peer_0_tor_address to be equal with the signed one and forwards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.7754" x="2106.1133" y="5335.0762">peer_0_id and peer_0_tor_address_signed_by_boomlet_0 to ST.</text><polygon fill="#FFC0CB" points="2022,5351.8184,2912,5351.8184,2922,5362.8184,2912,5374.8184,2022,5374.8184,2012,5362.8184,2022,5351.8184" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="886.2471" x="2024" y="5368.3867">Assert schnorr_verify(pubkey: peer_0_id.boomlet_0_identity_pubkey, content: peer_0_tor_address_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2246,5385.1289,2688,5385.1289,2698,5396.1289,2688,5408.1289,2246,5408.1289,2236,5396.1289,2246,5385.1289" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="438.2231" x="2248" y="5401.6973">peer_0_tor_address := onion_service(privkey: peer_0_tor_secret_key).</text><polygon fill="#FFC0CB" points="2170,5418.4395,2764,5418.4395,2774,5429.4395,2764,5441.4395,2170,5441.4395,2160,5429.4395,2170,5418.4395" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="590.6558" x="2172" y="5435.0078">Niso checks if the peer_0_tor_address_signed_by_boomlet_0.content == peer_0_tor_address.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1581.2158,5494.6816,1571.2158,5498.6816,1581.2158,5502.6816,1577.2158,5498.6816" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="5497.9316" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1575.2158" x2="2462.6899" y1="5498.6816" y2="5498.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1587.2158" y="5478.6289">[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.561" x="1618.0029" y="5463.3184">SetupNisoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.147" x="1622.1162" y="5478.6289">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.5635" x="1622.1162" y="5493.9395">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1231,5511.6816,1908,5511.6816,1918,5537.6816,1908,5564.6816,1231,5564.6816,1221,5537.6816,1231,5511.6816" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="639.5454" x="1233" y="5528.25">ST receives {peer_0_id, peer_0_tor_address_signed_by_boomlet_0} from Niso. Since ST already knows</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.9614" x="1237.1133" y="5543.5605">boomlet_0_identity_pubkey it checks the peer_0_id to make sure it contains the same identity pubkey for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.561" x="1237.1133" y="5558.8711">Boomlet.</text><polygon fill="#FFC0CB" points="1325,5575.6133,1813,5575.6133,1823,5586.6133,1813,5598.6133,1325,5598.6133,1315,5586.6133,1325,5575.6133" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="484.8403" x="1327" y="5592.1816">Assert peer_0_id.boomlet_0_identity_pubkey == boomlet_0_identity_pubkey</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="418.2012,5651.8555,408.2012,5655.8555,418.2012,5659.8555,414.2012,5655.8555" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="5655.1055" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1565.2158" y1="5655.8555" y2="5655.8555"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="5635.8027">[33]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.6631" x="454.9883" y="5620.4922">SetupStOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.147" x="459.1016" y="5635.8027">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.5635" x="459.1016" y="5651.1133">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="66,5668.8555,747,5668.8555,757,5687.8555,747,5706.8555,66,5706.8555,56,5687.8555,66,5668.8555" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.4609" x="68" y="5685.4238">User receives {peer_0_id, peer_0_tor_address_signed_by_boomlet_0} from ST and proceeds to share it with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.6309" x="72.1133" y="5700.7344">peers in an out-of-band channel.</text><g class="message" data-participant-1="User" data-participant-2="Peers"><polygon fill="#181818" points="418.2012,5760.4082,408.2012,5764.4082,418.2012,5768.4082,414.2012,5764.4082" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3765.1384,5760.4082,3775.1384,5764.4082,3765.1384,5768.4082,3769.1384,5764.4082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="412.2012" x2="3771.1384" y1="5764.4082" y2="5764.4082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="5744.3555">[34]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="244.4927" x="454.9883" y="5729.0449">SetupUserPeersOutOfBandMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.147" x="459.1016" y="5744.3555">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.5635" x="459.1016" y="5759.666">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="63,5777.4082,749,5777.4082,759,5811.4082,749,5846.4082,63,5846.4082,53,5811.4082,63,5777.4082" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="675.9365" x="65" y="5793.9766">User receives {peer_i_id, peer_i_tor_address_signed_by_boomlet_i} from peers, sending his own {peer_0_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="674.1909" x="69.1133" y="5809.2871">peer_0_tor_address_signed_by_boomlet_0} at the same time. It then forms peer_addresses_collection from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.2056" x="69.1133" y="5824.5977">pairs &lt;peer_i_id, peer_i_tor_address_signed_by_boomlet_i&gt; and inputs it alongside wt_ids_collection and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.584" x="69.1133" y="5839.9082">milestone_block_collection into Niso.</text><polygon fill="#E6E6FA" points="62,5856.6504,750,5856.6504,760,5867.6504,750,5879.6504,62,5879.6504,52,5867.6504,62,5856.6504" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.4678" x="64" y="5873.2188">peer_addresses_collection := Collection&lt;peer_i_id, peer_i_tor_address_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="406.7012" cy="5951.4531" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,5948.2031,2465.6899,5952.2031,2455.6899,5956.2031,2459.6899,5952.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="2461.6899" y1="5952.2031" y2="5952.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="5924.4951">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.1792" x="444.9883" y="5901.5293">SetupNisoInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.9502" x="449.1016" y="5916.8398">peer_addresses_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.1802" x="449.1016" y="5932.1504">wt_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.5967" x="449.1016" y="5947.4609">milestone_block_collection</text></g><polygon fill="#FFF0F5" points="2106,5965.2031,2827,5965.2031,2837,6007.2031,2827,6049.2031,2106,6049.2031,2096,6007.2031,2106,5965.2031" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.0996" x="2108" y="5981.7715">Niso receives {peer_addresses_collection, wt_ids_collection, milestone_block_collection} from User. It checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.9307" x="2112.1133" y="5997.082">the peer_i_id.boomlet_i_identity_pubkey's signature on every peer_i_tor_address_signed_by_boomlet_i and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="482.5742" x="2112.1133" y="6012.3926">if successful attempts connecting to all of them. He then checks inclusion of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.4458" x="2112.1133" y="6027.7031">&lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; in peer_addresses_collection and forwards the received</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.2383" x="2112.1133" y="6043.0137">values to Boomlet.</text><polygon fill="#FFC0CB" points="1815,6059.7559,3120,6059.7559,3130,6070.7559,3120,6082.7559,1815,6082.7559,1805,6070.7559,1815,6059.7559" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1301.1934" x="1817" y="6076.3242">Assert schnorr_verify(pubkey: peer_addresses_collection.peer_i_id.boomlet_i_identity_pubkey, content: peer_addresses_collection.peer_i_tor_address_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4].</text><polygon fill="#E6E6FA" points="2227,6093.0664,2708,6093.0664,2718,6104.0664,2708,6116.0664,2227,6116.0664,2217,6104.0664,2227,6093.0664" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="477.1216" x="2229" y="6109.6348">Connect to peer_i_tor_address_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2122,6126.377,2811,6126.377,2821,6137.377,2811,6149.377,2122,6149.377,2112,6137.377,2122,6126.377" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="685.6357" x="2124" y="6142.9453">Niso checks &lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; inclusion in peer_addresses_collection.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,6217.9297,1511.3169,6221.9297,1521.3169,6225.9297,1517.3169,6221.9297" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="6221.1797" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="6221.9297" y2="6221.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="6194.2217">[36]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="6171.2559">SetupNisoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.9502" x="1562.2173" y="6186.5664">peer_addresses_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.1802" x="1562.2173" y="6201.877">wt_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.5967" x="1562.2173" y="6217.1875">milestone_block_collection</text></g><polygon fill="#FFF0F5" points="1153,6234.9297,1866,6234.9297,1876,6283.9297,1866,6333.9297,1153,6333.9297,1143,6283.9297,1153,6234.9297" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.3848" x="1155" y="6251.498">Boomlet receives {peer_addresses_collection, wt_ids_collection, milestone_block_collection} from Niso. It</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.4678" x="1159.1133" y="6266.8086">checks the peer_i_id.boomlet_i_identity_pubkey's signature on every peer_i_tor_address_signed_by_boomlet_i,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.4268" x="1159.1133" y="6282.1191">checks inclusion of &lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; in peer_addresses_collection.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="675.4541" x="1159.1133" y="6297.4297">To verify boomerang_params_seed that includes peer_ids, wt_ids and milestone_block_collection with User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="701.4097" x="1159.1133" y="6312.7402">it adds nonce to it to get boomerang_params_with_nonce, encrypts boomerang_params_with_nonce for ST and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.6143" x="1159.1133" y="6328.0508">sends boomerang_params_seed_encrypted_by_boomlet_0_for_st to Niso.</text><polygon fill="#FFC0CB" points="857,6344.793,2162,6344.793,2172,6355.793,2162,6367.793,857,6367.793,847,6355.793,857,6344.793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1301.1934" x="859" y="6361.3613">Assert schnorr_verify(pubkey: peer_addresses_collection.peer_i_id.boomlet_i_identity_pubkey, content: peer_addresses_collection.peer_i_tor_address_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1153,6378.1035,1866,6378.1035,1876,6389.1035,1866,6401.1035,1153,6401.1035,1143,6389.1035,1153,6378.1035" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.1094" x="1155" y="6394.6719">Boomlet checks &lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; inclusion in peer_addresses_collection.</text><path d="M58,6413.4141 L340.123,6413.4141 L340.123,6420.7246 L330.123,6430.7246 L58,6430.7246 L58,6413.4141" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1259.3223" style="stroke:#000000;stroke-width:1.5;" width="2773.7153" x="58" y="6413.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="237.123" x="73" y="6426.9824">St_check(boomerang_params_seed)</text><polygon fill="#E6E6FA" points="898,6435.7246,2121,6435.7246,2131,6523.7246,2121,6611.7246,898,6611.7246,888,6523.7246,898,6435.7246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="543.0039" x="900" y="6452.293">peer_ids_collection := Collection&lt;peer_addresses_collection.peer_i_id&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.8198" x="904.1133" y="6467.6035">boomerang_params_seed := BoomerangParamsSeed{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.6816" x="904.1133" y="6482.9141">peer_ids: peer_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4658" x="904.1133" y="6498.2246">wt_ids: wt_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.4199" x="904.1133" y="6513.5352">milestone_block_collection: milestone_block_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="904.1133" y="6528.8457">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="387.3403" x="904.1133" y="6544.1563">boomerang_params_seed_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.0962" x="904.1133" y="6559.4668">content: boomerang_params_seed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.9761" x="904.1133" y="6574.7773">nonce: rand() [u8; 32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="900" y="6590.0879">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1215.8745" x="904.1133" y="6605.3984">boomerang_params_seed_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: boomerang_params_seed_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="6653.0117" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,6649.7617,2465.6899,6653.7617,2455.6899,6657.7617,2459.6899,6653.7617" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="6653.7617" y2="6653.7617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="6641.3643">[37]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="6633.709">SetupBoomletNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.5928" x="1552.2173" y="6649.0195">boomerang_params_seed_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="2123,6666.7617,2811,6666.7617,2821,6677.7617,2811,6689.7617,2123,6689.7617,2113,6677.7617,2123,6666.7617" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.7153" x="2125" y="6683.3301">Niso receives boomerang_params_seed_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1581.2158,6727.6934,1571.2158,6731.6934,1581.2158,6735.6934,1577.2158,6731.6934" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="6730.9434" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1575.2158" x2="2462.6899" y1="6731.6934" y2="6731.6934"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1587.2158" y="6719.2959">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.561" x="1618.0029" y="6711.6406">SetupNisoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.5928" x="1622.1162" y="6726.9512">boomerang_params_seed_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1242,6744.6934,1897,6744.6934,1907,6770.6934,1897,6797.6934,1242,6797.6934,1232,6770.6934,1242,6744.6934" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="647.8228" x="1244" y="6761.2617">ST receives boomerang_params_seed_encrypted_by_boomlet_0_for_st from Niso and decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="639.5327" x="1248.1133" y="6776.5723">boomerang_params_seed_with_nonce separates boomerang_params_seed_with_nonce.content to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.7817" x="1248.1133" y="6791.8828">boomerang_params_seed which it sends to User.</text><polygon fill="#E6E6FA" points="958,6808.625,2182,6808.625,2192,6827.625,2182,6846.625,958,6846.625,948,6827.625,958,6808.625" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1215.9888" x="960" y="6825.1934">boomerang_params_seed_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: boomerang_params_seed_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="474.5063" x="964.1133" y="6840.5039">boomerang_params_seed := boomerang_params_seed_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="418.2012,6884.8672,408.2012,6888.8672,418.2012,6892.8672,414.2012,6888.8672" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1569.7158" cy="6888.1172" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1565.2158" y1="6888.8672" y2="6888.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="6876.4697">[39]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.6631" x="454.9883" y="6868.8145">SetupStOutput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.1226" x="459.1016" y="6884.125">boomerang_params_seed</text></g><polygon fill="#FFF0F5" points="78,6901.8672,735,6901.8672,745,6920.8672,735,6939.8672,78,6939.8672,68,6920.8672,78,6901.8672" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="649.6509" x="80" y="6918.4355">User receives boomerang_params_seed from ST and checks the correctness of it's peer_ids, wt_ids and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="551.002" x="84.1133" y="6933.7461">milestone_block_collection. He then informs ST of his agreement with the given values.</text><polygon fill="#FFC0CB" points="146,6950.4883,666,6950.4883,676,6961.4883,666,6973.4883,146,6973.4883,136,6961.4883,146,6950.4883" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.6929" x="148" y="6967.0566">Assert boomerang_params_seed.peer_ids == peer_addresses_collection.peer_i_id</text><polygon fill="#FFC0CB" points="212,6983.7988,601,6983.7988,611,6994.7988,601,7006.7988,212,7006.7988,202,6994.7988,212,6983.7988" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.0171" x="214" y="7000.3672">Assert boomerang_params_seed.wt_ids == wt_ids_collection</text><polygon fill="#FFC0CB" points="116,7017.1094,697,7017.1094,707,7028.1094,697,7040.1094,116,7040.1094,106,7028.1094,116,7017.1094" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="577.0845" x="118" y="7033.6777">Assert boomerang_params_seed.milestone_block_collection == milestone_block_collection</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="406.7012" cy="7081.291" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1558.2158,7078.041,1568.2158,7082.041,1558.2158,7086.041,1562.2158,7082.041" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1564.2158" y1="7082.041" y2="7082.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="7069.6436">[40]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.0024" x="444.9883" y="7061.9883">SetupStInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="564.9731" x="449.1016" y="7077.2988">magic: "setup_user_verified_peer_ids_and_wt_ids_received_with_those_registered_before"</text></g><polygon fill="#FFF0F5" points="1215,7095.041,1924,7095.041,1934,7121.041,1924,7148.041,1215,7148.041,1205,7121.041,1215,7095.041" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="682.0303" x="1217" y="7111.6094">ST receives {magic: "setup_user_verified_peer_ids_and_wt_ids_received_with_those_registered_before"} from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="696.9854" x="1221.1133" y="7126.9199">User and proceeds to sign the received boomerang_params_seed_with_nonce, encrypt it for boomlet and send</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.7817" x="1221.1133" y="7142.2305">it to Niso.</text><polygon fill="#E6E6FA" points="831,7158.9727,2308,7158.9727,2318,7200.9727,2308,7242.9727,831,7242.9727,821,7200.9727,831,7158.9727" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="485.6909" x="833" y="7175.541">boomerang_params_seed_with_nonce_signed_by_st := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="540.5601" x="837.1133" y="7190.8516">signature: schnorr_sign(st_0_identity_privkey, boomerang_params_seed_with_nonce),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.8232" x="837.1133" y="7206.1621">content: boomerang_params_seed_with_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="833" y="7221.4727">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1469.4951" x="837.1133" y="7236.7832">boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: boomerang_params_seed_with_nonce_signed_by_st)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1569.7158" cy="7284.3965" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,7281.1465,2465.6899,7285.1465,2455.6899,7289.1465,2459.6899,7285.1465" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1574.2158" x2="2461.6899" y1="7285.1465" y2="7285.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1577.2158" y="7272.749">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.561" x="1608.0029" y="7265.0938">SetupStNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="533.2666" x="1612.1162" y="7280.4043">boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2126,7298.1465,2808,7298.1465,2818,7317.1465,2808,7336.1465,2126,7336.1465,2116,7317.1465,2126,7298.1465" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.9561" x="2128" y="7314.7148">Niso receives boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.3198" x="2132.1133" y="7330.0254">and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,7374.3887,1511.3169,7378.3887,1521.3169,7382.3887,1517.3169,7378.3887" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="7377.6387" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="7378.3887" y2="7378.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="7365.9912">[42]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="7358.3359">SetupNisoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="533.2666" x="1562.2173" y="7373.6465">boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1135,7391.3887,1884,7391.3887,1894,7471.3887,1884,7552.3887,1135,7552.3887,1125,7471.3887,1135,7391.3887" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="714.2954" x="1137" y="7407.957">Boomlet receives boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from Niso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="708.1445" x="1141.1133" y="7423.2676">Boomerang decrypts boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="485.6719" x="1141.1133" y="7438.5781">boomerang_params_seed_with_nonce_signed_by_st, checks the signature on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.79" x="1141.1133" y="7453.8887">boomerang_params_seed_with_nonce_signed_by_st using st_0_identity_pubkey, and checks the content of it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="737.2231" x="1141.1133" y="7469.1992">match boomerang_params_seed_with_nonce sent before concluding that User verified the boomerang_params_seed.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="618.3569" x="1141.1133" y="7484.5098">It then constructs boomerang_descriptor using network, milestone_block_collection and peer_ids.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.3657" x="1141.1133" y="7499.8203">milestone_block_0 marks the block that N of N of the boom_keys can spend. milestone_block_1 marks the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="566.8901" x="1141.1133" y="7515.1309">block that enables deterministic spending i.e. N of N of the normal_keys can spend. other</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="662.3335" x="1141.1133" y="7530.4414">milestone_blocks decrease the number of peers required to sign with their normal_pubkey. It then forms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="692.6816" x="1141.1133" y="7545.752">boomerang_params made up of peer_ids, wt_ids and boomerang_descriptor. Then signs and sends it to Niso.</text><polygon fill="#E6E6FA" points="773,7562.4941,2246,7562.4941,2256,7573.4941,2246,7585.4941,773,7585.4941,763,7573.4941,773,7562.4941" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1469.6094" x="775" y="7579.0625">boomerang_params_seed_with_nonce_signed_by_st := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1088,7595.8047,1932,7595.8047,1942,7606.8047,1932,7618.8047,1088,7618.8047,1078,7606.8047,1088,7595.8047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="840.5566" x="1090" y="7612.373">Assert schnorr_verify(pubkey: st_0_identity_pubkey, content: boomerang_params_seed_with_nonce_signed_by_st.signature) == True</text><polygon fill="#FFC0CB" points="1161,7629.1152,1859,7629.1152,1869,7648.1152,1859,7667.1152,1161,7667.1152,1151,7648.1152,1161,7629.1152" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.4663" x="1163" y="7645.6836">Freshness Check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.1616" x="1167.1133" y="7660.9941">Assert boomerang_params_seed_with_nonce_signed_by_st.content == boomerang_params_seed_with_nonce</text><polygon fill="#E6E6FA" points="1083,7684.7363,1936,7684.7363,1946,7764.7363,1936,7845.7363,1083,7845.7363,1073,7764.7363,1083,7684.7363" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.311" x="1085" y="7701.3047">boomerang_descriptor := construct_boomerang_descriptor(network, peer_addresses_collection.peer_i_id, milestone_block_collection)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.3564" x="1089.1133" y="7716.6152">boomerang_params := BoomerangParams{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.6816" x="1089.1133" y="7731.9258">peer_ids: peer_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4658" x="1089.1133" y="7747.2363">wt_ids: wt_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293.9092" x="1089.1133" y="7762.5469">boomerang_descriptor: boomerang_descriptor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1085" y="7777.8574">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427.5527" x="1089.1133" y="7793.168">boomerang_params_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="467.7017" x="1089.1133" y="7808.4785">signature: schnorr_sign(boomlet_0_identity_privkey, boomerang_params),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.3018" x="1089.1133" y="7823.7891">content: boomerang_params</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1085" y="7839.0996">}</text><path d="M1033,7857.8418 L1503.6929,7857.8418 L1503.6929,7865.1523 L1493.6929,7875.1523 L1033,7875.1523 L1033,7857.8418" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="506.832" style="stroke:#000000;stroke-width:1.5;" width="2775.24" x="1033" y="7857.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="425.6929" x="1048" y="7871.4102">&lt;Acknowledgement of boomerang_params between Boomlets&gt;</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="7911.0234" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,7907.7734,2465.6899,7911.7734,2455.6899,7915.7734,2459.6899,7911.7734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="7911.7734" y2="7911.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="7899.376">[43]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="7891.7207">SetupBoomletNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.6582" x="1552.2173" y="7907.0313">boomerang_params_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2127,7924.7734,2806,7924.7734,2816,7943.7734,2806,7962.7734,2127,7962.7734,2117,7943.7734,2127,7924.7734" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.3218" x="2129" y="7941.3418">Niso receives boomerang_params_signed_by_boomlet_0 from Boomlet and proceeds to share it with other</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.4185" x="2133.1133" y="7956.6523">peers' Nisos.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2478.6899,8001.0156,2468.6899,8005.0156,2478.6899,8009.0156,2474.6899,8005.0156" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3765.1384,8001.0156,3775.1384,8005.0156,3765.1384,8009.0156,3769.1384,8005.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3771.1384" y1="8005.0156" y2="8005.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="7992.6182">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.8545" x="2515.4771" y="7984.9629">SetupNisoPeerNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.7515" x="2519.5903" y="8000.2734">boomerang_params_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2010,8018.0156,2925,8018.0156,2935,8052.0156,2925,8087.0156,2010,8087.0156,2000,8052.0156,2010,8018.0156" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="755.3267" x="2012" y="8034.584">Niso receives boomerang_params_signed_by_boomlet_i from peers, sending boomerang_params_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.1431" x="2016.1133" y="8049.8945">at the same time. It checks the content of each to be equal to boomerang_params_signed_by_boomlet_0 and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="903.1445" x="2016.1133" y="8065.2051">for the signatures to be valid.  It then forms boomerang_params_signed_by_all_peers: Collection&lt;(boomerang_params_signed_by_boomlet_i)&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6577" x="2016.1133" y="8080.5156">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="2161,8097.2578,2773,8097.2578,2783,8108.2578,2773,8120.2578,2161,8120.2578,2151,8108.2578,2161,8097.2578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="608.7085" x="2163" y="8113.8262">Assert boomerang_params_signed_by_boomlet_i.content == boomerang_params [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2011,8130.5684,2923,8130.5684,2933,8141.5684,2923,8153.5684,2011,8153.5684,2001,8141.5684,2011,8130.5684" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="908.8257" x="2013" y="8147.1367">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: boomerang_params_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,8191.5,1511.3169,8195.5,1521.3169,8199.5,1517.3169,8195.5" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="8194.75" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="8195.5" y2="8195.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="8183.1025">[45]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="8175.4473">SetupNisoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="704.3105" x="1562.2173" y="8190.7578">boomerang_params_signed_by_all_peers: Collection&lt;boomerang_params_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1152,8208.5,1867,8208.5,1877,8250.5,1867,8292.5,1152,8292.5,1142,8250.5,1152,8208.5" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.3008" x="1154" y="8225.0684">Boomlet receives boomerang_params_signed_by_all_peers from Niso. It checks the content of each peer's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="702.9966" x="1158.1133" y="8240.3789">boomerang_params_signed_by_boomlet_i to be equal to boomerang_params_signed_by_boomlet_0 and for the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.1812" x="1158.1133" y="8255.6895">signatures to match peer_i.boomlet_i_identity_pubkey.  If the message checks out, Boomlet fixes the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.4688" x="1158.1133" y="8271">boomerang_params as an agreed upon value between peers, changing of which will be addressed in ancillary.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.022" x="1158.1133" y="8286.3105">It then informs Niso that boomerang_params is fixed.</text><polygon fill="#FFC0CB" points="1203,8303.0527,1815,8303.0527,1825,8314.0527,1815,8326.0527,1203,8326.0527,1193,8314.0527,1203,8303.0527" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="608.7085" x="1205" y="8319.6211">Assert boomerang_params_signed_by_boomlet_i.content == boomerang_params [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1053,8336.3633,1965,8336.3633,1975,8347.3633,1965,8359.3633,1053,8359.3633,1043,8347.3633,1053,8336.3633" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="908.8257" x="1055" y="8352.9316">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: boomerang_params_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="8407.5449" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,8404.2949,2465.6899,8408.2949,2455.6899,8412.2949,2459.6899,8408.2949" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="8408.2949" y2="8408.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="8395.8975">[46]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="8388.2422">SetupBoomletNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261.022" x="1552.2173" y="8403.5527">magic: "setup_boomerang_params_fixed"</text></g><polygon fill="#FFF0F5" points="2116,8421.2949,2818,8421.2949,2828,8440.2949,2818,8459.2949,2116,8459.2949,2106,8440.2949,2116,8421.2949" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.9639" x="2118" y="8437.8633">Niso receives {magic: "setup_boomerang_params_fixed"} from Boomlet and informs it to generate the mystery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.6611" x="2122.1133" y="8453.1738">value that's used for withdrawal.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,8497.5371,1511.3169,8501.5371,1521.3169,8505.5371,1517.3169,8501.5371" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="8500.7871" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="8501.5371" y2="8501.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="8489.1396">[47]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="8481.4844">SetupNisoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.5493" x="1562.2173" y="8496.7949">magic: "setup_boomerang_params_fixed_boomlet_can_draw_mystery"</text></g><polygon fill="#FFF0F5" points="1128,8514.5371,1892,8514.5371,1902,8563.5371,1892,8613.5371,1128,8613.5371,1118,8563.5371,1128,8514.5371" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="687.521" x="1130" y="8531.1055">Boomlet receives {magic: "setup_boomerang_params_fixed"} from Niso. Boomlet then generates mystery as a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="752.2544" x="1134.1133" y="8546.416">random integer between MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS and MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="719.71" x="1134.1133" y="8561.7266">Initializes the counter value as 0, hashes boomerang_params using sha256 to get boomerang_params_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="731.4087" x="1134.1133" y="8577.0371">and signs it to get boomerang_params_fingerprint_signed_by_boomlet_0, sorts peer_ids.boomlet_i_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.1333" x="1134.1133" y="8592.3477">values and signs it to get sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0 and sends this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="535.9072" x="1134.1133" y="8607.6582">alongside sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0 to Niso.</text><polygon fill="#E6E6FA" points="1161,8624.4004,1859,8624.4004,1869,8719.4004,1859,8815.4004,1161,8815.4004,1151,8719.4004,1161,8624.4004" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="678.5962" x="1163" y="8640.9688">mystery := Rand(MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS, MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.0981" x="1167.1133" y="8656.2793">counter := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402.2827" x="1167.1133" y="8671.5898">boomerang_params_fingerprint := sha256(boomerang_params)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="501.5156" x="1167.1133" y="8686.9004">boomerang_params_fingerprint_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.6646" x="1167.1133" y="8702.2109">signature: schnorr_sign(boomlet_0_identity_privkey, boomerang_params_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.2646" x="1167.1133" y="8717.5215">content: boomerang_params_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1167.1133" y="8732.832">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="685.9277" x="1167.1133" y="8748.1426">sorted_all_peers_boomlet_identity_pubkeys := sort(boomerang_params.peer_ids.boomlet_i_identity_pubkey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="576.6211" x="1167.1133" y="8763.4531">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616.77" x="1167.1133" y="8778.7637">signature: schnorr_sign(boomlet_0_identity_privkey, sorted_all_peers_boomlet_identity_pubkeys),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.3701" x="1167.1133" y="8794.0742">content: sorted_all_peers_boomlet_identity_pubkeys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1167.1133" y="8809.3848">}</text><path d="M51,8835.127 L243.9321,8835.127 L243.9321,8842.4375 L233.9321,8852.4375 L51,8852.4375 L51,8835.127" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2466.0918" style="stroke:#000000;stroke-width:1.5;" width="3767.24" x="51" y="8835.127"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147.9321" x="66" y="8848.6953">watchtower activation</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="8903.6191" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,8900.3691,2465.6899,8904.3691,2455.6899,8908.3691,2459.6899,8904.3691" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="8904.3691" y2="8904.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="8884.3164">[48]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="8869.0059">SetupBoomletNisoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.7266" x="1552.2173" y="8884.3164">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.6211" x="1552.2173" y="8899.627">boomerang_params_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2060,8917.3691,2875,8917.3691,2885,8943.3691,2875,8970.3691,2060,8970.3691,2050,8943.3691,2060,8917.3691" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="513.0874" x="2062" y="8933.9375">Niso receives {sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="802.8262" x="2066.1133" y="8949.248">boomerang_params_fingerprint_signed_by_boomlet_0} from Boomlet and forwards them alongside boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.6348" x="2066.1133" y="8964.5586">and peer_0_tor_address_signed_by_boomlet_0 to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2467.1899" cy="9058.1035" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3140.7803,9054.8535,3150.7803,9058.8535,3140.7803,9062.8535,3144.7803,9058.8535" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2471.6899" x2="3146.7803" y1="9058.8535" y2="9058.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2474.6899" y="9023.4902">[49]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="2505.4771" y="8992.8691">SetupNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="2509.5903" y="9008.1797">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.7266" x="2509.5903" y="9023.4902">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.5635" x="2509.5903" y="9038.8008">peer_0_tor_address_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.6211" x="2509.5903" y="9054.1113">boomerang_params_fingerprint_signed_by_boomlet_0</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="3163.7803,9145.4063,3153.7803,9149.4063,3163.7803,9153.4063,3159.7803,9149.4063" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3776.6384" cy="9148.6563" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3157.7803" x2="3772.1384" y1="9149.4063" y2="9149.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="3169.7803" y="9083.4219">SetupNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="3173.8936" y="9098.7324">boomlet_i_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413.2642" x="3173.8936" y="9114.043">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.6387" x="3173.8936" y="9129.3535">peer_i_tor_address_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.2612" x="3173.8936" y="9144.6641">boomerang_params_fingerprint_signed_by_boomlet_i [1&lt;=i&lt;=4]</text></g><polygon fill="#FFF0F5" points="2791,9162.4063,3514,9162.4063,3524,9211.4063,3514,9261.4063,2791,9261.4063,2781,9211.4063,2791,9162.4063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="677.2188" x="2793" y="9178.9746">WT receives {boomlet_i_identity_pubkey, sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="702.2158" x="2797.1133" y="9194.2852">peer_i_tor_address_signed_by_boomlet_i, boomerang_params_fingerprint_signed_by_boomlet_i} from Niso and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="606.6138" x="2797.1133" y="9209.5957">Peers. WT checks the signature of the received boomlet_i_identity_pubkey on the corresponding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="706.6719" x="2797.1133" y="9224.9063">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i, peer_i_tor_address_signed_by_boomlet_i and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="711.0518" x="2797.1133" y="9240.2168">boomerang_params_fingerprint_signed_by_boomlet_i. It then responds to each peer's Niso with an invoice made</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.3828" x="2797.1133" y="9255.5273">for that peer.</text><polygon fill="#FFC0CB" points="2623,9272.2695,3680,9272.2695,3690,9283.2695,3680,9295.2695,2623,9295.2695,2613,9283.2695,2623,9272.2695" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1053.7808" x="2625" y="9288.8379">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i.signature) == True[0 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2701,9305.5801,3603,9305.5801,3613,9316.5801,3603,9328.5801,2701,9328.5801,2691,9316.5801,2701,9305.5801" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.1553" x="2703" y="9322.1484">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: peer_i_tor_address_signed_by_boomlet_i.signature) == True[0 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2661,9338.8906,3643,9338.8906,3653,9349.8906,3643,9361.8906,2661,9361.8906,2651,9349.8906,2661,9338.8906" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="978.6753" x="2663" y="9355.459">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: boomerang_params_fingerprint_signed_by_boomlet_i.signature) == True[0 &lt;= i &lt;= 4].</text><polygon fill="#E6E6FA" points="2966,9372.2012,3339,9372.2012,3349,9414.2012,3339,9456.2012,2966,9456.2012,2956,9414.2012,2966,9372.2012" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369.1099" x="2968" y="9388.7695">wt_service_fee_payment_info := WtServiceFeePaymentInfo{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.4209" x="2972.1133" y="9404.0801">service_fee_invoice: service_fee_invoice,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.4902" x="2972.1133" y="9419.3906">payment_deadline: payment_deadline,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.8643" x="2972.1133" y="9434.7012">wt_id: wt_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2968" y="9450.0117">}</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2478.6899,9494.375,2468.6899,9498.375,2478.6899,9502.375,2474.6899,9498.375" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3152.2803" cy="9497.625" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3147.7803" y1="9498.375" y2="9498.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="9485.9775">[50]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="2515.4771" y="9478.3223">SetupWtNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.7744" x="2519.5903" y="9493.6328">wt_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="2228,9511.375,2706,9511.375,2716,9522.375,2706,9534.375,2228,9534.375,2218,9522.375,2228,9511.375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="474.0112" x="2230" y="9527.9434">Niso receives wt_service_fee_payment_info from WT and outputs it to User.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="418.2012,9572.3066,408.2012,9576.3066,418.2012,9580.3066,414.2012,9576.3066" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="9575.5566" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="2462.6899" y1="9576.3066" y2="9576.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="9563.9092">[51]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.8398" x="454.9883" y="9556.2539">SetupNisoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.7744" x="459.1016" y="9571.5645">wt_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="71,9589.3066,743,9589.3066,753,9608.3066,743,9627.3066,71,9627.3066,61,9608.3066,71,9589.3066" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="663.9712" x="73" y="9605.875">User receives wt_service_fee_payment_info from Niso, verifies the service_fee_invoice and wt_id and pays</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.4277" x="77.1133" y="9621.1855">the invoice generating wt_service_fee_payment_receipt as a result.</text><polygon fill="#E6E6FA" points="186,9637.9277,627,9637.9277,637,9648.9277,627,9660.9277,186,9660.9277,176,9648.9277,186,9637.9277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437.5059" x="188" y="9654.4961">wt_service_fee_payment_receipt := pay(wt_service_fee_payment_info)</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="406.7012" cy="9702.1094" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,9698.8594,2465.6899,9702.8594,2455.6899,9706.8594,2459.6899,9702.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="2461.6899" y1="9702.8594" y2="9702.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="9690.4619">[52]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.1792" x="444.9883" y="9682.8066">SetupNisoInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.4492" x="449.1016" y="9698.1172">wt_service_fee_payment_receipt</text></g><polygon fill="#FFF0F5" points="2215,9715.8594,2718,9715.8594,2728,9726.8594,2718,9738.8594,2215,9738.8594,2205,9726.8594,2215,9715.8594" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.4399" x="2217" y="9732.4277">Niso receives wt_service_fee_payment_receipt from User and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2467.1899" cy="9780.041" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3140.7803,9776.791,3150.7803,9780.791,3140.7803,9784.791,3144.7803,9780.791" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2471.6899" x2="3146.7803" y1="9780.791" y2="9780.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2474.6899" y="9768.3936">[53]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="2505.4771" y="9760.7383">SetupNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.4492" x="2509.5903" y="9776.0488">wt_service_fee_payment_receipt</text></g><polygon fill="#FFF0F5" points="2812,9793.791,3492,9793.791,3502,9812.791,3492,9831.791,2812,9831.791,2802,9812.791,2812,9793.791" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.9375" x="2814" y="9810.3594">WT receives wt_service_fee_payment_receipt from Niso and verifies it. It then signs the previously received</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="624.3555" x="2818.1133" y="9825.6699">boomerang_params_fingerprint and returns boomerang_params_fingerprint_signed_by_wt to Niso.</text><polygon fill="#E6E6FA" points="2923,9842.4121,3380,9842.4121,3390,9876.4121,3380,9911.4121,2923,9911.4121,2913,9876.4121,2923,9842.4121" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="449.522" x="2925" y="9858.9805">boomerang_params_fingerprint_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435.646" x="2929.1133" y="9874.291">signature: schnorr_sign(wt_privkey, boomerang_params_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.2646" x="2929.1133" y="9889.6016">content: boomerang_params_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2929.1133" y="9904.9121">}</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2478.6899,9949.2754,2468.6899,9953.2754,2478.6899,9957.2754,2474.6899,9953.2754" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3152.2803" cy="9952.5254" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3147.7803" y1="9953.2754" y2="9953.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="9940.8779">[54]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="2515.4771" y="9933.2227">SetupWtNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.6274" x="2519.5903" y="9948.5332">boomerang_params_fingerprint_signed_by_wt</text></g><polygon fill="#FFF0F5" points="2110,9966.2754,2823,9966.2754,2833,9992.2754,2823,10019.2754,2110,10019.2754,2100,9992.2754,2110,9966.2754" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.8237" x="2112" y="9982.8438">Niso receives boomerang_params_fingerprint_signed_by_wt from WT. Niso verifies wt_pubkey's signature,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="701.5874" x="2116.1133" y="9998.1543">checks that the content matches the boomerang_params_fingerprint_signed_by_boomlet_0 that was previously</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.2329" x="2116.1133" y="10013.4648">sent and forwards it to Boomlet.</text><polygon fill="#FFC0CB" points="2060,10030.207,2873,10030.207,2883,10041.207,2873,10053.207,2060,10053.207,2050,10041.207,2060,10030.207" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="809.6245" x="2062" y="10046.7754">Assert boomerang_params_fingerprint_signed_by_wt.content == boomerang_params_fingerprint_signed_by_boomlet_0.content</text><polygon fill="#FFC0CB" points="2096,10063.5176,2839,10063.5176,2849,10074.5176,2839,10086.5176,2096,10086.5176,2086,10074.5176,2096,10063.5176" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="739.0322" x="2098" y="10080.0859">Assert schnorr_verify(pubkey: wt_pubkey, content: boomerang_params_fingerprint_signed_by_wt.signature) == True</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,10124.4492,1511.3169,10128.4492,1521.3169,10132.4492,1517.3169,10128.4492" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="10127.6992" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="10128.4492" y2="10128.4492"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="10116.0518">[55]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="10108.3965">SetupNisoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.6274" x="1562.2173" y="10123.707">boomerang_params_fingerprint_signed_by_wt</text></g><polygon fill="#FFF0F5" points="1152,10141.4492,1868,10141.4492,1878,10183.4492,1868,10225.4492,1152,10225.4492,1142,10183.4492,1152,10141.4492" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="708.2905" x="1154" y="10158.0176">Boomlet receives boomerang_params_fingerprint_signed_by_wt from WT, checks the content to match what was</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.9844" x="1158.1133" y="10173.3281">previously sent and verifies the signature using wt_pubkey. It then hashes boomerang_params alongside</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.3657" x="1158.1133" y="10188.6387">{magic: "setup_wt_service_initialized"} to get shared_state_active_wt_fingerprint and signs it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.6074" x="1158.1133" y="10203.9492">shared_state_active_wt_fingerprint_signed_by_boomlet_0, returning this to Niso to check if other peers have</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.5303" x="1158.1133" y="10219.2598">also finalized the same wt.</text><polygon fill="#FFC0CB" points="1201,10236.002,1819,10236.002,1829,10247.002,1819,10259.002,1201,10259.002,1191,10247.002,1201,10236.002" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="614.4341" x="1203" y="10252.5703">Assert boomerang_params_fingerprint_signed_by_wt.content == boomerang_params_fingerprint</text><polygon fill="#FFC0CB" points="1138,10269.3125,1881,10269.3125,1891,10280.3125,1881,10292.3125,1138,10292.3125,1128,10280.3125,1138,10269.3125" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="739.0322" x="1140" y="10285.8809">Assert schnorr_verify(pubkey: wt_pubkey, content: boomerang_params_fingerprint_signed_by_wt.signature) == True</text><path d="M987,10304.623 L1731.7656,10304.623 L1731.7656,10311.9336 L1721.7656,10321.9336 L987,10321.9336 L987,10304.623" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="647.3164" style="stroke:#000000;stroke-width:1.5;" width="2821.24" x="987" y="10304.623"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="699.7656" x="1002" y="10318.1914">&lt;Boomlet Shared State in Sync regarding the WT service being activated and all peers in the know of it&gt;</text><polygon fill="#E6E6FA" points="1223,10326.9336,1795,10326.9336,1805,10398.9336,1795,10471.9336,1223,10471.9336,1213,10398.9336,1223,10326.9336" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362.3687" x="1225" y="10343.502">shared_state_active_wt := SharedStateBoomerangParams{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.8828" x="1229.1133" y="10358.8125">boomerang_params: boomerang_params</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.4897" x="1229.1133" y="10374.123">magic: "setup_wt_service_initialized"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1225" y="10389.4336">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440.0259" x="1229.1133" y="10404.7441">shared_state_active_wt_fingerprint := sha256(shared_state_active_wt)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520.3872" x="1229.1133" y="10420.0547">shared_state_active_wt_fingerprint_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="560.5361" x="1229.1133" y="10435.3652">signature: schnorr_sign(boomlet_0_identity_privkey, shared_state_active_wt_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.1362" x="1229.1133" y="10450.6758">content: shared_state_active_wt_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1229.1133" y="10465.9863">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="10513.5996" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,10510.3496,2465.6899,10514.3496,2455.6899,10518.3496,2459.6899,10514.3496" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="10514.3496" y2="10514.3496"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="10501.9521">[56]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="10494.2969">SetupBoomletNisoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="361.4927" x="1552.2173" y="10509.6074">shared_state_active_wt_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2126,10527.3496,2808,10527.3496,2818,10538.3496,2808,10550.3496,2126,10550.3496,2116,10538.3496,2126,10527.3496" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="678.5137" x="2128" y="10543.918">Niso receives shared_state_active_wt_fingerprint_signed_by_boomlet_0 and proceeds to share it with Peers.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2478.6899,10588.2813,2468.6899,10592.2813,2478.6899,10596.2813,2474.6899,10592.2813" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3765.1384,10588.2813,3775.1384,10592.2813,3765.1384,10596.2813,3769.1384,10592.2813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3771.1384" y1="10592.2813" y2="10592.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="10579.8838">[57]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.8545" x="2515.4771" y="10572.2285">SetupNisoPeerNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="447.5859" x="2519.5903" y="10587.5391">shared_state_active_wt_fingerprint_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2041,10605.2813,2893,10605.2813,2903,10647.2813,2893,10689.2813,2041,10689.2813,2031,10647.2813,2041,10605.2813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="575.3896" x="2043" y="10621.8496">Niso receives shared_state_active_wt_fingerprint_signed_by_boomlet_i from peers, sending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="537.748" x="2047.1133" y="10637.1602">shared_state_active_wt_fingerprint_signed_by_boomlet_0 at the same time. It verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.0029" x="2047.1133" y="10652.4707">boomlet_i_identity_pubkey's signature on each and the contents to match the one signed by boomlet_0, then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="840.3853" x="2047.1133" y="10667.7813">forms shared_state_active_wt_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_wt_fingerprint_signed_by_boomlet_i&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6577" x="2047.1133" y="10683.0918">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="1964,10699.834,2969,10699.834,2979,10710.834,2969,10722.834,1964,10722.834,1954,10710.834,1964,10699.834" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1001.6602" x="1966" y="10716.4023">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_wt_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1972,10733.1445,2961,10733.1445,2971,10744.1445,2961,10756.1445,1972,10756.1445,1962,10744.1445,1972,10733.1445" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="985.4546" x="1974" y="10749.7129">Assert shared_state_active_wt_fingerprint_signed_by_boomlet_i.content == shared_state_active_wt_fingerprint_signed_by_boomlet_0.content [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,10794.0762,1511.3169,10798.0762,1521.3169,10802.0762,1517.3169,10798.0762" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="10797.3262" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="10798.0762" y2="10798.0762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="10785.6787">[58]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="10778.0234">SetupNisoBoomletMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="889.9795" x="1562.2173" y="10793.334">shared_state_active_wt_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_wt_fingerprint_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1111,10811.0762,1908,10811.0762,1918,10845.0762,1908,10880.0762,1111,10880.0762,1101,10845.0762,1111,10811.0762" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.1694" x="1113" y="10827.6445">Boomlet receives shared_state_active_wt_fingerprint_signed_by_all_peers from Niso. It checks the content of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523.999" x="1117.1133" y="10842.9551">each peer's shared_state_active_wt_fingerprint_signed_by_boomlet_i to be equal to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="785.0527" x="1117.1133" y="10858.2656">shared_state_active_wt_fingerprint_signed_by_boomlet_0 and for the signatures to match peer_i.boomlet_i_identity_pubkey.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.5859" x="1117.1133" y="10873.5762">It then informs Niso that wt is confirmed and active for all peers.</text><polygon fill="#FFC0CB" points="1007,10890.3184,2012,10890.3184,2022,10901.3184,2012,10913.3184,1007,10913.3184,997,10901.3184,1007,10890.3184" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1001.6602" x="1009" y="10906.8867">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_wt_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1113,10923.6289,1907,10923.6289,1917,10934.6289,1907,10946.6289,1113,10946.6289,1103,10934.6289,1113,10923.6289" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="790.2642" x="1115" y="10940.1973">Assert shared_state_active_wt_fingerprint_signed_by_boomlet_i.content == shared_state_active_wt_fingerprint [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="10994.8105" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,10991.5605,2465.6899,10995.5605,2455.6899,10999.5605,2459.6899,10995.5605" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="10995.5605" y2="10995.5605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="10983.1631">[59]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="10975.5078">SetupBoomletNisoMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.4326" x="1552.2173" y="10990.8184">magic: "setup_wt_service_confirmed_by_peers"</text></g><polygon fill="#FFF0F5" points="2106,11008.5605,2827,11008.5605,2837,11019.5605,2827,11031.5605,2106,11031.5605,2096,11019.5605,2106,11008.5605" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="717.7422" x="2108" y="11025.1289">Niso receives {magic: "setup_wt_service_confirmed_by_peers"} from Boomlet and informs Boomlet to finalize sars.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,11069.4922,1511.3169,11073.4922,1521.3169,11077.4922,1517.3169,11073.4922" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="11072.7422" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="11073.4922" y2="11073.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="11061.0947">[60]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="11053.4395">SetupNisoBoomletMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="438.6929" x="1562.2173" y="11068.75">magic: "setup_wt_service_confirmed_by_peers_sars_can_be_finalized"</text></g><polygon fill="#FFF0F5" points="1085,11086.4922,1934,11086.4922,1944,11128.4922,1934,11170.4922,1085,11170.4922,1075,11128.4922,1085,11086.4922" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="716.0918" x="1087" y="11103.0605">Boomlet receives {magic: "setup_wt_service_confirmed_by_peers_sars_can_be_finalized"} from Niso. Boomlet then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="633.6675" x="1091.1133" y="11118.3711">generates doxing_data_identifier by hashing doxing_key and encrypts it by sar_pubkey. It also signs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="649.1304" x="1091.1133" y="11133.6816">sar_ids_collection and encrypts sar_ids_collection_signed_by_boomlet_0 it by wt_pubkey. It then sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="836.8496" x="1091.1133" y="11148.9922">{sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, doxing_data_identifier_encrypted_by_boomlet_0_for_sar}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.0483" x="1091.1133" y="11164.3027">to Niso.</text><polygon fill="#E6E6FA" points="872,11181.0449,2147,11181.0449,2157,11238.0449,2147,11296.0449,872,11296.0449,862,11238.0449,872,11181.0449" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.313" x="874" y="11197.6133">doxing_data_identifier := sha256(doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1045.3193" x="878.1133" y="11212.9238">doxing_data_identifier_encrypted_by_boomlet_0_for_sar := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: doxing_data_identifier)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413.6514" x="878.1133" y="11228.2344">sar_ids_collection_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="453.8003" x="878.1133" y="11243.5449">signature: schnorr_sign(boomlet_0_identity_privkey, sar_ids_collection),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.4004" x="878.1133" y="11258.8555">content: sar_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="878.1133" y="11274.166">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1267.5635" x="878.1133" y="11289.4766">sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt :=  AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: sar_ids_collection_signed_by_boomlet_0)</text><path d="M35,11315.2188 L170.9365,11315.2188 L170.9365,11322.5293 L160.9365,11332.5293 L35,11332.5293 L35,11315.2188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2396.1602" style="stroke:#000000;stroke-width:1.5;" width="4235.5117" x="35" y="11315.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.9365" x="50" y="11328.7871">sar activation</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="11383.7109" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,11380.4609,2465.6899,11384.4609,2455.6899,11388.4609,2459.6899,11384.4609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="11384.4609" y2="11384.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="11364.4082">[61]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="11349.0977">SetupBoomletNisoMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="464.6167" x="1552.2173" y="11364.4082">sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.5513" x="1552.2173" y="11379.7188">doxing_data_identifier_encrypted_by_boomlet_0_for_sar</text></g><polygon fill="#FFF0F5" points="2166,11397.4609,2768,11397.4609,2778,11416.4609,2768,11435.4609,2166,11435.4609,2156,11416.4609,2166,11397.4609" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="559.9775" x="2168" y="11414.0293">Niso receives {sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="594.001" x="2172.1133" y="11429.3398">doxing_data_identifier_encrypted_by_boomlet_0_for_sar} from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2467.1899" cy="11492.2637" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3140.7803,11489.0137,3150.7803,11493.0137,3140.7803,11497.0137,3144.7803,11493.0137" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2471.6899" x2="3146.7803" y1="11493.0137" y2="11493.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2474.6899" y="11472.9609">[62]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="2505.4771" y="11457.6504">SetupNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="464.6167" x="2509.5903" y="11472.9609">sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.5513" x="2509.5903" y="11488.2715">doxing_data_identifier_encrypted_by_boomlet_0_for_sar</text></g><polygon fill="#FFF0F5" points="2691,11506.0137,3614,11506.0137,3624,11548.0137,3614,11590.0137,2691,11590.0137,2681,11548.0137,2691,11506.0137" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="915.2368" x="2693" y="11522.582">WT receives {sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, doxing_data_identifier_encrypted_by_boomlet_0_for_sar}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="715.3174" x="2697.1133" y="11537.8926">from Niso and decrypts sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt. It then verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="491.7656" x="2697.1133" y="11553.2031">the signature on sar_ids_collection_signed_by_boomlet_0 and if correct sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="683.6362" x="2697.1133" y="11568.5137">doxing_data_identifier_encrypted_by_boomlet_0_for_sar alongside boomlet_0_identity_pubkey to the SAR in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.54" x="2697.1133" y="11583.8242">sar_ids_collection.</text><polygon fill="#E6E6FA" points="2518,11600.5664,3785,11600.5664,3795,11611.5664,3785,11623.5664,2518,11623.5664,2508,11611.5664,2518,11600.5664" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1263.5645" x="2520" y="11617.1348">sar_ids_collection_signed_by_boomlet_0 := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, wt_privkey), content: sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt)</text><polygon fill="#FFC0CB" points="2744,11633.877,3561,11633.877,3571,11644.877,3561,11656.877,2744,11656.877,2734,11644.877,2744,11633.877" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="813.2935" x="2746" y="11650.4453">Assert schnorr_verify(pubkey: boomlet_0_identity_pubkey, content: sar_ids_collection_signed_by_boomlet_0.signature) == True.</text><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="3152.2803" cy="11713.3691" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3633.7715,11710.1191,3643.7715,11714.1191,3633.7715,11718.1191,3637.7715,11714.1191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3156.7803" x2="3639.7715" y1="11714.1191" y2="11714.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3159.7803" y="11694.0664">[63]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141.9907" x="3190.5674" y="11678.7559">SetupWtSarMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.5513" x="3194.6807" y="11694.0664">doxing_data_identifier_encrypted_by_boomlet_0_for_sar</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="3194.6807" y="11709.377">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3247,11727.1191,4042,11727.1191,4052,11792.1191,4042,11857.1191,3247,11857.1191,3237,11792.1191,3247,11727.1191" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.8345" x="3249" y="11743.6875">SAR receives {doxing_data_identifier_encrypted_by_boomlet_0_for_sar, boomlet_0_identity_pubkey} from WT.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="723.6899" x="3253.1133" y="11758.998">ST decrypts doxing_data_identifier_encrypted_by_boomlet_0_for_sar using boomlet_0_identity_pubkey and checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.2627" x="3253.1133" y="11774.3086">if the plaintext was previously received as doxing_data_identifier. If True it generates sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="609.5146" x="3253.1133" y="11789.6191">containing {doxing_data_identifier, fingerprint_of_static_doxing_data_encrypted_by_doxing_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="769.7422" x="3253.1133" y="11804.9297">iv_of_static_doxing_data_encrypted_by_doxing_key} in which fingerprint_of_static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="783.5737" x="3253.1133" y="11820.2402">is the sha256 hash of static_doxing_data_encrypted_by_doxing_key and iv_of_static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="730.6025" x="3253.1133" y="11835.5508">is the iv used in AES encryption algorithm it got alongside the ciphertext of doxing_data_encrypted_by_doxing_key.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="678.5581" x="3253.1133" y="11850.8613">SAR then signs sar_setup_response encrypts it with boomlet_0_identity_pubkey and sends the result to WT.</text><polygon fill="#E6E6FA" points="3067,11867.6035,4224,11867.6035,4234,11878.6035,4224,11890.6035,3067,11890.6035,3057,11878.6035,3067,11867.6035" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1153.2803" x="3069" y="11884.1719">freshly_received_doxing_data_identifier := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, sar_privkey), content: doxing_data_identifier_encrypted_by_boomlet_0_for_sar)</text><polygon fill="#FFC0CB" points="3412,11900.9141,3879,11900.9141,3889,11911.9141,3879,11923.9141,3412,11923.9141,3402,11911.9141,3412,11900.9141" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.5059" x="3414" y="11917.4824">Assert freshly_received_doxing_data_identifier == doxing_data_identifier</text><polygon fill="#E6E6FA" points="3040,11934.2246,4250,11934.2246,4260,12014.2246,4250,12095.2246,3040,12095.2246,3030,12014.2246,3040,11934.2246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.354" x="3042" y="11950.793">sar_setup_response := SarSetupResponse{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.2295" x="3046.1133" y="11966.1035">doxing_data_identifier: doxing_data_identifier,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="731.7451" x="3046.1133" y="11981.4141">fingerprint_of_static_doxing_data_encrypted_by_doxing_key: sha256(static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="634.3784" x="3046.1133" y="11996.7246">iv_of_static_doxing_data_encrypted_by_doxing_key: static_doxing_data_encrypted_by_doxing_key.iv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="3042" y="12012.0352">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.8789" x="3046.1133" y="12027.3457">sar_setup_response_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.0029" x="3046.1133" y="12042.6563">signature: schnorr_sign(sar_privkey, sar_setup_response),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.375" x="3046.1133" y="12057.9668">content: sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="3046.1133" y="12073.2773">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1202.3984" x="3046.1133" y="12088.5879">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, sar_privkey), content: sar_setup_response_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="3163.7803,12132.9512,3153.7803,12136.9512,3163.7803,12140.9512,3159.7803,12136.9512" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3645.2715" cy="12136.2012" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3157.7803" x2="3640.7715" y1="12136.9512" y2="12136.9512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="3169.7803" y="12124.5537">[64]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141.9907" x="3200.5674" y="12116.8984">SetupSarWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="434.0908" x="3204.6807" y="12132.209">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2798,12149.9512,3506,12149.9512,3516,12168.9512,3506,12187.9512,2798,12187.9512,2788,12168.9512,2798,12149.9512" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="682.8745" x="2800" y="12166.5195">WT receives sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0 from SAR. It then adds the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="699.9497" x="2804.1133" y="12181.8301">suffix "setup_sar_acknowledgement_of_finalization_received" to it, signs it with wt_privkey and send it to Niso.</text><polygon fill="#E6E6FA" points="2754,12198.5723,3551,12198.5723,3561,12263.5723,3551,12328.5723,2754,12328.5723,2744,12263.5723,2754,12198.5723" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="692.7896" x="2756" y="12215.1406">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt := WtSarSetupResponse{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="494.1777" x="2760.1133" y="12230.4512">content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.001" x="2760.1133" y="12245.7617">wt_suffix: "setup_sar_acknowledgement_of_finalization_received"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2760.1133" y="12261.0723">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="785.0845" x="2760.1133" y="12276.3828">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="771.2085" x="2760.1133" y="12291.6934">signature: schnorr_sign(wt_privkey, sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="590.8271" x="2760.1133" y="12307.0039">content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="2760.1133" y="12322.3145">}</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2478.6899,12366.6777,2468.6899,12370.6777,2478.6899,12374.6777,2474.6899,12370.6777" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3152.2803" cy="12369.9277" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3147.7803" y1="12370.6777" y2="12370.6777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="12358.2803">[65]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.8838" x="2515.4771" y="12350.625">SetupWtNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.1899" x="2519.5903" y="12365.9355">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt</text></g><polygon fill="#FFF0F5" points="2064,12383.6777,2870,12383.6777,2880,12409.6777,2870,12436.6777,2064,12436.6777,2054,12409.6777,2064,12383.6777" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="717.3232" x="2066" y="12400.2461">Niso receives sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="794.2886" x="2070.1133" y="12415.5566">checks the signature using wt_pubkey and checks the suffix to match "setup_sar_acknowledgement_of_finalization_received".</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.6792" x="2070.1133" y="12430.8672">It then forwards the message to Boomlet.</text><polygon fill="#FFC0CB" points="1926,12447.6094,3008,12447.6094,3018,12458.6094,3008,12470.6094,1926,12470.6094,1916,12458.6094,1926,12447.6094" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1078.708" x="1928" y="12464.1777">Assert schnorr_verify(pubkey: wt_pubkey, content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.signature) == True.</text><polygon fill="#FFC0CB" points="1944,12480.9199,2989,12480.9199,2999,12491.9199,2989,12503.9199,1944,12503.9199,1934,12491.9199,1944,12480.9199" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1041.5933" x="1946" y="12497.4883">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.suffix == "setup_sar_acknowledgement_of_finalization_received"</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,12541.8516,1511.3169,12545.8516,1521.3169,12549.8516,1517.3169,12545.8516" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="12545.1016" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="12545.8516" y2="12545.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="12533.4541">[66]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1558.104" y="12525.7988">SetupNisoBoomletMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.1899" x="1562.2173" y="12541.1094">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt</text></g><polygon fill="#FFF0F5" points="1137,12558.8516,1881,12558.8516,1891,12615.8516,1881,12673.8516,1137,12673.8516,1127,12615.8516,1137,12558.8516" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="736.6836" x="1139" y="12575.4199">Boomlet receives sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="568.3501" x="1143.1133" y="12590.7305">from Niso. Boomlet verifies the signature using wt_pubkey and checks the suffix to match</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.5327" x="1143.1133" y="12606.041">"setup_sar_acknowledgement_of_finalization_received". It then decrypts the suffixed content to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="696.0713" x="1143.1133" y="12621.3516">sar_setup_response_signed_by_sar, verifies sar_pubkey's signature and makes sure the doxing_data_identifier</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.0649" x="1143.1133" y="12636.6621">in sar_setup_response_signed_by_sar matches what was sent to SAR. Boomlet saves sar_setup_response to send</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="618.3696" x="1143.1133" y="12651.9727">to Iso later on and hashes SharedStateSarFinalization{ magic: "setup_wt_received_sar_data"} to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="662.8794" x="1143.1133" y="12667.2832">shared_state_active_sar_fingerprint. Then signs it using boomlet_0_identity_pubkey and sends it to Niso.</text><polygon fill="#FFC0CB" points="968,12684.0254,2050,12684.0254,2060,12695.0254,2050,12707.0254,968,12707.0254,958,12695.0254,968,12684.0254" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1078.708" x="970" y="12700.5938">Assert schnorr_verify(pubkey: wt_pubkey, content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.signature) == True.</text><polygon fill="#FFC0CB" points="987,12717.3359,2032,12717.3359,2042,12728.3359,2032,12740.3359,987,12740.3359,977,12728.3359,987,12717.3359" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1041.5933" x="989" y="12733.9043">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.suffix == "setup_sar_acknowledgement_of_finalization_received"</text><polygon fill="#E6E6FA" points="907,12750.6465,2113,12750.6465,2123,12761.6465,2113,12773.6465,907,12773.6465,897,12761.6465,907,12750.6465" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1202.5127" x="909" y="12767.2148">sar_setup_response_signed_by_sar := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1169,12783.957,1849,12783.957,1859,12794.957,1849,12806.957,1169,12806.957,1159,12794.957,1169,12783.957" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.749" x="1171" y="12800.5254">Assert schnorr_verify(pubkey: sar_pubkey, content: sar_setup_response_signed_by_sar.signature) == True.</text><polygon fill="#FFC0CB" points="1214,12817.2676,1805,12817.2676,1815,12828.2676,1805,12840.2676,1214,12840.2676,1204,12828.2676,1214,12817.2676" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="587.7422" x="1216" y="12833.8359">sar_setup_response_signed_by_sar.content.doxing_data_identifier == doxing_data_identifier</text><path d="M985,12852.5781 L1798.9487,12852.5781 L1798.9487,12859.8887 L1788.9487,12869.8887 L985,12869.8887 L985,12852.5781" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="632.0059" style="stroke:#000000;stroke-width:1.5;" width="2823.24" x="985" y="12852.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="768.9487" x="1000" y="12866.1465">&lt;Boomlet Shared State in Sync regarding the WT know about SARs being activated and all peers in the know of it&gt;</text><polygon fill="#E6E6FA" points="1221,12874.8887,1798,12874.8887,1808,12939.8887,1798,13004.8887,1221,13004.8887,1211,12939.8887,1221,12874.8887" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.7832" x="1223" y="12891.457">shared_state_active_sar := SharedStateSarFinalization{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.5405" x="1227.1133" y="12906.7676">magic: "setup_wt_received_sar_data"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1223" y="12922.0781">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="448.519" x="1227.1133" y="12937.3887">shared_state_active_sar_fingerprint := sha256(shared_state_active_sar)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="524.6338" x="1227.1133" y="12952.6992">shared_state_active_sar_fingerprint_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="564.7827" x="1227.1133" y="12968.0098">signature: schnorr_sign(boomlet_0_identity_privkey, shared_state_active_sar_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.3828" x="1227.1133" y="12983.3203">content: shared_state_active_sar_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1227.1133" y="12998.6309">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="13046.2441" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,13042.9941,2465.6899,13046.9941,2455.6899,13050.9941,2459.6899,13046.9941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="13046.9941" y2="13046.9941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="13034.5967">[67]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.3794" x="1548.104" y="13026.9414">SetupBoomletNisoMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.7393" x="1552.2173" y="13042.252">shared_state_active_sar_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2124,13059.9941,2810,13059.9941,2820,13070.9941,2810,13082.9941,2124,13082.9941,2114,13070.9941,2124,13059.9941" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="682.7603" x="2126" y="13076.5625">Niso receives shared_state_active_sar_fingerprint_signed_by_boomlet_0 and proceeds to share it with Peers.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2478.6899,13120.9258,2468.6899,13124.9258,2478.6899,13128.9258,2474.6899,13124.9258" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3765.1384,13120.9258,3775.1384,13124.9258,3765.1384,13128.9258,3769.1384,13124.9258" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3771.1384" y1="13124.9258" y2="13124.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="13112.5283">[68]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.8545" x="2515.4771" y="13104.873">SetupNisoPeerNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="451.8325" x="2519.5903" y="13120.1836">shared_state_active_sar_fingerprint_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="2057,13137.9258,2877,13137.9258,2887,13179.9258,2877,13221.9258,2057,13221.9258,2047,13179.9258,2057,13137.9258" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="579.6362" x="2059" y="13154.4941">Niso receives shared_state_active_sar_fingerprint_signed_by_boomlet_i from peers, sending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="724.7119" x="2063.1133" y="13169.8047">shared_state_active_sar_fingerprint_signed_by_boomlet_0 at the same time. It verifies boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="548.2471" x="2063.1133" y="13185.1152">signature on each and the contents to match the one signed by boomlet_0, then forms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="807.917" x="2063.1133" y="13200.4258">shared_state_active_sar_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_sar_fingerprint_signed_by_boomlet_i&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6577" x="2063.1133" y="13215.7363">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="1962,13232.4785,2971,13232.4785,2981,13243.4785,2971,13255.4785,1962,13255.4785,1952,13243.4785,1962,13232.4785" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1005.9067" x="1964" y="13249.0469">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_sar_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1968,13265.7891,2965,13265.7891,2975,13276.7891,2965,13288.7891,1968,13288.7891,1958,13276.7891,1968,13265.7891" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="993.9478" x="1970" y="13282.3574">Assert shared_state_active_sar_fingerprint_signed_by_boomlet_i.content == shared_state_active_sar_fingerprint_signed_by_boomlet_0.content [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,13326.7207,1511.3169,13330.7207,1521.3169,13334.7207,1517.3169,13330.7207" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="13329.9707" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="13330.7207" y2="13330.7207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="13318.3232">[69]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.9551" x="1558.104" y="13310.668">SetupNisoBoomletMessage10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.4727" x="1562.2173" y="13325.9785">shared_state_active_sar_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_sar_fingerprint_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1157,13343.7207,1862,13343.7207,1872,13377.7207,1862,13412.7207,1157,13412.7207,1147,13377.7207,1157,13343.7207" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.5376" x="1159" y="13360.2891">Boomlet receives shared_state_active_sar_fingerprint_signed_by_all_peers from Niso. It checks the content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="545.124" x="1163.1133" y="13375.5996">of each peer's shared_state_active_sar_fingerprint_signed_by_boomlet_i to be equal to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="569.7148" x="1163.1133" y="13390.9102">shared_state_active_sar_fingerprint_signed_by_boomlet_0 and for the signatures to match</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697.5693" x="1163.1133" y="13406.2207">peer_i.boomlet_i_identity_pubkey. It then informs Niso that sar activation is confirmed and active for all peers.</text><polygon fill="#FFC0CB" points="1005,13422.9629,2014,13422.9629,2024,13433.9629,2014,13445.9629,1005,13445.9629,995,13433.9629,1005,13422.9629" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1005.9067" x="1007" y="13439.5313">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_sar_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1108,13456.2734,1910,13456.2734,1920,13467.2734,1910,13479.2734,1108,13479.2734,1098,13467.2734,1108,13456.2734" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="798.7573" x="1110" y="13472.8418">Assert shared_state_active_sar_fingerprint_signed_by_boomlet_i.content == shared_state_active_sar_fingerprint [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="13527.4551" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,13524.2051,2465.6899,13528.2051,2455.6899,13532.2051,2459.6899,13528.2051" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="13528.2051" y2="13528.2051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="13515.8076">[70]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.9551" x="1548.104" y="13508.1523">SetupBoomletNisoMessage10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392.4756" x="1552.2173" y="13523.4629">magic: "setup_sar_acknowledgement_of_finalization_received"</text></g><polygon fill="#FFF0F5" points="2118,13541.2051,2816,13541.2051,2826,13560.2051,2816,13579.2051,2118,13579.2051,2108,13560.2051,2118,13541.2051" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="690.4854" x="2120" y="13557.7734">Niso receives {magic: "setup_sar_acknowledgement_of_finalization_received"} from Boomlet and informs User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.6489" x="2124.1133" y="13573.084">to initialize backup.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="418.2012,13617.4473,408.2012,13621.4473,418.2012,13625.4473,414.2012,13621.4473" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="13620.6973" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="2462.6899" y1="13621.4473" y2="13621.4473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="13609.0498">[71]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.8398" x="454.9883" y="13601.3945">SetupNisoOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.1196" x="459.1016" y="13616.7051">magic: "setup_sar_finalization_confirmed"</text></g><polygon fill="#FFF0F5" points="55,13634.4473,758,13634.4473,768,13653.4473,758,13672.4473,55,13672.4473,45,13653.4473,55,13634.4473" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.0557" x="57" y="13651.0156">User receives {magic: "setup_sar_finalization_confirmed"} from Niso and proceeds to connect the hardware for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.7437" x="61.1133" y="13666.3262">Boomletwo, which is going to be the backup of Boomlet, to Iso.</text><polygon fill="#E6E6FA" points="2317,13683.0684,2616,13683.0684,2626,13694.0684,2616,13706.0684,2317,13706.0684,2307,13694.0684,2317,13683.0684" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.5942" x="2319" y="13699.6367">Niso drops all information about</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.4849" x="2528.7075" y="13699.6367">wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.2031" x="2549.3057" y="13699.6367">payments.</text><path d="M16,13725.3789 L179.5869,13725.3789 L179.5869,13732.6895 L169.5869,13742.6895 L16,13742.6895 L16,13725.3789" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3791.4824" style="stroke:#000000;stroke-width:1.5;" width="3802.24" x="16" y="13725.3789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118.5869" x="31" y="13738.9473">backup activation</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="406.7012" cy="13778.5605" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1027.4346,13775.3105,1037.4346,13779.3105,1027.4346,13783.3105,1031.4346,13779.3105" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1033.4346" y1="13779.3105" y2="13779.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="13766.9131">[72]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101.2705" x="444.9883" y="13759.2578">SetupIsoInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.4512" x="449.1016" y="13774.5684">magic: "setup_user_is_informed_that_sar_is_set_and_can_install_boomlet_backup"</text></g><polygon fill="#FFF0F5" points="627,13792.3105,1451,13792.3105,1461,13811.3105,1451,13830.3105,627,13830.3105,617,13811.3105,627,13792.3105" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="816.5688" x="629" y="13808.8789">Iso is turned on in backup mode indicated by {magic: "setup_user_is_informed_that_sar_is_set_and_can_install_boomlet_backup"}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441.2573" x="633.1133" y="13824.1895">from User and proceeds to install Boomletwo_binary on the hardware.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomletwo"><ellipse cx="1038.9346" cy="13871.8027" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1627.8081,13868.5527,1637.8081,13872.5527,1627.8081,13876.5527,1631.8081,13872.5527" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1633.8081" y1="13872.5527" y2="13872.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="13860.1553">[73]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.0356" x="1077.2217" y="13852.5">SetupIsoBoomletwo1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.9019" x="1081.335" y="13867.8105">magic: "setup_backup_started"</text></g><polygon fill="#FFF0F5" points="1324,13885.5527,1953,13885.5527,1963,13911.5527,1953,13938.5527,1324,13938.5527,1314,13911.5527,1324,13885.5527" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585.1523" x="1326" y="13902.1211">Boomletwo gets installed indicated by {magic: "setup_backup_started"} from Iso. It generates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="617.665" x="1330.1133" y="13917.4316">boomletwo_Identity_privkey, derives boomletwo_Identity_pubkey from it and responds to Iso with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.8447" x="1330.1133" y="13932.7422">boomletwo_Identity_pubkey.</text><polygon fill="#E6E6FA" points="1398,13949.4844,1881,13949.4844,1891,13968.4844,1881,13987.4844,1398,13987.4844,1388,13968.4844,1398,13949.4844" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314.7993" x="1400" y="13966.0527">boomletwo_Identity_privkey := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="475.1855" x="1404.1133" y="13981.3633">boomletwo_Identity_pubkey := derive_pubkey(boomletwo_Identity_privkey)</text><g class="message" data-participant-1="Boomletwo" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,14025.7266,1040.4346,14029.7266,1050.4346,14033.7266,1046.4346,14029.7266" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1639.3081" cy="14028.9766" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1634.8081" y1="14029.7266" y2="14029.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="14017.3291">[74]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.0356" x="1087.2217" y="14009.6738">SetupBoomletwoIso1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.7314" x="1091.335" y="14024.9844">boomletwo_Identity_pubkey</text></g><polygon fill="#FFF0F5" points="699,14042.7266,1379,14042.7266,1389,14053.7266,1379,14065.7266,699,14065.7266,689,14053.7266,699,14042.7266" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.8506" x="701" y="14059.2949">Iso receives boomletwo_Identity_pubkey from Boomletwo and proceeds to inform User to connect Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="418.2012,14103.6582,408.2012,14107.6582,418.2012,14111.6582,414.2012,14107.6582" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1038.9346" cy="14106.9082" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1034.4346" y1="14107.6582" y2="14107.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="14095.2607">[75]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="75.4673" x="454.9883" y="14087.6055">IsoOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="491.791" x="459.1016" y="14102.916">magic: "setup_boomletwo_identity_pubkey_received_connect_boomlet_to_iso"</text></g><polygon fill="#FFF0F5" points="67,14120.6582,746,14120.6582,756,14146.6582,746,14173.6582,67,14173.6582,57,14146.6582,67,14120.6582" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.8359" x="69" y="14137.2266">User receives {magic: "setup_boomletwo_identity_pubkey_received_connect_boomlet_to_iso"} from Iso and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="658.7979" x="73.1133" y="14152.5371">proceeds to connect Boomlet to Iso and Input the values necessary for backup and for verification of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.5386" x="73.1133" y="14167.8477">received doxing_data_fingerprint.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="406.7012" cy="14292.0137" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1027.4346,14288.7637,1037.4346,14292.7637,1027.4346,14296.7637,1031.4346,14292.7637" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1033.4346" y1="14292.7637" y2="14292.7637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="14242.0898">[76]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.8066" x="444.9883" y="14196.1582">IsoInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.5967" x="449.1016" y="14211.4688">milestone_block_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.0923" x="449.1016" y="14226.7793">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.0537" x="449.1016" y="14242.0898">mnemonic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.2334" x="449.1016" y="14257.4004">passphrase</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.4219" x="449.1016" y="14272.7109">static_doxing_data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6904" x="449.1016" y="14288.0215">doxing_password</text></g><polygon fill="#FFF0F5" points="654,14305.7637,1423,14305.7637,1433,14331.7637,1423,14358.7637,654,14358.7637,644,14331.7637,654,14305.7637" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="714.0796" x="656" y="14322.332">Iso receives {milestone_block_collection, network, mnemonic, passphrase, static_doxing_data, doxing_password}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603.6494" x="660.1133" y="14337.6426">from User. It then generates backup_request which is composed of {"boomlet_backup_request",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="761.7124" x="660.1133" y="14352.9531">boomletwo_Identity_pubkey, normal_pubkey_0}, signs it using normal_privkey_0 and sends the signed value to Boomlet.</text><polygon fill="#E6E6FA" points="836,14369.6953,1242,14369.6953,1252,14441.6953,1242,14514.6953,836,14514.6953,826,14441.6953,836,14369.6953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.8696" x="838" y="14386.2637">backup_request := BoomletBackupRequest{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.4546" x="842.1133" y="14401.5742">magic: "boomlet_backup_request",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.1567" x="842.1133" y="14416.8848">backup_boomlet_pubkey: boomletwo_Identity_pubkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.3374" x="842.1133" y="14432.1953">backup_normal_pubkey: normal_pubkey_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="838" y="14447.5059">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="394.4307" x="842.1133" y="14462.8164">backup_request_signed_by_normal_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380.5547" x="842.1133" y="14478.127">signature: schnorr_sign(normal_privkey_0, backup_request),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.8857" x="842.1133" y="14493.4375">content: backup_request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="842.1133" y="14508.748">}</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1038.9346" cy="14556.3613" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1498.3169,14553.1113,1508.3169,14557.1113,1498.3169,14561.1113,1502.3169,14557.1113" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1504.3169" y1="14557.1113" y2="14557.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="14544.7139">[77]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1077.2217" y="14537.0586">SetupIsoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.5361" x="1081.335" y="14552.3691">backup_request_signed_by_normal_0</text></g><polygon fill="#FFF0F5" points="1149,14570.1113,1869,14570.1113,1879,14612.1113,1869,14654.1113,1149,14654.1113,1139,14612.1113,1149,14570.1113" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.7861" x="1151" y="14586.6797">Boomlet receives backup_request_signed_by_normal_0 from Iso, checks normal_pubkey_0's signature, checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="694.8398" x="1155.1133" y="14601.9902">backup_request.magic to match "boomlet_backup_request" and backup_request.backup_normal_key to match</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="685.0264" x="1155.1133" y="14617.3008">normal_pubkey_0. Boomlet then encrypts it's own data except mystery with boomletwo_Identity_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="708.4937" x="1155.1133" y="14632.6113">sends this boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo, along with boomlet_0_identity_pubkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324.9302" x="1155.1133" y="14647.9219">boomerang_params and sar_setup_response to Iso.</text><polygon fill="#FFC0CB" points="1144,14664.6641,1876,14664.6641,1886,14675.6641,1876,14687.6641,1144,14687.6641,1134,14675.6641,1144,14664.6641" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="728.2285" x="1146" y="14681.2324">Assert schnorr_verify(pubkey: normal_pubkey_0, content: backup_request_signed_by_normal_0.signature) == True</text><polygon fill="#E6E6FA" points="1303,14697.9746,1716,14697.9746,1726,14708.9746,1716,14720.9746,1303,14720.9746,1293,14708.9746,1303,14697.9746" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409.9824" x="1305" y="14714.543">backup_request := backup_request_signed_by_normal_0.content</text><polygon fill="#FFC0CB" points="1316,14731.2852,1702,14731.2852,1712,14742.2852,1702,14754.2852,1316,14754.2852,1306,14742.2852,1316,14731.2852" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.7954" x="1318" y="14747.8535">Assert backup_request.magic == "boomlet_backup_request"</text><polygon fill="#FFC0CB" points="1289,14764.5957,1730,14764.5957,1740,14775.5957,1730,14787.5957,1289,14787.5957,1279,14775.5957,1289,14764.5957" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437.7915" x="1291" y="14781.1641">Assert backup_request.backup_normal_pubkey == normal_pubkey_0</text><polygon fill="#E6E6FA" points="937,14797.9063,2082,14797.9063,2092,14808.9063,2082,14820.9063,937,14820.9063,927,14808.9063,937,14797.9063" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1141.4038" x="939" y="14814.4746">boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, boomletwo_identity_pubkey, content: boomlet.memory)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,14904.7695,1040.4346,14908.7695,1050.4346,14912.7695,1046.4346,14908.7695" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1509.8169" cy="14908.0195" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1505.3169" y1="14908.7695" y2="14908.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="14873.4063">[78]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1087.2217" y="14842.7852">SetupBoomletIsoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1091.335" y="14858.0957">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384.376" x="1091.335" y="14873.4063">boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.3281" x="1091.335" y="14888.7168">boomerang_params</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.4014" x="1091.335" y="14904.0273">sar_setup_response</text></g><polygon fill="#FFF0F5" points="689,14921.7695,1389,14921.7695,1399,14986.7695,1389,15051.7695,689,15051.7695,679,14986.7695,689,14921.7695" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="651.8091" x="691" y="14938.3379">Iso receives {boomlet_0_identity_pubkey, boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="655.897" x="695.1133" y="14953.6484">boomerang_params, sar_setup_response} from Boomlet. Iso reconstructs the descriptor using {network,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="639.082" x="695.1133" y="14968.959">boomerang_params.peer_ids, milestone_block_collection} and checks to see if it's same as the one in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="652.7104" x="695.1133" y="14984.2695">boomerang_params received.  It then regenerates doxing_key using the inputted doxing_password and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="605.4521" x="695.1133" y="14999.5801">doxing_data_identifier using doxing_key. Iso then doxing_data_identifier in sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.0894" x="695.1133" y="15014.8906">matches the one generated. Then Iso encrypts the static_doxing_data using the iv in sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="688.5176" x="695.1133" y="15030.2012">and doxing_key then checks to see if it matches fingerprint_of_static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.4536" x="695.1133" y="15045.5117">in sar_setup_response.</text><polygon fill="#E6E6FA" points="636,15062.2539,1442,15062.2539,1452,15073.2539,1442,15085.2539,636,15085.2539,626,15073.2539,636,15062.2539" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="802.0581" x="638" y="15078.8223">boomerang_descriptor := construct_boomerang_descriptor(network, boomerang_params.peer_ids, milestone_block_collection)</text><polygon fill="#FFC0CB" points="793,15095.5645,1284,15095.5645,1294,15106.5645,1284,15118.5645,793,15118.5645,783,15106.5645,793,15095.5645" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="487.7793" x="795" y="15112.1328">Assert boomerang_descriptor == boomerang_params.boomerang_descriptor</text><polygon fill="#E6E6FA" points="889,15128.875,1188,15128.875,1198,15147.875,1188,15166.875,889,15166.875,879,15147.875,889,15128.875" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.5586" x="891" y="15145.4434">doxing_key := sha256(doxing_password)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.313" x="895.1133" y="15160.7539">doxing_data_identifier := sha256(doxing_key)</text><polygon fill="#FFC0CB" points="795,15177.4961,1283,15177.4961,1293,15188.4961,1283,15200.4961,795,15200.4961,785,15188.4961,795,15177.4961" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="484.0596" x="797" y="15194.0645">Assert sar_setup_response.doxing_data_identifier == doxing_data_identifier</text><polygon fill="#FFC0CB" points="333,15210.8066,1744,15210.8066,1754,15221.8066,1744,15233.8066,333,15233.8066,323,15221.8066,333,15210.8066" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1407.4341" x="335" y="15227.375">Assert sar_setup_response.fingerprint_of_static_doxing_data_encrypted_by_doxing_key == sha256(AES_encrypt(private_key: doxing_key, content: static_doxing_data, iv: iv_of_static_doxing_data_encrypted_by_doxing_key))</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="418.2012,15271.7383,408.2012,15275.7383,418.2012,15279.7383,414.2012,15275.7383" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1038.9346" cy="15274.9883" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1034.4346" y1="15275.7383" y2="15275.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="15263.3408">[79]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="75.4673" x="454.9883" y="15255.6855">IsoOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="471.4722" x="459.1016" y="15270.9961">magic: "setup_boomlet_backup_data_received_connect_boomletwo_to_iso"</text></g><polygon fill="#FFF0F5" points="56,15288.7383,756,15288.7383,766,15307.7383,756,15326.7383,56,15326.7383,46,15307.7383,56,15288.7383" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="692.7515" x="58" y="15305.3066">User receives {magic: "setup_boomlet_backup_data_received_connect_boomletwo_to_iso"} from Iso. User then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.1655" x="62.1133" y="15320.6172">proceeds to connect Boomletwo to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="406.7012" cy="15368.2305" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1027.4346,15364.9805,1037.4346,15368.9805,1027.4346,15372.9805,1031.4346,15368.9805" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1033.4346" y1="15368.9805" y2="15368.9805"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="15356.583">[80]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.8066" x="444.9883" y="15348.9277">IsoInput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="573.333" x="449.1016" y="15364.2383">magic: "setup_user_is_asked_to_connect_boomletwo_to_iso_boomletwo_connected_to_iso"</text></g><polygon fill="#FFF0F5" points="672,15381.9805,1405,15381.9805,1415,15400.9805,1405,15419.9805,672,15419.9805,662,15400.9805,672,15381.9805" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="725.8354" x="674" y="15398.5488">Iso receives {magic: "setup_user_is_asked_to_connect_boomletwo_to_iso_boomletwo_connected_to_iso"} from User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324.4478" x="678.1133" y="15413.8594">and proceeds to give the backup file to Boomletwo.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomletwo"><ellipse cx="1038.9346" cy="15476.7832" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1627.8081,15473.5332,1637.8081,15477.5332,1627.8081,15481.5332,1631.8081,15477.5332" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1633.8081" y1="15477.5332" y2="15477.5332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="15457.4805">[81]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.0356" x="1077.2217" y="15442.1699">SetupIsoBoomletwo2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4624" x="1081.335" y="15457.4805">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384.376" x="1081.335" y="15472.791">boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo</text></g><polygon fill="#FFF0F5" points="1209,15490.5332,2069,15490.5332,2079,15532.5332,2069,15574.5332,1209,15574.5332,1199,15532.5332,1209,15490.5332" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.0156" x="1211" y="15507.1016">Boomletwo receives {boomlet_0_identity_pubkey, boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="735.1475" x="1215.1133" y="15522.4121">from Iso. It decrypts boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo using boomletwo_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="677.1616" x="1215.1133" y="15537.7227">diffie-hellman with boomlet_0_identity_pubkey and imports the data into it's memory. It generates it's own</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="848.6943" x="1215.1133" y="15553.0332">mystery and generates backup_done composed of {"boomlet_backup_done", boomletwo_Identity_pubkey, boomlet_0_identity_pubkey}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="639.1201" x="1215.1133" y="15568.3438">and signs it using boomletwo_Identity_privkey and sends backup_done_signed_by_boomletwo to Iso.</text><polygon fill="#E6E6FA" points="1052,15585.0859,2225,15585.0859,2235,15596.0859,2225,15608.0859,1052,15608.0859,1042,15596.0859,1052,15585.0859" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1169.9683" x="1054" y="15601.6543">boomletwo.memory += AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, boomletwo_identity_privkey), content: boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo)</text><polygon fill="#E6E6FA" points="1298,15618.3965,1980,15618.3965,1990,15629.3965,1980,15641.3965,1298,15641.3965,1288,15629.3965,1298,15618.3965" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="678.5962" x="1300" y="15634.9648">mystery := Rand(MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS, MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS)</text><polygon fill="#E6E6FA" points="1418,15651.707,1859,15651.707,1869,15723.707,1859,15796.707,1418,15796.707,1408,15723.707,1418,15651.707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.9443" x="1420" y="15668.2754">backup_done := BackupDone{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.3887" x="1424.1133" y="15683.5859">magic: "boomlet_backup_done",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.1567" x="1424.1133" y="15698.8965">backup_boomlet_pubkey: boomletwo_Identity_pubkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.4063" x="1424.1133" y="15714.207">boomlet_pubkey: boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1420" y="15729.5176">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389.3525" x="1424.1133" y="15744.8281">backup_done_signed_by_boomletwo := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429.5015" x="1424.1133" y="15760.1387">signature: schnorr_sign(boomletwo_identity_privkey, backup_done),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.8198" x="1424.1133" y="15775.4492">content: backup_done</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1424.1133" y="15790.7598">}</text><g class="message" data-participant-1="Boomletwo" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,15835.123,1040.4346,15839.123,1050.4346,15843.123,1046.4346,15839.123" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1639.3081" cy="15838.373" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1634.8081" y1="15839.123" y2="15839.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="15826.7256">[82]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.0356" x="1087.2217" y="15819.0703">SetupBoomletwoIso2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.458" x="1091.335" y="15834.3809">backup_done_signed_by_boomletwo</text></g><polygon fill="#FFF0F5" points="668,15852.123,1410,15852.123,1420,15863.123,1410,15875.123,668,15875.123,658,15863.123,668,15852.123" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="738.0737" x="670" y="15868.6914">Iso receives {backup_done_signed_by_boomletwo} from Boomletwo. Iso proceeds to inform User to connect Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="418.2012,15913.0547,408.2012,15917.0547,418.2012,15921.0547,414.2012,15917.0547" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1038.9346" cy="15916.3047" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1034.4346" y1="15917.0547" y2="15917.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="15904.6572">[83]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="75.4673" x="454.9883" y="15897.002">IsoOutput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398.6709" x="459.1016" y="15912.3125">magic: "setup_boomlet_backup_done_connect_boomlet_to_iso"</text></g><polygon fill="#FFF0F5" points="36,15930.0547,778,15930.0547,788,15941.0547,778,15953.0547,36,15953.0547,26,15941.0547,36,15930.0547" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="738.1055" x="38" y="15946.623">User receives {magic: "setup_boomlet_backup_done_connect_boomlet_to_iso"} from Iso and connects Boomlet to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="406.7012" cy="15994.2363" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1027.4346,15990.9863,1037.4346,15994.9863,1027.4346,15998.9863,1031.4346,15994.9863" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="1033.4346" y1="15994.9863" y2="15994.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="15982.5889">[84]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.8066" x="444.9883" y="15974.9336">IsoInput5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="537.3291" x="449.1016" y="15990.2441">magic: "setup_user_is_asked_to_connect_boomlet_to_iso_boomlet_connected_to_iso"</text></g><polygon fill="#FFF0F5" points="690,16007.9863,1387,16007.9863,1397,16026.9863,1387,16045.9863,690,16045.9863,680,16026.9863,690,16007.9863" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="689.8315" x="692" y="16024.5547">Iso receives {magic: "setup_user_is_asked_to_connect_boomlet_to_iso_boomlet_connected_to_iso"} from User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="466.0449" x="696.1133" y="16039.8652">and proceeds to forward backup_done_signed_by_boomletwo to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="1038.9346" cy="16087.4785" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1498.3169,16084.2285,1508.3169,16088.2285,1498.3169,16092.2285,1502.3169,16088.2285" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1043.4346" x2="1504.3169" y1="16088.2285" y2="16088.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1046.4346" y="16075.8311">[85]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1077.2217" y="16068.1758">SetupIsoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.458" x="1081.335" y="16083.4863">backup_done_signed_by_boomletwo</text></g><polygon fill="#FFF0F5" points="1168,16101.2285,1850,16101.2285,1860,16127.2285,1850,16154.2285,1168,16154.2285,1158,16127.2285,1168,16101.2285" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="663.0762" x="1170" y="16117.7969">Boomlet receives {backup_done_signed_by_boomletwo} from Iso. It verifies boomletwo_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.4902" x="1174.1133" y="16133.1074">pubkey on backup_done_signed_by_boomletwo. Boomlet then checks magic,backup_boomlet_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379.063" x="1174.1133" y="16148.418">boomlet_pubkey of backup_done to match expected values.</text><polygon fill="#FFC0CB" points="1114,16165.1602,1906,16165.1602,1916,16176.1602,1906,16188.1602,1114,16188.1602,1104,16176.1602,1114,16165.1602" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="788.1631" x="1116" y="16181.7285">Assert schnorr_verify(pubkey: boomletwo_identity_pubkey, content: backup_done_signed_by_boomletwo.signature) == True</text><polygon fill="#E6E6FA" points="1313,16198.4707,1705,16198.4707,1715,16209.4707,1705,16221.4707,1313,16221.4707,1303,16209.4707,1313,16198.4707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.8384" x="1315" y="16215.0391">backup_done := backup_done_signed_by_boomletwo.content</text><polygon fill="#FFC0CB" points="1332,16231.7813,1686,16231.7813,1696,16242.7813,1686,16254.7813,1332,16254.7813,1322,16242.7813,1332,16231.7813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="350.6636" x="1334" y="16248.3496">Assert backup_done.magic == "boomlet_backup_done"</text><polygon fill="#FFC0CB" points="1261,16265.0918,1759,16265.0918,1769,16276.0918,1759,16288.0918,1261,16288.0918,1251,16276.0918,1261,16265.0918" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="494.4316" x="1263" y="16281.6602">Assert backup_done.backup_boomlet_pubkey == boomletwo_Identity_pubkey</text><polygon fill="#FFC0CB" points="1288,16298.4023,1730,16298.4023,1740,16309.4023,1730,16321.4023,1288,16321.4023,1278,16309.4023,1288,16298.4023" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="438.7944" x="1290" y="16314.9707">Assert backup_done.boomlet_pubkey == boomlet_0_identity_pubkey</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1050.4346,16359.334,1040.4346,16363.334,1050.4346,16367.334,1046.4346,16363.334" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1509.8169" cy="16362.584" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1044.4346" x2="1505.3169" y1="16363.334" y2="16363.334"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1056.4346" y="16350.9365">[86]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.4707" x="1087.2217" y="16343.2813">SetupBoomletIsoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.7573" x="1091.335" y="16358.5918">magic: "setup_boomlet_backup_done"</text></g><polygon fill="#FFF0F5" points="708,16376.334,1369,16376.334,1379,16395.334,1369,16414.334,708,16414.334,698,16395.334,708,16376.334" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="653.4087" x="710" y="16392.9023">Iso receives {magic: "setup_boomlet_backup_done"} from Boomlet and proceeds to inform User that the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.9365" x="714.1133" y="16408.2129">backup process has been completed.</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="418.2012,16452.5762,408.2012,16456.5762,418.2012,16460.5762,414.2012,16456.5762" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1038.9346" cy="16455.8262" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="1034.4346" y1="16456.5762" y2="16456.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="16444.1787">[87]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112.9312" x="454.9883" y="16436.5234">SetupIsoOutput5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523.7388" x="459.1016" y="16451.834">magic: "setup_boomlet_backup_completed_boomlet_closed_ready_to_finish_setup"</text></g><polygon fill="#FFF0F5" points="62,16469.5762,750,16469.5762,760,16488.5762,750,16507.5762,62,16507.5762,52,16488.5762,62,16469.5762" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.3545" x="64" y="16486.1445">User receives {magic: "setup_boomlet_backup_completed_boomlet_closed_ready_to_finish_setup"} from Iso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.4731" x="68.1133" y="16501.4551">User proceeds to connect Boomlet to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="406.7012" cy="16549.0684" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,16545.8184,2465.6899,16549.8184,2455.6899,16553.8184,2459.6899,16549.8184" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="411.2012" x2="2461.6899" y1="16549.8184" y2="16549.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="414.2012" y="16537.4209">[88]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.1792" x="444.9883" y="16529.7656">SetupNisoInput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.3345" x="449.1016" y="16545.0762">magic: "setup_user_is_informed_that_boomlet_is_closed"</text></g><polygon fill="#FFF0F5" points="2016,16562.8184,2918,16562.8184,2928,16573.8184,2918,16585.8184,2016,16585.8184,2006,16573.8184,2016,16562.8184" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="898.7456" x="2018" y="16579.3867">Niso receives {magic: "setup_user_is_informed_that_boomlet_is_closed"} from User and proceeds to tell Boomlet to finish the setup procedure.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,16623.75,1511.3169,16627.75,1521.3169,16631.75,1517.3169,16627.75" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="16627" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="16627.75" y2="16627.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="16615.3525">[89]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.9551" x="1558.104" y="16607.6973">SetupNisoBoomletMessage11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.4048" x="1562.2173" y="16623.0078">magic: "setup_boomlet_closed_finish_setup"</text></g><polygon fill="#FFF0F5" points="1108,16640.75,1911,16640.75,1921,16674.75,1911,16709.75,1108,16709.75,1098,16674.75,1108,16640.75" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="691.8057" x="1110" y="16657.3184">Boomlet receives {magic: "setup_boomlet_closed_finish_setup"} from Niso and proceeds to generate and hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="702.457" x="1114.1133" y="16672.6289">shared_state_active_backup composed of {magic: "boomlet_backup_done_and_setup_finish_initialized"}. It then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="791.5083" x="1114.1133" y="16687.9395">signs the digest shared_state_active_backup_fingerprint to get shared_state_active_backup_fingerprint_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.9683" x="1114.1133" y="16703.25">and sends this value to Niso.</text><path d="M971,16721.9922 L1799.9229,16721.9922 L1799.9229,16729.3027 L1789.9229,16739.3027 L971,16739.3027 L971,16721.9922" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="632.0059" style="stroke:#000000;stroke-width:1.5;" width="2837.24" x="971" y="16721.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="783.9229" x="986" y="16735.5605">&lt;Boomlet Shared State in Sync regarding the BoomletBackup created being activated and all peers in the know of it&gt;</text><polygon fill="#E6E6FA" points="1208,16744.3027,1811,16744.3027,1821,16809.3027,1811,16874.3027,1208,16874.3027,1198,16809.3027,1208,16744.3027" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.4277" x="1210" y="16760.8711">shared_state_active_backup := SharedStateBackupDone{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379.52" x="1214.1133" y="16776.1816">magic: "boomlet_backup_done_and_setup_finish_initialized"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1210" y="16791.4922">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502.0044" x="1214.1133" y="16806.8027">shared_state_active_backup_fingerprint := sha256(shared_state_active_backup)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="547.2632" x="1214.1133" y="16822.1133">shared_state_active_backup_fingerprint_signed_by_boomlet_0 = SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="591.5254" x="1214.1133" y="16837.4238">signature: schnorr_sign(boomlet_0_identity_privkey, shared_state_active_backup_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.1255" x="1214.1133" y="16852.7344">content: shared_state_active_backup_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="1214.1133" y="16868.0449">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="16915.6582" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,16912.4082,2465.6899,16916.4082,2455.6899,16920.4082,2459.6899,16916.4082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="16916.4082" y2="16916.4082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="16904.0107">[90]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.9551" x="1548.104" y="16896.3555">SetupBoomletNisoMessage11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392.4819" x="1552.2173" y="16911.666">shared_state_active_backup_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2110,16929.4082,2823,16929.4082,2833,16940.4082,2823,16952.4082,2110,16952.4082,2100,16940.4082,2110,16929.4082" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.5029" x="2112" y="16945.9766">Niso receives shared_state_active_backup_fingerprint_signed_by_boomlet_0 and proceeds to share it with Peers.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2478.6899,16990.3398,2468.6899,16994.3398,2478.6899,16998.3398,2474.6899,16994.3398" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3765.1384,16990.3398,3775.1384,16994.3398,3765.1384,16998.3398,3769.1384,16994.3398" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2472.6899" x2="3771.1384" y1="16994.3398" y2="16994.3398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="2484.6899" y="16981.9424">[91]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.8545" x="2515.4771" y="16974.2871">SetupNisoPeerNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="478.5752" x="2519.5903" y="16989.5977">shared_state_active_backup_fingerprint_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1994,17007.3398,2940,17007.3398,2950,17049.3398,2940,17091.3398,1994,17091.3398,1984,17049.3398,1994,17007.3398" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="606.3789" x="1996" y="17023.9082">Niso receives shared_state_active_backup_fingerprint_signed_by_boomlet_i from peers, sending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585.2222" x="2000.1133" y="17039.2188">shared_state_active_backup_fingerprint_signed_by_boomlet_i at the same time.  It  It verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="657.6489" x="2000.1133" y="17054.5293">boomlet_i_identity_pubkey's signature on each and the contents to match the one signed by boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="934.7178" x="2000.1133" y="17069.8398">then forms shared_state_active_backup_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_backup_fingerprint_signed_by_boomlet_i&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6577" x="2000.1133" y="17085.1504">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="1949,17101.8926,2985,17101.8926,2995,17112.8926,2985,17124.8926,1949,17124.8926,1939,17112.8926,1949,17101.8926" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1032.6494" x="1951" y="17118.4609">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_backup_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1941,17135.2031,2992,17135.2031,3002,17146.2031,2992,17158.2031,1941,17158.2031,1931,17146.2031,1941,17135.2031" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1047.4331" x="1943" y="17151.7715">Assert shared_state_active_backup_fingerprint_signed_by_boomlet_i.content == shared_state_active_backup_fingerprint_signed_by_boomlet_0.content [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1521.3169,17196.1348,1511.3169,17200.1348,1521.3169,17204.1348,1517.3169,17200.1348" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="17199.3848" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1515.3169" x2="2462.6899" y1="17200.1348" y2="17200.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1527.3169" y="17187.7373">[92]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.9551" x="1558.104" y="17180.082">SetupNisoBoomletMessage12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="861.4023" x="1562.2173" y="17195.3926">shared_state_active_backup_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_backup_fingerprint_signed_by_boomlet_i&gt;</text></g><polygon fill="#FFF0F5" points="1019,17213.1348,1999,17213.1348,2009,17247.1348,1999,17282.1348,1019,17282.1348,1009,17247.1348,1019,17213.1348" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="698.2803" x="1021" y="17229.7031">Boomlet receives shared_state_active_backup_fingerprint_signed_by_all_peers from Niso. It checks the content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="968.4619" x="1025.1133" y="17245.0137">of each peer's shared_state_active_backup_fingerprint_signed_by_boomlet_i to be equal to shared_state_active_backup_fingerprint_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="710.1758" x="1025.1133" y="17260.3242">and for the signatures to match peer_i.boomlet_i_identity_pubkey. It then informs Niso that the setup procedure</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.0942" x="1025.1133" y="17275.6348">is finished.</text><polygon fill="#FFC0CB" points="991,17292.377,2027,17292.377,2037,17303.377,2027,17315.377,991,17315.377,981,17303.377,991,17292.377" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1032.6494" x="993" y="17308.9453">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_backup_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1082,17325.6875,1938,17325.6875,1948,17336.6875,1938,17348.6875,1082,17348.6875,1072,17336.6875,1082,17325.6875" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="852.2427" x="1084" y="17342.2559">Assert shared_state_active_backup_fingerprint_signed_by_boomlet_i.content == shared_state_active_backup_fingerprint [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1509.8169" cy="17396.8691" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2455.6899,17393.6191,2465.6899,17397.6191,2455.6899,17401.6191,2459.6899,17397.6191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1514.3169" x2="2461.6899" y1="17397.6191" y2="17397.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1517.3169" y="17385.2217">[93]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.9551" x="1548.104" y="17377.5664">SetupBoomletNisoMessage12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.7368" x="1552.2173" y="17392.877">magic: "setup_done"</text></g><polygon fill="#FFF0F5" points="2145,17410.6191,2789,17410.6191,2799,17421.6191,2789,17433.6191,2145,17433.6191,2135,17421.6191,2145,17410.6191" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.0215" x="2147" y="17427.1875">Niso receives {magic: "setup_done"} from Boomlet and proceeds to inform User that setup is finished.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="418.2012,17471.5508,408.2012,17475.5508,418.2012,17479.5508,414.2012,17475.5508" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2467.1899" cy="17474.8008" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="412.2012" x2="2462.6899" y1="17475.5508" y2="17475.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="424.2012" y="17463.1533">[94]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="122.8398" x="454.9883" y="17455.498">SetupNisoOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.7368" x="459.1016" y="17470.8086">magic: "setup_done"</text></g><polygon fill="#FFF0F5" points="257,17488.5508,555,17488.5508,565,17499.5508,555,17511.5508,257,17511.5508,247,17499.5508,257,17488.5508" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.9692" x="259" y="17505.1191">User receives {magic: "setup_done"} from Niso.</text><!--SRC=[xJrhSziuaj_zArYU3x6oZDQM_DuaLPddkcxdKN7kSbV9b8gMQ8iNYTIIb1sVo__zkXjl4WH1IivaxdPhAoEJ8D1ez1kDHl4fILTH7Ys38lxdEawdySznKKGtyPj5SfC6Y_Ywt2cJSX47bt6vNi6_h5NmVHBTu6TxxvDodgtBuBACohWOx5nbduFTVo_YFBXCPl5ky0tqD8s_NQpZdMXQPdb0xx9y1lyU1D_y8xcPbz_TH-aEW54cqsGLfMLmKMIyoOWteGxq9jzcsN8HbxpPc3VxBKa_6Sqkt_4MXy4t_v5ay8MjbxjCjQ9-VigZUwFXBua4wKYsYMCJxD_cMHhpLiV1Dzz5ivW17gUp011ZD7ul83ix3Rvv6yzCiD-yBSJhi-2R_ueNY-oE8_2tECx5ouFz_PrdGHhVBP8qBeAe3ARPOhrCY-1WTFgNyVwhWwFJC1WT7UFlqUbn68nF3_7tuS5X61mTZF3tqU5e9rgNMRfUNa6Vko-lNd_Ot_zzToVDIfZERSmMxJm8dZ_77y-V1n_Ju6NoUfaiuWA-YoTNYspwQG9ZB-9fcMJfUV2T_Fsoqkmr__gkd2IpekaZUliw-70nYrEWmFiWkmwYnI80ielZMR1UPIcYS1gbisI6f1S6rqbUb45I1EKSm8QLO0-YieoNgn8-AhC0K9ZSGlFVEH15bBkWOAyjOAnowcPn3uo3ZQ5tN3FHROeqbN_YVy6dURQwdrpT0vpysIegYjKyZufOG08Cb4mdi-npajvCO4eHVy6Vu0VGvum_pLVJoNIHGDUJTRweFuG5dU_yDL1B-FuTBU3xTtBvSCJud77sspYQtR_BtiOtIL76-MMStmBRgfN2-NwAx_MbEmyUs5y1_0-U06rEejai1m4I6YzMwolswICdcwme9uYUoLLIJhCavUGpZv6j3A0HfmGs_EWEDwwU2JXRJmDoV6G7dJuNiED3WD-0ZlYTmADV3C0QT68PxzDeQIvmXS52CLrWmD_Ul7tpym_lVdXxYPz_CuklWS63dz_yv-JTsuiVBYS__lfsylt5JpzT_FBJv2TeERduPVBjFtxzxjykWofN7hoeFjat-eGls_hSkSapbFvltWO5w8KNwzKEY9tBCbw13DzX4lt5QuaFW9-cJtzVfAjrUO0ZMWYvpdu2XHLCpIjO1naStO9OZNCGiCKS1cMFytWQ9xV0PG-LqKBBMA5bfCVWEi-MJ4k1R86li3VU04bXx_BlRq2W1hFa1f2Ayg0-jG6A6j2J-Vsgj8n17Lle8TYBXpV30DOeGl06m-2YH646686fIYYmASm41T9r0c0YH9Cca01aWWRN3lwJf4cPH8laVsBe4vPewC0i85MRz_che9X7CCnURR9gj2fejOyG74axenskCO5s5EahqhcCScwE73IFeK-0r6QDCd3gaYuQ0AL5Pz3Wue0a00K3ABy3yoQ8ICFU1pTn6kSHodgafOB9cibr70CkxfSeTPFqEXisGtGUEBz4TC6SkH3xCOv_OoyluDq3CORsOPBUPl3xtFOmnCQYvna88JGFpcjFGiM2v_o_AAM7Se76EymGiV0sm4cFz0LopQqx1pinHUk52ukhTPtbTr4EgvMKIEF8kpQwHkCGXdbJmFlIlOGS6QzUMQG6VocHTAXHCRUJ32h-TLqA2UYB898-DVpGqmxeeT7303f46Yy8LT2AsKUSKWHD0q-u0AHHLoNq0Vz7xbWloc7mzvX9fmH5VD7-yLKq_OGBj4B0XiqJTh29x0jO1PxjkR2W1CsHZuuQ-I1WUsGiPsBgcmej4ualilIc064bL0eAe9fI2RMtDjs2dJSAqHOrK1zj8WS3gtPYgeatO4lmrtlSJiPNvves2S5FIKiO_TpIDrCezIbiRqnBvpGeuQ2SHq9f1uGvy2X0_u9UHSTNKztoxNer8wr0zWAsJ90dm1ozZHPaxpEC4g_Ces9k6XJygndo9NIchJOinZthSCcaBB5V6gnJjEvnxQOqhhwEWkIFlNMh5ztRpRB65Mcs23ekxOU2d1baQ8xFtpig_8UsgOKT9XOsJ2liEAz7kuHk1vMM8GC1hBZTvFAYoAO9a-SWGSXyQLW9myu1KSFevIEIBWYX9Uy1wEp-MOxw8YZkq-cGDxjBm0b6VahIjQ5413NZRmt4EceiPfAfe0ahzm87Ussu6Q2sVfUluyP-lvl7g7-GlHjGmcC7HRGaLXDnX5KUtoRPkW0Ja9FLR1X8JZjXHjABTYE9E6qPtIJJys2NpEy9cnN-cg5_1jW3IfyWfYUuTXDIbRizt9y-mpoQPXMZWuBf9a9RKZuhc9oyWxSly7j6Ol29Xf5JBuke0HivT-M1QX1CeB6KuYlWf5kmuMCfFVGPvB7g4gpoR1h7Z5Me8unI3YcqHzunzv5dQumYC6HBX9mf-mC-qj01Vod_M0iQrI96PhZ8ovFMqOG1rHgMyA524XyzDCSEjP73mCEdvdZZ0Gq0R9h769uBbccyp5BGceZCPOJOdtn6LJtPPvymgnIGCGpUeQO4I0corJfVPKKyoREiDByW-Z4wkaqYwcSL0L4k_pgzEZr-5jpDa-aSUNlvrwFHmVveZi9i5a-JPRG8uIsGWHWasADF1a8Ii0WYKIfR2l2jkKExUvLbIv1wwStk80IrdeCOGRc0M0KrbSc9fy14qO97aYRx8MUbGdCdPmciGxaWlKapgynvVJNP1_vgMb1VHrq5RVPtACGEzCWZu2PDyeUwRrUPXHbXQ0xbSAhIGHUH-nezYXSQJLPHfsjYMpo73yU94ES8_4YQB0KblrXGN6M8WBrZZiiiNY4CQQcvz-2eC4Wc-rmvbFSoZiY9gGpMHLneOPuGAOhYFQG1SVS4oPDXiA18Za4LQWZyDLckuPEH66K22vWpiTFGZc64cX6N4KsHKYwpcnX8DsU2kOP1CKaYxv_Nbz1R4DtSW40aIeI62-1HGZ2ex9W1e7qlnaApjq3RCmqa8qncSJ7DGHbdkGfTcQ4K6sQfxw6JH80w76i252-c9PxjaJtlW-Ik7skOns-PbEAFzvg1h7HPcNsldXGpggyDAFTyYAT28TJxAWQPkazXyGAe6dfmefatJsRO1BUdBcOF5I3FBNHaZ7nU9rKDOHLqdJim-J5zL7BkO4UGKatryXVmK1TpZVrsqwRDu95W4a3P7FvtoeSx64anVVdEbD2NPMUeBzzPFALtlM0sURfeOsTzP8ecT6BYmejVh9rg6c-yWrl1DIguh190iV7Q5uqeR8XNSingwtxOHJsFVC3sLxhDuAEzAyMwKfPH6aHv7j7Mw540Uc06RT5Tly5zwYlGo36q9-JYv0_EJhbcuQRo5DsoIR6AU7I5ArJ23c0A04A3C2cOUhkAcTuf2UDe_A8Y4rrbASKBmFfcfYG3V5qD2DlqYmKQ8BBlwIbvZfVux87UdDCqzpuS38SmdRyT_Jvu98EerWNphbAA745lVCKmP-8NV8RRa2eeLGU0X6Ggnni47zQdVml6ez-3zl7Cq8DYxciKwgKpPlR3Tz__tQ60GYkD34BNL3J0DAOyak8vQvVFemsdt8sBDy5j9nb_t2xZjpdpDYsmyRn9IdmVAnw62OD5kk4KGenieL4T0PMjmKEz9zix0biSn0wA09QzKg11IZPgR6Ce41XSTw5JWFkXkAUnMCqZa5F9D5eWetrY9lmyknCXMH9lV6U9PD8yMUBVj2M7pWS8FWR64kD6TMdaKeUjKWFvb3iNddnA31dQ5QqtdxeNP61VK5BChbw7V73502T2CrT2HPUbjdDMxxDh5CW2ArFAxzH65blC0bQJ4Hd6P4L8uVBTioBux-o-03hvDCH597tqCTNr43gKdv44DVf3iWMxbhqYc19o79VnCijn8vwe5qEEf43LoEHdOVmrcCFC5B4nhuie4vpQcvQTD1iKKh5TqjCBVFW0hv9fN9m77wWHQ3NDa3vL4In3J87zb5RMI1-fX-Gn09LxOuHmMYFXG5kQwtm3hWvo-5mfKHvPgSTotGGRrWmINRApZHicvIWUsCpdyESiprO5Z3jRfpDCywCuU0FgUfWE1kgKxU3cH_htiHq8Kno0Q44v8AL2FtkYevngW4mpACxQhVpHfbFjPKVqGoeNK5vEmwXJJ6-yJIpuEnUROuF2gxW7QreO7rCoCjpz3uCtroN0IvmWn0FZCEZYAhPk_g0A3z7j4UA-YACSp0wK1FGzfGP9MSAbA8MOwng7zkxWCmmr2uEbPfEWemIznxYzbG08gbEhRH4oV5X5YyrRooWwQDMf8VVkLp7JF0mPjFDH59gyYs0jucA-aR68HbfTPZeyCuTmx6uXTVHaUX7im3enSvEpXM3P35-zyf7XFT2eMMjD471CwFIYETbMQ- -3fSlV_-L-VtNkzwXBT7JyVzBx7db4MCT_CkyxhEh6_sVUDx31TP8lQQiFd__B6-_WZO_6BTxuw8juusHhySKza3G7n4KqnyuuiH3mQa59SCBJi-Webif26QeM0N3eTcn7Nx5Zo_wMAGD_c6FRmtaD_BrNb-hz4xkgewDsLtNy9tLLaIJRlDNZBjxguP_OMntAVXiSIAV722uSKx0ivnvP_qZp7DC2w71TQfuhIRoYMHo64fnFALEntDN3JJBCJWvsHM1ojail-CVOCq43cCGS9ioQkilMYnawpkYo0eWef6dUpvytM97Fd_CPHJmVvZfA5aMeMGmykKuudKmJb55Uofolfiv7pv-3nyx8RYyYJn_tBkFFqtcKtiG36XaFRsBkLPRDGdDbq8Fcg3QSw7-vfr-_U-e_bJO_5MUZiOiIM2TTzYeFwxcjVB3h94sAEV1Mn_HCTsUFTQy7sHl5XNWsZLBar5bIo6nNjdbHhlDKIy-K1wYgcQqgpOig1d16LGWwbHAzOZh2OsqdHmpKrMAK02e_XvtDJEYyHGH_NSV1QY7I28nytVcwd6LtgOmUSXH8vB1W51toX__Al7P-H59EKSlZnRRQ7F5FQoPl_PnszP2sXWS2e8O7Ucf9r3Mx3giTwoTPUHOaKpTw9cGTF8e0cZqXBcz12c7WZwMg1hT9Z2dWW2nAjsNlPsBYGs0w1lOqMoxNAPdeg6k0a6xcmRjVtr9s5xM8Yay5wK9xqfbErzh1nFqTLf71QZ_WAqiAgyb2wYIioOiTqbERE-IuHq1K45OcDAk9yaFdKhLPSH1IEYaHUZtvIkRUXGq8v0PPVL2IUnLtibNPMM1NgLZQqpqhC0D_IEWiB0fc44_nhobVHtOALZm-3uefm9ldr85JaTO77OI64sAPc9v9E3umn7-5-_ahVAeJdCgBRCofzCP7Pp7HHXYXvy2cQY5g1g3baIKoFCM2WFdbkxpCZMtEEUJdJS1GAtbGIKveo0KrPHUlKvHAM1TbckJJDILcOy_DpA3sGYnhpeQQPTW5vrso6DX4LSQ-vLEsXHJ_Snqj66iAr41pSOX4kaK6TP2wyaCR3r_KYA5ojfcp1Jj2jIUIPXK67HwkWoEi4aCkllK0bacgZG8457kMYkDTUvnhp-sBE31FGXZpPpg7BLZ272VFQOXz3fX3_GjDyOoKuZ7YHVZKJCfjudvF9c-BAZKmU3idCwLqcQ3fZWxx8gSg9SmTT2Qf9mOpgFbXCalq2OWTHG0s0bn6O6SehrJq58Xyqens8ALUhypRf6OFiiLbQqw2belN5jmSRs7Tl4wazLqx7c0nRTk8OPra3WUP11aO_DcwV95TlxWYcnUyu3HUQEVqnZpu-PBEBk9d6axm3Jq3rFnw_Itqi4NYzaTIef2Kj8oGS2GH0a9v2XNt4D3srv7k3VHZeE-4byaoLlOSEnr9_V0UOkFuapJgeWGMv6NdwRokXAxLoV1QwInXvJLNv6B6EkDzPxvOytn0JckbiNfCvyD-yF9LaE0_XxyhAZngzwf6SiMiaC7BEagSwEXdJja63-j3Xuw17_NGlx8k-AQPHAeKTKbLcZqhJ7kBLGdmMm919g0QY_KKuslNwuKea5O8hvXlpc6aZ6-hgGn9eLlJAQ29Rx1XVQlE0kqrIgZc5JMC9HQKutiQQ7n6YpKxV6TJ85qD8jluGu-5g9fAhdvQriLYH9dCCdJQLD_nQ0QMLl4RJrWx7mxSWrZCgdvBBSZ5jUYQbNNSpRr_Kl7G8I2mPI4XmmSVqvhXzNH28jI6C_XysqpEpk5clD13BRu89Z-Uyo4_4C6O2OyDy2ZmoGwJDoizieb8kw3K0nKwcnKguq-bHzJ6jcwJEbgHHQkslzZkgNL6BLaSGabxHBJ_JmcrwXnbsFhffGulRbYolO4zwweDl09Z5H5ZCPZSwr8naOGtLkSAwFbRyU8tUdu9Zn-a60H0pcqWXKeMdjj4abCedhiu3RvyR8ItKpg0VSRD2G4VKyV0Vs0MNXic1feZTj8jkZZgEU6kLcyVd7P9lnkV-aHJjZ5RdyFFlMRAzZ3g2UaywQwL7OeONvID85XISLjwLoKgU5KnIqN4IWQF3zC-NTvR3zmFdABH5vEA3izQ0aE7ZUDrZMhOWTQ3EvgbHmcJqpB5A2aOO5H-oMe2EUMsNgYHnInmijSK6A5osdZGG8MiRm1EuMDPZfQPDeXrEaC1euockjLUlq7uz668cYBhrw53ky4W3cT1LWBTToSJZkkxa9XrC-6RARE9rDXOb8hFIZY-Z7xfw8XUlkegngCYkvqYnqy3mgCCUCbYbaQS4lE73K- -ZKsbvIto4wyg-OdSgBUPp1q5d6P0ChEWuzPZOJSHMas0iDtoqSMmqzHfcCqVcGpP2L2L6tbu8CHnnHAwh6snRX4Lsp6E-gs2aFyVKw-pVeUZRl6HyHEYoZyyidM4iVW8tqUYdfKLjit1_CqvezTGL-L6EAPhJtnFkx1oOSrcO5OYsGlycCGoAgTp7riKlcFI7Bl1c0lB6efA9jE5bg21x4eKXnCR99IVcg-dndAe6c5yLZAVoQ5_vGuvgAEXpThPXpdc70FqX47z2wBX5t58XKfG0SuAIeOhiFBRi7vTWjOJhfFgB4wZgmMc1SUWzvQOUeSbWgaRAZ4tZ8UL0Nb9g-gGyWHcPUo2o3V68e_gJ0tsnRRqylYVwoHdjMz8cmgJBSdDubdLBIeBkS4aPt6mNedUQnQblQWRLSrZsKZLGmBrhQMcAcwT5F7JvSvkKK8C-aVh2dSIHYSWMt8nge3zY6TuoRTWbN61J5psSUEeMkf4suTQKgateMW2u_oLaYaJMuizAKmyt0wNnB4wc9QmsrP2RhQPdDinq6W1Fda6NNN85jkLikTOPFNbcoacbopYsGrpDK7cr9gBEc6S5ehNojWP1oywPj-DVN6qkSrdmNij0jQShY4r0KduPpIQbcrqU1YyuARUIqkA1hx0P-r6iMKhsDoCtpuU4cioXXS2qGgsPLtOhHmw4gWdt-5lds7KKINJGXEfVBVH0fCDAyhKqNMqM93_N1XtYEtv86lmMjZ-kaxrtTxs6S4bfdttWTsgp6TJoGjIsyQH2Q1aaAFWnRYRBtJOmY7sHVI1-xK9vRQSf3fabTrX1rjWysU5jqpeoqM2XNJLmcfSaUF1j6BpfYFo63EOnJqNV4hPMZklTfryZfLPNgLWTZE6VZiWHJ2bNk5oY8w2eI023B4ukQWgAMo56KkTcyBZAByt_1aHFkNfnr6TyV1e6S8vyzc_VKAkxMQ3Va76LVQVPE7ZRhhTShIg1XijmMxd72-lNYr7hGHTY9qVhSBsyXw3fFSoQud8vXcldOriWsR0B8_keeKcrKwwYRGZNvJ8fG9dT8AZJZXyspa1uyOOarUYZqfP8e4dkbyA3qaPPMGb5_jSLaXBudDJ8Xcm5_BKZf2WQxnfXgyMWBCVYZjxQlp7ep9KRByna-GQsiGvcD6iY8we3b-uia-qRsmo5yofB2_LLb2pPDMovMm3OpTu1OPGB9E6UjlDab-xk0Wd9pDKD-lPcGIZEOc2Qi3JUOjP0Jxa4NhHne0vDumMeFjzgmxLrrPTkr3pbDg-_GEyDttujbs82WMJ0-gzleGNQ5p3oh2TUWUTHle2MFI6fO9IVsmXVcidR-_GYYgpEznLO_SN6xkEfzqKwD7cMEr1pvsLyKOGXdr0V7Jahh3YGbAykQuVw7YSwxsM3tDufXJ_-se-p7k_alzRMLrFyFlGWNRJU55cgnr-dRd_Z9DjppXHCRpM1FhkCqx017xvAddv2Zn2RUvOpsCP1mVgkdKZTlxUieV_Nj_3TzZi6-4Yz4T6s1aLZvMSARmQ4I4SqbNkrisowthEW9q8ibIbpCWQOvjIHjZnO4LNX5YkoH65rRZhJhXYjn2dyj9MshoHeQk87P4RLkbdQxxVHYYqE8NDMS1R1Rjtcl8NWgypiNI5LBEKxqhdhTFlI_kbqrtkdFQ_SffsGVXcY77A_cX_vxqryUDzBV73CQ6kfeOBDoIlthF4l8nI0SrRfYNa1qfpLt88yRbM_yGJS9zSmbR0SUYmSbQ_ld8qEROOyefeVXxDSajqmw3y6axZWcZdESEMVlZzpeufQjSxZzfF48uTkETZRebkn0oSzphhLj_HsCVg6tMRG9i1uGEyrDEIWf9IQImMJ63bN-gb1zlSPLR9XDKUyXI4Tmrv1kzRSlqQU-lk70BMdiIbLhHm6FY8m547O-DkyxJ_HWnoySWhSaWoGJJLpg65nZ4sli4dmjkqKS15LETG2Rly42IFHeZi45RfJAVhkglMX0Pd1aGByBOAPXtst2IckziLTxPy4NKcvUYeMn3wk3T9Rh0vraQOeMrpJEvBtGcwGTD5aOwacuOYDopiAp6l969Jd5Z53M2WIinSayDc0IaHeiLyWTa4hoYF9nJzYV6RgYYjHdQH_5k_j4TEc5HcYN_ifXfP5utIX99hdhR0zYB5tJIiccEIiWcetVkxijTUsAQyrdytRFiinTDW11YNj330PRX9bAJ19LwZZHUmvZDHf0rK0AUAu2gcQzLPt2zc9XeUpPTbFh0zvjUmZC_NRJ5pErcGBgGt19OjowcA0slEJ-15tIADoOEuLLZTtdZGdzIt7Hnk1Q8Q5MwVlMaR7FDRRe9k0T_Z_YZgQZdqN0XtaXGB4IaqdF1gZ46dpAXHRonic2lLSqnRzbH_KhVcKqdzvegkrae9O70A5qnJgLgkXxmsXnK-kxeFDDL2MlAZoAJgD1LxMau_t6wKQxL97AqNj1vP5MqWznjNqxJzgCvUPaGnyYa_VTdDq3pfp0RRfPqj97drWzuhxUjZQeIFUmgVIYBO1d97omxhbnhcpB-weule-OqVmZWYu6XKQISzSNBKbs3i9gY_06zNI1veM_7mMJTRvCHf8yg5H61fuJPDud9txiZbadbAoga1xQdR8SSTQn2VTfpw18UZJAshU28Tg-raQlKPk3cDwwEUoJNBFYTuPY4g8yunO6BaQ0YWUunM36yXwh7gjv10AnXSTwp9hMJUBKgXABTLlfDTrDzRfH8RoUB1CuC0lNI_dbnL2kxAi04Ppje6KVwebIDlltt0ZcxbDYbiiqk2-a2qOQ4KkQB6rGLMG0RsLVuIxbjjqAgxLgSzcGsr1MB1wMo0P4dCEexzu1hK4evmoIsPHiSTZ-6SRWqtVGctUzRHLjY-BxYFhTLpCDQkrcFait4q_gfMeJMnvOyMl0rLVRO1bj8pkkTTEntkAVx8MhaMDMAKwkeduNros_Xj3vTltl8wwNL8NJa8_cAzTwqXjJ_NNGowrswmKHg8wuYl7tGMPq4pHSTYqn3MfZ0s3I-ZN4-Rw4SShdn3e-eAZ6wfFGFqelYx5mHXy_YFQXCImCHBrWNBzfjhsyK4Mha5LacNTi0N4HvL-5pRXfJxuL4JF7Gh5Vb-UDk1DAEHAfYjpZB3YbWO8p0IGjY0o33GNR_iclowP3hHMniOKFOXwQtajjj7ZoWAs4cgtWFJk7oNZHscG5S1enaT-Y1nUDjxuEIMdSc1sO3q4Hu5EHYBconFolbIN4UXH2N5NfBL72G0hZrUDje-AADJu0ajYyAoshfRH65mDqcAWnZYfZYHPDB8dS2OT8dtubxLTsfs9lhN24BZtt9DOX_U7DHdOqfXtmdXZMNMDqvqMHO9NP0e9r7xbZzxQ9IoJRCclklDFEToVypxaq4VHZ_lm8n3u2QnnLT3cbuyWhcMNOjjAP8ABVrRtBQw8FM2hLBq0nviiNQMdI_QG599RyU7EqIXDUCV2D9CdDzmcbsizqqnokfWlNchB6Mgs2pE5g-lhvFF8eQ5NqTcPGcaQ1wm8izL2e9TLkvPkqcBHAeo5rLDkOQ2SXPRTeE9JjXKz4mqCjLgaiIRC5e657ctRDppVZZS4jzK9h_DdBpjGjOgIJPQSsDl__Z89-rl_CJOxxor_NIWX9MYzutfLzNwPrn8o1scFfHkx3ePrr280WMRRnZRqeoU49zM_x49yYU5WwqFmD1dPHJ3TBmYukmBiaw7ZU0dbAHwB4jjsFZbDBOn5VJTZw_KNPZSkr6znxEWNk6w3K7QwGQrpM2ahD0D4T4dR81_qaNJTg_W8rqKq6gmYbHbcJrQS939RX5uPdVJMenFJ6_YjMlX9rv8kuZma3dVok8vf5ek7fW5FshOVAZl8Kft1uV3MQdqqOQTUw8avN4OXVta5Oe-3cUoZHihlZ9HM0N-AvQ6RRcU7ixN1WKMhVjw6s9h40GR55EK47K0QDla878hXbs33pqJXIdtDxhArYKBMNo9X67Xk3kab2tPeIweN9d05I7LaWgCph5dJtzGCd052eziu2e6J9VX97ZHBo7uR0CyRIFxrMSvEgK47vyAL7IhbZZkZuWdI0hs6RH3Lh0NbfrfmQwSO9qljf8MB4iLTvkBVswd1tg_fiHW3t2V9ZFOP-2Mz44Fqcl93Ju-2rwCWsukti7-7qu-JvGRx05_UtBmnxHQ5hAl4FBB3lQLygxqO5cBn9KXt9mUREOnVRMfmbjdzGwvmjldTaUsyCb-DqE5SRHfHlPsa7fa3tSQov5CB6wWn4q8UGmkk8AkrojbnPpur90OsJ5YW2I9VBVpdTlUFLTB-UYssbJSHmjS3VGokqFJpRpo_IuBnJrbHN2JyIk7hrXyXY46fHLl7V9GYViQN7emoxDLGTpCaCyudxb7pv_VbS-VYveanR2MzyW7jgG-dcWb9YuCghtGhwYstAoK51C62R0D2YL2QeALyKkwOmdph9CK60eakM0v1eUnUXSsuiM7cB-mpj6eOXTTyZaiindwZBDaIauW65mFsmLE9SjPhtlYNwdrdbm18UMoJfEW2utynpiNfhQ_g-1PFZwm53mbg50mOQqYMsJaBclKldSKB2i4q9G6qeovob2S4owuvbKfF2fh2cP_KNCH0GnvgBtQXeNPgDz4rCfGzQ4kH4ceXX6ONcn10Q-KOOSElM4n4V5iR-0S3pzXK-8FzfgxLxlO9uSx2hOwSybtyFZ0ERmNhnY511muLo3LoHgvXP6y9kbgDpIT74bYLgBymY745KGLsq45JVXWaX5BQ5jacyhu_WChmXVbpsnAG3j88rgIl2Gfm6lJGaDK-20Tw9etBeMvRSZSqIaJvBmU75O85fbrUZ1DZschjJYsoEuBlIwG-rvRVgS8DKpZPPOcKvfiL1IhUHwnX99wSeoMRebDeOjPDo9zQ0Ohr6vDuY256a2X1Pom2emfm9KPhGGO5tHuxn30eVJrD5kkCaoMWzLus3NrWcYz6phPDJHlB9hiFuRLxGVHW8cCIhrX6KdWLRNjRlf5nKAeJ8XVvm9VVKilthBd3nfpEYV7deac5I_0DcVraJ7xyoeoC2ggsl91DTESD-yJjAnYDQoCKgrSP6BC242Ud5GLjbLTwsLdMsVKiovCAwA4f985OIeODmiLgVnUi-SXaOMMMz107km6BVDJS-5vEhtqSYlWL0xOQRcW06Xs1u851KpyUHglIba5MyyIjMWsusfwAksY0jWSE4VwvPMosod_jIKdDRHVqe0SRDqIlTXe0x62lR29VYsKuNjdbbEAj8zYgVBKL0d7Hd6uFzX0Qzsxj8aW7A62HPyRkZfJpsOd2HjjbKgf7jG3Ir2BkMvfccMohNRcXLaasrbZkT_qRLnXJNFeQ2eu6B4dbriWjUNNcL6FeG1BtVn82HVLEnyVfFbY6MQeBYHije0UZHGLpAc8yJ062KZQpeWAkUcGM6_Sb1QaTiLJ7jSECkDoCw1PGKom6KjbTGfZIaZNXfrTre5-1k22OfHnunVMJ1HvbsUi9YS0dl4a3knOwWiobEgMgJQVs-QHwFoRGWAxqhEES0dHPkS_R52uZRaDRmZiHNQ36aHDTSmqe2oboeQsXgxPQjYgdUqMHEWuu6q_4Duo6Sk2R7AWmc-4_bJqIawnKSFeXvrKIDxYAoMtvvrFI0mqPNFcSl_7ZUw_4D4qJ9F_3Uflgwv_nq7rU1UBW_0Q40xl_ouJHfuwlNowxt3B3vkZgL7n2QELMIE4sWFUXBMlOip70zy-18zQq5HS5g4XxWOtfBGW-3M88iszlJCmUE0TCHqzZJtJESpwT1QB2cU8IAnn5tXtKyr8WZHCJXuZHM6RN8EKUp6F5ujbbFgSqqkMAxgxYSmYrCKWvp9cjZ2BjH94bXuVyeEu90ktBQfHcXaQ0yx83BRO3Ltn2SSXs-hLLLNir2B8AbgZ3L_VNbIIeKEycXltmLysE2hUlB23kZVHZNG6xLDvmfkhFF2eKGp6mEZFx-4lH-IB4q_li9UzjLKKQQ6lHfhfdQrdMUzG7yqU_o9K6S6lqv7tniKeQ9zGLtVFtTjZPHk3kHjzzZ5Enov3vh3Ta448dtJZmcUaoau5RrLKzYQqMHywJ9EZxgP9nIpumcP9w-Wj9Wa_0EKZn-lqSzGbHdpSaLCwr3_punXXEbHJ8EiH9vO2gUuUQkc_4j3bRZIjOsWLgFgDGjfJl3fT4qaoX1n_Nj6IyXsrpPEOt36sbidsZgaAbTGsGETmAlRK74ibvTQnC_kgSLU_TOlQPu2cdYqrM2Ix7NS9SXvxYU_DX9EjGqkcLADk4XT5IC70cXPOU1xFEY0pWT4B_U2bon8F9nQr9MGEqrr7hPEN_Ih9kK3Z6dpaQ7QFmlCwIPDYpY8OMrPd7GVNvHVCYqPgtutN47RQVeNEeM-6aymSB3ZGc-RX-Gxpw4X8AcELZSIhUWBw-9r8fQ2hsLfFIJezwvY1VD1CL7pvZ5KBjdRjSjC8hZGzUL6rE7VObCdB6SzmBXrk0cMECT0uBCRD5YhJuAD-YT0ikS7TjERnZHnJn-qOzTPDTrTMBZ2MgGJyYg7kfx6CR89W2gnA6MHVu40MNwBABGw-ZfrxnLndj2nBupwcnJuO-FTdNRmdFwjLXyFZk9O56ORFUBRVzyGM4opz4RQDuqcUIzFfuDRPGR-3MuSReUC9pcvvZjlX-9PdZ_KJN2XU_v3R7LWjIzVj3iuv-H_5yKFDrtIOom_YfpdFvJbsoo4FF-vlETLrDXBitl7EXuDHBpRPEabjxqYN7zpREjNbAKmg1xisjwusk_gX-M2NnMhdjHoP_OA-u1S_nlKKJDxX9DTJyRdZFDVPkACPOqbyhuKOUlY7lQ8AZ7uCaf7pElGuYJNsc4kFE80-5rPNHPvI-by0]--></g></svg>