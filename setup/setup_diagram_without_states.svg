<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="19424px" preserveAspectRatio="none" style="width:4090px;height:19424px;background:#FFFFFF;" version="1.1" viewBox="0 0 4090 19424" width="4090px" zoomAndPan="magnify"><title>Setup Sequence Diagram (Without States)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="292.2489" x="1900.0905" y="29.9659">Setup Sequence Diagram (Without States)</text><rect fill="#F0F8FF" height="19372.8889" style="stroke:#181818;stroke-width:0.5;" width="2096.5029" x="367.3735" y="46.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="60.2941" x="1385.478" y="59.9649">User Side</text><rect fill="none" height="1322.4189" style="stroke:#000000;stroke-width:1.5;" width="3839.8794" x="27" y="451.7261"/><rect fill="none" height="3412.5483" style="stroke:#000000;stroke-width:1.5;" width="2069.6956" x="49" y="1788.145"/><rect fill="none" height="4559.2612" style="stroke:#000000;stroke-width:1.5;" width="3564.3058" x="31" y="5214.6933"/><rect fill="none" height="1400.655" style="stroke:#000000;stroke-width:1.5;" width="2652.5585" x="52" y="7090.7626"/><rect fill="none" height="559.5324" style="stroke:#000000;stroke-width:1.5;" width="2587.3058" x="998" y="8700.4777"/><rect fill="none" height="2647.9558" style="stroke:#000000;stroke-width:1.5;" width="3550.3058" x="45" y="9787.9545"/><rect fill="none" height="719.1805" style="stroke:#000000;stroke-width:1.5;" width="2631.3058" x="954" y="11326.7275"/><rect fill="none" height="2659.6618" style="stroke:#000000;stroke-width:1.5;" width="4055.4299" x="28" y="12449.9103"/><rect fill="none" height="701.4745" style="stroke:#000000;stroke-width:1.5;" width="2633.3058" x="952" y="14159.7435"/><rect fill="none" height="4196.3168" style="stroke:#000000;stroke-width:1.5;" width="3586.3058" x="9" y="15123.5721"/><rect fill="none" height="701.4745" style="stroke:#000000;stroke-width:1.5;" width="2645.3058" x="940" y="18441.1783"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="385.6825" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="389.3735" x2="389.3735" y1="146.8419" y2="19336.8889"/></g><g><title>Iso</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="994.3799" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="997.4189" x2="997.4189" y1="146.8419" y2="19336.8889"/></g><g><title>Boomlet</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="1445.3872" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1448.5413" x2="1448.5413" y1="146.8419" y2="19336.8889"/></g><g><title>ST</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="1504.9681" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1508.2331" x2="1508.2331" y1="146.8419" y2="19336.8889"/></g><g><title>Boomletwo</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="1574.2859" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1577.7031" x2="1577.7031" y1="146.8419" y2="19336.8889"/></g><g><title>Niso</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="2347.846" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2351.132" x2="2351.132" y1="146.8419" y2="19336.8889"/></g><g><title>Phone</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="2427.8065" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2431.7366" x2="2431.7366" y1="146.8419" y2="19336.8889"/></g><g><title>WT</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="3005.1374" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3008.7354" x2="3008.7354" y1="146.8419" y2="19336.8889"/></g><g><title>SARs</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="3479.0247" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3483.0018" x2="3483.0018" y1="146.8419" y2="19336.8889"/></g><g><title>Peers</title><rect fill="#000000" fill-opacity="0.00000" height="19190.0471" width="8" x="3549.9308" y="146.8419"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="3553.5559" x2="3553.5559" y1="146.8419" y2="19336.8889"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="371.3735" y="142.7399">User</text><ellipse cx="389.6825" cy="76.2739" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M389.6825,84.2739 L389.6825,111.2739 M376.6825,92.2739 L402.6825,92.2739 M389.6825,111.2739 L376.6825,126.2739 M389.6825,111.2739 L402.6825,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="371.3735" y="19350.8548">User</text><ellipse cx="389.6825" cy="19363.4568" fill="#E0FFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M389.6825,19371.4568 L389.6825,19398.4568 M376.6825,19379.4568 L402.6825,19379.4568 M389.6825,19398.4568 L376.6825,19413.4568 M389.6825,19398.4568 L402.6825,19413.4568" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="981.4189" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="988.4189" y="134.7399">Iso</text></g><g class="participant participant-tail" data-participant="Iso"><rect fill="#ADD8E6" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.9219" x="981.4189" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.9219" x="988.4189" y="19357.8548">Iso</text></g><g class="participant participant-head" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="1414.5413" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="1421.5413" y="134.7399">Boomlet</text></g><g class="participant participant-tail" data-participant="Boomlet"><rect fill="#FFB6C1" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6918" x="1414.5413" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6918" x="1421.5413" y="19357.8548">Boomlet</text></g><g class="participant participant-head" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1494.2331" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1501.2331" y="134.7399">ST</text></g><g class="participant participant-tail" data-participant="ST"><rect fill="#EE82EE" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="29.4699" x="1494.2331" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15.4699" x="1501.2331" y="19357.8548">ST</text></g><g class="participant participant-head" data-participant="Boomletwo"><rect fill="#D3D3D3" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.1657" x="1533.7031" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.1657" x="1540.7031" y="134.7399">Boomletwo</text></g><g class="participant participant-tail" data-participant="Boomletwo"><rect fill="#D3D3D3" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.1657" x="1533.7031" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.1657" x="1540.7031" y="19357.8548">Boomletwo</text></g><g class="participant participant-head" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="2330.132" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="2337.132" y="134.7399">Niso</text></g><g class="participant participant-tail" data-participant="Niso"><rect fill="#90EE90" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.4279" x="2330.132" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.4279" x="2337.132" y="19357.8548">Niso</text></g><g class="participant participant-head" data-participant="Phone"><rect fill="#5F9EA0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56.1398" x="2403.7366" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1398" x="2410.7366" y="134.7399">Phone</text></g><g class="participant participant-tail" data-participant="Phone"><rect fill="#5F9EA0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56.1398" x="2403.7366" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1398" x="2410.7366" y="19357.8548">Phone</text></g><g class="participant participant-head" data-participant="WT"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8039" x="2991.7354" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8039" x="2998.7354" y="134.7399">WT</text></g><g class="participant participant-tail" data-participant="WT"><rect fill="#FF0000" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.8039" x="2991.7354" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.8039" x="2998.7354" y="19357.8548">WT</text></g><g class="participant participant-head" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3460.0018" y="112.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3467.0018" y="134.7399">SARs</text></g><g class="participant participant-tail" data-participant="SARs"><rect fill="#FFFF00" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.0459" x="3460.0018" y="19335.8889"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.0459" x="3467.0018" y="19357.8548">SARs</text></g><g class="participant participant-head" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7499" x="3532.5559" y="142.7399">Peers</text><ellipse cx="3553.9308" cy="76.2739" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3553.9308,84.2739 L3553.9308,111.2739 M3540.9308,92.2739 L3566.9308,92.2739 M3553.9308,111.2739 L3540.9308,126.2739 M3553.9308,111.2739 L3566.9308,126.2739" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Peers"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.7499" x="3532.5559" y="19350.8548">Peers</text><ellipse cx="3553.9308" cy="19363.4568" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M3553.9308,19371.4568 L3553.9308,19398.4568 M3540.9308,19379.4568 L3566.9308,19379.4568 M3553.9308,19398.4568 L3540.9308,19413.4568 M3553.9308,19398.4568 L3566.9308,19413.4568" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><path d="M28,161.8419 L28,365.8419 L751,365.8419 L751,171.8419 L741,161.8419 L28,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M741,161.8419 L741,171.8419 L751,171.8419 L741,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.874" x="34" y="180.7389">User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="63.874" y="180.7389">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="198.4449">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="321.0613" x="37.38" y="198.4449">milestone_block_collection: Collection&lt;milestone_block&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="216.1509">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="695.6049" x="37.38" y="216.1509">wt_ids_collection: Collection&lt;wt_id&gt; [Identity of all agreed upon WT candidates, first is the one first attempted to activate]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="233.8569">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="432.0814" x="37.38" y="233.8569">sar_ids_collection: Collection&lt;sar_id&gt; [Identity of all privately selected SARs]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="251.5629">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="46.657" x="37.38" y="251.5629">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="269.2689">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="79.5731" x="37.38" y="269.2689">entropy_bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="286.975">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65.8581" x="37.38" y="286.975">passphrase</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="304.681">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="107.2891" x="37.38" y="304.681">static_doxing_data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="322.387">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="100.2301" x="37.38" y="322.387">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="340.093">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="75.8421" x="37.38" y="340.093">rpc_client_url</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="34" y="357.799">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="86.5411" x="37.38" y="357.799">rpc_client_auth</text><path d="M2904,161.8419 L2904,294.8419 L3112,294.8419 L3112,171.8419 L3102,161.8419 L2904,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3102,161.8419 L3102,171.8419 L3112,171.8419 L3102,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.098" x="2910" y="180.7389">WT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2930.098" y="180.7389">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2910" y="198.4449">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="59.9691" x="2913.38" y="198.4449">wt_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2910" y="216.1509">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="40.989" x="2913.38" y="216.1509">wt_id: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2910" y="233.8569">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="89.4531" x="2926.9" y="233.8569">wt_tor_address,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2910" y="251.5629">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="60.4241" x="2926.9" y="251.5629">wt_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2910" y="269.2689">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2910" y="286.975">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="184.0412" x="2913.38" y="286.975">most_work_bitcoin_block_height</text><path d="M3417,161.8419 L3417,294.8419 L3548,294.8419 L3548,171.8419 L3538,161.8419 L3417,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3538,161.8419 L3538,171.8419 L3548,171.8419 L3538,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.713" x="3423" y="180.7389">SAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3447.713" y="180.7389">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3423" y="198.4449">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="64.4281" x="3426.38" y="198.4449">sar_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3423" y="216.1509">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="45.4481" x="3426.38" y="216.1509">sar_id: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3423" y="233.8569">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="93.9121" x="3439.9" y="233.8569">sar_tor_address,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3423" y="251.5629">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="64.8831" x="3439.9" y="251.5629">sar_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3423" y="269.2689">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="4.55" x="3426.38" y="269.2689">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="3423" y="286.975">&#160;</text><path d="M2356,161.8419 L2356,206.8419 L2505,206.8419 L2505,171.8419 L2495,161.8419 L2356,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2495,161.8419 L2495,171.8419 L2505,171.8419 L2495,161.8419" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40.976" x="2362" y="180.7389">Phone</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2402.976" y="180.7389">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3.38" x="2362" y="198.4449">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="125.5411" x="2365.38" y="198.4449">dynamic_doxing_data</text><path d="M371,376.608 L371,439.608 L3500,439.608 L3500,386.608 L3490,376.608 L371,376.608" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3490,376.608 L3490,386.608 L3500,386.608 L3490,376.608" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="84.7731" x="1760.0424" y="395.505">PARAMETERS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1760.0424" y="413.2111">1.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328.1853" x="1774.4464" y="413.2111">#define MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.92" x="1760.0424" y="430.9171">2.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.5473" x="1774.4464" y="430.9171">#define MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS</text><path d="M27,451.7261 L148.245,451.7261 L148.245,461.4321 L138.245,471.4321 L27,471.4321 L27,451.7261" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1322.4189" style="stroke:#000000;stroke-width:1.5;" width="3839.8794" x="27" y="451.7261"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="76.245" x="42" y="466.6231">SAR sign-up</text><g class="message" data-participant-1="User" data-participant-2="Phone"><ellipse cx="389.1825" cy="547.5062" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2419.8065,544.2562,2429.8065,548.2562,2419.8065,552.2562,2423.8065,548.2562" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="2425.8065" y1="548.2562" y2="548.2562"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="515.8881">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.6801" x="424.1605" y="489.3291">SetupPhoneInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0811" x="427.5405" y="507.0351">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.3401" x="427.5405" y="524.7411">sar_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.4381" x="427.5405" y="542.4472">static_doxing_data</text></g><polygon fill="#FFF0F5" points="1983,561.2562,2878,561.2562,2888,591.2562,2878,622.2562,1983,622.2562,1973,591.2562,1983,561.2562" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="758.4985" x="1985" y="579.1532">Phone receives {doxing_password, sar_ids_collection, static_doxing_data} from User and saves doxing_key (SHA256 digest of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="885.0535" x="1988.38" y="596.8592">doxing_password) to encrypt static_doxing_data and dynamic_doxing_data (e.g. location). It then sends doxing_data_identifier (SHA_256 digest of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.2392" x="1988.38" y="614.5652">doxing_key) to SAR to initialize setup.</text><polygon fill="#E6E6FA" points="2290,632.3742,2571,632.3742,2581,653.3742,2571,675.3742,2290,675.3742,2280,653.3742,2290,632.3742" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.2192" x="2292" y="650.2712">doxing_key := sha256(doxing_password)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.3652" x="2295.38" y="667.9772">doxing_data_identifier := sha256(doxing_key)</text><g class="message" data-participant-1="Phone" data-participant-2="SARs"><ellipse cx="2431.3065" cy="721.4483" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3471.0247,718.1983,3481.0247,722.1983,3471.0247,726.1983,3475.0247,722.1983" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2435.8065" x2="3477.0247" y1="722.1983" y2="722.1983"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2438.8065" y="707.5363">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.2151" x="2466.2846" y="698.6833">SetupPhoneSarMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2271" x="2469.6646" y="716.3893">doxing_data_identifier</text></g><polygon fill="#FFF0F5" points="3124,735.1983,3841,735.1983,3851,747.1983,3841,760.1983,3124,760.1983,3114,747.1983,3124,735.1983" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="713.5313" x="3126" y="753.0953">SAR receives doxing_data_identifier from Phone and responds with a newly generated sar_service_fee_payment_info.</text><polygon fill="#E6E6FA" points="3295,770.9043,3669,770.9043,3679,818.9043,3669,866.9043,3295,866.9043,3285,818.9043,3295,770.9043" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.4062" x="3297" y="788.8013">sar_service_fee_payment_info := SarServiceFeePaymentInfo{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.1902" x="3300.38" y="806.5073">service_fee_invoice: service_fee_invoice,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.5342" x="3300.38" y="824.2133">payment_deadline: payment_deadline,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.8841" x="3300.38" y="841.9194">sar_id: sar_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.424" x="3297" y="859.6254">}.</text><g class="message" data-participant-1="SARs" data-participant-2="Phone"><polygon fill="#181818" points="2442.8065,909.8464,2432.8065,913.8464,2442.8065,917.8464,2438.8065,913.8464" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3482.5247" cy="913.0964" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2436.8065" x2="3478.0247" y1="913.8464" y2="913.8464"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2448.8065" y="899.1844">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.2151" x="2476.2846" y="890.3314">SetupSarPhoneMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.4281" x="2479.6646" y="908.0374">sar_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="2187,926.8464,2675,926.8464,2685,938.8464,2675,951.8464,2187,951.8464,2177,938.8464,2187,926.8464" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="484.8092" x="2189" y="944.7434">Phone receives sar_service_fee_payment_info from SAR and forwards it to User.</text><polygon fill="#FFC0CB" points="2214,962.5524,2647,962.5524,2657,974.5524,2647,987.5524,2214,987.5524,2204,974.5524,2214,962.5524" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429.9233" x="2216" y="980.4494">Assert sar_service_fee_payment_info.sar_id == sar_ids_collection.sar_id</text><g class="message" data-participant-1="Phone" data-participant-2="User"><polygon fill="#181818" points="400.6825,1030.6705,390.6825,1034.6705,400.6825,1038.6705,396.6825,1034.6705" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2431.3065" cy="1033.9205" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="2426.8065" y1="1034.6705" y2="1034.6705"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="1020.0085">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.6131" x="434.1605" y="1011.1555">SetupPhoneOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.4281" x="437.5405" y="1028.8615">sar_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="49,1047.6705,729,1047.6705,739,1068.6705,729,1090.6705,49,1090.6705,39,1068.6705,49,1047.6705" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="591.7083" x="51" y="1065.5675">User receives sar_service_fee_payment_info from Phone, verifies and pays the invoice generating</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="672.6333" x="54.38" y="1083.2735">sar_service_fee_payment_receipts as a result. He then inputs sar_service_fee_payment_receipts back to Phone.</text><polygon fill="#E6E6FA" points="170,1101.0825,609,1101.0825,619,1113.0825,609,1126.0825,170,1126.0825,160,1113.0825,170,1101.0825" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="435.0713" x="172" y="1118.9795">sar_service_fee_payment_receipts := pay(sar_service_fee_payment_info)</text><g class="message" data-participant-1="User" data-participant-2="Phone"><ellipse cx="389.1825" cy="1172.4506" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2419.8065,1169.2006,2429.8065,1173.2006,2419.8065,1177.2006,2423.8065,1173.2006" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="2425.8065" y1="1173.2006" y2="1173.2006"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="1158.5385">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.6801" x="424.1605" y="1149.6855">SetupPhoneInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.2451" x="427.5405" y="1167.3916">sar_service_fee_payment_receipts</text></g><polygon fill="#FFF0F5" points="1937,1186.2006,2926,1186.2006,2936,1207.2006,2926,1229.2006,1937,1229.2006,1927,1207.2006,1937,1186.2006" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="981.994" x="1939" y="1204.0976">Phone receives sar_service_fee_payment_receipts from User and forwards it to SAR alongside encrypted static_doxing_data, encrypted dynamic_doxing_data and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.7111" x="1942.38" y="1221.8036">doxing_data_identifier.</text><polygon fill="#E6E6FA" points="2059,1239.6126,2803,1239.6126,2813,1278.6126,2803,1317.6126,2059,1317.6126,2049,1278.6126,2059,1239.6126" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.0452" x="2061" y="1257.5096">static_doxing_data_encrypted_by_doxing_key := AES_encrypt(private_key: doxing_key, content: static_doxing_data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="733.4474" x="2064.38" y="1275.2156">dynamic_doxing_data_encrypted_by_doxing_key := AES_encrypt(private_key: doxing_key, content: dynamic_doxing_data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="504.9204" x="2064.38" y="1292.9216">note that static data is sent once and dynamic data is updated and sent in intervals</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.2025" x="2064.38" y="1310.6277">Phone then hashes doxing_key and sends this alongside every sent message as an unauthenticated identifier.</text><g class="message" data-participant-1="Phone" data-participant-2="SARs"><ellipse cx="2431.3065" cy="1417.2167" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3471.0247,1413.9667,3481.0247,1417.9667,3471.0247,1421.9667,3475.0247,1417.9667" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2435.8065" x2="3477.0247" y1="1417.9667" y2="1417.9667"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2438.8065" y="1376.7457">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.2151" x="2466.2846" y="1341.3337">SetupPhoneSarMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.2451" x="2469.6646" y="1359.0397">sar_service_fee_payment_receipts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.7952" x="2469.6646" y="1376.7457">static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2271" x="2469.6646" y="1394.4517">doxing_data_identifier</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409.0063" x="2469.6646" y="1412.1577">dynamic_doxing_data_encrypted_by_doxing_key [sent_at_intervals]</text></g><polygon fill="#FFF0F5" points="3119,1430.9667,3846,1430.9667,3856,1469.9667,3846,1508.9667,3119,1508.9667,3109,1469.9667,3119,1430.9667" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="720.4994" x="3121" y="1448.8638">SAR receives {sar_service_fee_payment_receipts, static_doxing_data_encrypted_by_doxing_key, doxing_data_identifier,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="639.7044" x="3124.38" y="1466.5698">dynamic_doxing_data_encrypted_by_doxing_key} from Phone, verifies sar_service_fee_payment_receipts,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="581.8933" x="3124.38" y="1484.2758">stores encrypted_doxing_data associating it with doxing_data_identifier and responds to Phone</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="646.4124" x="3124.38" y="1501.9818">informing it they're in sync. Phone will continue generating and sending encrypted_dynamic_doxing_data.</text><polygon fill="#FFC0CB" points="3281,1519.7908,3683,1519.7908,3693,1531.7908,3683,1544.7908,3281,1544.7908,3271,1531.7908,3281,1519.7908" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398.8403" x="3283" y="1537.6878">Assert verify_payment(sar_service_fee_payment_receipts) == True</text><polygon fill="#FFC0CB" points="3246,1555.4968,3718,1555.4968,3728,1567.4968,3718,1580.4968,3246,1580.4968,3236,1567.4968,3246,1555.4968" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="468.7674" x="3248" y="1573.3938">Check that doxing_data_identifier is the same as the one previously received.</text><g class="message" data-participant-1="SARs" data-participant-2="Phone"><polygon fill="#181818" points="2442.8065,1623.6149,2432.8065,1627.6149,2442.8065,1631.6149,2438.8065,1627.6149" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2436.8065" x2="3482.0247" y1="1627.6149" y2="1627.6149"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2448.8065" y="1612.9529">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="163.2151" x="2476.2846" y="1604.0999">SetupSarPhoneMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.7622" x="2479.6646" y="1621.8059">magic: "setup_sar_setup_done_and_in_sync_with_phone"</text></g><polygon fill="#FFF0F5" points="2092,1640.6149,2769,1640.6149,2779,1661.6149,2769,1683.6149,2092,1683.6149,2082,1661.6149,2092,1640.6149" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.5144" x="2094" y="1658.5119">Phone receives {magic: "setup_sar_setup_done_and_in_sync_with_phone"} from SAR and informs User that it's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.2751" x="2097.38" y="1676.2179">now in-sync with SAR.</text><g class="message" data-participant-1="Phone" data-participant-2="User"><polygon fill="#181818" points="400.6825,1726.4389,390.6825,1730.4389,400.6825,1734.4389,396.6825,1730.4389" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2431.3065" cy="1729.6889" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="2426.8065" y1="1730.4389" y2="1730.4389"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="1715.7769">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.6131" x="434.1605" y="1706.9239">SetupPhoneOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344.2142" x="437.5405" y="1724.6299">magic: "setup_sar_registered_and_connected_to_phone"</text></g><polygon fill="#FFF0F5" points="47,1743.4389,731,1743.4389,741,1755.4389,731,1768.4389,47,1768.4389,37,1755.4389,47,1743.4389" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.2252" x="49" y="1761.336">User receives {magic: "setup_sar_registered_and_connected_to_phone"} from Phone and proceeds to setup Iso.</text><path d="M49,1788.145 L179.176,1788.145 L179.176,1797.851 L169.176,1807.851 L49,1807.851 L49,1788.145" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3412.5483" style="stroke:#000000;stroke-width:1.5;" width="2069.6956" x="49" y="1788.145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85.176" x="64" y="1803.042">duress_setup</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="389.1825" cy="1919.3371" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="986.3799,1916.0871,996.3799,1920.0871,986.3799,1924.0871,990.3799,1920.0871" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="992.3799" y1="1920.0871" y2="1920.0871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="1870.013">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100.2691" x="424.1605" y="1825.748">SetupIsoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.453" x="427.5405" y="1843.454">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.5671" x="427.5405" y="1861.16">entropy_bytes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.9921" x="427.5405" y="1878.866">passphrase</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0811" x="427.5405" y="1896.5721">doxing_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.3401" x="427.5405" y="1914.2781">sar_ids_collection</text></g><polygon fill="#FFF0F5" points="680,1933.0871,1315,1933.0871,1325,1981.0871,1315,2029.0871,680,2029.0871,670,1981.0871,680,1933.0871" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="604.7344" x="682" y="1950.9841">Iso receives {network, entropy_bytes, passphrase, doxing_password, sar_ids_collection} from  User,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="580.8013" x="685.38" y="1968.6901">creates mnemonic and master_xpriv_0 from the input. Then derives purpose_root_xpriv_0 from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.0624" x="685.38" y="1986.3961">master_xpriv_0 via the path m/cb86' which is m/52102h in decimal, where purpose (cb86') is the first 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="624.7413" x="685.38" y="2004.1021">bytes of sha256("boomerang"), hardened. Iso also creates normal_pubkey_0, that is generated directly</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.9872" x="685.38" y="2021.8082">from purpose_root_xpub_0.</text><polygon fill="#E6E6FA" points="873,2039.6172,1122,2039.6172,1132,2051.6172,1122,2064.6172,873,2064.6172,863,2051.6172,873,2039.6172" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.2192" x="875" y="2057.5142">doxing_key := sha256(doxing_password)</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="997.8799" cy="2164.1033" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1437.3872,2160.8533,1447.3872,2164.8533,1437.3872,2168.8533,1441.3872,2164.8533" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1443.3872" y1="2164.8533" y2="2164.8533"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="2123.6322">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1032.8579" y="2088.2202">SetupIsoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.9781" x="1036.2379" y="2105.9262">normal_pubkey_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.7961" x="1036.2379" y="2123.6322">doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.3401" x="1036.2379" y="2141.3382">sar_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.453" x="1036.2379" y="2159.0443">network</text></g><polygon fill="#FFF0F5" points="1101,2177.8533,1796,2177.8533,1806,2234.8533,1796,2291.8533,1101,2291.8533,1091,2234.8533,1101,2177.8533" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="645.9963" x="1103" y="2195.7503">Boomlet receives {normal_pubkey_0, doxing_key, sar_ids_collection, network} from Iso during installation.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="613.1193" x="1106.38" y="2213.4563">Then independently generates boomlet_0_identity_privkey which it uses to encrypt, decrypt and sign</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="684.6193" x="1106.38" y="2231.1623">messages. It also creates boomlet_0_boom_musig2_privkey_share and boomlet_0_boom_musig2_pubkey_share,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.5465" x="1106.38" y="2248.8683">that will together with normal_pubkey_0, generate the MuSig2 aggregated public key, named boom_pubkey_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="610.7793" x="1106.38" y="2266.5743">that is used in boomerang_descriptor. After successful installation on an empty smart card, Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.4283" x="1106.38" y="2284.2804">responds to Iso with boomlet_0_identity_pubkey.</text><polygon fill="#E6E6FA" points="1130,2302.0894,1768,2302.0894,1778,2403.0894,1768,2504.0894,1130,2504.0894,1120,2403.0894,1130,2302.0894" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.1802" x="1132" y="2319.9864">boomlet_0_identity_privkey := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.9753" x="1135.38" y="2337.6924">boomlet_0_boom_musig2_privkey_share := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="528.3075" x="1135.38" y="2355.3984">boomlet_0_boom_musig2_pubkey_share := derive_pubkey(boomlet_0_identity_privkey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="447.5124" x="1135.38" y="2373.1044">boomlet_0_identity_pubkey := derive_pubkey(boomlet_0_identity_privkey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="627.5884" x="1135.38" y="2390.8104">boom_pubkey_0 := derive_musig2_pubkey(boomlet_0_boom_musig2_pubkey_share, normal_pubkey_0)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.4342" x="1135.38" y="2408.5165">peer_0_tor_secret_key := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.2771" x="1135.38" y="2426.2225">peer_0_id := PeerId{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.7162" x="1135.38" y="2443.9285">boom_pubkey: boom_pubkey_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.0962" x="1135.38" y="2461.6345">normal_pubkey: normal_pubkey_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327.7043" x="1135.38" y="2479.3405">boomlet_identity_pubkey: boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1132" y="2497.0465">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,2547.2676,999.3799,2551.2676,1009.3799,2555.2676,1005.3799,2551.2676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1448.3872" y1="2551.2676" y2="2551.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="2536.6056">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1042.8579" y="2527.7526">SetupBoomletIsoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1046.2379" y="2545.4586">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="764,2564.2676,1231,2564.2676,1241,2576.2676,1231,2589.2676,764,2589.2676,754,2576.2676,764,2564.2676" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.8923" x="766" y="2582.1646">Iso receives boomlet_0_identity_pubkey from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Iso" data-participant-2="ST"><ellipse cx="997.8799" cy="2635.6356" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1496.9681,2632.3856,1506.9681,2636.3856,1496.9681,2640.3856,1500.9681,2636.3856" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1502.9681" y1="2636.3856" y2="2636.3856"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="2621.7236">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.6921" x="1032.8579" y="2612.8706">SetupIsoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1036.2379" y="2630.5766">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="1218,2649.3856,1798,2649.3856,1808,2661.3856,1798,2674.3856,1218,2674.3856,1208,2661.3856,1218,2649.3856" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="576.6284" x="1220" y="2667.2826">ST receives boomlet_0_identity_pubkey from Boomlet and responds with st_0_identity_pubkey.</text><polygon fill="#E6E6FA" points="1321,2685.0916,1695,2685.0916,1705,2706.0916,1695,2728.0916,1321,2728.0916,1311,2706.0916,1321,2685.0916" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.8412" x="1323" y="2702.9886">st_0_identity_privkey := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366.8344" x="1326.38" y="2720.6947">st_0_identity_pubkey := derive_pubkey(st_0_identity_privkey)</text><g class="message" data-participant-1="ST" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,2770.9157,999.3799,2774.9157,1009.3799,2778.9157,1005.3799,2774.9157" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="2774.1657" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1503.9681" y1="2774.9157" y2="2774.9157"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="2760.2537">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.6921" x="1042.8579" y="2751.4007">SetupStIsoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1046.2379" y="2769.1067">st_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="780,2787.9157,1216,2787.9157,1226,2799.9157,1216,2812.9157,780,2812.9157,770,2799.9157,780,2787.9157" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="432.7183" x="782" y="2805.8127">Iso receives st_0_identity_pubkey from SAR and forwards it to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="997.8799" cy="2859.2838" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1437.3872,2856.0338,1447.3872,2860.0338,1437.3872,2864.0338,1441.3872,2860.0338" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1443.3872" y1="2860.0338" y2="2860.0338"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="2845.3717">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1032.8579" y="2836.5187">SetupIsoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6851" x="1036.2379" y="2854.2247">st_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="1062,2873.0338,1835,2873.0338,1845,2894.0338,1835,2916.0338,1062,2916.0338,1052,2894.0338,1062,2873.0338" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="656.0065" x="1064" y="2890.9308">Boomlet receives st_0_identity_pubkey from Iso. It then generates an array of 5 random integers between 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="765.9082" x="1067.38" y="2908.6368">and 195 named duress_check_space and encrypts it for st. This will be used to record the duress_consent_set input from user.</text><polygon fill="#E6E6FA" points="859,2926.4458,2039,2926.4458,2049,2974.4458,2039,3022.4458,859,3022.4458,849,2974.4458,859,2926.4458" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.2313" x="861" y="2944.3428">duress_check_space := DuressCheckSpace{space: rand([1..195;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2902" x="864.38" y="2962.0488">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3582" x="864.38" y="2979.7548">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="864.38" y="2997.4608">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.355" x="864.38" y="3015.1669">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,3065.3879,999.3799,3069.3879,1009.3799,3073.3879,1005.3799,3069.3879" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1448.8872" cy="3068.6379" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1444.3872" y1="3069.3879" y2="3069.3879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="3054.7259">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1042.8579" y="3045.8729">SetupBoomletIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1046.2379" y="3063.5789">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="649,3082.3879,1346,3082.3879,1356,3094.3879,1346,3107.3879,649,3107.3879,639,3094.3879,649,3082.3879" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.0175" x="651" y="3100.2849">Iso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Iso" data-participant-2="ST"><ellipse cx="997.8799" cy="3153.756" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1496.9681,3150.506,1506.9681,3154.506,1496.9681,3158.506,1500.9681,3154.506" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1502.9681" y1="3154.506" y2="3154.506"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="3139.8439">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.6921" x="1032.8579" y="3130.9909">SetupIsoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1036.2379" y="3148.6969">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1171,3167.506,1845,3167.506,1855,3206.506,1845,3245.506,1171,3245.506,1161,3206.506,1171,3167.506" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="633.7893" x="1173" y="3185.403">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Iso. Decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="663.7284" x="1176.38" y="3203.109">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st, assign a country to each of the numbers in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="622.6874" x="1176.38" y="3220.815">the duress_check_space corresponding to its alphabetical rank and shows this array to User for him to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.4742" x="1176.38" y="3238.521">select 5 of them as duress_consent_set.</text><polygon fill="#E6E6FA" points="918,3256.33,2098,3256.33,2108,3277.33,2098,3299.33,918,3299.33,908,3277.33,918,3256.33" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.3156" x="920" y="3274.227">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.6093" x="923.38" y="3291.933">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="400.6825,3342.1541,390.6825,3346.1541,400.6825,3350.1541,396.6825,3346.1541" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="3345.4041" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="1503.9681" y1="3346.1541" y2="3346.1541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="3331.4921">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.442" x="434.1605" y="3322.6391">SetupStOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6031" x="437.5405" y="3340.3451">duress_check_space</text></g><polygon fill="#FFF0F5" points="69,3359.1541,709,3359.1541,719,3389.1541,709,3420.1541,69,3420.1541,59,3389.1541,69,3359.1541" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="594.5424" x="71" y="3377.0511">User receives duress_check_space from ST. He then selects 5 countries via the ST's joystick. ST will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="630.0063" x="74.38" y="3394.7571">record the index in the duress_signal_index User is to memorize the name of 5 countries that they have</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.3651" x="74.38" y="3412.4631">selected in this stage.</text><polygon fill="#E6E6FA" points="204,3430.2721,575,3430.2721,585,3442.2721,575,3455.2721,204,3455.2721,194,3442.2721,204,3430.2721" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.0943" x="206" y="3448.1691">duress_signal_index := DuressSignalIndex{indices: [index;5]}</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="389.1825" cy="3501.6402" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1496.9681,3498.3902,1506.9681,3502.3902,1496.9681,3506.3902,1500.9681,3502.3902" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="1502.9681" y1="3502.3902" y2="3502.3902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="3487.7282">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.509" x="424.1605" y="3478.8752">SetupStInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5771" x="427.5405" y="3496.5812">duress_signal_index</text></g><polygon fill="#FFF0F5" points="1175,3515.3902,1841,3515.3902,1851,3536.3902,1841,3558.3902,1175,3558.3902,1165,3536.3902,1175,3515.3902" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="620.8804" x="1177" y="3533.2872">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="658.7753" x="1180.38" y="3550.9932">nonce from previously received duress_check_space_with_nonce, encrypts it for Boomlet and sends it to Iso.</text><polygon fill="#E6E6FA" points="918,3568.8022,2098,3568.8022,2108,3616.8022,2098,3664.8022,918,3664.8022,908,3616.8022,918,3568.8022" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.4932" x="920" y="3586.6992">ST drops redundant data.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2642" x="923.38" y="3604.4052">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3322" x="923.38" y="3622.1113">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.2492" x="923.38" y="3639.8173">nonce: duress_check_space_with_nonce.nonce}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.303" x="923.38" y="3657.5233">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,3707.7443,999.3799,3711.7443,1009.3799,3715.7443,1005.3799,3711.7443" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="3710.9943" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1503.9681" y1="3711.7443" y2="3711.7443"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="3697.0823">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.6921" x="1042.8579" y="3688.2293">SetupStIsoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1046.2379" y="3705.9353">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="649,3724.7443,1345,3724.7443,1355,3736.7443,1345,3749.7443,649,3749.7443,639,3736.7443,649,3724.7443" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="692.9916" x="651" y="3742.6413">Iso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and forwards it to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="997.8799" cy="3796.1124" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1437.3872,3792.8624,1447.3872,3796.8624,1437.3872,3800.8624,1441.3872,3796.8624" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1443.3872" y1="3796.8624" y2="3796.8624"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="3782.2004">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1032.8579" y="3773.3474">SetupIsoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1036.2379" y="3791.0534">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1035,3809.8624,1863,3809.8624,1873,3866.8624,1863,3923.8624,1035,3923.8624,1025,3866.8624,1035,3809.8624" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.4354" x="1037" y="3827.7594">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Iso and decrypts it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="610.9483" x="1040.38" y="3845.4654">get duress_signal_index_with_nonce. After checking the nonce to be the same as the one sent, It will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="605.4883" x="1040.38" y="3863.1714">search for the newly received indices in duress_check_space store those numbers corresponding to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616.9805" x="1040.38" y="3880.8774">aforementioned indices as duress_consent_set, and drops redundant data. It then generates another</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="817.5574" x="1040.38" y="3898.5835">duress_check_space, and repeat the same process and sends a fresh duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.921" x="1040.38" y="3916.2895">to Iso.</text><polygon fill="#E6E6FA" points="860,3934.0985,2037,3934.0985,2047,3946.0985,2037,3959.0985,860,3959.0985,850,3946.0985,860,3934.0985" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.2635" x="862" y="3951.9955">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1176,3969.8045,1721,3969.8045,1731,3981.8045,1721,3994.8045,1176,3994.8045,1166,3981.8045,1176,3969.8045" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.0215" x="1178" y="3987.7015">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="1250,4005.5105,1648,4005.5105,1658,4026.5105,1648,4048.5105,1250,4048.5105,1240,4026.5105,1250,4005.5105" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5573" x="1252" y="4023.4075">duress_signal_index := duress_signal_index_with_nonce.content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390.8193" x="1255.38" y="4041.1135">duress_consent_set := duress_check_space[duress_signal_index]</text><polygon fill="#E6E6FA" points="859,4058.9225,2039,4058.9225,2049,4106.9225,2039,4154.9225,859,4154.9225,849,4106.9225,859,4058.9225" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.2313" x="861" y="4076.8196">duress_check_space := DuressCheckSpace{space: rand([1..195;5])}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2902" x="864.38" y="4094.5256">duress_check_space_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3582" x="864.38" y="4112.2316">content: duress_check_space</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="864.38" y="4129.9376">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.355" x="864.38" y="4147.6436">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_check_space_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,4197.8647,999.3799,4201.8647,1009.3799,4205.8647,1005.3799,4201.8647" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1448.3872" y1="4201.8647" y2="4201.8647"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="4187.2027">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1042.8579" y="4178.3496">SetupBoomletIsoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1046.2379" y="4196.0557">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="649,4214.8647,1346,4214.8647,1356,4226.8647,1346,4239.8647,649,4239.8647,639,4226.8647,649,4214.8647" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.0175" x="651" y="4232.7617">Iso receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Iso" data-participant-2="ST"><ellipse cx="997.8799" cy="4286.2327" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1496.9681,4282.9827,1506.9681,4286.9827,1496.9681,4290.9827,1500.9681,4286.9827" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1502.9681" y1="4286.9827" y2="4286.9827"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="4272.3207">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.6921" x="1032.8579" y="4263.4677">SetupIsoStMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1494" x="1036.2379" y="4281.1737">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1171,4299.9827,1845,4299.9827,1855,4338.9827,1845,4377.9827,1171,4377.9827,1161,4338.9827,1171,4299.9827" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="632.2943" x="1173" y="4317.8797">ST receives duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st from Iso, decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="663.7284" x="1176.38" y="4335.5857">duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st, assign a country to each of the numbers in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="622.6874" x="1176.38" y="4353.2918">the duress_check_space corresponding to its alphabetical rank and shows this array to User for him to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.2993" x="1176.38" y="4370.9978">select 5 of them as confirmation of duress_consent_set.</text><polygon fill="#E6E6FA" points="918,4388.8068,2098,4388.8068,2108,4409.8068,2098,4431.8068,918,4431.8068,908,4409.8068,918,4388.8068" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.3156" x="920" y="4406.7038">duress_check_space_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_check_space_with_nonce_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.6093" x="923.38" y="4424.4098">duress_check_space := duress_check_space_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="400.6825,4474.6308,390.6825,4478.6308,400.6825,4482.6308,396.6825,4478.6308" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="4477.8808" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="1503.9681" y1="4478.6308" y2="4478.6308"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="4463.9688">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.442" x="434.1605" y="4455.1158">SetupStOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6031" x="437.5405" y="4472.8218">duress_check_space</text></g><polygon fill="#FFF0F5" points="87,4491.6308,691,4491.6308,701,4512.6308,691,4534.6308,87,4534.6308,77,4512.6308,87,4491.6308" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="597.5062" x="89" y="4509.5279">User receives duress_check_space from ST. He will select 1 country in each column to replicate the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.4183" x="92.38" y="4527.2339">duress_consent_set and inputs it to ST.</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="389.1825" cy="4580.7049" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1496.9681,4577.4549,1506.9681,4581.4549,1496.9681,4585.4549,1500.9681,4581.4549" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="1502.9681" y1="4581.4549" y2="4581.4549"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="4566.7929">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.509" x="424.1605" y="4557.9399">SetupStInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5771" x="427.5405" y="4575.6459">duress_signal_index</text></g><polygon fill="#FFF0F5" points="1174,4594.4549,1843,4594.4549,1853,4615.4549,1843,4637.4549,1174,4637.4549,1164,4615.4549,1174,4594.4549" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.7654" x="1176" y="4612.3519">ST receives duress_signal_index from User. ST then creates duress_signal_index_with_nonce using the nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="617.8903" x="1179.38" y="4630.0579">from previously received duress_check_space_with_nonce, encrypts it for Boomlet and sends it to Iso.</text><polygon fill="#E6E6FA" points="918,4647.8669,2098,4647.8669,2108,4686.8669,2098,4725.8669,918,4725.8669,908,4686.8669,918,4647.8669" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.2642" x="920" y="4665.764">duress_signal_index_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.3322" x="923.38" y="4683.47">content: duress_signal_index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3202" x="923.38" y="4701.176">nonce: rand() [u8; 32] }</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.303" x="923.38" y="4718.882">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: duress_signal_index_with_nonce)</text><g class="message" data-participant-1="ST" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,4769.103,999.3799,4773.103,1009.3799,4777.103,1005.3799,4773.103" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="4772.353" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1503.9681" y1="4773.103" y2="4773.103"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="4758.441">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.6921" x="1042.8579" y="4749.588">SetupStIsoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1046.2379" y="4767.294">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="720,4786.103,1276,4786.103,1286,4807.103,1276,4829.103,720,4829.103,710,4807.103,720,4786.103" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="548.8605" x="722" y="4804.0001">Iso receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from ST and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.7511" x="725.38" y="4821.7061">forwards it to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="997.8799" cy="4875.1771" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1437.3872,4871.9271,1447.3872,4875.9271,1437.3872,4879.9271,1441.3872,4875.9271" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1443.3872" y1="4875.9271" y2="4875.9271"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="4861.2651">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1032.8579" y="4852.4121">SetupIsoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.1234" x="1036.2379" y="4870.1181">duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1124,4888.9271,1773,4888.9271,1783,4918.9271,1773,4949.9271,1124,4949.9271,1114,4918.9271,1124,4888.9271" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="641.7455" x="1126" y="4906.8241">Boomlet receives duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0 from Iso. Boomlet will</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="624.3253" x="1129.38" y="4924.5301">search for the indices in duress_check_space. If the resulting 5 numbers constitute the same set as the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="511.4724" x="1129.38" y="4942.2362">duress_consent_set, Boomlet knows that the user has "memorized" the consent set.</text><polygon fill="#E6E6FA" points="860,4960.0452,2037,4960.0452,2047,4972.0452,2037,4985.0452,860,4985.0452,850,4972.0452,860,4960.0452" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1173.2635" x="862" y="4977.9422">duress_signal_index_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: duress_signal_index_with_nonce_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1176,4995.7512,1721,4995.7512,1731,5007.7512,1721,5020.7512,1176,5020.7512,1166,5007.7512,1176,4995.7512" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="541.0215" x="1178" y="5013.6482">Assert duress_signal_index_with_nonce.nonce == duress_check_space_with_nonce.nonce</text><polygon fill="#E6E6FA" points="1253,5031.4572,1645,5031.4572,1655,5043.4572,1645,5056.4572,1253,5056.4572,1243,5043.4572,1253,5031.4572" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.5573" x="1255" y="5049.3542">duress_signal_index := duress_signal_index_with_nonce.content</text><polygon fill="#FFC0CB" points="1252,5067.1632,1645,5067.1632,1655,5079.1632,1645,5092.1632,1252,5092.1632,1242,5079.1632,1252,5067.1632" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389.3503" x="1254" y="5085.0602">Assert duress_check_space[duress_signal_index] == consent_set</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,5135.2813,999.3799,5139.2813,1009.3799,5143.2813,1005.3799,5139.2813" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1448.8872" cy="5138.5313" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1444.3872" y1="5139.2813" y2="5139.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="5124.6192">[27]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1042.8579" y="5115.7662">SetupBoomletIsoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.3202" x="1046.2379" y="5133.4723">magic: "setup_duress_finished"</text></g><polygon fill="#FFF0F5" points="678,5152.2813,1318,5152.2813,1328,5173.2813,1318,5195.2813,678,5195.2813,668,5173.2813,678,5152.2813" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="633.0613" x="680" y="5170.1783">Iso receives {magic: "setup_duress_finished"} from Boomlet and knowing Boomlet can be disconnected,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.8402" x="683.38" y="5187.8843">returns mnemonic to User.</text><path d="M31,5214.6933 L245.6371,5214.6933 L245.6371,5224.3993 L235.6371,5234.3993 L31,5234.3993 L31,5214.6933" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="4559.2612" style="stroke:#000000;stroke-width:1.5;" width="3564.3058" x="31" y="5214.6933"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="169.6371" x="46" y="5229.5903">boomerang_params setup</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="400.6825,5271.8113,390.6825,5275.8113,400.6825,5279.8113,396.6825,5275.8113" style="stroke:#181818;stroke-width:1;"/><ellipse cx="997.8799" cy="5275.0613" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="993.3799" y1="5275.8113" y2="5275.8113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="5261.1493">[28]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2021" x="434.1605" y="5252.2963">SetupIsoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.1691" x="437.5405" y="5270.0023">mnemonic</text></g><polygon fill="#FFF0F5" points="51,5288.8113,727,5288.8113,737,5309.8113,727,5331.8113,51,5331.8113,41,5309.8113,51,5288.8113" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669.3312" x="53" y="5306.7084">User receives mnemonic from Iso, saves it in a safe place and proceeds to shutdown Iso and connect Boomlet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.3132" x="56.38" y="5324.4144">to Niso to continue setup.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="389.1825" cy="5413.2974" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,5410.0474,2349.846,5414.0474,2339.846,5418.0474,2343.846,5414.0474" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="2345.846" y1="5414.0474" y2="5414.0474"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="5381.6794">[29]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.7461" x="424.1605" y="5355.1204">SetupNisoInput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.453" x="427.5405" y="5372.8264">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.9121" x="427.5405" y="5390.5324">rpc_client_url</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.2091" x="427.5405" y="5408.2384">rpc_client_auth</text></g><polygon fill="#FFF0F5" points="2022,5427.0474,2681,5427.0474,2691,5457.0474,2681,5488.0474,2022,5488.0474,2012,5457.0474,2022,5427.0474" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="622.4144" x="2024" y="5444.9445">Niso receives {network, rpc_client_url, rpc_client_auth} from User during the installation. rpc_client_url</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="648.2844" x="2027.38" y="5462.6505">and rpc_client_auth provides a direct view into the provided network. As Niso communicates through TOR,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.2562" x="2027.38" y="5480.3565">Niso asks for peer_0_tor_secret_key from Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,5530.5775,1450.3872,5534.5775,1460.3872,5538.5775,1456.3872,5534.5775" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="5533.8275" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="5534.5775" y2="5534.5775"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="5519.9155">[30]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="5511.0625">SetupNisoBoomletMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.7891" x="1497.2453" y="5528.7685">magic: "setup_initialized"</text></g><polygon fill="#FFF0F5" points="1152,5547.5775,1745,5547.5775,1755,5577.5775,1745,5608.5775,1152,5608.5775,1142,5577.5775,1152,5547.5775" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585.6763" x="1154" y="5565.4745">Boomlet receives {magic: "setup_initialized"} from Niso. It then derives peer_0_tor_address from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="531.3884" x="1157.38" y="5583.1806">peer_0_tor_secret_key, signs it and responds with peer_0_id, peer_0_tor_secret_key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.9742" x="1157.38" y="5600.8866">peer_0_tor_address_signed_by_boomlet_0.</text><polygon fill="#E6E6FA" points="1220,5618.6956,1678,5618.6956,1688,5666.6956,1678,5714.6956,1220,5714.6956,1210,5666.6956,1220,5618.6956" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="395.0963" x="1222" y="5636.5926">peer_0_tor_address := derive_tor_address(peer_0_tor_secret_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="410.7354" x="1225.38" y="5654.2986">peer_0_tor_address_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="447.3305" x="1225.38" y="5672.0046">signature: schnorr_sign(boomlet_0_identity_privkey, peer_0_tor_address),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.9001" x="1225.38" y="5689.7106">content: peer_0_tor_address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1222" y="5707.4167">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="5796.2997" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,5793.0497,2349.846,5797.0497,2339.846,5801.0497,2343.846,5797.0497" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="5797.0497" y2="5797.0497"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="5764.6817">[31]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="5738.1227">SetupBoomletNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.357" x="1487.2453" y="5755.8287">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.5761" x="1487.2453" y="5773.5347">peer_0_tor_secret_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4902" x="1487.2453" y="5791.2407">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1999,5810.0497,2703,5810.0497,2713,5858.0497,2703,5906.0497,1999,5906.0497,1989,5858.0497,1999,5810.0497" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.2064" x="2001" y="5827.9467">Niso receives {peer_0_id, peer_0_tor_secret_key, peer_0_tor_address_signed_by_boomlet_0} from Boomlet. It</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.9924" x="2004.38" y="5845.6528">verifies the signature on peer_0_tor_address_signed_by_boomlet_0 using boomlet_0_identity_pubkey that it got in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="631.6705" x="2004.38" y="5863.3588">peer_0_id. Niso then runs a tor circuit using peer_0_tor_secret_key and generates peer_0_tor_address in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="593.0213" x="2004.38" y="5881.0648">doing so. It checks the generated peer_0_tor_address to be equal to the signed one and forwards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.0963" x="2004.38" y="5898.7708">peer_0_id and peer_0_tor_address_signed_by_boomlet_0 to ST.</text><polygon fill="#FFC0CB" points="1927,5916.5798,2776,5916.5798,2786,5928.5798,2776,5941.5798,1927,5941.5798,1917,5928.5798,1927,5916.5798" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="845.1825" x="1929" y="5934.4768">Assert schnorr_verify(pubkey: peer_0_id.boomlet_0_identity_pubkey, content: peer_0_tor_address_signed_by_boomlet_0.signature) == True</text><polygon fill="#E6E6FA" points="2141,5952.2858,2562,5952.2858,2572,5964.2858,2562,5977.2858,2141,5977.2858,2131,5964.2858,2141,5952.2858" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.1573" x="2143" y="5970.1828">peer_0_tor_address := onion_service(privkey: peer_0_tor_secret_key).</text><polygon fill="#FFC0CB" points="2069,5987.9918,2633,5987.9918,2643,5999.9918,2633,6012.9918,2069,6012.9918,2059,5999.9918,2069,5987.9918" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="560.8724" x="2071" y="6005.8888">Niso checks if the peer_0_tor_address_signed_by_boomlet_0.content == peer_0_tor_address.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1519.9681,6073.8159,1509.9681,6077.8159,1519.9681,6081.8159,1515.9681,6077.8159" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="6077.0659" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1513.9681" x2="2346.846" y1="6077.8159" y2="6077.8159"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1525.9681" y="6054.3009">[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.1691" x="1553.4461" y="6036.5949">SetupNisoStMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.357" x="1556.8261" y="6054.3009">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4902" x="1556.8261" y="6072.0069">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1185,6090.8159,1832,6090.8159,1842,6120.8159,1832,6151.8159,1185,6151.8159,1175,6120.8159,1185,6090.8159" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="614.4714" x="1187" y="6108.7129">ST receives {peer_0_id, peer_0_tor_address_signed_by_boomlet_0} from Niso. Since ST already knows</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.6364" x="1190.38" y="6126.4189">boomlet_0_identity_pubkey it checks the peer_0_id to make sure it contains the same identity pubkey for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.1981" x="1190.38" y="6144.1249">Boomlet.</text><polygon fill="#FFC0CB" points="1277,6161.934,1740,6161.934,1750,6173.934,1740,6186.934,1277,6186.934,1267,6173.934,1277,6161.934" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="459.0564" x="1279" y="6179.831">Assert peer_0_id.boomlet_0_identity_pubkey == boomlet_0_identity_pubkey</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="400.6825,6247.758,390.6825,6251.758,400.6825,6255.758,396.6825,6251.758" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="6251.008" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="1503.9681" y1="6251.758" y2="6251.758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="6228.243">[33]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.442" x="434.1605" y="6210.537">SetupStOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.357" x="437.5405" y="6228.243">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4902" x="437.5405" y="6245.949">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="61,6264.758,717,6264.758,727,6285.758,717,6307.758,61,6307.758,51,6285.758,61,6264.758" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="648.6745" x="63" y="6282.655">User receives {peer_0_id, peer_0_tor_address_signed_by_boomlet_0} from ST and proceeds to share it with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.7932" x="66.38" y="6300.361">peers in a secure out-of-band channel.</text><g class="message" data-participant-1="User" data-participant-2="Peers"><polygon fill="#181818" points="400.6825,6368.2881,390.6825,6372.2881,400.6825,6376.2881,396.6825,6372.2881" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3541.9308,6368.2881,3551.9308,6372.2881,3541.9308,6376.2881,3545.9308,6372.2881" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="394.6825" x2="3547.9308" y1="6372.2881" y2="6372.2881"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="6348.7731">[34]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="240.3572" x="434.1605" y="6331.0671">SetupUserPeersOutOfBandMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.357" x="437.5405" y="6348.7731">peer_0_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4902" x="437.5405" y="6366.4791">peer_0_tor_address_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="58,6385.2881,719,6385.2881,729,6424.2881,719,6463.2881,58,6463.2881,48,6424.2881,58,6385.2881" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="651.6904" x="60" y="6403.1851">User receives {peer_i_id, peer_i_tor_address_signed_by_boomlet_i} from peers, sending his own {peer_0_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.9624" x="63.38" y="6420.8911">peer_0_tor_address_signed_by_boomlet_0} at the same time. It then forms peer_addresses_collection from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="633.0744" x="63.38" y="6438.5971">pairs &lt;peer_i_id, peer_i_tor_address_signed_by_boomlet_i&gt; and inputs it alongside wt_ids_collection and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.1332" x="63.38" y="6456.3032">milestone_block_collection into Niso.</text><polygon fill="#E6E6FA" points="69,6474.1122,708,6474.1122,718,6486.1122,708,6499.1122,69,6499.1122,59,6486.1122,69,6474.1122" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="635.6486" x="71" y="6492.0092">peer_addresses_collection := Collection&lt;peer_i_id, peer_i_tor_address_signed_by_boomlet_i&gt; [0 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="389.1825" cy="6580.8923" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,6577.6423,2349.846,6581.6423,2339.846,6585.6423,2343.846,6581.6423" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="2345.846" y1="6581.6423" y2="6581.6423"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="6549.2742">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.7461" x="424.1605" y="6522.7152">SetupNisoInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.9001" x="427.5405" y="6540.4212">peer_addresses_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.3621" x="427.5405" y="6558.1272">wt_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6171" x="427.5405" y="6575.8332">milestone_block_collection</text></g><polygon fill="#FFF0F5" points="1990,6594.6423,2713,6594.6423,2723,6642.6423,2713,6690.6423,1990,6690.6423,1980,6642.6423,1990,6594.6423" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="657.7744" x="1992" y="6612.5393">Niso receives {peer_addresses_collection, wt_ids_collection, milestone_block_collection} from User. It checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="712.6603" x="1995.38" y="6630.2453">the correctness of peer_i_id.boomlet_i_identity_pubkey's signature on every peer_i_tor_address_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="487.8773" x="1995.38" y="6647.9513">and if successful attempts connecting to all of them. He then checks inclusion of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="677.8986" x="1995.38" y="6665.6573">&lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; in peer_addresses_collection and forwards the received</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.3601" x="1995.38" y="6683.3633">values to Boomlet.</text><polygon fill="#FFC0CB" points="1733,6701.1723,2969,6701.1723,2979,6713.1723,2969,6726.1723,1733,6726.1723,1723,6713.1723,1733,6701.1723" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1232.5309" x="1735" y="6719.0693">Assert schnorr_verify(pubkey: peer_addresses_collection.peer_i_id.boomlet_i_identity_pubkey, content: peer_addresses_collection.peer_i_tor_address_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4].</text><polygon fill="#E6E6FA" points="2127,6736.8783,2576,6736.8783,2586,6748.8783,2576,6761.8783,2127,6761.8783,2117,6748.8783,2127,6736.8783" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445.3414" x="2129" y="6754.7754">Connect to peer_i_tor_address_signed_by_boomlet_i.content [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2024,6772.5844,2679,6772.5844,2689,6784.5844,2679,6797.5844,2024,6797.5844,2014,6784.5844,2024,6772.5844" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="651.0925" x="2026" y="6790.4814">Niso checks &lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; inclusion in peer_addresses_collection.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,6876.1144,1450.3872,6880.1144,1460.3872,6884.1144,1456.3872,6880.1144" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="6879.3644" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="6880.1144" y2="6880.1144"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="6847.7464">[36]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="6821.1874">SetupNisoBoomletMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.9001" x="1497.2453" y="6838.8934">peer_addresses_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.3621" x="1497.2453" y="6856.5994">wt_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6171" x="1497.2453" y="6874.3054">milestone_block_collection</text></g><polygon fill="#FFF0F5" points="1069,6893.1144,1827,6893.1144,1837,6950.1144,1827,7007.1144,1069,7007.1144,1059,6950.1144,1069,6893.1144" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.6624" x="1071" y="6911.0115">Boomlet receives {peer_addresses_collection, wt_ids_collection, milestone_block_collection} from Niso. It</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.5143" x="1074.38" y="6928.7175">checks the peer_i_id.boomlet_i_identity_pubkey's signature on every peer_i_tor_address_signed_by_boomlet_i,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.1036" x="1074.38" y="6946.4235">checks inclusion of &lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; in peer_addresses_collection.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.3904" x="1074.38" y="6964.1295">To verify boomerang_params_seed that includes peer_ids, wt_ids and milestone_block_collection with User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="748.2283" x="1074.38" y="6981.8355">it adds nonce to it to get boomerang_params_seed_with_nonce, encrypts boomerang_params_seed_with_nonce for ST and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.1863" x="1074.38" y="6999.5415">sends boomerang_params_seed_encrypted_by_boomlet_0_for_st to Niso.</text><polygon fill="#FFC0CB" points="831,7017.3505,2067,7017.3505,2077,7029.3505,2067,7042.3505,831,7042.3505,821,7029.3505,831,7017.3505" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1232.5309" x="833" y="7035.2476">Assert schnorr_verify(pubkey: peer_addresses_collection.peer_i_id.boomlet_i_identity_pubkey, content: peer_addresses_collection.peer_i_tor_address_signed_by_boomlet_i.signature) == True [0 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1109,7053.0566,1788,7053.0566,1798,7065.0566,1788,7078.0566,1109,7078.0566,1099,7065.0566,1109,7053.0566" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="675.4805" x="1111" y="7070.9536">Boomlet checks &lt;peer_0_id, peer_0_tor_address_signed_by_boomlet_0&gt; inclusion in peer_addresses_collection.</text><path d="M52,7090.7626 L326.7102,7090.7626 L326.7102,7100.4686 L316.7102,7110.4686 L52,7110.4686 L52,7090.7626" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1400.655" style="stroke:#000000;stroke-width:1.5;" width="2652.5585" x="52" y="7090.7626"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229.7102" x="67" y="7105.6596">St_check(boomerang_params_seed)</text><polygon fill="#E6E6FA" points="860,7115.4686,2037,7115.4686,2047,7216.4686,2037,7317.4686,860,7317.4686,850,7216.4686,860,7115.4686" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.4214" x="862" y="7133.3656">peer_ids_collection := Collection&lt;peer_addresses_collection.peer_i_id&gt; [0 &lt;= i &lt;= 4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329.6412" x="865.38" y="7151.0716">boomerang_params_seed := BoomerangParamsSeed{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.2032" x="865.38" y="7168.7776">peer_ids: peer_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.9691" x="865.38" y="7186.4837">wt_ids: wt_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.0983" x="865.38" y="7204.1897">milestone_block_collection: milestone_block_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="865.38" y="7221.8957">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.3522" x="865.38" y="7239.6017">boomerang_params_seed_with_nonce := MessageWithNonce{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.4202" x="865.38" y="7257.3077">content: boomerang_params_seed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0002" x="865.38" y="7275.0137">nonce: rand() [u8; 32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="862" y="7292.7198">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1170.131" x="865.38" y="7310.4258">boomerang_params_seed_encrypted_by_boomlet_0_for_st := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: boomerang_params_seed_with_nonce)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="7363.8968" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,7360.6468,2349.846,7364.6468,2339.846,7368.6468,2343.846,7364.6468" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="7364.6468" y2="7364.6468"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="7349.9848">[37]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="7341.1318">SetupBoomletNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.8633" x="1487.2453" y="7358.8378">boomerang_params_seed_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="2018,7377.6468,2684,7377.6468,2694,7389.6468,2684,7402.6468,2018,7402.6468,2008,7389.6468,2018,7377.6468" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="662.5585" x="2020" y="7395.5438">Niso receives boomerang_params_seed_encrypted_by_boomlet_0_for_st from Boomlet and forwards it to ST.</text><g class="message" data-participant-1="Niso" data-participant-2="ST"><polygon fill="#181818" points="1519.9681,7445.7649,1509.9681,7449.7649,1519.9681,7453.7649,1515.9681,7449.7649" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="7449.0149" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1513.9681" x2="2346.846" y1="7449.7649" y2="7449.7649"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1525.9681" y="7435.1029">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.1691" x="1553.4461" y="7426.2498">SetupNisoStMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.8633" x="1556.8261" y="7443.9559">boomerang_params_seed_encrypted_by_boomlet_0_for_st</text></g><polygon fill="#FFF0F5" points="1178,7462.7649,1839,7462.7649,1849,7492.7649,1839,7523.7649,1178,7523.7649,1168,7492.7649,1178,7462.7649" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="601.8353" x="1180" y="7480.6619">ST receives boomerang_params_seed_encrypted_by_boomlet_0_for_st from Niso, decrypts it to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.9622" x="1183.38" y="7498.3679">boomerang_params_seed_with_nonce and separates boomerang_params_seed_with_nonce.content to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.7802" x="1183.38" y="7516.0739">boomerang_params_seed which it sends to User.</text><polygon fill="#E6E6FA" points="920,7533.8829,2097,7533.8829,2107,7554.8829,2097,7576.8829,920,7576.8829,910,7554.8829,920,7533.8829" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1170.0917" x="922" y="7551.7799">boomerang_params_seed_with_nonce := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: boomerang_params_seed_encrypted_by_boomlet_0_for_st)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460.7332" x="925.38" y="7569.4859">boomerang_params_seed := boomerang_params_seed_with_nonce.content</text><g class="message" data-participant-1="ST" data-participant-2="User"><polygon fill="#181818" points="400.6825,7619.707,390.6825,7623.707,400.6825,7627.707,396.6825,7623.707" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1508.4681" cy="7622.957" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="1503.9681" y1="7623.707" y2="7623.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="7609.045">[39]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104.442" x="434.1605" y="7600.192">SetupStOutput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.6651" x="437.5405" y="7617.898">boomerang_params_seed</text></g><polygon fill="#FFF0F5" points="72,7636.707,705,7636.707,715,7657.707,705,7679.707,72,7679.707,62,7657.707,72,7636.707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626.3535" x="74" y="7654.604">User receives boomerang_params_seed from ST and checks the correctness of it's peer_ids, wt_ids and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="529.6725" x="77.38" y="7672.31">milestone_block_collection. He then informs ST of his agreement with the given values.</text><polygon fill="#FFC0CB" points="140,7690.119,638,7690.119,648,7702.119,638,7715.119,140,7715.119,130,7702.119,140,7690.119" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="494.3513" x="142" y="7708.016">Assert boomerang_params_seed.peer_ids == peer_addresses_collection.peer_i_id</text><polygon fill="#FFC0CB" points="204,7725.825,573,7725.825,583,7737.825,573,7750.825,204,7750.825,194,7737.825,204,7725.825" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.9373" x="206" y="7743.722">Assert boomerang_params_seed.wt_ids == wt_ids_collection</text><polygon fill="#FFC0CB" points="112,7761.531,666,7761.531,676,7773.531,666,7786.531,112,7786.531,102,7773.531,112,7761.531" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="550.5504" x="114" y="7779.4281">Assert boomerang_params_seed.milestone_block_collection == milestone_block_collection</text><g class="message" data-participant-1="User" data-participant-2="ST"><ellipse cx="389.1825" cy="7832.8991" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1496.9681,7829.6491,1506.9681,7833.6491,1496.9681,7837.6491,1500.9681,7833.6491" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="1502.9681" y1="7833.6491" y2="7833.6491"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="7818.9871">[40]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.509" x="424.1605" y="7810.1341">SetupStInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="547.6122" x="427.5405" y="7827.8401">magic: "setup_user_verified_peer_ids_and_wt_ids_received_with_those_registered_before"</text></g><polygon fill="#FFF0F5" points="1165,7846.6491,1851,7846.6491,1861,7876.6491,1851,7907.6491,1165,7907.6491,1155,7876.6491,1165,7846.6491" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="661.6483" x="1167" y="7864.5461">ST receives {magic: "setup_user_verified_peer_ids_and_wt_ids_received_with_those_registered_before"} from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="675.5452" x="1170.38" y="7882.2521">User and proceeds to sign the received boomerang_params_seed_with_nonce, encrypt it for boomlet and send</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.1751" x="1170.38" y="7899.9581">it to Niso.</text><polygon fill="#E6E6FA" points="798,7917.7671,2218,7917.7671,2228,7965.7671,2218,8013.7671,798,8013.7671,788,7965.7671,798,7917.7671" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="472.0564" x="800" y="7935.6642">boomerang_params_seed_with_nonce_signed_by_st := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="521.8594" x="803.38" y="7953.3702">signature: schnorr_sign(st_0_identity_privkey, boomerang_params_seed_with_nonce),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.7682" x="803.38" y="7971.0762">content: boomerang_params_seed_with_nonce</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="800" y="7988.7822">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1413.0756" x="803.38" y="8006.4882">boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, st_0_identity_privkey), content: boomerang_params_seed_with_nonce_signed_by_st)</text><g class="message" data-participant-1="ST" data-participant-2="Niso"><ellipse cx="1508.4681" cy="8059.9593" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,8056.7093,2349.846,8060.7093,2339.846,8064.7093,2343.846,8060.7093" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1512.9681" x2="2345.846" y1="8060.7093" y2="8060.7093"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1515.9681" y="8046.0472">[41]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.1691" x="1543.4461" y="8037.1942">SetupStNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.0095" x="1546.8261" y="8054.9003">boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2022,8073.7093,2680,8073.7093,2690,8094.7093,2680,8116.7093,2022,8116.7093,2012,8094.7093,2022,8073.7093" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.8715" x="2024" y="8091.6063">Niso receives boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from ST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.4532" x="2027.38" y="8109.3123">and forwards it to Boomlet.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,8159.5333,1450.3872,8163.5333,1460.3872,8167.5333,1456.3872,8163.5333" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="8162.7833" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="8163.5333" y2="8163.5333"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="8148.8713">[42]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="8140.0183">SetupNisoBoomletMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="516.0095" x="1497.2453" y="8157.7243">boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="1085,8176.5333,1813,8176.5333,1823,8268.5333,1813,8361.5333,1085,8361.5333,1075,8268.5333,1085,8176.5333" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="691.7045" x="1087" y="8194.4303">Boomlet receives boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 from Niso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="686.9464" x="1090.38" y="8212.1364">Boomerang decrypts boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0 to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="470.1194" x="1090.38" y="8229.8424">boomerang_params_seed_with_nonce_signed_by_st, checks the signature on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.2733" x="1090.38" y="8247.5484">boomerang_params_seed_with_nonce_signed_by_st using st_0_identity_pubkey, and checks the content of it to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="717.8082" x="1090.38" y="8265.2544">match boomerang_params_seed_with_nonce sent before concluding that User verified the boomerang_params_seed.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="596.3494" x="1090.38" y="8282.9604">It then constructs boomerang_descriptor using network, milestone_block_collection and peer_ids.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643.2534" x="1090.38" y="8300.6664">milestone_block_0 marks the block that N of N of the boom_keys can spend. milestone_block_1 marks the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="544.1415" x="1090.38" y="8318.3725">block that enables deterministic spending i.e. N of N of the normal_keys can spend. other</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.3154" x="1090.38" y="8336.0785">milestone_blocks decrease the number of peers required to sign with their normal_pubkey. It then forms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="667.5244" x="1090.38" y="8353.7845">boomerang_params made up of peer_ids, wt_ids and boomerang_descriptor. Then signs and sends it to Niso.</text><polygon fill="#E6E6FA" points="740,8371.5935,2157,8371.5935,2167,8383.5935,2157,8396.5935,740,8396.5935,730,8383.5935,740,8371.5935" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1413.0361" x="742" y="8389.4905">boomerang_params_seed_with_nonce_signed_by_st := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, st_0_identity_pubkey), content: boomerang_params_seed_with_nonce_signed_by_st_encrypted_by_st_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1045,8407.2995,1853,8407.2995,1863,8419.2995,1853,8432.2995,1045,8432.2995,1035,8419.2995,1045,8407.2995" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="804.3235" x="1047" y="8425.1965">Assert schnorr_verify(pubkey: st_0_identity_pubkey, content: boomerang_params_seed_with_nonce_signed_by_st.signature) == True</text><polygon fill="#FFC0CB" points="1113,8443.0055,1785,8443.0055,1795,8464.0055,1785,8486.0055,1113,8486.0055,1103,8464.0055,1113,8443.0055" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.6731" x="1115" y="8460.9025">Freshness Check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="665.3663" x="1118.38" y="8478.6086">Assert boomerang_params_seed_with_nonce_signed_by_st.content == boomerang_params_seed_with_nonce</text><polygon fill="#E6E6FA" points="1039,8503.4176,1859,8503.4176,1869,8595.4176,1859,8688.4176,1039,8688.4176,1029,8595.4176,1039,8503.4176" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="813.3325" x="1041" y="8521.3146">boomerang_descriptor := construct_boomerang_descriptor(network, peer_addresses_collection.peer_i_id, milestone_block_collection)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.1872" x="1044.38" y="8539.0206">boomerang_params := BoomerangParams{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.2032" x="1044.38" y="8556.7266">peer_ids: peer_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.9691" x="1044.38" y="8574.4326">wt_ids: wt_ids_collection,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.0922" x="1044.38" y="8592.1386">boomerang_descriptor: boomerang_descriptor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1041" y="8609.8447">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.5974" x="1044.38" y="8627.5507">boomerang_params_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="452.1924" x="1044.38" y="8645.2567">signature: schnorr_sign(boomlet_0_identity_privkey, boomerang_params),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.7622" x="1044.38" y="8662.9627">content: boomerang_params</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1041" y="8680.6687">}</text><path d="M998,8700.4777 L1453.9563,8700.4777 L1453.9563,8710.1837 L1443.9563,8720.1837 L998,8720.1837 L998,8700.4777" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="559.5324" style="stroke:#000000;stroke-width:1.5;" width="2587.3058" x="998" y="8700.4777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="410.9563" x="1013" y="8715.3747">&lt;Acknowledgement of boomerang_params between Boomlets&gt;</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="8760.8458" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,8757.5958,2349.846,8761.5958,2339.846,8765.5958,2343.846,8761.5958" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="8761.5958" y2="8761.5958"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="8746.9338">[43]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="8738.0808">SetupBoomletNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261.3522" x="1487.2453" y="8755.7868">boomerang_params_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="2022,8774.5958,2680,8774.5958,2690,8795.5958,2680,8817.5958,2022,8817.5958,2012,8795.5958,2022,8774.5958" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="651.3524" x="2024" y="8792.4928">Niso receives boomerang_params_signed_by_boomlet_0 from Boomlet and proceeds to share it with other</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.5971" x="2027.38" y="8810.1988">peers' Nisos.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2362.846,8860.4198,2352.846,8864.4198,2362.846,8868.4198,2358.846,8864.4198" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3541.9308,8860.4198,3551.9308,8864.4198,3541.9308,8868.4198,3545.9308,8864.4198" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3547.9308" y1="8864.4198" y2="8864.4198"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="8849.7578">[44]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.8382" x="2396.324" y="8840.9048">SetupNisoPeerNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.6943" x="2399.704" y="8858.6108">boomerang_params_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1912,8877.4198,2790,8877.4198,2800,8916.4198,2790,8955.4198,1912,8955.4198,1902,8916.4198,1912,8877.4198" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="732.5894" x="1914" y="8895.3169">Niso receives boomerang_params_signed_by_boomlet_i from peers, sending boomerang_params_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.1962" x="1917.38" y="8913.0229">at the same time. It checks the content of each to be equal to boomerang_params_signed_by_boomlet_0 and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="867.3994" x="1917.38" y="8930.7289">for the signatures to be valid.  It then forms boomerang_params_signed_by_all_peers: Collection&lt;(boomerang_params_signed_by_boomlet_i)&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.4602" x="1917.38" y="8948.4349">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="2063,8966.2439,2638,8966.2439,2648,8978.2439,2638,8991.2439,2063,8991.2439,2053,8978.2439,2063,8966.2439" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="571.7275" x="2065" y="8984.1409">Assert boomerang_params_signed_by_boomlet_i.content == boomerang_params [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1921,9001.9499,2781,9001.9499,2791,9013.9499,2781,9026.9499,1921,9026.9499,1911,9013.9499,1921,9001.9499" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="856.9476" x="1923" y="9019.8469">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: boomerang_params_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,9070.068,1450.3872,9074.068,1460.3872,9078.068,1456.3872,9074.068" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="9073.318" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="9074.068" y2="9074.068"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="9059.406">[45]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="9050.553">SetupNisoBoomletMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="663.6506" x="1497.2453" y="9068.259">boomerang_params_signed_by_all_peers: Collection&lt;boomerang_params_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1085,9087.068,1812,9087.068,1822,9135.068,1812,9183.068,1085,9183.068,1075,9135.068,1085,9087.068" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="645.7493" x="1087" y="9104.965">Boomlet receives boomerang_params_signed_by_all_peers from Niso. It checks the content of each peer's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="716.3781" x="1090.38" y="9122.671">boomerang_params_signed_by_boomlet_i to be equal to boomerang_params_signed_by_boomlet_0 and verifies each</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="704.2625" x="1090.38" y="9140.377">of the corresponding signatures by peer_i.boomlet_i_identity_pubkey.  If the message checks out, Boomlet fixes the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.0503" x="1090.38" y="9158.083">boomerang_params as an agreed upon value between peers.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327.4703" x="1090.38" y="9175.789">It then informs Niso that boomerang_params is fixed.</text><polygon fill="#FFC0CB" points="1161,9193.5981,1736,9193.5981,1746,9205.5981,1736,9218.5981,1161,9218.5981,1151,9205.5981,1161,9193.5981" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="571.7275" x="1163" y="9211.4951">Assert boomerang_params_signed_by_boomlet_i.content == boomerang_params [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1018,9229.3041,1878,9229.3041,1888,9241.3041,1878,9254.3041,1018,9254.3041,1008,9241.3041,1018,9229.3041" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="856.9476" x="1020" y="9247.2011">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: boomerang_params_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="9307.6721" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,9304.4221,2349.846,9308.4221,2339.846,9312.4221,2343.846,9308.4221" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="9308.4221" y2="9308.4221"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="9293.7601">[46]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="9284.9071">SetupBoomletNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.3712" x="1487.2453" y="9302.6131">magic: "setup_boomerang_params_fixed"</text></g><polygon fill="#FFF0F5" points="2010,9321.4221,2693,9321.4221,2703,9342.4221,2693,9364.4221,2010,9364.4221,2000,9342.4221,2010,9321.4221" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="676.0004" x="2012" y="9339.3191">Niso receives {magic: "setup_boomerang_params_fixed"} from Boomlet and informs it to generate the mystery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.6012" x="2015.38" y="9357.0251">value that's used for withdrawal.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,9407.2462,1450.3872,9411.2462,1460.3872,9415.2462,1456.3872,9411.2462" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="9410.4962" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="9411.2462" y2="9411.2462"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="9396.5842">[47]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="9387.7312">SetupNisoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="430.1964" x="1497.2453" y="9405.4372">magic: "setup_boomerang_params_fixed_boomlet_can_draw_mystery"</text></g><polygon fill="#FFF0F5" points="1072,9424.2462,1826,9424.2462,1836,9481.2462,1826,9538.2462,1072,9538.2462,1062,9481.2462,1072,9424.2462" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.4894" x="1074" y="9442.1432">Boomlet receives {magic: "setup_boomerang_params_fixed"} from Niso. Boomlet then generates mystery as a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="743.6005" x="1077.38" y="9459.8492">random integer between MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS and MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.7734" x="1077.38" y="9477.5552">Initializes the counter value as 0, hashes boomerang_params using sha256 to get boomerang_params_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="704.2363" x="1077.38" y="9495.2612">and signs it to get boomerang_params_fingerprint_signed_by_boomlet_0, sorts peer_ids.boomlet_i_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="648.9344" x="1077.38" y="9512.9673">values and signs it to get sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0 and sends this</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="515.3984" x="1077.38" y="9530.6733">alongside sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0 to Niso.</text><polygon fill="#E6E6FA" points="1112,9548.4823,1786,9548.4823,1796,9658.4823,1786,9768.4823,1112,9768.4823,1102,9658.4823,1112,9548.4823" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.9266" x="1114" y="9566.3793">mystery := Rand(MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS, MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.6831" x="1117.38" y="9584.0853">counter := 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389.1293" x="1117.38" y="9601.7913">boomerang_params_fingerprint := sha256(boomerang_params)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="487.3705" x="1117.38" y="9619.4973">boomerang_params_fingerprint_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523.9655" x="1117.38" y="9637.2034">signature: schnorr_sign(boomlet_0_identity_privkey, boomerang_params_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.5352" x="1117.38" y="9654.9094">content: boomerang_params_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1117.38" y="9672.6154">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.0233" x="1117.38" y="9690.3214">sorted_all_peers_boomlet_identity_pubkeys := sort(boomerang_params.peer_ids.boomlet_i_identity_pubkey)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="556.6865" x="1117.38" y="9708.0274">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="593.2816" x="1117.38" y="9725.7334">signature: schnorr_sign(boomlet_0_identity_privkey, sorted_all_peers_boomlet_identity_pubkeys),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.8513" x="1117.38" y="9743.4395">content: sorted_all_peers_boomlet_identity_pubkeys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1117.38" y="9761.1455">}</text><path d="M45,9787.9545 L237.2121,9787.9545 L237.2121,9797.6605 L227.2121,9807.6605 L45,9807.6605 L45,9787.9545" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2647.9558" style="stroke:#000000;stroke-width:1.5;" width="3550.3058" x="45" y="9787.9545"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147.2121" x="60" y="9802.8515">watchtower activation</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="9866.0285" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,9862.7785,2349.846,9866.7785,2339.846,9870.7785,2343.846,9866.7785" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="9866.7785" y2="9866.7785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="9843.2635">[48]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="9825.5575">SetupBoomletNisoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402.4413" x="1487.2453" y="9843.2635">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333.1253" x="1487.2453" y="9860.9695">boomerang_params_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1956,9879.7785,2746,9879.7785,2756,9909.7785,2746,9940.7785,1956,9940.7785,1946,9909.7785,1956,9879.7785" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="494.7415" x="1958" y="9897.6756">Niso receives {sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="780.1174" x="1961.38" y="9915.3816">boomerang_params_fingerprint_signed_by_boomlet_0} from Boomlet and forwards them alongside boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.3123" x="1961.38" y="9933.0876">and peer_0_tor_address_signed_by_boomlet_0 to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2351.346" cy="10039.6767" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2997.1374,10036.4267,3007.1374,10040.4267,2997.1374,10044.4267,3001.1374,10040.4267" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2355.846" x2="3003.1374" y1="10040.4267" y2="10040.4267"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2358.846" y="9999.2056">[49]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="2386.324" y="9963.7936">SetupNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="2389.704" y="9981.4996">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402.4413" x="2389.704" y="9999.2056">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4902" x="2389.704" y="10016.9117">peer_0_tor_address_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333.1253" x="2389.704" y="10034.6177">boomerang_params_fingerprint_signed_by_boomlet_0</text></g><g class="message" data-participant-1="Peers" data-participant-2="WT"><polygon fill="#181818" points="3020.1374,10138.9568,3010.1374,10142.9568,3020.1374,10146.9568,3016.1374,10142.9568" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3553.4308" cy="10142.2068" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3014.1374" x2="3548.9308" y1="10142.9568" y2="10142.9568"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="3026.1374" y="10066.3237">SetupNisoWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.9422" x="3029.5174" y="10084.0297">boomlet_i_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398.3593" x="3029.5174" y="10101.7357">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.3262" x="3029.5174" y="10119.4417">peer_i_tor_address_signed_by_boomlet_i</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.9474" x="3029.5174" y="10137.1478">boomerang_params_fingerprint_signed_by_boomlet_i [1&lt;=i&lt;=4]</text></g><polygon fill="#FFF0F5" points="2659,10155.9568,3358,10155.9568,3368,10212.9568,3358,10269.9568,2659,10269.9568,2649,10212.9568,2659,10155.9568" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="652.4575" x="2661" y="10173.8538">WT receives {boomlet_i_identity_pubkey, sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="679.8224" x="2664.38" y="10191.5598">peer_i_tor_address_signed_by_boomlet_i, boomerang_params_fingerprint_signed_by_boomlet_i} from Niso and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="586.0403" x="2664.38" y="10209.2658">Peers. WT checks the signature of the received boomlet_i_identity_pubkey on the corresponding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="680.2514" x="2664.38" y="10226.9718">sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i, peer_i_tor_address_signed_by_boomlet_i and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="689.0914" x="2664.38" y="10244.6778">boomerang_params_fingerprint_signed_by_boomlet_i. It then responds to each peer's Niso with an invoice made</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6911" x="2664.38" y="10262.3839">for that peer.</text><polygon fill="#FFC0CB" points="2509,10280.1929,3507,10280.1929,3517,10292.1929,3507,10305.1929,2509,10305.1929,2499,10292.1929,2509,10280.1929" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="994.6567" x="2511" y="10298.0899">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: sorted_all_peers_boomlet_identity_pubkeys_signed_by_boomlet_i.signature) == True[0 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2584,10315.8989,3432,10315.8989,3442,10327.8989,3432,10340.8989,2584,10340.8989,2574,10327.8989,2584,10315.8989" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="844.6237" x="2586" y="10333.7959">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: peer_i_tor_address_signed_by_boomlet_i.signature) == True[0 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="2544,10351.6049,3473,10351.6049,3483,10363.6049,3473,10376.6049,2544,10376.6049,2534,10363.6049,2544,10351.6049" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="925.3407" x="2546" y="10369.5019">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: boomerang_params_fingerprint_signed_by_boomlet_i.signature) == True[0 &lt;= i &lt;= 4].</text><polygon fill="#E6E6FA" points="2826,10387.3109,3190,10387.3109,3200,10435.3109,3190,10483.3109,2826,10483.3109,2816,10435.3109,2826,10387.3109" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360.4122" x="2828" y="10405.2079">wt_service_fee_payment_info := WtServiceFeePaymentInfo{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.1902" x="2831.38" y="10422.9139">service_fee_invoice: service_fee_invoice,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.5342" x="2831.38" y="10440.62">payment_deadline: payment_deadline,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.9281" x="2831.38" y="10458.326">wt_id: wt_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2828" y="10476.032">}</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2362.846,10526.253,2352.846,10530.253,2362.846,10534.253,2358.846,10530.253" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3008.6374" cy="10529.503" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3004.1374" y1="10530.253" y2="10530.253"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="10515.591">[50]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="2396.324" y="10506.738">SetupWtNisoMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.4501" x="2399.704" y="10524.444">wt_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="2121,10543.253,2582,10543.253,2592,10555.253,2582,10568.253,2121,10568.253,2111,10555.253,2121,10543.253" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.5482" x="2123" y="10561.15">Niso receives wt_service_fee_payment_info from WT and outputs it to User.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="400.6825,10611.3711,390.6825,10615.3711,400.6825,10619.3711,396.6825,10615.3711" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="10614.6211" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="2346.846" y1="10615.3711" y2="10615.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="10600.7091">[51]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120.6791" x="434.1605" y="10591.8561">SetupNisoOutput1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.4501" x="437.5405" y="10609.5621">wt_service_fee_payment_info</text></g><polygon fill="#FFF0F5" points="65,10628.3711,712,10628.3711,722,10649.3711,712,10671.3711,65,10671.3711,55,10649.3711,65,10628.3711" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.3672" x="67" y="10646.2681">User receives wt_service_fee_payment_info from Niso, verifies the service_fee_invoice and wt_id and pays</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="405.8993" x="70.38" y="10663.9741">the invoice generating wt_service_fee_payment_receipt as a result.</text><polygon fill="#E6E6FA" points="177,10681.7831,601,10681.7831,611,10693.7831,601,10706.7831,177,10706.7831,167,10693.7831,177,10681.7831" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420.8882" x="179" y="10699.6801">wt_service_fee_payment_receipt := pay(wt_service_fee_payment_info)</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="389.1825" cy="10753.1512" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,10749.9012,2349.846,10753.9012,2339.846,10757.9012,2343.846,10753.9012" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="2345.846" y1="10753.9012" y2="10753.9012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="10739.2391">[52]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.7461" x="424.1605" y="10730.3861">SetupNisoInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.0401" x="427.5405" y="10748.0922">wt_service_fee_payment_receipt</text></g><polygon fill="#FFF0F5" points="2108,10766.9012,2595,10766.9012,2605,10778.9012,2595,10791.9012,2108,10791.9012,2098,10778.9012,2108,10766.9012" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="483.4053" x="2110" y="10784.7982">Niso receives wt_service_fee_payment_receipt from User and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2351.346" cy="10838.2692" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2997.1374,10835.0192,3007.1374,10839.0192,2997.1374,10843.0192,3001.1374,10839.0192" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2355.846" x2="3003.1374" y1="10839.0192" y2="10839.0192"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2358.846" y="10824.3572">[53]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="2386.324" y="10815.5042">SetupNisoWtMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.0401" x="2389.704" y="10833.2102">wt_service_fee_payment_receipt</text></g><polygon fill="#E6E6FA" points="2737,10852.0192,3281,10852.0192,3291,10926.0192,3281,11001.0192,2737,11001.0192,2727,10926.0192,2737,10852.0192" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="517.6342" x="2739" y="10869.9162">boomerang_params_fingerprint_suffixed_by_wt := WtBoomerangParamsFingerprint{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.5352" x="2742.38" y="10887.6222">content: boomerang_params_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.0533" x="2742.38" y="10905.3283">suffix: "setup_peers_registration_with_wt_completed"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2739" y="10923.0343">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="533.4294" x="2742.38" y="10940.7403">boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.1674" x="2742.38" y="10958.4463">signature: schnorr_sign(wt_privkey, boomerang_params_fingerprint_suffixed_by_wt),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.1503" x="2742.38" y="10976.1523">content: boomerang_params_fingerprint_suffixed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2742.38" y="10993.8583">}</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2362.846,11044.0794,2352.846,11048.0794,2362.846,11052.0794,2358.846,11048.0794" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3008.6374" cy="11047.3294" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3004.1374" y1="11048.0794" y2="11048.0794"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="11033.4174">[54]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="2396.324" y="11024.5644">SetupWtNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379.1843" x="2399.704" y="11042.2704">boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt</text></g><polygon fill="#FFC0CB" points="1947,11061.0794,2755,11061.0794,2765,11073.0794,2755,11086.0794,1947,11086.0794,1937,11073.0794,1947,11061.0794" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="804.6222" x="1949" y="11078.9764">Assert schnorr_verify(pubkey: wt_pubkey, content: boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt.signature) == True</text><polygon fill="#FFC0CB" points="1967,11096.7854,2736,11096.7854,2746,11108.7854,2736,11121.7854,1967,11121.7854,1957,11108.7854,1967,11096.7854" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="765.0246" x="1969" y="11114.6824">Assert boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt.suffix == "setup_peers_registration_with_wt_completed"</text><polygon fill="#FFC0CB" points="1934,11132.4914,2768,11132.4914,2778,11144.4914,2768,11157.4914,1934,11157.4914,1924,11144.4914,1934,11132.4914" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830.9863" x="1936" y="11150.3884">Assert boomerang_params_fingerprint_signed_by_wt.content.content == boomerang_params_fingerprint_signed_by_boomlet_0.content</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,11200.6095,1450.3872,11204.6095,1460.3872,11208.6095,1456.3872,11204.6095" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="11203.8595" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="11204.6095" y2="11204.6095"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="11189.9474">[55]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="11181.0944">SetupNisoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379.1843" x="1497.2453" y="11198.8005">boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt</text></g><polygon fill="#FFC0CB" points="1045,11217.6095,1853,11217.6095,1863,11229.6095,1853,11242.6095,1045,11242.6095,1035,11229.6095,1045,11217.6095" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="804.6222" x="1047" y="11235.5065">Assert schnorr_verify(pubkey: wt_pubkey, content: boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt.signature) == True</text><polygon fill="#FFC0CB" points="1064,11253.3155,1833,11253.3155,1843,11265.3155,1833,11278.3155,1064,11278.3155,1054,11265.3155,1064,11253.3155" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="765.0246" x="1066" y="11271.2125">Assert boomerang_params_fingerprint_suffixed_by_wt_signed_by_wt.suffix == "setup_peers_registration_with_wt_completed"</text><polygon fill="#FFC0CB" points="1125,11289.0215,1772,11289.0215,1782,11301.0215,1772,11314.0215,1125,11314.0215,1115,11301.0215,1125,11289.0215" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643.2663" x="1127" y="11306.9185">Assert boomerang_params_fingerprint_signed_by_wt.content.content == boomerang_params_fingerprint</text><path d="M954,11326.7275 L1670.2943,11326.7275 L1670.2943,11336.4335 L1660.2943,11346.4335 L954,11346.4335 L954,11326.7275" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="719.1805" style="stroke:#000000;stroke-width:1.5;" width="2631.3058" x="954" y="11326.7275"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="671.2943" x="969" y="11341.6245">&lt;Boomlet Shared State in Sync regarding the WT service being activated and all peers in the know of it&gt;</text><polygon fill="#E6E6FA" points="1173,11351.4335,1723,11351.4335,1733,11434.4335,1723,11518.4335,1173,11518.4335,1163,11434.4335,1173,11351.4335" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.7192" x="1175" y="11369.3305">shared_state_active_wt := SharedStateBoomerangParams{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.3622" x="1178.38" y="11387.0366">boomerang_params: boomerang_params,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.7022" x="1178.38" y="11404.7426">magic: "setup_wt_service_initialized"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1175" y="11422.4486">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421.5773" x="1178.38" y="11440.1546">shared_state_active_wt_fingerprint := sha256(shared_state_active_wt)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="503.5945" x="1178.38" y="11457.8606">shared_state_active_wt_fingerprint_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="540.1895" x="1178.38" y="11475.5666">signature: schnorr_sign(boomlet_0_identity_privkey, shared_state_active_wt_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.7592" x="1178.38" y="11493.2727">content: shared_state_active_wt_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1178.38" y="11510.9787">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="11564.4497" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,11561.1997,2349.846,11565.1997,2339.846,11569.1997,2343.846,11565.1997" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="11565.1997" y2="11565.1997"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="11550.5377">[56]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="11541.6847">SetupBoomletNisoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="349.3493" x="1487.2453" y="11559.3907">shared_state_active_wt_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1978,11578.1997,2725,11578.1997,2735,11590.1997,2725,11603.1997,1978,11603.1997,1968,11590.1997,1978,11578.1997" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="743.6655" x="1980" y="11596.0967">Niso receives shared_state_active_wt_fingerprint_signed_by_boomlet_0 from Boomlet and proceeds to share it with Peers.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2362.846,11646.3178,2352.846,11650.3178,2362.846,11654.3178,2358.846,11650.3178" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3541.9308,11646.3178,3551.9308,11650.3178,3541.9308,11654.3178,3545.9308,11650.3178" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3547.9308" y1="11650.3178" y2="11650.3178"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="11635.6557">[57]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.8382" x="2396.324" y="11626.8027">SetupNisoPeerNisoMessage2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418.6914" x="2399.704" y="11644.5088">shared_state_active_wt_fingerprint_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1943,11663.3178,2759,11663.3178,2769,11711.3178,2759,11759.3178,1943,11759.3178,1933,11711.3178,1943,11663.3178" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="555.8544" x="1945" y="11681.2148">Niso receives shared_state_active_wt_fingerprint_signed_by_boomlet_i from peers, sending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="518.8434" x="1948.38" y="11698.9208">shared_state_active_wt_fingerprint_signed_by_boomlet_0 at the same time. It verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.9113" x="1948.38" y="11716.6268">boomlet_i_identity_pubkey's signature on each and the contents to match the one signed by boomlet_0, then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="805.6884" x="1948.38" y="11734.3328">forms shared_state_active_wt_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_wt_fingerprint_signed_by_boomlet_i&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.4602" x="1948.38" y="11752.0388">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="1877,11769.8478,2825,11769.8478,2835,11781.8478,2825,11794.8478,1877,11794.8478,1867,11781.8478,1877,11769.8478" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="944.9447" x="1879" y="11787.7449">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_wt_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1883,11805.5539,2818,11805.5539,2828,11817.5539,2818,11830.5539,1883,11830.5539,1873,11817.5539,1883,11805.5539" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="931.9576" x="1885" y="11823.4509">Assert shared_state_active_wt_fingerprint_signed_by_boomlet_i.content == shared_state_active_wt_fingerprint_signed_by_boomlet_0.content [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,11873.6719,1450.3872,11877.6719,1460.3872,11881.6719,1456.3872,11877.6719" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="11876.9219" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="11877.6719" y2="11877.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="11863.0099">[58]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="11854.1569">SetupNisoBoomletMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="839.6447" x="1497.2453" y="11871.8629">shared_state_active_wt_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_wt_fingerprint_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1001,11890.6719,1896,11890.6719,1906,11929.6719,1896,11968.6719,1001,11968.6719,991,11929.6719,1001,11890.6719" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.9072" x="1003" y="11908.5689">Boomlet receives shared_state_active_wt_fingerprint_signed_by_all_peers from Niso. It checks the content of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="506.0774" x="1006.38" y="11926.2749">each peer's shared_state_active_wt_fingerprint_signed_by_boomlet_i to be equal to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="884.3513" x="1006.38" y="11943.981">shared_state_active_wt_fingerprint_signed_by_boomlet_0 and verifies each of the corresponding signatures by peer_i.boomlet_i_identity_pubkey.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392.8604" x="1006.38" y="11961.687">It then informs Niso that wt is confirmed and active for all peers.</text><polygon fill="#FFC0CB" points="974,11979.496,1922,11979.496,1932,11991.496,1922,12004.496,974,12004.496,964,11991.496,974,11979.496" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="944.9447" x="976" y="11997.393">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_wt_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1075,12015.202,1823,12015.202,1833,12027.202,1823,12040.202,1075,12040.202,1065,12027.202,1075,12015.202" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="744.2377" x="1077" y="12033.099">Assert shared_state_active_wt_fingerprint_signed_by_boomlet_i.content == shared_state_active_wt_fingerprint [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="12093.57" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,12090.32,2349.846,12094.32,2339.846,12098.32,2343.846,12094.32" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="12094.32" y2="12094.32"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="12079.658">[59]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="12070.805">SetupBoomletNisoMessage7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286.7152" x="1487.2453" y="12088.511">magic: "setup_wt_service_confirmed_by_peers"</text></g><polygon fill="#FFF0F5" points="2001,12107.32,2701,12107.32,2711,12119.32,2701,12132.32,2001,12132.32,1991,12119.32,2001,12107.32" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="696.0595" x="2003" y="12125.2171">Niso receives {magic: "setup_wt_service_confirmed_by_peers"} from Boomlet and informs Boomlet to finalize sars.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,12175.4381,1450.3872,12179.4381,1460.3872,12183.4381,1456.3872,12179.4381" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="12178.6881" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="12179.4381" y2="12179.4381"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="12164.7761">[60]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="12155.9231">SetupNisoBoomletMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="423.1113" x="1497.2453" y="12173.6291">magic: "setup_wt_service_confirmed_by_peers_sars_can_be_finalized"</text></g><polygon fill="#FFF0F5" points="1041,12192.4381,1856,12192.4381,1866,12240.4381,1856,12288.4381,1041,12288.4381,1031,12240.4381,1041,12192.4381" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.2535" x="1043" y="12210.3351">Boomlet receives {magic: "setup_wt_service_confirmed_by_peers_sars_can_be_finalized"} from Niso. Boomlet then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="608.0492" x="1046.38" y="12228.0411">generates doxing_data_identifier by hashing doxing_key and encrypts it by sar_pubkey. It also signs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.0624" x="1046.38" y="12245.7471">sar_ids_collection and encrypts sar_ids_collection_signed_by_boomlet_0 it by wt_pubkey. It then sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="805.0124" x="1046.38" y="12263.4532">{sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, doxing_data_identifier_encrypted_by_boomlet_0_for_sar}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.748" x="1046.38" y="12281.1592">to Niso.</text><polygon fill="#E6E6FA" points="840,12298.9682,2058,12298.9682,2068,12363.9682,2058,12429.9682,840,12429.9682,830,12363.9682,840,12298.9682" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.3652" x="842" y="12316.8652">doxing_data_identifier := sha256(doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1000.7797" x="845.38" y="12334.5712">doxing_data_identifier_encrypted_by_boomlet_0_for_sar := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: doxing_data_identifier)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.9304" x="845.38" y="12352.2772">sar_ids_collection_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="434.5255" x="845.38" y="12369.9832">signature: schnorr_sign(boomlet_0_identity_privkey, sar_ids_collection),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.0952" x="845.38" y="12387.6892">content: sar_ids_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="845.38" y="12405.3953">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1211.1199" x="845.38" y="12423.1013">sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt :=  AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, wt_pubkey), content: sar_ids_collection_signed_by_boomlet_0)</text><path d="M28,12449.9103 L162.18,12449.9103 L162.18,12459.6163 L152.18,12469.6163 L28,12469.6163 L28,12449.9103" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2659.6618" style="stroke:#000000;stroke-width:1.5;" width="4055.4299" x="28" y="12449.9103"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.18" x="43" y="12464.8073">sar activation</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="12527.9844" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,12524.7344,2349.846,12528.7344,2339.846,12532.7344,2343.846,12528.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="12528.7344" y2="12528.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="12505.2193">[61]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="12487.5133">SetupBoomletNisoMessage8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445.8744" x="1487.2453" y="12505.2193">sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.3943" x="1487.2453" y="12522.9253">doxing_data_identifier_encrypted_by_boomlet_0_for_sar</text></g><polygon fill="#FFF0F5" points="2061,12541.7344,2642,12541.7344,2652,12562.7344,2642,12584.7344,2061,12584.7344,2051,12562.7344,2061,12541.7344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.1744" x="2063" y="12559.6314">Niso receives {sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="574.1064" x="2066.38" y="12577.3374">doxing_data_identifier_encrypted_by_boomlet_0_for_sar} from Boomlet and forwards it to WT.</text><g class="message" data-participant-1="Niso" data-participant-2="WT"><ellipse cx="2351.346" cy="12648.5144" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2997.1374,12645.2644,3007.1374,12649.2644,2997.1374,12653.2644,3001.1374,12649.2644" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2355.846" x2="3003.1374" y1="12649.2644" y2="12649.2644"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2358.846" y="12625.7494">[62]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="2386.324" y="12608.0434">SetupNisoWtMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445.8744" x="2389.704" y="12625.7494">sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.3943" x="2389.704" y="12643.4554">doxing_data_identifier_encrypted_by_boomlet_0_for_sar</text></g><polygon fill="#FFF0F5" points="2565,12662.2644,3453,12662.2644,3463,12710.2644,3453,12758.2644,2565,12758.2644,2555,12710.2644,2565,12662.2644" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="880.8804" x="2567" y="12680.1614">WT receives {sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt, doxing_data_identifier_encrypted_by_boomlet_0_for_sar}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="687.2454" x="2570.38" y="12697.8675">from Niso and decrypts sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt. It then verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="471.7054" x="2570.38" y="12715.5735">the signature on sar_ids_collection_signed_by_boomlet_0 and if correct sends</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="656.6824" x="2570.38" y="12733.2795">doxing_data_identifier_encrypted_by_boomlet_0_for_sar alongside boomlet_0_identity_pubkey to the SAR in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.8241" x="2570.38" y="12750.9855">sar_ids_collection.</text><polygon fill="#E6E6FA" points="2403,12768.7945,3614,12768.7945,3624,12780.7945,3614,12793.7945,2403,12793.7945,2393,12780.7945,2403,12768.7945" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1207.7007" x="2405" y="12786.6915">sar_ids_collection_signed_by_boomlet_0 := AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, wt_privkey), content: sar_ids_collection_signed_by_boomlet_0_encrypted_by_boomlet_0_for_wt)</text><polygon fill="#FFC0CB" points="2620,12804.5005,3398,12804.5005,3408,12816.5005,3398,12829.5005,2620,12829.5005,2610,12816.5005,2620,12804.5005" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="774.0204" x="2622" y="12822.3975">Assert schnorr_verify(pubkey: boomlet_0_identity_pubkey, content: sar_ids_collection_signed_by_boomlet_0.signature) == True.</text><g class="message" data-participant-1="WT" data-participant-2="SARs"><ellipse cx="3008.6374" cy="12893.5746" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="3471.0247,12890.3246,3481.0247,12894.3246,3471.0247,12898.3246,3475.0247,12894.3246" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="3013.1374" x2="3477.0247" y1="12894.3246" y2="12894.3246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="3016.1374" y="12870.8096">[63]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.4521" x="3043.6154" y="12853.1036">SetupWtSarMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="342.3943" x="3046.9954" y="12870.8096">doxing_data_identifier_encrypted_by_boomlet_0_for_sar</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="3046.9954" y="12888.5156">boomlet_0_identity_pubkey</text></g><polygon fill="#FFF0F5" points="3103,12907.3246,3861,12907.3246,3871,12981.3246,3861,13056.3246,3103,13056.3246,3093,12981.3246,3103,12907.3246" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="665.6656" x="3105" y="12925.2216">SAR receives {doxing_data_identifier_encrypted_by_boomlet_0_for_sar, boomlet_0_identity_pubkey} from WT.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="694.5255" x="3108.38" y="12942.9276">ST decrypts doxing_data_identifier_encrypted_by_boomlet_0_for_sar using boomlet_0_identity_pubkey and checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640.9523" x="3108.38" y="12960.6336">if the plaintext was previously received as doxing_data_identifier. If True it generates sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585.4685" x="3108.38" y="12978.3397">containing {doxing_data_identifier, fingerprint_of_static_doxing_data_encrypted_by_doxing_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="737.6592" x="3108.38" y="12996.0457">iv_of_static_doxing_data_encrypted_by_doxing_key} in which fingerprint_of_static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="747.8383" x="3108.38" y="13013.7517">is the sha256 hash of static_doxing_data_encrypted_by_doxing_key and iv_of_static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="699.5952" x="3108.38" y="13031.4577">is the iv used in AES encryption algorithm it got alongside the ciphertext of doxing_data_encrypted_by_doxing_key.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="651.9504" x="3108.38" y="13049.1637">SAR then signs sar_setup_response encrypts it with boomlet_0_identity_pubkey and sends the result to WT.</text><polygon fill="#E6E6FA" points="2928,13066.9727,4037,13066.9727,4047,13078.9727,4037,13091.9727,2928,13091.9727,2918,13078.9727,2928,13066.9727" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1105.2996" x="2930" y="13084.8697">freshly_received_doxing_data_identifier := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, sar_privkey), content: doxing_data_identifier_encrypted_by_boomlet_0_for_sar)</text><polygon fill="#FFC0CB" points="3260,13102.6787,3704,13102.6787,3714,13114.6787,3704,13127.6787,3260,13127.6787,3250,13114.6787,3260,13102.6787" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440.1412" x="3262" y="13120.5758">Assert freshly_received_doxing_data_identifier == doxing_data_identifier</text><polygon fill="#E6E6FA" points="2902,13138.3848,4063,13138.3848,4073,13230.3848,4063,13323.3848,2902,13323.3848,2892,13230.3848,2902,13138.3848" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.8032" x="2904" y="13156.2818">sar_setup_response := SarSetupResponse{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.8022" x="2907.38" y="13173.9878">doxing_data_identifier: doxing_data_identifier,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="699.9983" x="2907.38" y="13191.6938">fingerprint_of_static_doxing_data_encrypted_by_doxing_key: sha256(static_doxing_data_encrypted_by_doxing_key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="605.7355" x="2907.38" y="13209.3998">iv_of_static_doxing_data_encrypted_by_doxing_key: static_doxing_data_encrypted_by_doxing_key.iv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2904" y="13227.1058">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.1073" x="2907.38" y="13244.8119">sar_setup_response_signed_by_sar := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.8452" x="2907.38" y="13262.5179">signature: schnorr_sign(sar_privkey, sar_setup_response),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.8502" x="2907.38" y="13280.2239">content: sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2907.38" y="13297.9299">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1154.0499" x="2907.38" y="13315.6359">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0 := AES_encrypt(private_key: ECDH(boomlet_0_identity_pubkey, sar_privkey), content: sar_setup_response_signed_by_sar)</text><g class="message" data-participant-1="SARs" data-participant-2="WT"><polygon fill="#181818" points="3020.1374,13365.857,3010.1374,13369.857,3020.1374,13373.857,3016.1374,13369.857" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3482.5247" cy="13369.107" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="3014.1374" x2="3478.0247" y1="13369.857" y2="13369.857"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="3026.1374" y="13355.195">[64]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.4521" x="3053.6154" y="13346.3419">SetupSarWtMessage1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.0294" x="3056.9954" y="13364.048">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0</text></g><polygon fill="#FFF0F5" points="2670,13382.857,3347,13382.857,3357,13403.857,3347,13425.857,2670,13425.857,2660,13403.857,2670,13382.857" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="658.8145" x="2672" y="13400.754">WT receives sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0 from SAR. It then adds the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.0593" x="2675.38" y="13418.46">suffix "setup_sar_acknowledgement_of_finalization_received" to it, signs it with wt_privkey and send it to Niso.</text><polygon fill="#E6E6FA" points="2625,13436.269,3392,13436.269,3402,13510.269,3392,13585.269,2625,13585.269,2615,13510.269,2625,13436.269" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="668.1354" x="2627" y="13454.166">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt := WtSarSetupResponse{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.2684" x="2630.38" y="13471.872">content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="397.5403" x="2630.38" y="13489.578">wt_suffix: "setup_sar_acknowledgement_of_finalization_received"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2630.38" y="13507.2841">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="756.6784" x="2630.38" y="13524.9901">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="741.4163" x="2630.38" y="13542.6961">signature: schnorr_sign(wt_privkey, sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="568.3994" x="2630.38" y="13560.4021">content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="2630.38" y="13578.1081">}</text><g class="message" data-participant-1="WT" data-participant-2="Niso"><polygon fill="#181818" points="2362.846,13628.3292,2352.846,13632.3292,2362.846,13636.3292,2358.846,13632.3292" style="stroke:#181818;stroke-width:1;"/><ellipse cx="3008.6374" cy="13631.5792" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3004.1374" y1="13632.3292" y2="13632.3292"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="13617.6672">[65]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.5771" x="2396.324" y="13608.8141">SetupWtNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="602.4333" x="2399.704" y="13626.5202">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt</text></g><polygon fill="#FFF0F5" points="1964,13645.3292,2739,13645.3292,2749,13675.3292,2739,13706.3292,1964,13706.3292,1954,13675.3292,1964,13645.3292" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="745.7324" x="1966" y="13663.2262">Niso receives sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt from WT,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="764.6866" x="1969.38" y="13680.9322">checks the signature using wt_pubkey and checks the suffix to match "setup_sar_acknowledgement_of_finalization_received".</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.6572" x="1969.38" y="13698.6382">It then forwards the message to Boomlet.</text><polygon fill="#FFC0CB" points="1834,13716.4472,2869,13716.4472,2879,13728.4472,2869,13741.4472,1834,13741.4472,1824,13728.4472,1834,13716.4472" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1031.3552" x="1836" y="13734.3442">Assert schnorr_verify(pubkey: wt_pubkey, content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.signature) == True.</text><polygon fill="#FFC0CB" points="1851,13752.1532,2852,13752.1532,2862,13764.1532,2852,13777.1532,1851,13777.1532,1841,13764.1532,1851,13752.1532" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="997.5425" x="1853" y="13770.0502">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.suffix == "setup_sar_acknowledgement_of_finalization_received"</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,13820.2713,1450.3872,13824.2713,1460.3872,13828.2713,1456.3872,13824.2713" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="13823.5213" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="13824.2713" y2="13824.2713"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="13809.6093">[66]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1493.8653" y="13800.7563">SetupNisoBoomletMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="602.4333" x="1497.2453" y="13818.4623">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt</text></g><polygon fill="#FFF0F5" points="1090,13837.2713,1808,13837.2713,1818,13902.2713,1808,13968.2713,1090,13968.2713,1080,13902.2713,1090,13837.2713" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="710.6973" x="1092" y="13855.1683">Boomlet receives sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="546.8193" x="1095.38" y="13872.8743">from Niso. Boomlet verifies the signature using wt_pubkey and checks the suffix to match</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="605.0461" x="1095.38" y="13890.5803">"setup_sar_acknowledgement_of_finalization_received". It then decrypts the suffixed content to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.0212" x="1095.38" y="13908.2863">sar_setup_response_signed_by_sar, verifies sar_pubkey's signature and makes sure the doxing_data_identifier</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="685.2563" x="1095.38" y="13925.9924">in sar_setup_response_signed_by_sar matches what was sent to SAR. Boomlet saves sar_setup_response to send</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="602.4463" x="1095.38" y="13943.6984">to Iso later on and hashes SharedStateSarFinalization{ magic: "setup_wt_received_sar_data"} to get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="634.9984" x="1095.38" y="13961.4044">shared_state_active_sar_fingerprint. Then signs it using boomlet_0_identity_pubkey and sends it to Niso.</text><polygon fill="#FFC0CB" points="931,13979.2134,1966,13979.2134,1976,13991.2134,1966,14004.2134,931,14004.2134,921,13991.2134,931,13979.2134" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1031.3552" x="933" y="13997.1104">Assert schnorr_verify(pubkey: wt_pubkey, content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.signature) == True.</text><polygon fill="#FFC0CB" points="948,14014.9194,1949,14014.9194,1959,14026.9194,1949,14039.9194,948,14039.9194,938,14026.9194,948,14014.9194" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="997.5425" x="950" y="14032.8164">sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0_suffixed_by_wt_signed_by_wt.suffix == "setup_sar_acknowledgement_of_finalization_received"</text><polygon fill="#E6E6FA" points="870,14050.6254,2028,14050.6254,2038,14062.6254,2028,14075.6254,870,14075.6254,860,14062.6254,870,14050.6254" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1154.0104" x="872" y="14068.5224">sar_setup_response_signed_by_sar := AES_decrypt(private_key: ECDH(boomlet_0_identity_privkey, sar_pubkey), content: sar_setup_response_signed_by_sar_encrypted_by_sar_for_boomlet_0)</text><polygon fill="#FFC0CB" points="1124,14086.3314,1773,14086.3314,1783,14098.3314,1773,14111.3314,1124,14111.3314,1114,14098.3314,1124,14086.3314" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="645.7625" x="1126" y="14104.2285">Assert schnorr_verify(pubkey: sar_pubkey, content: sar_setup_response_signed_by_sar.signature) == True.</text><polygon fill="#FFC0CB" points="1166,14122.0375,1730,14122.0375,1740,14134.0375,1730,14147.0375,1166,14147.0375,1156,14134.0375,1166,14122.0375" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="560.8074" x="1168" y="14139.9345">sar_setup_response_signed_by_sar.content.doxing_data_identifier == doxing_data_identifier</text><path d="M952,14159.7435 L1734.5422,14159.7435 L1734.5422,14169.4495 L1724.5422,14179.4495 L952,14179.4495 L952,14159.7435" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="701.4745" style="stroke:#000000;stroke-width:1.5;" width="2633.3058" x="952" y="14159.7435"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="737.5422" x="967" y="14174.6405">&lt;Boomlet Shared State in Sync regarding the WT know about SARs being activated and all peers in the know of it&gt;</text><polygon fill="#E6E6FA" points="1171,14184.4495,1725,14184.4495,1735,14258.4495,1725,14333.4495,1171,14333.4495,1161,14258.4495,1171,14184.4495" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="330.4213" x="1173" y="14202.3465">shared_state_active_sar := SharedStateSarFinalization{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.5102" x="1176.38" y="14220.0525">magic: "setup_wt_received_sar_data"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1173" y="14237.7585">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429.5333" x="1176.38" y="14255.4646">shared_state_active_sar_fingerprint := sha256(shared_state_active_sar)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="507.5725" x="1176.38" y="14273.1706">shared_state_active_sar_fingerprint_signed_by_boomlet_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="544.1675" x="1176.38" y="14290.8766">signature: schnorr_sign(boomlet_0_identity_privkey, shared_state_active_sar_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.7372" x="1176.38" y="14308.5826">content: shared_state_active_sar_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1176.38" y="14326.2886">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="14379.7597" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,14376.5097,2349.846,14380.5097,2339.846,14384.5097,2343.846,14380.5097" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="14380.5097" y2="14380.5097"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="14365.8476">[67]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="185.2502" x="1483.8653" y="14356.9946">SetupBoomletNisoMessage9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.3273" x="1487.2453" y="14374.7007">shared_state_active_sar_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1976,14393.5097,2727,14393.5097,2737,14405.5097,2727,14418.5097,1976,14418.5097,1966,14405.5097,1976,14393.5097" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="747.6434" x="1978" y="14411.4067">Niso receives shared_state_active_sar_fingerprint_signed_by_boomlet_0 from Boomlet and proceeds to share it with Peers.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2362.846,14461.6277,2352.846,14465.6277,2362.846,14469.6277,2358.846,14465.6277" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3541.9308,14461.6277,3551.9308,14465.6277,3541.9308,14469.6277,3545.9308,14465.6277" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3547.9308" y1="14465.6277" y2="14465.6277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="14450.9657">[68]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.8382" x="2396.324" y="14442.1127">SetupNisoPeerNisoMessage3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422.6694" x="2399.704" y="14459.8187">shared_state_active_sar_fingerprint_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1959,14478.6277,2743,14478.6277,2753,14526.6277,2743,14574.6277,1959,14574.6277,1949,14526.6277,1959,14478.6277" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="559.8324" x="1961" y="14496.5247">Niso receives shared_state_active_sar_fingerprint_signed_by_boomlet_i from peers, sending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="698.2954" x="1964.38" y="14514.2307">shared_state_active_sar_fingerprint_signed_by_boomlet_0 at the same time. It verifies boomlet_i_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="528.9054" x="1964.38" y="14531.9368">signature on each and the contents to match the one signed by boomlet_0, then forms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="774.1765" x="1964.38" y="14549.6428">shared_state_active_sar_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_sar_fingerprint_signed_by_boomlet_i&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.4602" x="1964.38" y="14567.3488">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="1875,14585.1578,2827,14585.1578,2837,14597.1578,2827,14610.1578,1875,14610.1578,1865,14597.1578,1875,14585.1578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="948.9227" x="1877" y="14603.0548">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_sar_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1879,14620.8638,2822,14620.8638,2832,14632.8638,2822,14645.8638,1879,14645.8638,1869,14632.8638,1879,14620.8638" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="939.9137" x="1881" y="14638.7608">Assert shared_state_active_sar_fingerprint_signed_by_boomlet_i.content == shared_state_active_sar_fingerprint_signed_by_boomlet_0.content [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,14688.9819,1450.3872,14692.9819,1460.3872,14696.9819,1456.3872,14692.9819" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="14692.2319" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="14692.9819" y2="14692.9819"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="14678.3198">[69]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6862" x="1493.8653" y="14669.4668">SetupNisoBoomletMessage10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="847.6007" x="1497.2453" y="14687.1729">shared_state_active_sar_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_sar_fingerprint_signed_by_boomlet_i&gt; [1 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1105,14705.9819,1793,14705.9819,1803,14744.9819,1793,14783.9819,1105,14783.9819,1095,14744.9819,1105,14705.9819" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="649.1683" x="1107" y="14723.8789">Boomlet receives shared_state_active_sar_fingerprint_signed_by_all_peers from Niso. It checks the content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="525.7723" x="1110.38" y="14741.5849">of each peer's shared_state_active_sar_fingerprint_signed_by_boomlet_i to be equal to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="677.8853" x="1110.38" y="14759.2909">shared_state_active_sar_fingerprint_signed_by_boomlet_0 and verifies each of the corresponding signatures by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="670.0855" x="1110.38" y="14776.9969">peer_i.boomlet_i_identity_pubkey. It then informs Niso that sar activation is confirmed and active for all peers.</text><polygon fill="#FFC0CB" points="972,14794.8059,1924,14794.8059,1934,14806.8059,1924,14819.8059,972,14819.8059,962,14806.8059,972,14794.8059" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="948.9227" x="974" y="14812.7029">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_sar_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1071,14830.5119,1827,14830.5119,1837,14842.5119,1827,14855.5119,1071,14855.5119,1061,14842.5119,1071,14830.5119" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="752.1937" x="1073" y="14848.409">Assert shared_state_active_sar_fingerprint_signed_by_boomlet_i.content == shared_state_active_sar_fingerprint [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="14908.88" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,14905.63,2349.846,14909.63,2339.846,14913.63,2343.846,14909.63" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="14909.63" y2="14909.63"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="14894.968">[70]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6862" x="1483.8653" y="14886.115">SetupBoomletNisoMessage10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380.4583" x="1487.2453" y="14903.821">magic: "setup_sar_acknowledgement_of_finalization_received"</text></g><polygon fill="#FFF0F5" points="2012,14922.63,2691,14922.63,2701,14943.63,2691,14965.63,2012,14965.63,2002,14943.63,2012,14922.63" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="671.9183" x="2014" y="14940.527">Niso receives {magic: "setup_sar_acknowledgement_of_finalization_received"} from Boomlet and informs User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.5331" x="2017.38" y="14958.233">to initialize backup.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="400.6825,15008.4541,390.6825,15012.4541,400.6825,15016.4541,396.6825,15012.4541" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="15011.7041" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="2346.846" y1="15012.4541" y2="15012.4541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="14997.792">[71]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120.6791" x="434.1605" y="14988.939">SetupNisoOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0212" x="437.5405" y="15006.6451">magic: "setup_sar_finalization_confirmed"</text></g><polygon fill="#FFF0F5" points="48,15025.4541,730,15025.4541,740,15046.4541,730,15068.4541,48,15068.4541,38,15046.4541,48,15025.4541" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="674.8303" x="50" y="15043.3511">User receives {magic: "setup_sar_finalization_confirmed"} from Niso and proceeds to connect the hardware for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.6843" x="53.38" y="15061.0571">Boomletwo, which is going to be the backup of Boomlet, to Iso.</text><polygon fill="#E6E6FA" points="2206,15078.8661,2496,15078.8661,2506,15090.8661,2496,15103.8661,2206,15103.8661,2196,15090.8661,2206,15078.8661" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.6662" x="2208" y="15096.7631">Niso drops all information about</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.77" x="2410.0462" y="15096.7631">wt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.8431" x="2430.1962" y="15096.7631">payments.</text><path d="M9,15123.5721 L170.5581,15123.5721 L170.5581,15133.2781 L160.5581,15143.2781 L9,15143.2781 L9,15123.5721" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="4196.3168" style="stroke:#000000;stroke-width:1.5;" width="3586.3058" x="9" y="15123.5721"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116.5581" x="24" y="15138.4691">backup activation</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="389.1825" cy="15183.9402" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="986.3799,15180.6902,996.3799,15184.6902,986.3799,15188.6902,990.3799,15184.6902" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="992.3799" y1="15184.6902" y2="15184.6902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="15170.0281">[72]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100.2691" x="424.1605" y="15161.1751">SetupIsoInput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="499.5645" x="427.5405" y="15178.8812">magic: "setup_user_is_informed_that_sar_is_set_and_can_install_boomlet_backup"</text></g><polygon fill="#FFF0F5" points="600,15197.6902,1394,15197.6902,1404,15218.6902,1394,15240.6902,600,15240.6902,590,15218.6902,600,15197.6902" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="787.4494" x="602" y="15215.5872">Iso is turned on in backup mode indicated by {magic: "setup_user_is_informed_that_sar_is_set_and_can_install_boomlet_backup"}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="429.8452" x="605.38" y="15233.2932">from User and proceeds to install Boomletwo_binary on the hardware.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomletwo"><ellipse cx="997.8799" cy="15286.7642" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1566.2859,15283.5142,1576.2859,15287.5142,1566.2859,15291.5142,1570.2859,15287.5142" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1572.2859" y1="15287.5142" y2="15287.5142"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="15272.8522">[73]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.3201" x="1032.8579" y="15263.9992">SetupIsoBoomletwo1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.4352" x="1036.2379" y="15281.7052">magic: "setup_backup_started"</text></g><polygon fill="#FFF0F5" points="1273,15300.5142,1882,15300.5142,1892,15330.5142,1882,15361.5142,1273,15361.5142,1263,15330.5142,1273,15300.5142" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="569.8813" x="1275" y="15318.4112">Boomletwo gets installed indicated by {magic: "setup_backup_started"} from Iso. It generates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="598.9494" x="1278.38" y="15336.1173">boomletwo_Identity_privkey, derives boomletwo_Identity_pubkey from it and responds to Iso with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.4362" x="1278.38" y="15353.8233">boomletwo_Identity_pubkey.</text><polygon fill="#E6E6FA" points="1344,15371.6323,1810,15371.6323,1820,15392.6323,1810,15414.6323,1344,15414.6323,1334,15392.6323,1344,15371.6323" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.1083" x="1346" y="15389.5293">boomletwo_Identity_privkey := generate_privkey()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="459.3684" x="1349.38" y="15407.2353">boomletwo_Identity_pubkey := derive_pubkey(boomletwo_Identity_privkey)</text><g class="message" data-participant-1="Boomletwo" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,15457.4563,999.3799,15461.4563,1009.3799,15465.4563,1005.3799,15461.4563" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1577.7859" cy="15460.7063" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1573.2859" y1="15461.4563" y2="15461.4563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="15446.7943">[74]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.3201" x="1042.8579" y="15437.9413">SetupBoomletwoIso1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.9521" x="1046.2379" y="15455.6473">boomletwo_Identity_pubkey</text></g><polygon fill="#FFF0F5" points="666,15474.4563,1329,15474.4563,1339,15486.4563,1329,15499.4563,666,15499.4563,656,15486.4563,666,15474.4563" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="659.5684" x="668" y="15492.3534">Iso receives boomletwo_Identity_pubkey from Boomletwo and proceeds to inform User to connect Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="400.6825,15542.5744,390.6825,15546.5744,400.6825,15550.5744,396.6825,15546.5744" style="stroke:#181818;stroke-width:1;"/><ellipse cx="997.8799" cy="15545.8244" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="993.3799" y1="15546.5744" y2="15546.5744"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="15531.9124">[75]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2021" x="434.1605" y="15523.0594">SetupIsoOutput2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.5804" x="437.5405" y="15540.7654">magic: "setup_boomletwo_identity_pubkey_received_connect_boomlet_to_iso"</text></g><polygon fill="#FFF0F5" points="59,15559.5744,719,15559.5744,729,15589.5744,719,15620.5744,59,15620.5744,49,15589.5744,59,15559.5744" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="653.2634" x="61" y="15577.4714">User receives {magic: "setup_boomletwo_identity_pubkey_received_connect_boomlet_to_iso"} from Iso and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="637.2473" x="64.38" y="15595.1774">proceeds to connect Boomlet to Iso and Input the values necessary for backup and for verification of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.3612" x="64.38" y="15612.8834">received doxing_data_fingerprint.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="389.1825" cy="15754.8846" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="986.3799,15751.6346,996.3799,15755.6346,986.3799,15759.6346,990.3799,15755.6346" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="992.3799" y1="15755.6346" y2="15755.6346"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="15696.7075">[76]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100.2691" x="424.1605" y="15643.5894">SetupIsoInput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6171" x="427.5405" y="15661.2955">milestone_block_collection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.453" x="427.5405" y="15679.0015">network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.1691" x="427.5405" y="15696.7075">mnemonic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.9921" x="427.5405" y="15714.4135">passphrase</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.4381" x="427.5405" y="15732.1195">static_doxing_data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0811" x="427.5405" y="15749.8255">doxing_password</text></g><polygon fill="#FFF0F5" points="627,15768.6346,1369,15768.6346,1379,15798.6346,1369,15829.6346,627,15829.6346,617,15798.6346,627,15768.6346" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="687.9993" x="629" y="15786.5316">Iso receives {milestone_block_collection, network, mnemonic, passphrase, static_doxing_data, doxing_password}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="586.4174" x="632.38" y="15804.2376">from User. It then generates backup_request which is composed of {"boomlet_backup_request",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="734.7083" x="632.38" y="15821.9436">boomletwo_Identity_pubkey, normal_pubkey_0}, signs it using normal_privkey_0 and sends the signed value to Boomlet.</text><polygon fill="#E6E6FA" points="802,15839.7526,1194,15839.7526,1204,15922.7526,1194,16006.7526,802,16006.7526,792,15922.7526,802,15839.7526" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.2402" x="804" y="15857.6496">backup_request := BoomletBackupRequest{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.2772" x="807.38" y="15875.3556">magic: "boomlet_backup_request",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.5303" x="807.38" y="15893.0616">backup_boomlet_pubkey: boomletwo_Identity_pubkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.8832" x="807.38" y="15910.7677">backup_normal_pubkey: normal_pubkey_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="804" y="15928.4737">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381.6544" x="807.38" y="15946.1797">backup_request_signed_by_normal_0 := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366.3923" x="807.38" y="15963.8857">signature: schnorr_sign(normal_privkey_0, backup_request),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.0081" x="807.38" y="15981.5917">content: backup_request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="807.38" y="15999.2977">}</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="997.8799" cy="16052.7688" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1437.3872,16049.5188,1447.3872,16053.5188,1437.3872,16057.5188,1441.3872,16053.5188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1443.3872" y1="16053.5188" y2="16053.5188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="16038.8568">[77]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1032.8579" y="16030.0038">SetupIsoBoomletMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.4092" x="1036.2379" y="16047.7098">backup_request_signed_by_normal_0</text></g><polygon fill="#FFF0F5" points="1103,16066.5188,1794,16066.5188,1804,16114.5188,1794,16162.5188,1103,16162.5188,1093,16114.5188,1103,16066.5188" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="668.7723" x="1105" y="16084.4158">Boomlet receives backup_request_signed_by_normal_0 from Iso, checks normal_pubkey_0's signature, checks</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="673.3484" x="1108.38" y="16102.1218">backup_request.magic to match "boomlet_backup_request" and backup_request.backup_normal_key to match</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="663.6374" x="1108.38" y="16119.8278">normal_pubkey_0. Boomlet then encrypts it's own data except mystery with boomletwo_Identity_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="681.2135" x="1108.38" y="16137.5338">sends this boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo, along with boomlet_0_identity_pubkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.4852" x="1108.38" y="16155.2399">boomerang_params and sar_setup_response to Iso.</text><polygon fill="#FFC0CB" points="1099,16173.0489,1798,16173.0489,1808,16185.0489,1798,16198.0489,1099,16198.0489,1089,16185.0489,1099,16173.0489" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="695.2146" x="1101" y="16190.9459">Assert schnorr_verify(pubkey: normal_pubkey_0, content: backup_request_signed_by_normal_0.signature) == True</text><polygon fill="#E6E6FA" points="1251,16208.7549,1647,16208.7549,1657,16220.7549,1647,16233.7549,1251,16233.7549,1241,16220.7549,1251,16208.7549" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392.7173" x="1253" y="16226.6519">backup_request := backup_request_signed_by_normal_0.content</text><polygon fill="#FFC0CB" points="1264,16244.4609,1633,16244.4609,1643,16256.4609,1633,16269.4609,1264,16269.4609,1254,16256.4609,1264,16244.4609" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.8333" x="1266" y="16262.3579">Assert backup_request.magic == "boomlet_backup_request"</text><polygon fill="#FFC0CB" points="1238,16280.1669,1658,16280.1669,1668,16292.1669,1658,16305.1669,1238,16305.1669,1228,16292.1669,1238,16280.1669" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416.9234" x="1240" y="16298.0639">Assert backup_request.backup_normal_pubkey == normal_pubkey_0</text><polygon fill="#E6E6FA" points="898,16315.8729,2000,16315.8729,2010,16327.8729,2000,16340.8729,898,16340.8729,888,16327.8729,898,16315.8729" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1098.1759" x="900" y="16333.7699">boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo := AES_encrypt(private_key: ECDH(boomlet_0_identity_privkey, boomletwo_identity_pubkey, content: boomlet.memory)</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,16437.109,999.3799,16441.109,1009.3799,16445.109,1005.3799,16441.109" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1448.8872" cy="16440.359" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1444.3872" y1="16441.109" y2="16441.109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="16399.888">[78]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1042.8579" y="16364.476">SetupBoomletIsoMessage5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1046.2379" y="16382.182">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.3583" x="1046.2379" y="16399.888">boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.0071" x="1046.2379" y="16417.594">boomerang_params</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.0951" x="1046.2379" y="16435.3">sar_setup_response</text></g><polygon fill="#FFF0F5" points="663,16454.109,1332,16454.109,1342,16528.109,1332,16603.109,663,16603.109,653,16528.109,663,16454.109" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="628.7196" x="665" y="16472.006">Iso receives {boomlet_0_identity_pubkey, boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="638.8463" x="668.38" y="16489.7121">boomerang_params, sar_setup_response} from Boomlet. Iso reconstructs the descriptor using {network,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="614.4843" x="668.38" y="16507.4181">boomerang_params.peer_ids, milestone_block_collection} and checks to see if it's same as the one in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="632.7623" x="668.38" y="16525.1241">boomerang_params received.  It then regenerates doxing_key using the inputted doxing_password and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="581.1133" x="668.38" y="16542.8301">doxing_data_identifier using doxing_key. Iso then doxing_data_identifier in sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="637.3513" x="668.38" y="16560.5361">matches the one generated. Then Iso encrypts the static_doxing_data using the iv in sar_setup_response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="658.6194" x="668.38" y="16578.2421">and doxing_key then checks to see if it matches fingerprint_of_static_doxing_data_encrypted_by_doxing_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.3471" x="668.38" y="16595.9482">in sar_setup_response.</text><polygon fill="#E6E6FA" points="609,16613.7572,1387,16613.7572,1397,16625.7572,1387,16638.7572,609,16638.7572,599,16625.7572,609,16613.7572" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="774.5405" x="611" y="16631.6542">boomerang_descriptor := construct_boomerang_descriptor(network, boomerang_params.peer_ids, milestone_block_collection)</text><polygon fill="#FFC0CB" points="760,16649.4632,1234,16649.4632,1244,16661.4632,1234,16674.4632,760,16674.4632,750,16661.4632,760,16649.4632" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="470.8863" x="762" y="16667.3602">Assert boomerang_descriptor == boomerang_params.boomerang_descriptor</text><polygon fill="#E6E6FA" points="857,16685.1692,1138,16685.1692,1148,16706.1692,1138,16728.1692,857,16728.1692,847,16706.1692,857,16685.1692" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.2192" x="859" y="16703.0662">doxing_key := sha256(doxing_password)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.3652" x="862.38" y="16720.7722">doxing_data_identifier := sha256(doxing_key)</text><polygon fill="#FFC0CB" points="766,16738.5812,1230,16738.5812,1240,16750.5812,1230,16763.5812,766,16763.5812,756,16750.5812,766,16738.5812" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460.2003" x="768" y="16756.4782">Assert sar_setup_response.doxing_data_identifier == doxing_data_identifier</text><polygon fill="#FFC0CB" points="326,16774.2872,1669,16774.2872,1679,16786.2872,1669,16799.2872,326,16799.2872,316,16786.2872,326,16774.2872" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1339.9756" x="328" y="16792.1843">Assert sar_setup_response.fingerprint_of_static_doxing_data_encrypted_by_doxing_key == sha256(AES_encrypt(private_key: doxing_key, content: static_doxing_data, iv: iv_of_static_doxing_data_encrypted_by_doxing_key))</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="400.6825,16842.4053,390.6825,16846.4053,400.6825,16850.4053,396.6825,16846.4053" style="stroke:#181818;stroke-width:1;"/><ellipse cx="997.8799" cy="16845.6553" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="993.3799" y1="16846.4053" y2="16846.4053"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="16831.7433">[79]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2021" x="434.1605" y="16822.8903">SetupIsoOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457.3404" x="437.5405" y="16840.5963">magic: "setup_boomlet_backup_data_received_connect_boomletwo_to_iso"</text></g><polygon fill="#FFF0F5" points="48,16859.4053,729,16859.4053,739,16880.4053,729,16902.4053,48,16902.4053,38,16880.4053,48,16859.4053" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="674.0894" x="50" y="16877.3023">User receives {magic: "setup_boomlet_backup_data_received_connect_boomletwo_to_iso"} from Iso. User then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.5892" x="53.38" y="16895.0083">proceeds to connect Boomletwo to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="389.1825" cy="16948.4794" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="986.3799,16945.2294,996.3799,16949.2294,986.3799,16953.2294,990.3799,16949.2294" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="992.3799" y1="16949.2294" y2="16949.2294"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="16934.5674">[80]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100.2691" x="424.1605" y="16925.7143">SetupIsoInput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="553.8394" x="427.5405" y="16943.4204">magic: "setup_user_is_asked_to_connect_boomletwo_to_iso_boomletwo_connected_to_iso"</text></g><polygon fill="#FFF0F5" points="642,16962.2294,1353,16962.2294,1363,16983.2294,1353,17005.2294,642,17005.2294,632,16983.2294,642,16962.2294" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="703.8204" x="644" y="16980.1264">Iso receives {magic: "setup_user_is_asked_to_connect_boomletwo_to_iso_boomletwo_connected_to_iso"} from User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313.4693" x="647.38" y="16997.8324">and proceeds to give the backup file to Boomletwo.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomletwo"><ellipse cx="997.8799" cy="17069.0094" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1566.2859,17065.7594,1576.2859,17069.7594,1566.2859,17073.7594,1570.2859,17069.7594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1572.2859" y1="17069.7594" y2="17069.7594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="17046.2444">[81]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.3201" x="1032.8579" y="17028.5384">SetupIsoBoomletwo2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.0242" x="1036.2379" y="17046.2444">boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.3583" x="1036.2379" y="17063.9504">boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo</text></g><polygon fill="#FFF0F5" points="1160,17082.7594,1995,17082.7594,2005,17130.7594,1995,17178.7594,1160,17178.7594,1150,17130.7594,1160,17082.7594" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="681.4736" x="1162" y="17100.6565">Boomletwo receives {boomlet_0_identity_pubkey, boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="709.9045" x="1165.38" y="17118.3625">from Iso. It decrypts boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo using boomletwo_identity_privkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="650.4553" x="1165.38" y="17136.0685">diffie-hellman with boomlet_0_identity_pubkey and imports the data into it's memory. It generates it's own</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="824.4734" x="1165.38" y="17153.7745">mystery and generates backup_done composed of {"boomlet_backup_done", boomletwo_Identity_pubkey, boomlet_0_identity_pubkey}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616.9153" x="1165.38" y="17171.4805">and signs it using boomletwo_Identity_privkey and sends backup_done_signed_by_boomletwo to Iso.</text><polygon fill="#E6E6FA" points="1014,17189.2895,2142,17189.2895,2152,17201.2895,2142,17214.2895,1014,17214.2895,1004,17201.2895,1014,17189.2895" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1124.0715" x="1016" y="17207.1865">boomletwo.memory += AES_decrypt(private_key: ECDH(boomlet_0_identity_pubkey, boomletwo_identity_privkey), content: boomlet_0_backup_encrypted_by_boomlet_0_for_boomletwo)</text><polygon fill="#E6E6FA" points="1242,17224.9955,1912,17224.9955,1922,17236.9955,1912,17249.9955,1242,17249.9955,1232,17236.9955,1242,17224.9955" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="666.9266" x="1244" y="17242.8926">mystery := Rand(MIN_TRIES_FOR_DIGGING_GAME_IN_BLOCKS, MAX_TRIES_FOR_DIGGING_GAME_IN_BLOCKS)</text><polygon fill="#E6E6FA" points="1365,17260.7016,1790,17260.7016,1800,17343.7016,1790,17427.7016,1365,17427.7016,1355,17343.7016,1365,17260.7016" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.7922" x="1367" y="17278.5986">backup_done := BackupDone{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.5212" x="1370.38" y="17296.3046">magic: "boomlet_backup_done",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335.5303" x="1370.38" y="17314.0106">backup_boomlet_pubkey: boomletwo_Identity_pubkey,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.8473" x="1370.38" y="17331.7166">boomlet_pubkey: boomlet_0_identity_pubkey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1367" y="17349.4226">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.9624" x="1370.38" y="17367.1287">backup_done_signed_by_boomletwo := SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="414.5574" x="1370.38" y="17384.8347">signature: schnorr_sign(boomletwo_identity_privkey, backup_done),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.2521" x="1370.38" y="17402.5407">content: backup_done</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1370.38" y="17420.2467">}</text><g class="message" data-participant-1="Boomletwo" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,17470.4677,999.3799,17474.4677,1009.3799,17478.4677,1005.3799,17474.4677" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1577.7859" cy="17473.7177" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1573.2859" y1="17474.4677" y2="17474.4677"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="17459.8057">[82]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.3201" x="1042.8579" y="17450.9527">SetupBoomletwoIso2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.7172" x="1046.2379" y="17468.6587">backup_done_signed_by_boomletwo</text></g><polygon fill="#FFF0F5" points="636,17487.4677,1358,17487.4677,1368,17499.4677,1358,17512.4677,636,17512.4677,626,17499.4677,636,17487.4677" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="718.8743" x="638" y="17505.3648">Iso receives {backup_done_signed_by_boomletwo} from Boomletwo. Iso proceeds to inform User to connect Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="400.6825,17555.5858,390.6825,17559.5858,400.6825,17563.5858,396.6825,17559.5858" style="stroke:#181818;stroke-width:1;"/><ellipse cx="997.8799" cy="17558.8358" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="993.3799" y1="17559.5858" y2="17559.5858"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="17544.9238">[83]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2021" x="434.1605" y="17536.0708">SetupIsoOutput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="385.8794" x="437.5405" y="17553.7768">magic: "setup_boomlet_backup_done_connect_boomlet_to_iso"</text></g><polygon fill="#FFF0F5" points="29,17572.5858,750,17572.5858,760,17584.5858,750,17597.5858,29,17597.5858,19,17584.5858,29,17572.5858" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="717.0023" x="31" y="17590.4828">User receives {magic: "setup_boomlet_backup_done_connect_boomlet_to_iso"} from Iso and connects Boomlet to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Iso"><ellipse cx="389.1825" cy="17643.9538" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="986.3799,17640.7038,996.3799,17644.7038,986.3799,17648.7038,990.3799,17644.7038" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="992.3799" y1="17644.7038" y2="17644.7038"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="17630.0418">[84]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100.2691" x="424.1605" y="17621.1888">SetupIsoInput5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="517.6735" x="427.5405" y="17638.8948">magic: "setup_user_is_asked_to_connect_boomlet_to_iso_boomlet_connected_to_iso"</text></g><polygon fill="#FFF0F5" points="660,17657.7038,1335,17657.7038,1345,17678.7038,1335,17700.7038,660,17700.7038,650,17678.7038,660,17657.7038" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="667.6544" x="662" y="17675.6009">Iso receives {magic: "setup_user_is_asked_to_connect_boomlet_to_iso_boomlet_connected_to_iso"} from User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="452.5694" x="665.38" y="17693.3069">and proceeds to forward backup_done_signed_by_boomletwo to Boomlet.</text><g class="message" data-participant-1="Iso" data-participant-2="Boomlet"><ellipse cx="997.8799" cy="17746.7779" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="1437.3872,17743.5279,1447.3872,17747.5279,1437.3872,17751.5279,1441.3872,17747.5279" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1002.3799" x2="1443.3872" y1="17747.5279" y2="17747.5279"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1005.3799" y="17732.8659">[85]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1032.8579" y="17724.0129">SetupIsoBoomletMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.7172" x="1036.2379" y="17741.7189">backup_done_signed_by_boomletwo</text></g><polygon fill="#FFF0F5" points="1119,17760.5279,1778,17760.5279,1788,17790.5279,1778,17821.5279,1119,17821.5279,1109,17790.5279,1119,17760.5279" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="644.8003" x="1121" y="17778.4249">Boomlet receives {backup_done_signed_by_boomletwo} from Iso. It verifies boomletwo_identity_pubkey's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="648.5834" x="1124.38" y="17796.1309">pubkey on backup_done_signed_by_boomletwo. Boomlet then checks magic,backup_boomlet_pubkey and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.1703" x="1124.38" y="17813.837">boomlet_pubkey of backup_done to match expected values.</text><polygon fill="#FFC0CB" points="1069,17831.646,1828,17831.646,1838,17843.646,1828,17856.646,1069,17856.646,1059,17843.646,1069,17831.646" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="755.4434" x="1071" y="17849.543">Assert schnorr_verify(pubkey: boomletwo_identity_pubkey, content: backup_done_signed_by_boomletwo.signature) == True</text><polygon fill="#E6E6FA" points="1260,17867.352,1637,17867.352,1647,17879.352,1637,17892.352,1260,17892.352,1250,17879.352,1260,17867.352" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="373.2693" x="1262" y="17885.249">backup_done := backup_done_signed_by_boomletwo.content</text><polygon fill="#FFC0CB" points="1280,17903.058,1618,17903.058,1628,17915.058,1618,17928.058,1280,17928.058,1270,17915.058,1280,17903.058" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.3212" x="1282" y="17920.955">Assert backup_done.magic == "boomlet_backup_done"</text><polygon fill="#FFC0CB" points="1210,17938.764,1687,17938.764,1697,17950.764,1687,17963.764,1210,17963.764,1200,17950.764,1210,17938.764" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="473.3304" x="1212" y="17956.661">Assert backup_done.backup_boomlet_pubkey == boomletwo_Identity_pubkey</text><polygon fill="#FFC0CB" points="1238,17974.47,1659,17974.47,1669,17986.47,1659,17999.47,1238,17999.47,1228,17986.47,1238,17974.47" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="417.1314" x="1240" y="17992.367">Assert backup_done.boomlet_pubkey == boomlet_0_identity_pubkey</text><g class="message" data-participant-1="Boomlet" data-participant-2="Iso"><polygon fill="#181818" points="1009.3799,18042.5881,999.3799,18046.5881,1009.3799,18050.5881,1005.3799,18046.5881" style="stroke:#181818;stroke-width:1;"/><ellipse cx="1448.8872" cy="18045.8381" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1003.3799" x2="1444.3872" y1="18046.5881" y2="18046.5881"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1015.3799" y="18031.9261">[86]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.7731" x="1042.8579" y="18023.0731">SetupBoomletIsoMessage6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.0902" x="1046.2379" y="18040.7791">magic: "setup_boomlet_backup_done"</text></g><polygon fill="#FFF0F5" points="676,18059.5881,1320,18059.5881,1330,18080.5881,1320,18102.5881,676,18102.5881,666,18080.5881,676,18059.5881" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="636.7013" x="678" y="18077.4851">Iso receives {magic: "setup_boomlet_backup_done"} from Boomlet and proceeds to inform User that the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.9662" x="681.38" y="18095.1911">backup process has been completed.</text><g class="message" data-participant-1="Iso" data-participant-2="User"><polygon fill="#181818" points="400.6825,18145.4121,390.6825,18149.4121,400.6825,18153.4121,396.6825,18149.4121" style="stroke:#181818;stroke-width:1;"/><ellipse cx="997.8799" cy="18148.6621" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="993.3799" y1="18149.4121" y2="18149.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="18134.7501">[87]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2021" x="434.1605" y="18125.8971">SetupIsoOutput5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="506.6624" x="437.5405" y="18143.6031">magic: "setup_boomlet_backup_completed_boomlet_closed_ready_to_finish_setup"</text></g><polygon fill="#FFF0F5" points="55,18162.4121,722,18162.4121,732,18183.4121,722,18205.4121,55,18205.4121,45,18183.4121,55,18162.4121" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="660.1274" x="57" y="18180.3092">User receives {magic: "setup_boomlet_backup_completed_boomlet_closed_ready_to_finish_setup"} from Iso.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.3172" x="60.38" y="18198.0152">User proceeds to connect Boomlet to Iso.</text><g class="message" data-participant-1="User" data-participant-2="Niso"><ellipse cx="389.1825" cy="18251.4862" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,18248.2362,2349.846,18252.2362,2339.846,18256.2362,2343.846,18252.2362" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="393.6825" x2="2345.846" y1="18252.2362" y2="18252.2362"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="396.6825" y="18237.5742">[88]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.7461" x="424.1605" y="18228.7212">SetupNisoInput4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.8793" x="427.5405" y="18246.4272">magic: "setup_user_is_informed_that_boomlet_is_closed"</text></g><polygon fill="#FFF0F5" points="1915,18265.2362,2788,18265.2362,2798,18277.2362,2788,18290.2362,1915,18290.2362,1905,18277.2362,1915,18265.2362" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="869.5573" x="1917" y="18283.1332">Niso receives {magic: "setup_user_is_informed_that_boomlet_is_closed"} from User and proceeds to tell Boomlet to finish the setup procedure.</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,18333.3543,1450.3872,18337.3543,1460.3872,18341.3543,1456.3872,18337.3543" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="18336.6043" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="18337.3543" y2="18337.3543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="18322.6922">[89]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6862" x="1493.8653" y="18313.8392">SetupNisoBoomletMessage11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269.9063" x="1497.2453" y="18331.5453">magic: "setup_boomlet_closed_finish_setup"</text></g><polygon fill="#FFF0F5" points="1062,18350.3543,1835,18350.3543,1845,18389.3543,1835,18428.3543,1062,18428.3543,1052,18389.3543,1062,18350.3543" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="672.8022" x="1064" y="18368.2513">Boomlet receives {magic: "setup_boomlet_closed_finish_setup"} from Niso and proceeds to generate and hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="678.7175" x="1067.38" y="18385.9573">shared_state_active_backup composed of {magic: "boomlet_backup_done_and_setup_finish_initialized"}. It then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="762.8794" x="1067.38" y="18403.6633">signs the digest shared_state_active_backup_fingerprint to get shared_state_active_backup_fingerprint_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.3302" x="1067.38" y="18421.3693">and sends this value to Niso.</text><path d="M940,18441.1783 L1743.0822,18441.1783 L1743.0822,18450.8843 L1733.0822,18460.8843 L940,18460.8843 L940,18441.1783" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="701.4745" style="stroke:#000000;stroke-width:1.5;" width="2645.3058" x="940" y="18441.1783"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="758.0822" x="955" y="18456.0753">&lt;Boomlet Shared State in Sync regarding the BoomletBackup created being activated and all peers in the know of it&gt;</text><polygon fill="#E6E6FA" points="1159,18465.8843,1739,18465.8843,1749,18539.8843,1739,18614.8843,1159,18614.8843,1149,18539.8843,1159,18465.8843" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344.4222" x="1161" y="18483.7814">shared_state_active_backup := SharedStateBackupDone{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.4304" x="1164.38" y="18501.4874">magic: "boomlet_backup_done_and_setup_finish_initialized"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1161" y="18519.1934">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.7534" x="1164.38" y="18536.8994">shared_state_active_backup_fingerprint := sha256(shared_state_active_backup)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="529.6984" x="1164.38" y="18554.6054">shared_state_active_backup_fingerprint_signed_by_boomlet_0 = SignatureOnMessage{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="569.7775" x="1164.38" y="18572.3114">signature: schnorr_sign(boomlet_0_identity_privkey, shared_state_active_backup_fingerprint),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.3472" x="1164.38" y="18590.0175">content: shared_state_active_backup_fingerprint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.94" x="1164.38" y="18607.7235">}</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="18661.1945" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,18657.9445,2349.846,18661.9445,2339.846,18665.9445,2343.846,18661.9445" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="18661.9445" y2="18661.9445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="18647.2825">[90]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6862" x="1483.8653" y="18638.4295">SetupBoomletNisoMessage11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.9373" x="1487.2453" y="18656.1355">shared_state_active_backup_fingerprint_signed_by_boomlet_0</text></g><polygon fill="#FFF0F5" points="1963,18674.9445,2740,18674.9445,2750,18686.9445,2740,18699.9445,1963,18699.9445,1953,18686.9445,1963,18674.9445" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="773.2534" x="1965" y="18692.8415">Niso receives shared_state_active_backup_fingerprint_signed_by_boomlet_0 from Boomlet and proceeds to share it with Peers.</text><g class="message" data-participant-1="Niso" data-participant-2="Peers"><polygon fill="#181818" points="2362.846,18743.0626,2352.846,18747.0626,2362.846,18751.0626,2358.846,18747.0626" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="3541.9308,18743.0626,3551.9308,18747.0626,3541.9308,18751.0626,3545.9308,18747.0626" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2356.846" x2="3547.9308" y1="18747.0626" y2="18747.0626"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="2368.846" y="18732.4005">[91]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.8382" x="2396.324" y="18723.5475">SetupNisoPeerNisoMessage4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="448.2794" x="2399.704" y="18741.2536">shared_state_active_backup_fingerprint_signed_by_boomlet_i [0 &lt;= i &lt;= 4]</text></g><polygon fill="#FFF0F5" points="1898,18760.0626,2805,18760.0626,2815,18808.0626,2805,18856.0626,1898,18856.0626,1888,18808.0626,1898,18760.0626" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585.4424" x="1900" y="18777.9596">Niso receives shared_state_active_backup_fingerprint_signed_by_boomlet_i from peers, sending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="563.5894" x="1903.38" y="18795.6656">shared_state_active_backup_fingerprint_signed_by_boomlet_i at the same time.  It  It verifies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="633.4384" x="1903.38" y="18813.3716">boomlet_i_identity_pubkey's signature on each and the contents to match the one signed by boomlet_0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="896.3374" x="1903.38" y="18831.0776">then forms shared_state_active_backup_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_backup_fingerprint_signed_by_boomlet_i&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.4602" x="1903.38" y="18848.7836">and sends it to Boomlet.</text><polygon fill="#FFC0CB" points="1862,18866.5926,2840,18866.5926,2850,18878.5926,2840,18891.5926,1862,18891.5926,1852,18878.5926,1862,18866.5926" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="974.5327" x="1864" y="18884.4896">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_backup_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1854,18902.2987,2849,18902.2987,2859,18914.2987,2849,18927.2987,1854,18927.2987,1844,18914.2987,1854,18902.2987" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="991.1335" x="1856" y="18920.1957">Assert shared_state_active_backup_fingerprint_signed_by_boomlet_i.content == shared_state_active_backup_fingerprint_signed_by_boomlet_0.content [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Niso" data-participant-2="Boomlet"><polygon fill="#181818" points="1460.3872,18970.4167,1450.3872,18974.4167,1460.3872,18978.4167,1456.3872,18974.4167" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="18973.6667" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="1454.3872" x2="2346.846" y1="18974.4167" y2="18974.4167"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1466.3872" y="18959.7547">[92]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6862" x="1493.8653" y="18950.9017">SetupNisoBoomletMessage12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="825.3964" x="1497.2453" y="18968.6077">shared_state_active_backup_fingerprint_signed_by_all_peers: Collection&lt;shared_state_active_backup_fingerprint_signed_by_boomlet_i&gt;</text></g><polygon fill="#FFF0F5" points="977,18987.4167,1921,18987.4167,1931,19026.4167,1921,19065.4167,977,19065.4167,967,19026.4167,977,18987.4167" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="674.7783" x="979" y="19005.3137">Boomlet receives shared_state_active_backup_fingerprint_signed_by_all_peers from Niso. It checks the content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="933.6993" x="982.38" y="19023.0197">of each peer's shared_state_active_backup_fingerprint_signed_by_boomlet_i to be equal to shared_state_active_backup_fingerprint_signed_by_boomlet_0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="657.1374" x="982.38" y="19040.7257">and verifies each of the corresponding signatures by peer_i.boomlet_i_identity_pubkey. It then informs Niso</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.3512" x="982.38" y="19058.4318">that the setup procedure is finished.</text><polygon fill="#FFC0CB" points="960,19076.2408,1938,19076.2408,1948,19088.2408,1938,19101.2408,960,19101.2408,950,19088.2408,960,19076.2408" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="974.5327" x="962" y="19094.1378">Assert schnorr_verify(pubkey: boomlet_i_identity_pubkey, content: shared_state_active_backup_fingerprint_signed_by_boomlet_i.signature) == True [1 &lt;= i &lt;= 4].</text><polygon fill="#FFC0CB" points="1045,19111.9468,1852,19111.9468,1862,19123.9468,1852,19136.9468,1045,19136.9468,1035,19123.9468,1045,19111.9468" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="803.4136" x="1047" y="19129.8438">Assert shared_state_active_backup_fingerprint_signed_by_boomlet_i.content == shared_state_active_backup_fingerprint [1 &lt;= i &lt;= 4]</text><g class="message" data-participant-1="Boomlet" data-participant-2="Niso"><ellipse cx="1448.8872" cy="19190.3148" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><polygon fill="#181818" points="2339.846,19187.0648,2349.846,19191.0648,2339.846,19195.0648,2343.846,19191.0648" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1453.3872" x2="2345.846" y1="19191.0648" y2="19191.0648"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="1456.3872" y="19176.4028">[93]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6862" x="1483.8653" y="19167.5498">SetupBoomletNisoMessage12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.7881" x="1487.2453" y="19185.2558">magic: "setup_done"</text></g><polygon fill="#FFF0F5" points="2039,19204.0648,2664,19204.0648,2674,19216.0648,2664,19229.0648,2039,19229.0648,2029,19216.0648,2039,19204.0648" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="621.0753" x="2041" y="19221.9618">Niso receives {magic: "setup_done"} from Boomlet and proceeds to inform User that setup is finished.</text><g class="message" data-participant-1="Niso" data-participant-2="User"><polygon fill="#181818" points="400.6825,19272.1829,390.6825,19276.1829,400.6825,19280.1829,396.6825,19276.1829" style="stroke:#181818;stroke-width:1;"/><ellipse cx="2351.346" cy="19275.4329" fill="#000000" rx="4" ry="4" style="stroke:#181818;stroke-width:1.5;"/><line style="stroke:#181818;stroke-width:1;" x1="394.6825" x2="2346.846" y1="19276.1829" y2="19276.1829"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23.478" x="406.6825" y="19261.5209">[94]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120.6791" x="434.1605" y="19252.6679">SetupNisoOutput3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.7881" x="437.5405" y="19270.3739">magic: "setup_done"</text></g><polygon fill="#FFF0F5" points="243,19289.1829,535,19289.1829,545,19301.1829,535,19314.1829,243,19314.1829,233,19301.1829,243,19289.1829" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.0802" x="245" y="19307.0799">User receives {magic: "setup_done"} from Niso.</text><!--SRC=[xJrhSzj8Sj_rAr3o1uiEp9EejyvsbVTvgjm-obBYfEmj5aH28c8Iu06WP4Mb_vxkdZSm06P0olPUBfNQiq1WfgUdtztJKtnAqcMKHukWYF-nYjD9_4jS5D5D_7QUtAJ1FBukjygadCV1HLokbl1VzbRmGnBTu6SxxvDobgtAuAACohWOR5rbduFj_oZYFBX8fl5sy0n6ciJVpLVnLZGfipoWtx9y2l_T2vxzFRcPbT_VH-aMW54casGPfMLmNcJybH5_XGRGN_akonRpkEIlxVFNVa_IJyPh5vVyZOFWsNyc6NnX6-KkKs_HE3_dqRtnug-91EbGlXF79jY_px8qvcyT1S- -ZwOn0pnEfm4WndZvlO3iz2HuzYwUcc2_VLU8dq-3P_yTp-VP7KVWxt6SYn_tTdUtjg9LcQMhnHNylVtgwis7tTq_jhVIh0HGRcE6yBCWUF42__7YHV0n3LubRnR9F2xWktXyDSycdyQJR3wF9sMIfMV1z_BVhogllU5VtvNZP5eqVKI_lWa-d4_Z5AZdFiYkWsW-3u1audWQh9PPYikVHEaqcIBPXC5raXTba1H1EGEm0OliGLIMyM9PmaTb5i3oarju_GyEH17bRL2mdorWB7CQPduFH8ylm-Y8Rp5iYlIGV-9_mQTvjhmVNzq3dFpPCYgAvIoFYbX00iIVJCRJx7EItenXIH7_WJ_13s3CAN-QBoVZoJo1eSUhV5v_21iws_fBeBRm_ILjuFjBkNs0Obp6f_XUtv6pu87z5S3_mHCWbt4qdUR0qw7nmt9rnJvzvDIG5UKOLps-Iif9bgISAcOnKhe12wAAe85_I70GroOy3Fi6GFZ83X5zBa32Xm2MCIbn5irA_vBpJk_JQ65YlaBv8G6y1Npn-zjtRt_vyVB7TnV1rhFWsJI-Je3EVddxN-FBT-S_Nen_-ktT-8Vpdty-__NdyS_mvlZyr_5tV__j-tyttuUdNUyJloCOMpTvXbBpxRkW07dwShNSsdeEeZ9UWkpROfBmvHkvEW2In2pzVPukL-KUhjD2H7NIfwSrCjoQLN08iYkw1V3Y70HJCOD9sUCydiJ9BL3uGsMsq39NQ9dfCRZEimMJxi3Ny1MEnb_0ZTsv-DlRqU5HC4rkGA8WBzQNDa0s1_sItozBonmqi6NBWvruU3CCW68Z16ym3CvB52I04LYgX09VXPMWCBXE04o4QDm44e1CqE3UmVyaQL8cqJpvtnZ6X2qQjc0MaAgj- -nrKCmYc6QdjbWrMnMqsaS8ZgITqHRND40xd1qDqhc8Sgx6zvhdq1T0wgP66RXqIHSDWDAcCsXmSu2lGRW3ok_0B0YY88tlGCpUn6cSHoXdaPQ0Gcx191XVnp7Wudw14Yz9hxDXCqHdGUkNY2vOymNx-QSu_ftzU0w_FH1ZQ1ycwMq6_pwpFGpnPJ7oD8wcymGPi_eaL2nunlyNHUbGRj3-5bFW5ju6EEcHla5jQ_Fdu5PCqNxXnk9kNMVvNPJ3RYKbqZZoheskqQY2QTuMy7lPleKS6QzVMwG6_r4YwK2ZOcwZ65JysweK4j0LGIHzQlYXfnxeeTd300P46Yy8LV0MiqqufGYQ1fve0v1cNPOm1lm_SiTgNWw3lyLCEYKeuelkZw-YoIVS809isBpW5ZQHOm6hmBETDYmeGNFeegD6BWZO71dBbPZwfaBBHEBpBBqfG5W9bO82gAPKGkrNcsx1mHk5Q8SQgCysbfE1HJasrSHRC2hupplSHiMVpZHj4WQJB2rXzZFBs4oXr9UmkJajWzEaX8Do5Wcb7H3cm9e7_Gjw5Hr6JNNBNrVBAMa5iXVmpGHveeHDZ-PaQpEC4g_Cec9c6XJygodo9GocxJPinZqRSC6aBB5V6gnIjAnnxoOqhxwFWkIFd7Mh4ztRpRB67Mcs23otzaD1ZWGoDCVd7vuA_w5hQQ77miA6POMUwtgqI-XkK6aRCX30YjjDBY-AR98mUGuIXCoNXfqmx1mXbN42b9tvWey0T7R_F4Tz4HJtwMJ8NxjBm055VahIbQ5413NZlpKGwwYnc4ccWYQit0iSx7JXPe3Q-Z9VnOtZVZ-BKVyWUpUWXFljHRGWLXC-_3AFRvDiLO09oCbgEWmafnqp8-bbjv54dBQ8RfB9MR1DvlUOhGh_DSNW160FA7sCc1xZtesN-Fbs3_UdppIFfbd5wA1WkedGbfJF2oOdx-3Nb_Wz8p7uHCF8YPD5r82DFBv92k1re1e44sWifTW6kDmMRBXOIWzz9dcikWJBF9l4CMCL6WYZUqDoaSaxvZxoT8Kn0OPiYP1JPN_0Hnewu2_b7si1crgqnWpLE7dIEfem45d34ZvKIEApX-RSeJPp63Zur1nlF6O1W4to64DZmIAD5raAMXEHkOWG- -FFgAh7k-mJPfK2CeR19MfAW9GWMwxoPLR4uppBIlCBeXzZeDiaed6M4H3buY-JgvEZvy7TB9dCaBSNVpaSxUsEPYZCfl4aMKJp47u5CX2J13lqoK180XQz8qfbMm6-DNTejw-oR05IBxtP7eIWrdCG8oWN4AkWfZAvy1IOA9hpkD1uD-IiL6Zkv3I1VIZdf3TfPPKrhwx6ky1VJHlgwgYheCtk5eMcWHvvvDYaIVvGz-qggp0Z3CsX74vLEkWYubsZH_63HfDLrEcQs1RFuTDn8iGr0Z-I9aj1oS_d55SP8c2Np76Pnak48IqrznuS5GR9U9ShX_9UHWKvCPN1geWBBSmJ8aLHl8Sq86OTa3mP1WkAv1XKeQR0VuqNA_Xa96OPmmRcJEmqlCSmGgyHbn5DaL8kiviOI3TdWhc6GR588kzVLXSmMX3Tt81094g45-V0euHWKDan0q3xNio5Pc-1jcSQI4OOJ-DYaeCopl9XyFOQ63CeLfC9uE1wDJUs0DGg6h8O4mSBTn61kfz4A5043S0qkcs2EqdhiUqCmJPi9J6WhfOz1OuHQ17FTiWVSDaatu-rdSDlcPJZZtUQWQmCMLbzhv4KCwkl3IXtN8YlGc4q-Z86cRnBGV82k096Q4KpVpsPuYkO5ZgVFbI0FBFGeJ7pMPtKDOHLq7NMWicFwQEIatjRWfHggfl_00zrCTauhfysRWQF19i0oXOmk5G-uDv8YlcBIrF2NvJUK5zSMZojorumc-7LeekTzPaf6k75n8KJlrW7rJJc_XQcO6jKS54bW6BjlIyQKTWGx-IOrVRzm4UzZrp0TbVQpU2ZlImp6ahPWXw8yZoYjEPX07fa2k-Ykt-3-U4hqEWnl4_8nSNldHvopSHDxGcwTUDY6V7e35V8X1t050241cLICFLu5JEzLHB6qNX6HIY6obAADu3rpanH1lYg6b2swHSBD41aFz1JyZmlyDa3_N96ozpvi3SSmdB-UlZ7u94CgjeGp3jBAV84e_4Tmrg5N_4P9YLLKAiE00d9LCut23wiJluQx8_-2BhdCqCNYhclKQYNhJ6t7x__uMyj2YYqqiWWR5kA1fZ6b8TIF6VTydcqvfBzk7WTt7h9-ADk6R_9bNTfWRNNJLBYXrZnC2puXbc4QumTOcGCZV88g6m57kuzsUuHsF8WTb04iCgJ0WrQid5Z6qE1mE2w2vqApATYJcI-d4KWfv99D4T6-yHSW5bs9qAw9DvuPefaqYnPuD-KqaFd1GGV0sE1SQUwD6fJXvrI0_cKEoUEV4eC6TeLhJEVjc_8mBwXf9ZRHXtooHK370lDN0arNPHQvgq-fcyKoG8hKygNAX76DhE0tMH4XZ5T4PAuk7nU1F-JtHT09v-6k8caZyZHaNe87TBFI88Q_I7PWbtBVYAO4lA95l4Yop6HJzIB8KjIe6fcyjCmVXlCO6MAs9ZNHfG97jbDHoRE1eLKR1Vqz1mVFi1F2VXwPy47UWcqccP8dwW8c26cm7vAAtkapzH3yXY0ojmQ8PpsI3ZWbjTrlW5N1pbyffGeZypKOy7j11lM319TihF43vDo54zivdFuSvfdomBcdQxIAPRNKHoz0NKzJ0S3TSfsQET7-kzZDn2cE03HWd90IeL-zeIdd6g0J3CeJhkj_D6wI-rbH_H3AXTGJax3o2ickBz9BBWx5-jZWyApcCCrBOoFAHaPxUEBe1PnWX0FZCDWYAlOcZn25HwYsoF4VH57EPWTA0deUoejahA4Ir4AKTSr3kN-u3CCLGk3fMQJeAC4eyUO7ai013MerRO86JwieiNchMKKNRJgr91xzykOQHw63CgS58KcxoBOYxYOhMKief5MbvajdbcBSFIta3mzcLu4Ex0kp4oITX0iM-7hrouol0SQDMkj2GAE2PrUD2VRQkrzi0pvnx_Sxs_E_HxvH4Vt_oczxv53X7N_J-PzXrNT-F_C-mOsk4xo1SzJNV_B6_VnnaVx7Txuw8juusHhyStTapG7n4KqDydcgqNAGi3BEHNH2K_FegDOAGnLk5e4m46xOplwXXrRzhSiEVXgZcqFvpLmzrxRLE-Vs5KT7NQxglj_KbSLIRBBMptoyLOF_iJUwb2Es-10jdgCuC8n1Sjgzf7r3pNFCIs03bUbvhcIn2kQnQ4gqVYKCXNBNJrCac5rSx0j0fFJRVg1VnnK5UU_NBLlqrLpNqgNpuQhqKX7CU-nJzxke5udoYUxJjAac06TUPOwjW_sMFS0aDIHTSIpIPHYk6UQ5B9oD6IH_7ALfrgjepoDL2qJLJLJT6oz2Co2qT6956yLEmeUQsaDCP6l-IG1L4O_E-YOqE652FwwZeFbNEJKZUBNsQgSPdUf3ALn7EYrM_0QdJI7_vL5uloyeLoYLXIBxsfhn3-jPR7r0yVLqyOQ7WY06XxegQNgrHmwh0wi7mlb9OLCzkfbXNNmA1ncZeIul0KnX54mLlSPt2OnrbC3igXsbVq-5GiV0jSni2VPOh5AoLv5mGk4T3CBBdzxHxH7RqJ5fu8KWxq2IoTixPJVxXPh2s1LflYJfHxKv25rhDHaHezQp-O1EUuH41MHbDN1Qg7yFBQi3RRY8AJQJ2BqUYMIB4GB6n38hPFwf2JuAhvLfxQpmAxgahIdErPW1kwGqC5IbCmWdkBVKhwFx4YfU7mM51E0DyzfW5PDMfzq41eMkMLXUbdT_fuX_olSpt_2fph1gIB1nW93PtnuYuakmWWT9pPr2r4p02tF_v0L9ZO4QsGTjvVvTCq5UFpmHd2JbJp28XSqv88QUIfVfIYLi3d79CadAwfonf6RcK4b1YnxpgQQPZW4vrqo6TX2LVcxvLEMJud_iOgmebaY1buMvp6aXs3G1YahDwHnJxv62fLZmfmfs6ca7L4_gl3Nukory8DLNiYjjvvbCWcrKNo0MizISL9gX_FicNqB1-QX0cFzJEEmxKgO3-6u317oXpNKlz3KpaYf7IDqWa_D-jGctdTayQu0ImDxT_CnKqaN2LhkwBlEypYQtdFFgBLUEp5OGQqFwpgYJq3iA03m9S1b15Q6Sj34I84ehSme6IUrUcNT9ZKxa2rkMtCziDoyhZZV_WRspUbmLz-zux46qxAD6DR96E0W5zmWZYSaarVbo-pwvHNPlRC83D-vTl1jdqS3Nz5XGFnOmmp-Giy0GRzTVmSZR934tL6LA5Gb7JCa75M4Xb0UwyIWEjh_EkgTWNuCzDHmcInYPTEnuuOq3XyXDiuJISCkIc1RNdalvqqbbgkEMjVwG0bBhxcz53FOcGHeBQ1gNWz8QwtFKu_bVDWDNhqE4lpFmH-A2W-xFQkHt34hPF1Z7IMjwEXdKjac3-jJXoqJF-gnS6LXy2mIfOmcPOhACRiE98wb_4kg8kvvOPfWx1I-suu8bm_qfNRmYJV_AeIZp9DNsCABfvrK1Q5GkEa4iCOJKDWYoblAlK6nrRp1XWN5ueCyve_sQ3HViSDjDgtYQoNPvXywR4JLVceRfsDVB9QLoJl3LaFhUnxW08GupYTCe0zxxPDORAr-Mot8fMtJDTFhoC_ZVr9fuH4ZsB3Ca165ZsdD6diw8H5gqnbylcacP-TSCzv8eHPo13y0py6GQuXWJ8KJ1tWK-6I7jPjr81bAf6omRmHerEcqK1Lngdp0EhSzbzZrAXcyAb74yepsZzhh7OJsTeXt_rE9j-eQPL3xwUKFRoDOiip1ZdNN1avHiugmiLXIxVjIiPs4irRd3nZvE_73x_Jy0Xu_I848W9pPG0gLL3op2QTMyNZMndFmvMCZl5w9S_kAcrFd7zEMYRzYlLeN9WQQXtRi5teSzLomhpdS1wS-XMhx9ox1basirkMOSA-L8gHDjMcTlC1AKl37CkxMCT9-wvX1TOFW3RmipGShnIukNFjq9M8za3zebOskc5I4UDeHE3fedCyttc47MW_-Q4PVnL6aJaTMQwXLSEiz4Laq0nTxJI4JwXgDDVdCQg8GEC0ft2tBAIpJ2B4kPoXWbD7MThtNRnA-V9YYfidw3TYYtc2I5hz1DjtSRQ-xsw_dAB50PSnJBTEnLDdO_uclIlZ0Z7xfb8NUAUegnbCLsrwHvQS1uL66mcJVI2EEYQMsXbFlR7-BKhwhIYaVj-zjDhEdWDCiI6ONU2Oc2xkDq6a3XDscZow6MssTXjLypRf1Bq1L6U71dX375LFeefQ0tI0gDcCTzTi58Vy_fax7uWv6Vg6I_IT4bNkaPEC8Ow4IdcUYaPKbjid9t4qwOzHGL-L6PCPt99xnBgnSMBCPc9L8zW8_KR28oiciMxnGHIIJvZWCXbzOJL5KCfakj0HDP5UYE9r8dL0fPxwQ6DkXsd7nLSbgfnRzApFee8w6Dcjd5zQOSmpG4mRrhuY6NyLv3khM13Whg5Qkm2Phmzf8Uzf8k4zgi3YDhkPOGHk3tbjWPHvsuwLXg9lRC1vM9kJTdwfJoiEAbRaB8jyO-ocguoSYGu3d8F-nIdBM9eQqgJ3PajpiCrLDNbd83HOvZOFLKkKVAXQblNyQDQXZjKhLUlfwqgcfuPcN8dwwqjeDIeX1_t1TqLwauGLaHwr65R2VyBWh-HQi2IsGIPjzt3YhLbhHzQ5MSkfCA9h0E7kjPChOziQE52OERaURnB4wc9QusqPYRhQLdDanq6W1FdbzNNNA3jkLQkjOQFNLsmaMdypZwGrpDK7cr5uNBRKuBHHlbB6p7xpqhCtRTyNH-ZQV1U-r45XpEOVK12JXdzDiMZNImK7mafjwhop56_W3FkisYYrPOJDDltay9DOo3IS4eXLigyUmMpbqUgvIckSqZJhLOrfeej3lDffZAM95cROC7Stdv3yNnbLPEox86hmHjh-kKrqptIupj8bfrvHmkofpoIevGMhB79a0IWOv35xk-_b21nqSOjz45xZVc51koacgGrP95BUm1Rx-l72M2NsvIDOAqwGVKs7_ccUZDGQx4ddfvbGaCXuRHTmpmTUPhRJpNjV9vrZPwbMoPZTJw3VZKLXJAXl2fk6oY0Wfhp-Ewho5ZQvmrgbBZlO96TFFpFo2lAbCFCcbHtxgstAugWORRS6sTu6NqwYMmrQ2BaI2H-jNlRZ7EEYzh54YiddEEr6ZSa5DFysZksYk2QvZFwbrw8eIkLNWRuvnrZ67RpD7ODennaII6AFIf4VWYMvhmbDIHbDLoPCkTm3IbhXSBaWswhayjYE4v0hlRU6x1U3iXk86d1h_yS0BjQvlh1kvXdVY72nbrb96z5elscfDj6ziOXKifYmlLRQdMKvgjN6sYN4Ol512w8vnG_VfPk6kNGE4YvFbgUkDt5heelc1Wch0cNc7cNyNyWYTQ6F0_1T62p3yhbLDwdkhBZ6eEKDTttu51qsVlYlHKA5WyZ6TzvVm0Y_Ni3Bifjw1rqnV08lEi5HGweujn6_jwEqTHcZBx0uJP-mcNYEnUEAdG0_NnseFUlPMncj16FO1yR6bFeMrsf7YhQqPl-U9hlTQpSl1gLByxwirB-_T6k1lP7STmUz31zgTsKMPBRVufThkAquslU94XUbSokKzLvo02VpgTVBgDJXzsjgnkyKY3lRKnU56UFoz9Kt_Na_JjzZiQ-4YT4T6w8qApH8K0PRVcPU5bv9Rys7NzR80En5agSMhN9SoN0-sYDNu8aGbO_IxOtJld735xlHDvHMeb9-HqQc8dP8RLkbdOxxVMYYqE8NDbRuR1RjtAV8NWi-RM7mXrIpbkxBr3kVtfVqAPvyRdDqlSAP41yzt6CVi3tUttbjhEzxNQZjQ5kHhQhJXXkJLUrPxbr6rdtbdiuHyJsdkIfaWFjSQe3W2xb8ks0auAq0r3-lNTuuMnpP3NhZC3wDPxbnkc9HVQcbSjznwoB1Z77vRSiiIjSkIHzt71_TRSC_dt13TY1MqtfAiMts7-ovMtyXX0Sy33nF21NofgIKD9QNIMIoSm3h0r5lnTJdCh9a9Qp_aA0hl6ee9tdSKz1cZhQvvB8p68-5NoTl-f5v_yF6CsT0o7CPq9Qk5pCbdOybkGFmaMon1fcF3iQQaRJFC9aByFLmOmIakK9dM8qnGHJ9vjPBS3m8NAJzQ1oic9_HAMhhYdsi8tfL4yWaYkNRmBZJExV4qfeZmKnqMbzBUqI9sco88NuqJsLcpihLei5yoJoukx4KF1W9jIGFlbARpNFGRpkF3e-k1ey_FiTLQ5TEnrRNp2OU7Vjc2eyqnrXgPoqO1hnakbjmbTHl1UiKxGV1eTYgQbmJVqA68XUmb_IfTrXJZLp4VcAYIxz0qgDdzIuJNiPnZEiRBskCnHUvY_AQg1AjHUUJRpY_jKI-cJrbT9hjpHpQreogkv9fNbR1KiRXbX-vvXS7P0bHnnLsvHbRnIme9rmphbvCJlI1QGrI8SYenxmLH44W8p4GcQN21Dv_ZdRdvLBG212NCoJUuYl4X3ox7p0_0RW-odGo-ZtLQh7BuJLTYnaw_PAlGBmIMhLgkkiGwoOJrP6S37mhJoe4DLVB6_lAWFrDkEWNH2KGrzz2zUjCyE-8t2mL-QOMZ_YZoTRnwReH7wHsBIYgS7FCEe85NlTseDqhMhC3hEQUj9gy_tLkhzAHQRWlertfLO3mKDqop10fb2iXxYrYxlQlxGDE8fDm_YleyhwNOYxtwuNQj2hvrGhUze7KevEa2kT-ychBhHtNsFZQAaK_ucLu_a_dOcmqsIpiRA1ti1xrJCU77rCXOz1G-bVB2DUHEhUPm8mM7hNM0ODiayXuMOJyHn9IZaQRK4nVfVGbkRuBw2p1yXG-0u1LZd_fPAyUjLgJSI0IMDcxTOiBsmLjg2cMzd7BGGANgnicHPpFi4y-bZt4wgXYyYiVIITnCnM2VYPlB2J_g5ONJx7E2nsEYCk8S0m8XHrv7Lnyb07z3D0RMxuQ1js1oFKX0BZBpr54qHRcj_Q8SelwxLLIncIpH26ObOCJ1RQIsXXXtPTY0ZDOs6b7-gFN5xxu7muvkvLWfRBEhc_f0j6PJ7hcZnYKQLa06zbt-4WvURTAgGrUdFLcLjm5YmUMiWMH9p3gEtU0Qr0hVSCij5Mz7dYU-JZQ6cxw4wr_zjX6sxmlkOsUd9anugFqOkIGmzx-fNUWiiFhQWjVClyhM1Pi0I-aPtHslDI9m57-yVInlHwHKLpy9xr9ZoTlhNxnznnlsro5jguLn5-kzsrgf5Ak_66pVky5QvKXjfydTeBCu2vefkYyokx0tXP7PlOXolNod7t6qrRqQ3NvWTakR8w0NnT-z80YRvtzKcM00y-9IiMo_jNRTaA5rzi1EH_o-Wtc4HsO-rtB1iYeZQeA7xbqZtm-ltP1cD585izMPxrp4mXY1cH321aI6WUxwPTVaroMJiVwsWG5b7vBUIcxzFdf4KS2Qs_MUcERb6KDsg0TT1GmVU8n1ul2szyJ9BJiR1gi1wICy2d8mvZTPdfIpXRWNHObAYcuaonb80Dnxl0AsUr96fy0JMYsFPRTrjuXYu-qaAGu4YVlxHB5J8tS2OzBLwlDxrKgisPdetuuAZN_BvPLzU7DGNuqfXLqNX7VdMNzfHPTbaz05YN8IjU_uiuT6ATkqQkAxtinp9ZDepfyC-Z3wcGSp3e6RH1AmXZIzJmbpBNtxkYcI2YtZMzoskY1rWgtINmOURB1Dcvqlka1InPT71rj4eJNZ7mZIFC2nvZ9zhFTrCSfQhhrzfonbwXFEZvBpwW0UmyAl8xE92L8q3rYnMW4X2BPPat7jIZSIgSfSLEqB6teNMcpPDHPghOQqIH9dmkYOKDH_Lqeb_N2u8RvvmhBApKBMAKdMsdCZ-tzqw5ARkV_4sFVETpyX8N2hFgnSkT1OKbPjkSU5XSnMzw5u8_jaN88YsbyyJKtd4-BLwaSsGVwaS5HBlRnsHZ6EvmKbfr-GXJoon4_8I7fCIoLktEeqkvWAnkx7L-foLkxbgD7ZQL1lgjw58EsqZKet6FKiT3z9z0bVm3znlWRlu2DTJj5fk8gwSLaHMt2GoNuHU6QN9LkCKAnzuksIuPzuG_8ymgO7FAN5wsAriZqm3txIiFbGpoLAjmUdmrMfajY6j3vHal8yZ5wIyavF5ySpsSGjAT-OAAm2_mrBmwwoK0SdR8sUdjRytfhO6WJ16lqx9KGU06sQ76GbiMyG8kXNKqnbmj5LjYfPwE9Br1OB1xv5IjcA7kg2ggrck2AaEeg6qKbs7EahbGrNe72e6wvYm7GTZeEN_Kg7JzV0qoPAOrsset_nyD69m8jVjyxz_bXvWl9XbqazweTTKDvUGDnMFQmpoKOAY6MhRB-rk5U1Eg3tMoeXTW3tQMg8NIRkg2bq8BsEAkAZq-3bVk3dx-tjVdNoUQ8gOWVukyk8MLlGhZ9Y5o7aLaVi97_w51BBxZbjjSJDXSHcnTCtMrIySVxtg2hUl0XegIi-tlKpPHYRcuPcRnUgHvsnrrmjPSVYXbHCLyWZTS4L3BrQAjFcsANhoSYE4GCaIUJRtbV4EuzSRJwb6t0JSLyoS3VGo_GExRbhQgalq7ENXUBol2AuoVYLs5SiWiCGW_A1lntoO4hxDStqO9fdouAucI6VSJvpe5wyk2jVl11TT8fXhKAIJsmfaZpMcgAS6rHxhj-eRhdkAod6319W6nHAXDG4hsiewU8lhCXEKc0e4E-2vHWSnkwTsuWN7sAbmof7IujTlyhNiCYcw5LEamcvYI1B7pOBd2ghizv1nhzI-ps-0aBAPMSnGHSQ-UzldPicm5q5p_BndgL5Bq65WYblE3nybpMgv3iAfnK2Q2eOQSPSPIhE2UTS7QjY7rLV1Qi_hpcH08Oyp5zzXmNYQDn4z7PH7StEHHEpXXcONkn00U_iOeSE_MMn4F5iPz0w7tx2biGVx3GFh_BTnmTR2hOwSydVuF5Uw_HEl68qK6Z1kGAfJjR8BOpaDKbNkpRi-50ISqMKdxT8SWLMnO1GiHK-e-J64jujidK5VV-95VMBhdqsJQ2Tkn5laj0aKS1RAiEBgFL1HD05X5mKis9fRZbEc3JdXYCsjXQ5U7hCJGzzgmqvwXBW- -rNUzAzoEpA6tenZHTPcanenL5HB6Tvn8fGwWKrMeaclWf3JFt8zQ4Ph52xr8k356e0XHPmmYemfYXN1hKIPLpauRLO08VItDYj8SC2EzYIXsrJGuYtjyDMnWtD2xN6kuzXDLKXNc32ez8hMmOQU4TuknT_Nh4LAWlYjmt1Lz_H3-_OymUDGriNnvw9Loh-W6tDwYDZzMTLP604LRtB9zMCTFvwdm1d5QjXPPPgXoeJOqQmylYughgjYbjlcTovefvtUdGYIeWhsH2dWd6pmvIg2JP77X9PQ7K83UJ1BdWpFpKtdfVWoynh1PpAeJojVXG0pUv0iA20YJzFucKfExZhbQKM7SS5jTPjNWMxEN0j9PjNoeAdcjcEEjRGVbq8Sh0rVNg-LhAnWhsmYNujbE5wfLkh5EcUHJISSkXkOwCup2Ksq9h_a3OHX3DKiEXoWPmtzQnt-h3HOAcqHq8zi02rcEisfzdYtMfndfiDtblxW_TRleqhh2KHdgP22oFsv78BfBQQF3F-CHHWgOj9gJYZUYNfWpHVBDCCrNsPpHRGer7EWlKNCHxW8059sOwea3c9n7eXh3GZjHl8yhXs-1ctcm7Dchc2pLWgqrCOKqAwDcI1sG3wkO5pYbR6ZLzOgrRaLREnMfm0UCeBFd1WgI_8KAfRfjfwRfjdeZDp2WdinjawmYL4wvqPiK7HRiojUO5bBx8Rr21gwasc0MLfEpQqlTYsMWrRjVFWWWXR3eNR3v5tBCQo8UiSmd2ReJyLlPPBRDGm-W4f5Pot-4h9xPdtgOg1fcnEEmC1-us1026dQQucJnnqu4Q309wJwk4l5XRXpIDQuW1tcR3qrB7dazqk1_sWES8Q5PymWfarWgazuA-mzwjeS_75Dm_1enP85LUUQDYxmIIL5XY_1g6aERft1XhtdAEeewUnRBn3hqzdkwZ0XeZE6fVM-njjHkcaONpok2cAtUGQvDtBMJoVBwBKvPHVibZI3MHa8A5M1ecNCGE6sQwLmBBq_P0Vn5LlcCgenckcQ1QqncZmZUsmBLBHSaItUW5R5JkrgBAAssZJrrEEIZnunB2vcH_ysne7pPitTb3tA_n8Pz2zb2UyVyq1Znh5O3IC_lm1_cg9WN7YwHq0ixzj5KLQ4AoHPdhN-5dsEzHdiqV225L66Enav9pC60NT2_9r_Df7UwoaDfZZqIUtSRBVQT8ST9iq2EQJ9ZDSPgfaB_XRHILVeItzeCj8EVGtKYe6mXSsK3fdxp1E-04g5ubUfwH3dxZnaIVFUFHHS-CTOKHKgoRhKIXMDQdkqkeOlnBavQurxMDe5Qtw3LdQKz3mkd2IOUNuyvAsbAVQrYznQe-xTIosTvnLAAUk2Rn3h3XIStoLr9pdOFPTu-v_PmBRPOAcaIszN2Ix7Va4Fe-SPFXwmiasu6DxTRYXfSIj7r8mi5SBRCQFPoMGcKH3UKti77SgiCFEnSjnbUISevaDBdCqlKVXUPsaIJ5ZKOqDwpJFoNNv1UkYcRhJz1h2JhglX3fmhN-ITOK51thTAZtNQHvRofNAMDKgyUwWW3v-nrSfw6gwqWkMJauzYvRtcecARv-nQy76hX5lcg6jY4zUl2xEBJOL_tB6CzpC5eU1wieOQ1mMuxOFLNtmKRyIQvhSO8QjUNwZ0hNbnf3wsqrtiLOkv9Rb1Vp2BF_JN4Q5GJ01LgNwiYzme8jlKUN225SNhtt7sivuMRQc_PWN-s3WFfvryvxyh5ST3eVZNXPa6DxZwMxV4rzCiFH7s2PED3bkJV-3NwTx_Gv-7Qo5coSu- -KuhyVnBySHwoV0KDP-bNiaM8FCjdiaMjVaVfJ73JNVqc4mDuYVvZoOuzmTvq7SH477gR3JaM1tpzibzaQzs6JZ9BMv8s5kS6_gL9YZCAaS35lVr7g2IoQi1yD8z0XHQ9hsMD7AB1pq5h_uCR2du7oFas1FnVmjvy5EzpqD7KlDV2q8qSE3x1LtOCHZa8nSru73IQvzXxNqY1JeQs6TM-Gffs3h_m00]--></g></svg>